{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u5173\u4e8e\u6211","text":"<p>\u6211\u53eb\u5f20\u745e\u6cfd\uff0c\u6211\u5bf9\u8ba1\u7b97\u673a\u7684\u70ed\u7231\u8bde\u751f\u4e8e\u5c0f\u5b66\u4e09\u5e74\u7ea7\u7b2c\u4e00\u6b21\u5728win95\u5b89\u88c5CS1.5\u65f6\uff0c\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u8f93\u5165\u4e86\u795e\u79d8\u7684yes\u56de\u8f66\u540e\u5f00\u59cb\u4f53\u4f1a\u5230\u4e86\u548c\u8ba1\u7b97\u673a\u5bf9\u8bdd\u7684\u5feb\u4e50\u3002</p> <p>\u6211\u4ece\u521d\u4e2d\u5f00\u59cb\u5b66\u4e60C\u8bed\u8a00\u4ee5\u53caFlash ActionScript\uff0c\u5e76\u6301\u7eed\u4f7f\u7528Flash ActionScript\u505a\u4e86\u4e00\u4e9b\u4e1c\u897f\u5230\u9ad8\u4e09\u3002</p> <p>\u6211\u540e\u6765\u7535\u5b50\u79d1\u6280\u5927\u5b66\u8ba1\u7b97\u673a\u672c\u79d1\u6bd5\u4e1a\u540e\uff0c\u4e3b\u8981\u8fdb\u884c\u5ba2\u6237\u7aef\u5f00\u53d1\u5de5\u4f5c\uff0c\u540e\u6765\u4e5f\u5305\u62ec\u4e00\u4e9b\u524d\u7aef\u548c\u540e\u7aef\u7684\u5de5\u4f5c\u3002</p> <p>\u6211\u559c\u6b22\u8ba1\u7b97\u673a\u7684\u65b9\u65b9\u9762\u9762\uff0c\u4e5f\u559c\u6b22\u4ece\u8ba1\u7b97\u673a\u6570\u5b57\u4e16\u754c\u5ef6\u5c55\u601d\u8003\u5176\u4ed6\u9886\u57df\u7684\u4e1c\u897f\uff0c\u4ece\u8ba1\u7b97\u673a\u548c\u6587\u5b66\u3001\u5230\u8ba1\u7b97\u673a\u548c\u56fe\u5f62\u3001\u97f3\u4e50\uff0c\u4efb\u4f55\u9177\u7684\u3001\u6f02\u4eae\u3001\u7f8e\u4e3d\u7684\u4e1c\u897f\u3002</p> <p>\u6211\u559c\u6b22\u5e7f\u6cdb\u63a5\u89e6\u65b0\u9c9c\u4e1c\u897f\uff0c\u5bfb\u6c42\u7075\u611f\u3002\u6211\u559c\u6b22\u521b\u9020\uff0c\u6211\u4e0d\u559c\u6b22\u6ee5\u7528\u6280\u672f\u3002\u6bd4\u5982\u8fc7\u5ea6\u7684\u9884\u52a0\u8f7d\uff0c\u8fc7\u5ea6\u7684\u57cb\u70b9\u91cf\u5316\uff0c\u8fc7\u591a\u7684\u4f18\u5316\u7b56\u7565\u6210\u4e3a\u65b0\u7684\u8d1f\u62c5\u3002</p> <p>\u6211\u7684\u505a\u4e8b\u539f\u5219\u67092\u6761\uff1a1. \u5148\u5f00\u773c\uff0c\u518d\u7acb\u5fd7\u30022. \u505a\u4ec0\u4e48\uff0c\u548c\u8c01\u505a\uff0c\u52aa\u529b\u505a\uff08\u50cf\u72ee\u5b50\u800c\u4e0d\u662f\u50cf\u725b\uff09\u3002</p> <p>\u6211\u9884\u8ba1\u4ecd\u7136\u4f1a\u5bfb\u6c42\u5de5\u4f5c\u5e76\u5de5\u4f5c\u5230\u7ea635\u5c81\uff082029\u5e74\uff09\u3002\u5e76\u5e0c\u671b\u6709\u671d\u4e00\u65e5\u53ef\u4ee5\u53d1\u5e03\u81ea\u5df1\u7684\u72ec\u7acb\u6e38\u620f\uff0c\u5c06\u6211\u7684\u6709\u8da3\u601d\u8003\u548c\u7075\u611f\u5e26\u7ed9\u66f4\u591a\u4eba\u3002</p>"},{"location":"#_2","title":"\u7b80\u5386","text":"<p>\u70b9\u51fb\u4e0b\u8f7d\u6211\u7684\u7b80\u5386\uff0c\u66f4\u65b0\u4e8e2025-6\u6708\u3002</p> <p>\u538c\u5026\u4e86\u9605\u8bfb\uff1f\u4f60\u4e5f\u53ef\u4ee5\u5411Grok\u63d0\u95ee\u5173\u4e8e\u6211\u7684\u95ee\u9898\u3002</p>"},{"location":"#_3","title":"\u5de5\u4f5c\u9879\u76ee","text":"<p>\u6211\u5728\u51e0\u5bb6\u4e92\u8054\u7f51\u516c\u53f8\u5de5\u4f5c\u8fc7\uff0c\u7279\u522b\u662f\u6211\u559c\u7231\u5728\u5b57\u8282\u8df3\u52a8\u7684\u5de5\u4f5c\u3002\u66f4\u591a\u7ec6\u8282\u8bf7\u53c2\u9605\u7b80\u5386\u6587\u4ef6\u3002</p>"},{"location":"#_4","title":"\u4e2a\u4eba\u9879\u76ee","text":""},{"location":"#_5","title":"\u6280\u672f\u63a2\u7d22\u7c7b","text":"<p>(*\u4ee3\u8868\u5b9e\u9a8c\u6027\u8d28\u9879\u76ee\uff0c\u672a\u5bf9\u5916\u53ef\u7528)</p> <ul> <li>2025\u5e74<ul> <li>cx* \u591aagent\u7684\u81ea\u52a8\u5316\u4ea4\u6613\u7b56\u7565\u5de5\u4f5c\u6d41\u3002\u57fa\u4e8eCoinMarketCap\u3001TradingView\u7b49\u7ad9\u70b9\u6570\u636e\u3002</li> </ul> </li> <li>2024\u5e74<ul> <li>wsjrpc* AI\u63a7\u5236\u591a\u8bbe\u5907\u80fd\u529b\u6846\u67b6\uff0c\u57fa\u4e8ewebsocket, jsonrpc\uff0c\u65e9\u4e8eMCP\u534f\u8bae\u3002</li> </ul> </li> <li>2022\u5e74<ul> <li>logdog* \u5bf9adb logcat\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u3001\u6279\u5904\u7406\u3002</li> <li>fretboard \u5728\u7ec8\u7aef\u6253\u5370\u5409\u4ed6\u6307\u677f\u548c\u5f26\u3001\u97f3\u9636\u56fe\u3002</li> </ul> </li> <li>2021\u5e74<ul> <li>Sticker Board \u8d34\u7eb8\u6d82\u9e26\u677f \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\uff0c\u73b0\u5df2\u505c\u670d\u3002</li> <li>lx* \u4f7f\u7528typescript\u5199\u7684\u96f6\u5916\u90e8\u4f9d\u8d56\u73a9\u5177\u8bed\u8a00\uff0c\u76ee\u524d\u53ef\u7f16\u8bd1\u5230jvm class\u3002</li> <li>mx*  \u4f7f\u7528electron\u5199\u7684\u684c\u9762\u7aef\u97f3\u4e50\u5e94\u7528\uff0c\u66ff\u6362\u684c\u9762\u7248\u7f51\u6613\u4e91\u97f3\u4e50\u3002</li> <li>zrek app* \u4f7f\u7528\u5404\u79cd\u65b9\u5f0f\u5f00\u53d1\u7684\u4e2a\u4eba\u5b89\u5353\u5e94\u7528\uff0c\u529f\u80fd\u4e0a\u66ff\u4ee3\u5fae\u535a\u3001\u7f51\u6613\u4e91\u97f3\u4e50\u3002\u5fae\u535a\u6a21\u5757\u5b8c\u5168\u4f7f\u7528Jetpack\u7f16\u5199\uff0c\u97f3\u4e50\u6a21\u5757\u4f7f\u7528Compose\u7f16\u5199\uff0c\u535a\u5ba2\u6a21\u5757\u4f7f\u7528Flutter\u7f16\u5199\uff0c\u540e\u7eed\u518d\u8865\u5145\u8bd5\u9a8c\u573a\u6765\u5f15\u5165React Native\u548clx\u3002</li> </ul> </li> <li>2019\u5e74<ul> <li>LoL Camera \u4f7f\u7528AR Core\u7f16\u5199\u7684LoL AR\u62cd\u7167\u7c7b\u5e94\u7528\u3002\u7ef4\u62a4\u622a\u6b62\u81f32019\u5e74\u3002</li> </ul> </li> </ul>"},{"location":"#_6","title":"\u97f3\u9891\u53ef\u89c6\u5316\u7c7b","text":"<ul> <li>2024\u5e74    <ul> <li>NUNA \u70b9\u51fb\u4ee5\u67e5\u770b\u5f55\u5c4f\u7247\u6bb5</li> <li>WE PRAY \u70b9\u51fb\u4ee5\u67e5\u770b\u5f55\u5c4f\u7247\u6bb5</li> <li>INK \u70b9\u51fb\u4ee5\u67e5\u770b\u5f55\u5c4f\u7247\u6bb5</li> </ul> </li> </ul>"},{"location":"#_7","title":"\u8ba1\u7b97\u56fe\u5f62\u7c7b","text":"<ul> <li>2022\u5e74<ul> <li>flower \u4f7f\u7528glsl\uff0c\u52a8\u6001\u7684\u82b1\u6735\u548c\u52a8\u6001\u7684\u989c\u8272</li> <li>complex linear gradient \u4f7f\u7528canvas\uff0c\u968f\u673a\u7684\u7ebf\u6027\u6e10\u53d8\u56fe\u6848\uff0c\u7c7b\u4f3cWindows vista\u65f6\u4ee3</li> <li>flow field \u4f7f\u7528canvas\u548csimple noise\uff0c\u7c92\u5b50\u5728\u573a\u4e2d\u50cf\u6c34\u6d41\u8fd0\u52a8</li> <li>path tracing \u4f7f\u7528c++\u57fa\u4e8esmallpt\u9879\u76ee\u62d3\u5c55\u7684\u8def\u5f84\u8ffd\u8e2a\u6e32\u67d3\u7a0b\u5e8f</li> </ul> </li> </ul>"},{"location":"#_8","title":"\u97f3\u4e50\u5236\u4f5c\u7c7b","text":"<p>\u4f5c\u54c1\u8bd5\u542c\u8bf7\u8bbf\u95ee\u7f51\u6613\u97f3\u4e50\u4eba\u4e3b\u9875</p> <ul> <li>2020\u5e74<ul> <li>Fly With Me 2020-1\u6708 \u7535\u5b50\u7c7b\u97f3\u4e50\u4f5c\u54c1</li> <li>\u8ffd\u5bfb 2020-1\u6708 \u6292\u60c5\u7c7b\u94a2\u7434\u3001\u5409\u4ed6\u97f3\u4e50\u4f5c\u54c1</li> <li>\u94f6\u8c37 2020-3\u6708 \u63cf\u8ff0\u5bd2\u51b7\u3001\u7a7a\u6d1e\u73af\u5883\u7684\u4f5c\u54c1</li> <li>\u968f\u98ce 2020-5\u6708 \u5409\u4ed6\u5f55\u97f3\u7c7b\u4f5c\u54c1\uff0c\u539f\u66f2 weather cock</li> </ul> </li> </ul>"},{"location":"#_9","title":"\u6e29\u99a8\u63d0\u793a","text":"<p>\u60a8\u5927\u53ef\u4e0d\u5fc5\u9605\u8bfb\u6b64\u7ad9\u70b9\u7684\u6280\u672f\u539f\u7406\u76f8\u5173\u5185\u5bb9\u3002</p> <p>\u56e0\u4e3a\uff1a\u5728\u8ba1\u7b97\u673a\u5de5\u7a0b\u65b9\u9762\uff0c\u6211\u89c9\u5f97\u6700\u5e94\u8be5\u8bfb\u7684\uff0c\u5e94\u8be5\u662f\u6e90\u7801\u3001\u548c\u89c4\u8303\u6587\u6863\u3002\u8bfb\u5176\u4ed6\u4eba\u52a0\u5de5\u7406\u89e3\u7684\uff0c\u90fd\u662f\u6709\u4e0d\u5c11\u98ce\u9669\u7684\uff0c\u5f88\u5bb9\u6613\u5efa\u7acb\u7247\u9762\u7684\u8ba4\u77e5...\u53ea\u6709\u4ea7\u54c1\u8bf4\u660e\u4e66\u548c\u6e90\u7801\u662f\u6700\u5ba2\u89c2\u3001\u6700\u5168\u9762\u7684\u3002\u5c3d\u7ba1\u8fd9\u79cd\u65b9\u5f0f\u6d88\u5316\u6548\u7387\u53ef\u80fd\u5dee\u4e00\u4e9b\uff0c\u95e8\u69db\u9ad8\u4e00\u4e9b\u3002\u4f46\u662f\u8bfb\u522b\u4eba\u52a0\u5de5\u8fc7\u7684\u4e1c\u897f\uff0c\u5e26\u6765\u7684\u7247\u9762\u8ba4\u77e5\u5bfc\u81f4\u7684\u5f2f\u8def\u3001\u53ef\u80fd\u8981\u82b1\u5f88\u4e45\u624d\u4f1a\u610f\u8bc6\u5230\u3002</p>"},{"location":"Android/Activity/","title":"Activity","text":""},{"location":"Android/Activity/#_1","title":"\u5e94\u7528\u542f\u52a8","text":""},{"location":"Android/Activity/#_2","title":"\u65b0\u8fdb\u7a0b\u521b\u5efa\u524d","text":"<p>\u5f53\u7528\u6237\u70b9\u51fb\u4e00\u4e2a\u5e94\u7528\u56fe\u6807\uff0c\u6216\u8005\u7cfb\u7edf\u8bf7\u6c42\u67d0\u4e2a\u7ec4\u4ef6\uff08\u6cdb\u6307Activity\uff0cService\u7b49\uff09\u65f6\uff0c\u5c06\u662f\u5e94\u7528\u542f\u52a8\u3001Activity\u542f\u52a8\u7684\u4e00\u822c\u65f6\u673a\u3002</p> <ol> <li>\u6784\u9020<code>Intent</code>\u901a\u8fc7<code>PackageManager</code>\u6765\u89e3\u6790\uff0c\u5176\u5185\u90e8\u662f\u7528<code>resolveIntent</code>\uff0c\u82e5\u89e3\u6790\u6210\u529f\uff0c\u5219\u4f1a\u4fdd\u5b58\u89e3\u6790\u7ed3\u679c\u5230\u6b64<code>Intent</code>\u5b9e\u4f8b\u4ee5\u907f\u514d\u540e\u9762\u518d\u6b21\u89e3\u6790\u3002</li> <li>\u68c0\u67e5\u6743\u9650\uff0c<code>grantUriPermissionLocked</code>\u3002\u5bf9\u4e8e\u9700\u8981\u7533\u8bf7\u6743\u9650\u7684<code>Intent</code>\uff0c\u9700\u8981\u786e\u5b9a\u76ee\u6807\u7ec4\u4ef6\u62e5\u6709\u5408\u9002\u7684\u6743\u9650\u3002</li> <li>\u63a5\u4e0b\u6765\uff0c\u7531<code>ActivityManagerService</code>\u68c0\u67e5<code>Intent</code>\u7684<code>flags</code>\u6bd4\u5982<code>FLAG_ACTIVITY_NEW_TASK</code>\u3001<code>FLAG_ACTIVITY_CLEAR_TOP</code>\u6765\u786e\u5b9a\u662f\u5426\u9700\u8981\u5f00\u542f\u65b0\u7684\u4efb\u52a1\u6808\u3002</li> <li>\u63a5\u4e0b\u6765\u68c0\u67e5\uff0c\u5bf9\u4e8e\u6240\u9700\u8981\u7684\u8fdb\u7a0b\u5176<code>ProcessRecord</code>\u662f\u5426\u5df2\u7ecf\u5b58\u5728\uff0c\u82e5\u6ca1\u6709\u5219\u9700\u8981\u4e3a\u6b64\u7ec4\u4ef6\u521b\u5efa\u8fdb\u7a0b\u3002\u5426\u5219\u53ea\u9700\u8981\u8fdb\u884c\u4efb\u52a1\u6808\u7684\u7ef4\u62a4\uff0c\u4e0d\u9700\u8981\u521b\u5efa\u8fdb\u7a0b\u3002</li> </ol>"},{"location":"Android/Activity/#_3","title":"\u65b0\u8fdb\u7a0b\u521b\u5efa","text":"<p><code>ActivityManagerService</code>\u901a\u8fc7<code>startProcessLocked</code>\u65b9\u6cd5\uff0c\u7ed9<code>Zygote</code>\u8fdb\u7a0b\u4ee5<code>Socket</code>\u901a\u4fe1\u53d1\u9001\u542f\u52a8\u53c2\u6570\u3002<code>Zygote</code>\u8fdb\u7a0b\u4f7f\u7528<code>fork</code>\u7cfb\u7edf\u8c03\u7528\u5206\u79bb\u51fa\u5b50\u8fdb\u7a0b\u5e76\u4e14\u8c03\u7528<code>ZygoteInit.main()</code>\u4e3b\u65b9\u6cd5\u3002\u5e76\u5b9e\u4f8b\u5316<code>ActivityThread</code>\uff0c\u8fd4\u56de\u8fdb\u7a0bid\u7ed3\u679c\u3002</p> <pre><code>// ProcessList.java\uff0c\u6ce8\u610f\u8fd9\u4e2aentryPoint\u5f88\u91cd\u8981\uff0c\u6211\u627e\u4e86\u534a\u5929\uff0c\u73b0\u5728\u6ca1\u6709\u663e\u5f0f\u5f15\u7528ActivityThread\uff0c\u800c\u662f\u6307\u5b9aclassName\u53bb\u53cd\u5c04\u627emain\u65b9\u6cd5\n    final String entryPoint = \"android.app.ActivityThread\"; \n\n    return startProcessLocked(hostingRecord, entryPoint, app, uid, gids,\n            runtimeFlags, zygotePolicyFlags, mountExternal, seInfo, requiredAbi,\n            instructionSet, invokeWith, startTime); \n</code></pre> <p>\u65b0\u7684\u5e94\u7528\u8fdb\u7a0b\u8fdb\u5165<code>ActivityThread.main</code>\uff0c\u521d\u59cb\u5316\u4e86Java\u4fa7\u7684handler\u5373<code>H</code>\u7c7b\u5b9e\u4f8b\uff0cLooper\u4fbf\u5f00\u59cbloop\uff0c\u5b83\u6240\u5bf9\u5e94\u7684\u7ebf\u7a0b\u5373\u4e3aUI\u7ebf\u7a0b\u3001\u4e3b\u7ebf\u7a0b\u3002\u7531\u6b64\u540e\u7eed\u7684\u901a\u4fe1\uff0c\u4fbf\u53ef\u4ee5\u57fa\u4e8e\u6b64Looper\u548cjava\u4fa7\u7684<code>H</code>handler\u5b9e\u4f8b\u3002<code>ActivityThread</code>\u7684\u5185\u90e8\u7c7b<code>ApplicationThread</code>\u5b9e\u73b0\u4e86<code>IApplicationThread</code>\u8fd9\u662f<code>AMS</code>\u670d\u52a1\u7528\u4e8e\u8c03\u7528\u5e94\u7528\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u7684\u4e00\u7ec4\u63a5\u53e3\uff0c\u5176\u4e2d\u5305\u62ec<code>bindApplication</code>\u548c<code>scheduleTransaction</code> <pre><code>// ActivityThread.java \u5df2\u7cbe\u7b80\n public static void main(String[] args) {\n        AndroidOs.install();\n        Environment.initForCurrentUser();\n        TrustedCertificateStore.setDefaultUserDirectory(configDir);\n        initializeMainlineModules();\n\n        // Looper\u51c6\u5907\uff0c\u7ed1\u5b9a\u7ebf\u7a0b\u5185Looper\u5355\u4f8b\n        Looper.prepareMainLooper(); \n\n        // \u521b\u5efaActivityThread\u5b9e\u4f8b\uff0c\u56e0\u4e3a\u6211\u4eec\u76ee\u524d\u53ea\u662f\u5728main\u9759\u6001\u5165\u53e3\u65b9\u6cd5\u91cc\u3002\n        ActivityThread thread = new ActivityThread();\n\n        // \u5728\u8fd9\u91cc\u4f1a\u7528`ActivityManagerService`\u7684`attachApplication`\u628a`IApplicationThread`\u7684\u5b9e\u73b0\u5b9e\u4f8b`appThread`\u4f20\u9012\u8fc7\u53bb\u3002\u7531\u6b64AMS\u53ef\u4ee5\u901a\u8fc7`IApplicationThread`\u548c\u5e94\u7528\u8fdb\u7a0b\u8fdb\u884c\u56de\u8c03\u3002\u6bd4\u5982\u540e\u9762\u7684`ApplicationThread.bindApplication`\n        thread.attach(false, startSeq);\n        if (sMainThreadHandler == null) {\n            //\u6784\u9020Java\u4fa7handler\uff0c\u5373`H`\u7c7b\u5b9e\u4f8b\n            sMainThreadHandler = thread.getHandler();\n        }\n        //\u8fdb\u5165epoll\n        Looper.loop();\n        throw new RuntimeException(\"Main thread loop unexpectedly exited\");\n    }\n</code></pre></p>"},{"location":"Android/Activity/#application","title":"Application\u521b\u5efa","text":"<p>\u63a5\u4e0b\u6765\u4f1a\u7531AMS\u8c03\u7528<code>IApplicationThread.bindApplication</code>\uff0c\u5176\u5185\u90e8\u7528<code>H</code>\u5b9e\u4f8b\u53d1\u9001\u6d88\u606f<code>BIND_APPLICATION</code>\u5230UI\u7ebf\u7a0b\uff0c\u8fdb\u800c\u5230<code>handleBindApplication</code>\u5904\u7406\u3002\u6bd4\u8f83\u5173\u6ce8\u7684\u8fc7\u7a0b\u5c31\u662f<code>makeApplication</code>\u548c<code>Application.onCreate</code></p> <p><pre><code>// ActivityThread.java # handleBindApplication \u5927\u5e45\u7cbe\u7b80\n    final ContextImpl appContext = ContextImpl.createAppContext(this, data.info);\n    mInstrumentation = new Instrumentation();\n    mInstrumentation.basicInit(this);\n    Application app;\n    app = data.info.makeApplication(data.restrictedBackupMode, null);\n    if (!data.restrictedBackupMode) {\n        if (!ArrayUtils.isEmpty(data.providers)) {\n            installContentProviders(app, data.providers);\n        }\n    }\n    mInstrumentation.onCreate(data.instrumentationArgs);\n    mInstrumentation.callApplicationOnCreate(app);\n</code></pre> \u4e3b\u8981\u7684\u70b9\u4e0d\u8a00\u81ea\u660e\u3002\u7531\u6b64\u53ef\u4ee5\u6ce8\u610f\u7684\u662f\uff1a</p> <ul> <li>\u65e0\u8bba\u662f\u4ec0\u4e48\u7ec4\u4ef6\uff0c\u4f46\u51e1\u9700\u8981\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u65f6\uff0c\u5747\u4f1a\u7ecf\u5386\u6b64\u521d\u59cb\u5316\uff0c\u5373<code>application</code>\u7684\u521b\u5efa\u3002</li> <li>ContentProvider\u7684\u521b\u5efa\u65f6\u65e9\u4e8e<code>Application#onCreate</code>\u7684\uff0c\u800c\u5176\u4ed6\u7ec4\u4ef6\u5219\u4e0d\u662f\u3002</li> </ul>"},{"location":"Android/Activity/#activity","title":"Activity\u542f\u52a8","text":"<p>\u5f53\u542f\u52a8Activity\u7684\u65f6\u5019\uff0c\u4f1a\u7531<code>AMS</code>\u8c03\u7528<code>IApplicationThread</code>\u7684<code>scheduleTransaction</code>\uff0c\u8fdb\u800c\u7531<code>ApplicationThread</code>\u7ed9<code>H</code>\u53d1\u9001\u4e00\u4e2a<code>EXECUTE_TRANSACTION</code>\u4fe1\u606f\uff0c\u8fdb\u800c\u4ea4\u7ed9<code>TransactionExecutor</code>\u53bb\u5904\u7406\u4e8b\u52a1\uff0c\u8fdb\u800c\u4f1a\u5206\u53d1\u7ed9\u4e0d\u540c\u7684<code>LifecycleItem</code>\u6765\u5904\u7406\u4e8b\u52a1\u3002</p> <p><pre><code>// H\ncase EXECUTE_TRANSACTION:\n    final ClientTransaction transaction = (ClientTransaction) msg.obj;\n    mTransactionExecutor.execute(transaction);\n    break;\n</code></pre> \u8fdb\u800c <pre><code>// TransactionExecutor.java \u5df2\u7cbe\u7b80\npublic void executeCallbacks(ClientTransaction transaction) {\n    final List&lt;ClientTransactionItem&gt; callbacks = transaction.getCallbacks();\n    final IBinder token = transaction.getActivityToken();\n    ActivityClientRecord r = mTransactionHandler.getActivityClient(token);\n    final int size = callbacks.size();\n    for (int i = 0; i &lt; size; ++i) {\n        final ClientTransactionItem item = callbacks.get(i);\n        item.execute(mTransactionHandler, token, mPendingActions);\n        item.postExecute(mTransactionHandler, token, mPendingActions);\n    }\n}\n</code></pre> \u4e5f\u5c31\u662f\u8bf4\uff0c<code>ClientTransactionItem</code>\u662f\u7531\u670d\u52a1\u7aef\u4f20\u5165\u7684\u3002\u5b83\u7684\u7ee7\u627f\u5173\u7cfb\u5305\u542b\uff1a ClientTransactionItem \u5b50\u7c7b</p> <ul> <li>ActivityTransactionItem<ul> <li>ActivityConfigurationChangeItem </li> <li>ActivityLifecycleItem <ul> <li>DestroyActivityItem</li> <li>PauseActivityItem</li> <li>ResumeActivityItem</li> <li>StartActivityItem</li> <li>StopActivityItem</li> </ul> </li> <li>ActivityRelaunchItem</li> <li>ActivityResultItem</li> <li>NewIntentItem</li> <li>LaunchActivityItem</li> </ul> </li> </ul> <p>\u6bcf\u4e2aitem\u7684<code>execute</code>\u65b9\u6cd5\u662f\u5176\u5177\u4f53\u5b9e\u73b0\u3002\u5bf9\u4e8e<code>Activity</code>\u6765\u8bf4\uff0c\u5148\u88ab<code>Launch</code>\u3002 <pre><code>// \u5927\u5e45\u7cbe\u7b80\n    public Activity handleLaunchActivity(ActivityClientRecord r,\n            PendingTransactionActions pendingActions, Intent customIntent) {\n        if (ThreadedRenderer.sRendererEnabled\n                &amp;&amp; (r.activityInfo.flags &amp; ActivityInfo.FLAG_HARDWARE_ACCELERATED) != 0) {\n            HardwareRenderer.preload();\n        }\n        WindowManagerGlobal.initialize();\n        final Activity a = performLaunchActivity(r, customIntent);\n        return a;\n    }\n// \u6838\u5fc3\u5185\u5bb9\uff0c\u5927\u5e45\u7cbe\u7b80\n    private Activity performLaunchActivity(ActivityClientRecord r, Intent customIntent) {\n        ContextImpl appContext = createBaseContextForActivity(r);\n        Activity activity = null;\n        java.lang.ClassLoader cl = appContext.getClassLoader();\n        // \u6784\u9020Activity\n        activity = mInstrumentation.newActivity(cl, component.getClassName(), r.intent);\n        Application app = r.packageInfo.makeApplication(false, mInstrumentation);\n\n        // attachBaseContext, \u521b\u5efaPhoneWindow\u3002\n        activity.attach(appContext, this, getInstrumentation(), r.token,\n                r.ident, app, r.intent, r.activityInfo, title, r.parent,\n                r.embeddedID, r.lastNonConfigurationInstances, config,\n                r.referrer, r.voiceInteractor, window, r.configCallback,\n                r.assistToken, r.shareableActivityToken);\n\n        // \u8fdb\u5165onCreate\n        mInstrumentation.callActivityOnCreate(activity, r.state);\n        return activity;\n    }\n</code></pre></p> <p>\u5230\u8fd9\u91ccActivity\u7684\u6784\u9020\u3001\u542f\u52a8\u5c31\u5b8c\u6210\u4e86\u3002</p>"},{"location":"Android/Activity/#_4","title":"\u603b\u7ed3","text":"<ul> <li>\u5e94\u7528\u542f\u52a8\u9996\u5148\u9700\u8981\u89e3\u6790Intent\uff0c\u786e\u8ba4\u542f\u52a8\u65b9\u5f0f\u3001\u6743\u9650\u3001\u662f\u5426\u80fd\u627e\u5230\u5bf9\u5e94\u5305\u3001\u4ee5\u53ca\u76ee\u6807\u6240\u9700\u8981\u7684\u4efb\u52a1\u6808\u662f\u5426\u6ee1\u8db3\u3002\u518d\u6839\u636e\u9700\u8981\u51b3\u5b9a\u662f\u5426\u521b\u5efa\u8fdb\u7a0b\u3002</li> <li>\u521b\u5efa\u8fdb\u7a0b\u7531\u7cfb\u7edf\u670d\u52a1\u548cZygote\u8fdb\u7a0b\u901a\u8fc7socket\u901a\u4fe1\uff0c\u4f1a\u53d1\u9001\u5927\u91cf\u7684\u65b0\u8fdb\u7a0b\u542f\u52a8\u53c2\u6570\u3002\u65b0\u8fdb\u7a0b\u542f\u52a8\u540e\uff0c\u4f1a\u521d\u59cb\u5316\u7cfb\u7edf\u670d\u52a1\u3001\u4ee5\u53ca\u865a\u62df\u673a\u7684\u4e00\u4e9b\u914d\u7f6e\u7b49\u3002\u8fdb\u800c\u8fdb\u5165\u6307\u5b9a\u7684\u5165\u53e3\u7c7b\u3002\u4e00\u822c\u662f<code>ActivityThread</code>\u3002</li> <li>ActivityThread\u5185\u90e8\u6709\u5f88\u591a\u7c7b\u3002\u5176\u4e2d<code>ApplicationThread</code>\u5b9e\u73b0\u4e86\u670d\u52a1\u7aef\u5bf9\u5ba2\u6237\u7aef\u7684\u4e00\u4e9b\u8c03\u7528\u8bf7\u6c42\uff0c\u4e3b\u8981\u65b9\u6cd5\u5305\u62ec<code>bindApplication</code>\u548c<code>scheduleTransaction</code>\u3002\u6b64\u5916\uff0cActivityThread\u7684\u4e3b\u65b9\u6cd5\u4f1a\u51c6\u5907Looper\u5e76\u8fdb\u5165\u5faa\u73af\u3002\u4efb\u610f\u7ebf\u7a0b\u5747\u53ef\u4ee5\u4f7f\u7528<code>ActivityThread.getHandler()</code>\u7684<code>H</code>\u5b9e\u4f8b\u6765\u53d1\u9001\u4fe1\u606f\u3001\u56de\u8c03\u7ed9UI\u7ebf\u7a0b\u3002</li> <li>ActivityThread\u8d1f\u8d23\u4e86\u4e0d\u6b62\u4e00\u4e2aactivity\u7684\u751f\u547d\u5468\u671f\uff0c\u800c\u662f\u6240\u6709\u6b64\u8fdb\u7a0b\u7684activity\u3002application\u7684\u751f\u547d\u5468\u671f\u4e5f\u662f\u7531\u5b83\u6765\u8d1f\u8d23\u3002\u5148\u7531AMS\u5bf9<code>ApplicationThread</code>\u53d1\u8d77<code>bindApplication</code>\uff0c\u4e4b\u540e\u5b83\u8fd8\u4f1a\u6784\u9020<code>ClientTransactionItem</code>\u5e76\u901a\u8fc7<code>ApplicationThread</code>\u53d1\u8d77<code>scheduleTransaction</code>\u8fdb\u800c\u5468\u8f6cActivity\u7684\u751f\u547d\u5468\u671f\u3002</li> </ul> <p>\u5173\u4e8e<code>Looper</code>, <code>Handler</code>, <code>Binder</code>, \u4ee5\u53ca\u6e32\u67d3\u6d41\u7a0b\uff0c\u8bf7\u53c2\u89c1\u201cAndroid\u201dsection\u5176\u4ed6\u6587\u7ae0\u3002</p>"},{"location":"Android/Activity/#activity_1","title":"Activity\u542f\u52a8\u6a21\u5f0f","text":"<ol> <li> <p>standrad</p> <ul> <li>\u603b\u662f\u521b\u5efa\u65b0\u7684\u5b9e\u4f8b\u5728\u5f53\u524d\u7684ActivityTask\u7684\u6808\u4e0a\u3002</li> <li>taskAffinity\u6ca1\u4f5c\u7528\u3002\u56e0\u4e3a\u603b\u662f\u5728\u5f53\u524d\u7684ActivityTask\u4e0a\u3002</li> <li>\u76f8\u5f53\u4e8e\u5728\u4e0d\u540c\u7684ActivityTask\u4e0a\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u5b9e\u4f8b\u3002</li> </ul> </li> <li> <p>singleTop</p> <ul> <li>\u5982\u679c\u5f53\u524d\u5df2\u7ecf\u662f\u540c\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5219\u4e0d\u518d\u521b\u5efa\u65b0\u5b9e\u4f8b\uff0c\u800c\u662fonNewIntent\u3002\u5176\u4ed6\u60c5\u51b5\u540c\u524d\u8005\u3002</li> </ul> </li> <li> <p>singleTask</p> <ul> <li>\u5e26\u6709clearTop\u6548\u679c\u3002\u5f53\u4e4b\u524d\u6253\u5f00\u8fc7\u6b64\u5b9e\u4f8b\uff0c\u540e\u9762\u5728\u6b64task\u4e0a\u63d2\u5165\u4e86\u65b0\u7684\u5176\u4ed6\u9875\u9762\uff0c\u53c8\u6253\u5f00\u6b64\u9875\u9762\u65f6\uff0c\u4f1a\u590d\u7528\u4e0a\u6b21\u7684\uff0c\u5e76\u6e05\u9664\u6240\u6709\u4e4b\u95f4\u7684\u9875\u9762\u3002</li> <li>\u5982\u679c\u6307\u5b9a\u4e86taskAffinity\uff0c\u4e0e\u5f53\u524d\u7684task\u4e0d\u7b26\u5408\uff0c\u5219\u4f1a\u5728\u65b0\u7684appTask\u4e2d\u7684\u6808\u4e0a\u6253\u5f00\u3002</li> </ul> </li> <li> <p>singleInstance</p> <ul> <li>\u4e0esingleTask\u76f8\u4f3c\uff0c\u4f46\u53ea\u5141\u8bb8\u81ea\u5df1\u51fa\u73b0\u5728\u8fd9\u4e2aActivityTask\u4e2d\u3002\u5373\u4f7f\u6b64\u65f6\u5982\u679c\u6253\u5f00\u4e00\u4e2ataskAffinity\u4e00\u6837\u7684\u4f46\u6a21\u5f0f\u4e5f\u662fsingleInstance\u7684\u65b0\u9875\u9762\u65f6\uff0c\u8fd9\u4e2atask\u4ecd\u7136\u53ea\u4f1a\u4fdd\u7559\u65b0\u7684\u9875\u9762\uff0c\u6b64\u65f6\u70b9\u51fb\u8fd4\u56de\u4f1a\u9000\u51fa\u3002</li> <li>\u5b9e\u9645\u4e0a\u6b64\u65f6\u6253\u5f00\u4efb\u4f55Activity\u90fd\u4f1a\u79bb\u5f00\u6b64Task\uff0c\u5728\u65b0\u7684task\u4e2d\u6253\u5f00\u3002\u5305\u62ec\u4e0a\u9762\u7684\u60c5\u51b5\u3002</li> </ul> </li> </ol>"},{"location":"Android/Activity/#activity_2","title":"activity\u751f\u547d\u5468\u671f\u7ec6\u8282","text":"<p>\u4eceactivity A \u6253\u5f00 activity B\uff0cactivity A\u7684stop\u4e00\u5b9a\u662f\u5728activity B\u7684resume\u4e4b\u540e\u3002\u81f3\u4e8e\u4e3a\u4ec0\u4e48\uff0c\u53ef\u4ee5\u601d\u8003\u4e0b\u52a8\u753b\uff0c\u52a8\u52a8\u8111\u5b50\u5c31\u80fd\u60f3\u5f97\u901a\u3002</p> <p></p> <p>\u6b64\u5916\uff0c\u5bf9\u4e8e\u542f\u52a8\u534a\u900f\u660e/\u4e0d\u900f\u660e\u7684Activity\u6765\u8bf4\uff0c\u5373<code>android:windowIsTranslucent</code>\u6807\u5fd7\u4f4d\u5dee\u5f02\uff0c\u5b83\u7684\u751f\u547d\u5468\u671f\u56de\u8c03\u6709\u6240\u4e0d\u540c\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5373\u5bf9\u4e8e\u534a\u900f\u660e\u7684\u60c5\u51b5\uff0cActivity A\u4e0d\u4f1a\u89e6\u53d1onStop\u3002</p> <p></p> <p></p>"},{"location":"Android/Activity/#_5","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Android Application Launch explained</li> <li>ProcessList.java</li> <li>ZygoteProcess.java \u7528\u4e8e\u548cZygote\u8fdb\u7a0b\u901a\u4fe1\uff0c\u53d1\u9001socket\u6570\u636e</li> <li>Zygote.java\uff0c\u6536\u5230\u6570\u636e\u540e\u8fdb\u5165ChildMain\u65b9\u6cd5</li> <li>ZygoteInit.java\uff0c<code>RuntimeInit.applicationInit</code>\u65b9\u6cd5\u4f1a\u52a0\u8f7d\u542f\u52a8\u53c2\u6570\u5217\u8868\u91cc<code>startClass</code>\u7684<code>main</code>\u65b9\u6cd5\u3002\u6b64\u65f6\u5373<code>ActivityThread</code>\u7684<code>main</code>\u3002</li> <li>ActivityThread.java\uff0c\u4ece<code>main</code>\u65b9\u6cd5\u5f00\u59cb\uff0c\u6784\u9020<code>ActivityThread</code>\u5b9e\u4f8b\uff0cLooper.prepare\u6784\u9020\u7ebf\u7a0b\u5355\u4f8b\uff0c\u6784\u9020<code>ActivityThread</code>\u7684java\u4fa7handler\u5373<code>H</code>\u7c7b\u5b9e\u4f8b\uff0c\u7136\u540e\u8fdb\u5165Looper\u5faa\u73af\u3002\u6b64Looper\u7ed1\u5b9a\u7684\u7ebf\u7a0b\u5373\u662f\u4e3b\u7ebf\u7a0b\u3002</li> <li>IApplicationThread.aidl</li> </ul>"},{"location":"Android/Binder%20IPC/","title":"Binder IPC","text":""},{"location":"Android/Binder%20IPC/#_1","title":"\u80cc\u666f\u6982\u8ff0","text":"<p>Binder\u662f\u4e00\u79cd\u57fa\u4e8eLinux\u7cfb\u7edf\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\u3002\u8d77\u6e90\u4e8eOpenBinder\uff0c\u7ecf\u8fc7\u591a\u6b21\u516c\u53f8\u8f6c\u624b\u5f00\u53d1\uff0cbinder\u9a71\u52a8\u7a0b\u5e8f\u57282014\u5e74\u5de6\u53f3\u5df2\u7ecf\u5408\u5165\u5230linux\u5185\u6838\u3002</p> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u5feb\u901f\u3001\u5355\u6b21\u62f7\u8d1d\u3002\u57fa\u4e8e\u6bcf\u4e2a\u8fdb\u7a0b(<code>ProcessState::self()-&gt;init-&gt;open_driver()</code>, <code>mmap</code>)\u6253\u5f00Binder\u9a71\u52a8\u6587\u4ef6\u5e76mmap\u4e86\u4e00\u90e8\u5206\u5185\u5b58\uff0c\u4ee5\u7528\u4e8e\u63a5\u53d7transaction\u6570\u636e\u3002\u5728\u901a\u4fe1\u65f6Binder\u53ea\u9700\u8981\u5c06\u6570\u636e\u4ece\u53d1\u8d77\u8fdb\u7a0b\u7684\u7528\u6237\u7a7a\u95f4\u5199\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u7684mmap\u865a\u62df\u5185\u5b58\u5730\u5740\u5373\u53ef\uff08\u5728\u5b89\u53538\u4e4b\u524d\u662f\u4e09\u6b21\u62f7\u8d1d\uff0c\u989d\u5916\u7684\u4e24\u6b21\u5728Parcel\u7684\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\uff0c\u8be6\u89c1\u4e0b\u6587\uff09\u3002</li> <li>\u9762\u5411\u5bf9\u8c61\u3002\u5f00\u53d1\u8005\u53cb\u597d\u3002native\u6216\u8005java\u4fa7\uff0c\u90fd\u53ef\u4ee5\u62ff\u5230\u670d\u52a1\u63a5\u53e3\u7684proxy\uff08native\u9760\u6a21\u677f\u548c\u5b8f\u5c55\u5f00\uff0cjava\u9760aidl\u751f\u6210\uff09\uff0c\u53ef\u4ee5\u76f4\u63a5\u50cf\u8c03\u7528\u672c\u5730\u5bf9\u8c61\u7684\u65b9\u6cd5\u4e00\u6837\u8bbf\u95ee\u670d\u52a1\u8fdb\u7a0b\u7684\u529f\u80fd\u3002</li> <li>\u5b89\u5168/\u53ef\u8ba2\u9605\uff08\u6b7b\u4ea1\u4fe1\u606f\uff09</li> </ul> <p>\u4e89\u8bae\uff1a\u7531\u4e8elinux\u7f3a\u4e4f\u5bf9\u9ad8\u901fipc\u7684\u652f\u6301\uff0c\u51fa\u73b0\u4e86\u591a\u79cd\u9488\u5bf9\u9ad8\u901fipc\u7684\u65b9\u5f0f\u3002\u800cbinder\u7684\u4e89\u8bae\u4e3b\u8981\u5728\u4e8e\uff0c\u5bf9\u540c\u4e00\u4e2a\u8bbe\u5907\u6587\u4ef6\u6807\u8bc6\u7b26\uff0c\u5373<code>dev/binder</code>\uff0c\u5728\u4e0d\u540c\u8fdb\u7a0b\u4e2d\u7684\u884c\u4e3a\u662f\u4e0d\u4e00\u6837\u7684\u3002\u8fd9\u4e2a\u548c\u5927\u90e8\u5206\u4eba\u7684\u9884\u671f\u4e0d\u7b26\u3002 \u5728\u4e89\u6267\u4e86\u4e00\u6bb5\u65f6\u95f4\u540e\u8fd8\u662f\u5408\u5165\u4e86Linux\uff0c\u5e76\u4e14\u4e5f\u88ab\u529d\u544a\u5b83\u5e76\u4e0d\u597d\u7528\uff0c\u4f7f\u7528\u8005\u9700\u8981\u81ea\u884c\u8d1f\u8d23\u3002</p>"},{"location":"Android/Binder%20IPC/#_2","title":"\u8bbe\u8ba1\u6982\u8ff0","text":"<p>\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee<code>dev/binder</code>\u6807\u8bc6\u7b26\uff0c\u6765\u548cbinder\u9a71\u52a8\u7a0b\u5e8f\u901a\u4fe1\u3002\u800cbinder\u9a71\u52a8\u7a0b\u5e8f\u63d0\u4f9b\u4e86ipc\u7684\u6240\u9700\u6240\u6709\u529f\u80fd\u63a5\u53e3\u3002</p> <p>\u60c5\u666f\u5316\u601d\u8003\uff1a</p> <p>\u601d\u8003\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff0c\u8fdb\u7a0bA\uff0c\u8981\u548c\u4e00\u4e2a\u670d\u52a1B\u901a\u4fe1\uff0c\u8fd9\u4e2a\u670d\u52a1B\u65e2\u5305\u62ec\u7cfb\u7edf\u5185\u7f6e\u7684\u7cfb\u7edf\u670d\u52a1\uff0c\u4e5f\u5305\u62ec\u7528\u6237\u5e94\u7528\u63d0\u4f9b\u7684\u670d\u52a1\u3002\u800c\u670d\u52a1\u4f1a\u52a8\u6001\u53d8\u5316\uff0c\u56e0\u6b64\u5bf9\u4e8e\u8fdb\u7a0bA\u6765\u8bf4\uff0c\u60f3\u8981\u786c\u7f16\u7801\u4e00\u4e2a\u670d\u52a1\u5730\u5740\uff0c\u5e76\u4e0d\u53ef\u53d6\uff0c\u5408\u7406\u7684\u8bbe\u8ba1\u5e94\u8be5\u662fSPI\uff0c\u5373ServiceProviderInterface\uff0c\u6216\u8005SL\u5373ServiceLocator\u8bbe\u8ba1\u6a21\u5f0f\u3002\u4e8e\u662f\u5e94\u8be5\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u670d\u52a1\u5730\u5740\uff0c\u5b83\u6240\u63d0\u4f9b\u7684\u6838\u5fc3\u670d\u52a1\u4fbf\u662f\u67e5\u8be2\u5176\u4ed6\u670d\u52a1\u7684\u5730\u5740\u3002</p> <p>\u800c<code>ServiceManager</code>\uff0c\u5bf9\u5e94\u7684<code>handle:0</code>\uff0c\u5c31\u662f\u8fd9\u4e2a\u56fa\u5b9a\u5730\u5740\u7684\u7cfb\u7edf\u670d\u52a1\uff0c\u6240\u626e\u6f14\u7684\u89d2\u8272\u5c31\u662f\u670d\u52a1\u7ba1\u7406\u5668\u3002\u5b83\u81ea\u5df1\u9700\u8981\u4ecebinder\u9a71\u52a8\u7684<code>ioctl</code>\u6765\u8bbe\u7f6e\u81ea\u5df1\u662f\u7ba1\u7406\u8005\u3002\u800c\u5176\u4ed6\u7684\u670d\u52a1\u8fdb\u7a0b\u9700\u8981\u501f\u52a9binder\u9a71\u52a8\u7684<code>ioctl</code>\u6765\u548cserviceManager\u901a\u4fe1\uff0c\u8c03\u7528\u5b83\u7684<code>addService</code>\u670d\u52a1\u6765\u6ce8\u518c\u81ea\u5df1\u7684\u670d\u52a1\u3002\u800c\u5bf9\u4e8e\u8fdb\u7a0bA\uff0c\u5219\u662f\u4f9d\u9760binder\u9a71\u52a8<code>ioctl</code>\u6765\u4ece<code>serviceManager</code>\u4e2d\u83b7\u53d6\u67d0\u670d\u52a1\uff0c\u6bd4\u5982\u4f20\u5165\u7279\u5b9a\u679a\u4e3e\uff0c\u4ee5\u83b7\u5f97\u8be5\u679a\u4e3e\u5bf9\u5e94\u670d\u52a1\u7684<code>IBinder</code>\uff0c\u518d\u8f6c\u4e3a<code>Proxy</code>\u6765\u8c03\u7528\u76ee\u6807\u670d\u52a1\u7684\u529f\u80fd\u3002\u8c03\u7528\u76ee\u6807\u670d\u52a1\u7684\u529f\u80fd\u65f6\uff0c\u672c\u8d28\u4e0a\u548c<code>serviceManager</code>\u83b7\u53d6\u670d\u52a1\u65f6\u7684\u901a\u4fe1\u4e5f\u6ca1\u533a\u522b\u3002</p> <p></p>"},{"location":"Android/Binder%20IPC/#_3","title":"\u9884\u5907\u77e5\u8bc6","text":"<p>\u5728\u6b63\u5f0f\u5f00\u59cb\u524d\u9700\u8981\u5148\u660e\u786e\u4e00\u4e9b\u57fa\u672c\u7684\u77e5\u8bc6\u3002</p>"},{"location":"Android/Binder%20IPC/#alloc-malloc-calloc","title":"alloc, malloc, calloc","text":"<p>alloc\u5728\u6808\u4e0a\u5206\u914d\u5185\u5b58\u3002 malloc\u662f\u53ea\u5206\u914d\u5185\u5b58\uff0c\u4f46\u9700\u8981Memset\u540e\u624d\u80fd\u8bbf\u95ee\u3002 \u800ccalloc\u662f\u5206\u914d\u5185\u5b58\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\uff08\u90fd\u586b0\uff09\u3002\u540e\u4e24\u8005\u662f\u5728\u8fdb\u7a0b\u5806\u4e0a\u5206\u914d\u3002</p>"},{"location":"Android/Binder%20IPC/#kzalloc-kmalloc","title":"kzalloc, kmalloc","text":"<p>k\u524d\u7f00\u8868\u793a\u662f\u4eceKernel\u8c03\u7528\uff0c\u7528\u4ee5\u533a\u5206\u4ece\u7528\u6237\u7a7a\u95f4\u7684\u8c03\u7528\u3002\u90fd\u662f\u5728\u5185\u5b58\u5806\u4e2d\u5206\u914d\u3002\u524d\u8005\u4f1a\u6e05\u96f6\uff0c\u540e\u8005\u4e0d\u4f1a\u3002</p>"},{"location":"Android/Binder%20IPC/#mmap","title":"mmap","text":""},{"location":"Android/Binder%20IPC/#current","title":"current","text":"<p>\u5373\u5f53\u524d\u7684\u8fdb\u7a0btask_struct</p>"},{"location":"Android/Binder%20IPC/#pid-tid-tgid","title":"pid tid tgid","text":"<p>pid=processId, tid=threadId\u3002</p> <p>\u5728linux\uff0c\u7ebf\u7a0b\u5728\u5185\u6838\u6240\u7ef4\u62a4\u7684\u4efb\u52a1\u6570\u636e\u7ed3\u6784\u548c\u8fdb\u7a0b\u4e00\u81f4\uff0c\u90fd\u662ftask_struct\uff0c\u6240\u4ee5tid\u5c31\u662f\u7ebf\u7a0b\u5bf9\u5e94task_struct\u91cc\u9762\u7684pid\u3002\u800cpid\u5b9e\u9645\u4e0a\u662f\u8fdb\u7a0b\u5bf9\u5e94task_struct\u91cc\u9762\u7684tgid\u3002\u4e5f\u5c31\u662f\u7ebf\u7a0b\u7ec4id\u3002\u5bf9\u8fdb\u7a0b\u4e2d\u7684\u4e3b\u7ebf\u7a0b\u6765\u8bf4\uff0ctid = pid = tgid\u3002</p> <p>\u56e0\u6b64\u4f1a\u770b\u5230\u5728binder driver\u91cc\uff0cbinder_ioctl\u4e2d\u5bf9binder_thread\u7684\u83b7\u53d6\u5373\u5f53\u524d\u7ebf\u7a0b\u7684\u83b7\u53d6\u65b9\u5f0f\u662f\u5728<code>flip-&gt;privateData(BinderProc)</code>\u5bf9\u7ea2\u9ed1\u6811\u6570\u636e\u7ed3\u6784\u91cc\u7684\u8282\u70b9\u8bb0\u5f55\u6839\u636e<code>current-&gt;pid</code>\u6765\u6bd4\u5bf9\u67e5\u8be2\u3002\u5982\u679c\u67e5\u8be2\u4e0d\u5230\uff0c\u5219\u521b\u5efa\u65b0\u7684binder_thread\u8282\u70b9\u63d2\u5165\u5176\u4e2d\u3002</p>"},{"location":"Android/Binder%20IPC/#_4","title":"\u901a\u4fe1\u6d41\u7a0b\u63cf\u8ff0","text":""},{"location":"Android/Binder%20IPC/#ibinder-bbinder-bpbinder","title":"IBinder BBinder BpBinder","text":"<p><code>IBinder</code>\u4e2d\u5305\u542b<code>transact</code>\u7b49\u65b9\u6cd5\uff0c\u6709\u4e24\u4e2a\u5173\u952e\u5b50\u7c7b\uff1a</p> <ul> <li><code>BBinder</code>\uff08\u7406\u89e3\u4e3aService\u7684\u5b9e\u73b0\u7aef\uff09\uff0c\u4e5f\u5c31\u662f\u771f\u6b63\u5b9e\u73b0\u4e86\u670d\u52a1\u63a5\u53e3\uff0c\u4e00\u822c\u5728\u5b9e\u73b0\u7c7b\u4e2d\uff0c\u7b49\u5f85Binder\u6846\u67b6\u8c03\u7528\u5176onTransact-&gt;\u5e76\u89e3\u5305\u6570\u636e\uff0c\u8fdb\u800c\u5206\u53d1\u5230\u63a5\u53e3\u65b9\u6cd5\u4e0a\u3002</li> <li><code>BpBinder</code>\uff08\u7406\u89e3\u4e3aClient\u7aef\uff09\uff0c\u4e5f\u5c31\u662f\u670d\u52a1\u63a5\u53e3\u7684Proxy\u3002\u5ba2\u6237\u7aef\u8c03\u7528Proxy\uff0cProxy\u8d1f\u8d23\u5c01\u88c5\u6570\u636e\u3001\u8f6c\u4e3aParcel\uff0c\u8fdb\u884c\u540e\u7eed\u7684transact\u3002</li> </ul> <p>Parcel\u5728<code>writeBinder</code>\u65f6\uff0c\u5982\u679c\u662f\u5199\u5165<code>BBinder</code>\uff0c\u4e5f\u5c31\u662f\u670d\u52a1\u5b9e\u73b0\u7aef\uff0c\u4f1a\u8bb0\u5f55<code>binder_object_type: binder_type_binder</code>\u3002\u82e5\u662f\u4ee3\u7406\u7aef\uff0c\u5219\u662f<code>binder_type_handle</code>.\u8fd9\u4e24\u79cd\u7c7b\u578b\uff0c\u4f1a\u5728binder\u9a71\u52a8\u7684<code>binder_transaction</code>\u65b9\u6cd5\u4e2d\u5bf9\u5e94\u4e0d\u540c\u7684\u884c\u4e3a\u3002</p> <p><pre><code>//\u5df2\u7cbe\u7b80\nstatus_t BpBinder::transact(\n    uint32_t code, const Parcel&amp; data, Parcel* reply, uint32_t flags)\n{\n   status = IPCThreadState::self()-&gt;transact(binderHandle(), code, data, reply, flags);\n   return status;\n}\n</code></pre> \u5373\u4ea4\u7531<code>IPCThreadState</code>\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662f\u8fd9\u91cc\u7684<code>binderHandle()</code>\uff0c\u56e0\u4e3a\u5b83\u5c06\u7528\u4e8e\u5728\u6b64\u8fdb\u7a0b\u5bf9\u5e94\u7684Binder\u9a71\u52a8\u4e2d<code>binder_proc</code>\u7ed3\u6784\u91cc\u68c0\u7d22\u76ee\u6807\u8fdb\u7a0b\u7684<code>binder_ref_node</code>\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cBpBinder\u7684<code>transact</code>\u65b9\u6cd5\u867d\u7136\u6ca1\u66b4\u9732<code>handle</code>\u53c2\u6570\uff0c\u4f46\u5b83\u7684\u5185\u90e8\u6210\u5458<code>mHandle</code>\u5728BpBinder\u6784\u9020\u65f6\u4fbf\u5f97\u5230\u4e86\u6b64\u4ee3\u7406\u6240\u5bf9\u5e94\u7684\u5728\u8be5\u8fdb\u7a0b\u4e2d\u7684<code>handle</code>\u503c\u3002</p> <p>\u66f4\u8fdb\u4e00\u6b65\u6765\u8bb2\uff0cBpBinder\u7684\u521b\u5efa\u4e3b\u8981\u5206\u4e24\u79cd\uff1a</p> <ul> <li>handle\u4e3a0\u8868\u793a<code>ServiceManager</code>\u7684BpBinder\u3002</li> <li>\u901a\u8fc7<code>ServiceManager</code>\u7684\u529f\u80fd\u63a5\u53e3\u5f97\u5230\u7684\u8fd4\u56de\u7ed3\u679c\u91cc\u5305\u542b\u4e86IBinder\uff0c\u6b64\u65f6\u4f1a\u5728\u89e3\u5305\u7684\u8fc7\u7a0b\u4e2d\u7ecf\u7531<code>Parcel.readStrongBinder</code> ..-&gt; <code>Parcel.unflatternBnder</code>\uff1a</li> </ul> <p><pre><code>status_t Parcel::unflattenBinder(sp&lt;IBinder&gt;* out) const\n{\n        switch (flat-&gt;hdr.type) {\n            case BINDER_TYPE_BINDER: {\n                sp&lt;IBinder&gt; binder =\n                        sp&lt;IBinder&gt;::fromExisting(reinterpret_cast&lt;IBinder*&gt;(flat-&gt;cookie));\n               // \u8fd9\u91cc\u4ee3\u8868\u662f\u672c\u5730binder\n                return finishUnflattenBinder(binder, out);\n            }\n            case BINDER_TYPE_HANDLE: {\n                sp&lt;IBinder&gt; binder =\n                    ProcessState::self()-&gt;getStrongProxyForHandle(flat-&gt;handle);\n               // \u6b64\u8def\u5f84\u6700\u7ec8\u4f1a\u8c03\u7528\u5230 BpBinder::PrivateAccessor::create(handle);\u5373\u521b\u5efa\u4e86\u6b64handle\u7684BpBinder\n                return finishUnflattenBinder(binder, out);\n            }\n        }\n}\n</code></pre> \u5173\u4e8eIBinder\u7684type\u6709\u5982\u4e0b\u8bf4\u660e\uff1a</p> <p></p>"},{"location":"Android/Binder%20IPC/#processstate","title":"ProcessState","text":"<p>\u8fdb\u7a0b\u5355\u4f8b\u3002\u6784\u9020\u65b9\u6cd5\u5982\u4e0b\uff1a <pre><code>//\u5df2\u7cbe\u7b80\nProcessState::ProcessState(const char* driver)\n      : mDriverName(String8(driver)),\n        mDriverFD(-1),\n        mMaxThreads(DEFAULT_MAX_BINDER_THREADS) {\n    base::Result&lt;int&gt; opened = open_driver(driver);\n        // mmap the binder, providing a chunk of virtual address space to receive transactions.\n        mVMStart = mmap(nullptr, BINDER_VM_SIZE, PROT_READ, MAP_PRIVATE | MAP_NORESERVE,\n                        opened.value(), 0);\n        mDriverFD = opened.value();\n}\n\nstatic base::Result&lt;int&gt; open_driver(const char* driver) {\n    int fd = open(driver, O_RDWR | O_CLOEXEC);\n    status_t result = ioctl(fd, BINDER_VERSION, &amp;vers);\n    size_t maxThreads = DEFAULT_MAX_BINDER_THREADS;\n    result = ioctl(fd, BINDER_SET_MAX_THREADS, &amp;maxThreads);\n    return fd;\n}\n</code></pre> \u5373\u6253\u5f00Binder\u9a71\u52a8\uff0c\u5e76\u4ee5\u6253\u5f00\u7684fd\u6765\u6620\u5c04\u4e00\u7247\u865a\u62df\u5185\u5b58\u3001\u53ea\u8bfb\u3001\u79c1\u6709\u3002\u8fd9\u91cc\u4e5f\u7b80\u5355\u770b\u4e0bBinder\u9a71\u52a8\u4e2d\u7684\u5904\u7406\uff1a <pre><code>//\u5df2\u7cbe\u7b80\nstatic int binder_open(struct inode *nodp, struct file *filp)\n{\n    proc = kzalloc(sizeof(*proc), GFP_KERNEL);\n    if (proc == NULL)\n        return -ENOMEM;\n    INIT_LIST_HEAD(&amp;proc-&gt;todo);\n    init_waitqueue_head(&amp;proc-&gt;freeze_wait);\n    proc-&gt;context = &amp;binder_dev-&gt;context;\n    binder_alloc_init(&amp;proc-&gt;alloc);\n    binder_stats_created(BINDER_STAT_PROC);\n    proc-&gt;pid = current-&gt;group_leader-&gt;pid;\n    INIT_LIST_HEAD(&amp;proc-&gt;delivered_death);\n    INIT_LIST_HEAD(&amp;proc-&gt;waiting_threads);\n    filp-&gt;private_data = proc;\n    return 0;\n}\nstatic int binder_mmap(struct file *filp, struct vm_area_struct *vma)\n{\n    struct binder_proc *proc = filp-&gt;private_data;\n    return binder_alloc_mmap_handler(&amp;proc-&gt;alloc, vma);\n}\n/**\n * binder_alloc_mmap_handler() - map virtual address space for proc\n * @alloc:  alloc structure for this proc\n * @vma:    vma passed to mmap()\n *\n * Called by binder_mmap() to initialize the space specified in\n * vma for allocating binder buffers\n *\n * Return:\n *      0 = success\n *      -EBUSY = address space already mapped\n *      -ENOMEM = failed to map memory to given address space\n */\nint binder_alloc_mmap_handler(struct binder_alloc *alloc,\n                  struct vm_area_struct *vma)\n{\n    alloc-&gt;buffer = (void __user *)vma-&gt;vm_start;\n    alloc-&gt;pages = kcalloc(alloc-&gt;buffer_size / PAGE_SIZE,\n                   sizeof(alloc-&gt;pages[0]),\n                   GFP_KERNEL);\n    buffer-&gt;user_data = alloc-&gt;buffer;\n    list_add(&amp;buffer-&gt;entry, &amp;alloc-&gt;buffers);\n    buffer-&gt;free = 1;\n    binder_insert_free_buffer(alloc, buffer);\n    alloc-&gt;free_async_space = alloc-&gt;buffer_size / 2;\n    binder_alloc_set_vma(alloc, vma);\n    mmgrab(alloc-&gt;vma_vm_mm);\n    return 0;\n}\n</code></pre> \u5f53\u5b9e\u73b0\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0copen\u65b9\u6cd5\u7b7e\u540d\u662f<code>int (*open)(struct inode *inode, struct file *filp);</code>\u3002\u5176\u4e2d\uff0cfilp\u662ffile pointer\u5373\u6587\u4ef6\u6307\u9488\u7684\u542b\u4e49\u3002\u5728\u9a71\u52a8\u7a0b\u5e8f\u7684open\u65b9\u6cd5\u4e2d\uff0c\u4e00\u822c\u4f1a\u5206\u914d\u5e76\u586b\u5145\u8981\u653e\u8fdb <code>filp-&gt;private_data</code> \u7684\u4efb\u4f55\u6570\u636e\u7ed3\u6784\u3002Binder\u9a71\u52a8\u4e5f\u4e0d\u4f8b\u5916\uff0c\u5b83\u7684<code>flip-&gt;private_data</code>\u662f<code>binder_proc</code>\u7ed3\u6784\u3002</p> <p>\u4e4b\u540e\u5728mmap\u7684\u5904\u7406\u4e2d\uff0c\u7531Binder \u9a71\u52a8\u7533\u8bf7\u4e86\u4e00\u5757\u5185\u5b58\u5e76\u767b\u8bb0\u5728<code>binder_proc</code>\u7ed3\u6784\u4f53\u4e2d\u3002</p>"},{"location":"Android/Binder%20IPC/#ipcthreadstate","title":"IPCThreadState","text":"<p>\u5177\u4f53\u7684IPC\u7ebf\u7a0b\u72b6\u6001\uff0c\u7ebf\u7a0b\u5185\u5355\u4f8b\uff0c\u8d1f\u8d23IPC\u4e8b\u52a1\uff0c\u6784\u9020\u65b9\u6cd5\u5982\u4e0b\uff1a <pre><code>// \u5df2\u7cbe\u7b80\nIPCThreadState::IPCThreadState()\n      : mProcess(ProcessState::self()){\n    pthread_setspecific(gTLS, this);\n    mIn.setDataCapacity(256);\n    mOut.setDataCapacity(256);\n}\n</code></pre> \u5b83\u7684transact\u65b9\u6cd5\u4ee3\u7801\u7cbe\u7b80\u5982\u4e0b\uff1a <pre><code>status_t IPCThreadState::transact(int32_t handle,\n                                  uint32_t code, const Parcel&amp; data,\n                                  Parcel* reply, uint32_t flags)\n{\n    err = writeTransactionData(BC_TRANSACTION, flags, handle, code, data, nullptr);\n    if ((flags &amp; TF_ONE_WAY) == 0) {\n        if (reply) {\n            err = waitForResponse(reply);\n        } else {\n            Parcel fakeReply;\n            err = waitForResponse(&amp;fakeReply);\n        }\n    } else {\n        err = waitForResponse(nullptr, nullptr);\n    }\n    return err;\n}\n</code></pre> \u5373\u5199\u5165\u4e8b\u52a1\u6570\u636e\uff0c\u7b49\u5f85\u54cd\u5e94\u3002\u82e5\u9700\u8981\u56de\u590d\uff0c\u5373\u9700\u8981\u670d\u52a1\u7aef\u7684\u670d\u52a1\u8fd4\u56de\u6570\u636e\uff0c\u5219\u4f20\u5165\u6709\u6548\u7684reply\u6307\u9488\u3002<code>writeTransactionData</code>\u4f1a\u628a<code>Parcel</code>\u6570\u636e\u8fdb\u4e00\u6b65\u5305\u88c5\u4e3a<code>binder_transaction_data</code>\u6570\u636e\u7ed3\u6784\u3002\u8fd9\u91cc\u9762\u6709cmd\u662f<code>BC_TRANSACTION</code>\uff0ccode\u662f\u5bf9\u670d\u52a1\u7aef\u65b9\u6cd5\u7684\u7f16\u53f7\u3002cmd\u7684\u53d6\u503c\u5206\u4e3a<code>BC_</code>\u524d\u7f00\u548c<code>BR_</code>\u524d\u7f00\uff0c\u7531<code>Binder</code>\u9a71\u52a8\u53d1\u8d77\u7684\u662f<code>BR_</code>\u524d\u7f00\uff0c\u7531\u8fdb\u7a0b\u53d1\u8d77\u7684\u662f<code>BC_</code>\u524d\u7f00\u3002</p> <p> <pre><code>// \u5df2\u7cbe\u7b80\nstatus_t IPCThreadState::waitForResponse(Parcel *reply, status_t *acquireResult)\n{\n    while (1) {\n        if ((err=talkWithDriver()) &lt; NO_ERROR) break;\n        cmd = (uint32_t)mIn.readInt32();\n        switch (cmd) {\n        case BR_TRANSACTION_COMPLETE:\n            if (!reply &amp;&amp; !acquireResult) goto finish;\n            break;\n        case BR_REPLY:\n            {\n                binder_transaction_data tr;\n                err = mIn.read(&amp;tr, sizeof(tr));\n                if (reply) {\n                    if ((tr.flags &amp; TF_STATUS_CODE) == 0) {\n                        reply-&gt;ipcSetDataReference(\n                            reinterpret_cast&lt;const uint8_t*&gt;(tr.data.ptr.buffer),\n                            tr.data_size,\n                            reinterpret_cast&lt;const binder_size_t*&gt;(tr.data.ptr.offsets),\n                            tr.offsets_size/sizeof(binder_size_t),\n                            freeBuffer);\n                    } else {\n                        err = *reinterpret_cast&lt;const status_t*&gt;(tr.data.ptr.buffer);\n                    }\n                } else {\n                }\n            }\n        default:\n            err = executeCommand(cmd);\n            if (err != NO_ERROR) goto finish;\n            break;\n        }\n    }\n    return err;\n}\n// \u5927\u5e45\u7cbe\u7b80\nstatus_t IPCThreadState::talkWithDriver(bool doReceive)\n{\n    binder_write_read bwr;\n    do {\n        if (ioctl(mProcess-&gt;mDriverFD, BINDER_WRITE_READ, &amp;bwr) &gt;= 0)\n            err = NO_ERROR;\n    } while (err == -EINTR);\n    return err;\n}\n</code></pre> <code>waitForResponse</code>\u7684\u5de5\u4f5c\u4e3b\u8981\u662f\u51c6\u5907<code>binder_write_read</code>\u6570\u636e\uff0c\u901a\u8fc7ioctl\u63d0\u4ea4\u6b64\u6570\u636e\u3002\u7b49\u5f85\u8fd4\u56de\u7ed3\u679c\u3002</p>"},{"location":"Android/Binder%20IPC/#binder","title":"Binder \u9a71\u52a8","text":"<p><pre><code>static long binder_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)\n{\n   struct binder_proc *proc = filp-&gt;private_data;\n    struct binder_thread *thread;\n   thread = binder_get_thread(proc);\n    switch (cmd) {\n    case BINDER_WRITE_READ:\n        ret = binder_ioctl_write_read(filp, cmd, arg, thread);\n        break;\n    case BINDER_SET_MAX_THREADS: {\n        int max_threads;\n\n        if (copy_from_user(&amp;max_threads, ubuf,\n                   sizeof(max_threads))) {\n        }\n        proc-&gt;max_threads = max_threads;\n        break;\n    }\n    case BINDER_SET_CONTEXT_MGR:\n        ret = binder_ioctl_set_ctx_mgr(filp, NULL);\n        break;\n}\n\n\nstatic int binder_ioctl_write_read(struct file *filp,\n                unsigned int cmd, unsigned long arg,\n                struct binder_thread *thread)\n{\n    int ret = 0;\n    struct binder_proc *proc = filp-&gt;private_data;\n    struct binder_write_read bwr;\n\n    if (bwr.write_size &gt; 0) {\n        ret = binder_thread_write(proc, thread,\n                      bwr.write_buffer,\n                      bwr.write_size,\n                      &amp;bwr.write_consumed);\n    }\n    if (bwr.read_size &gt; 0) {\n      //\u975e\u963b\u585e\u8bfb\u53d6\n        ret = binder_thread_read(proc, thread, bwr.read_buffer,\n                     bwr.read_size,\n                     &amp;bwr.read_consumed,\n                     filp-&gt;f_flags &amp; O_NONBLOCK);\n        if (!binder_worklist_empty_ilocked(&amp;proc-&gt;todo))\n            binder_wakeup_proc_ilocked(proc);\n    }\n    if (copy_to_user(ubuf, &amp;bwr, sizeof(bwr))) {\n    }\n    return ret;\n}\n//\u5373\u5148\u5199\u518d\u8bfb\u3002\u6765\u770b\u5199\nstatic int binder_thread_write(struct binder_proc *proc,\n            struct binder_thread *thread,\n            binder_uintptr_t binder_buffer, size_t size,\n            binder_size_t *consumed)\n{\n    uint32_t cmd;\n    struct binder_context *context = proc-&gt;context;\n    void __user *buffer = (void __user *)(uintptr_t)binder_buffer;\n    void __user *ptr = buffer + *consumed;\n    void __user *end = buffer + size;\n\n    while (ptr &lt; end &amp;&amp; thread-&gt;return_error.cmd == BR_OK) {\n        int ret;\n\n        if (get_user(cmd, (uint32_t __user *)ptr))\n            return -EFAULT;\n        ptr += sizeof(uint32_t);\n        switch (cmd) {\n      ...\n        case BC_TRANSACTION:\n        case BC_REPLY: {\n            struct binder_transaction_data tr;\n\n            if (copy_from_user(&amp;tr, ptr, sizeof(tr)))\n                return -EFAULT;\n            ptr += sizeof(tr);\n            binder_transaction(proc, thread, &amp;tr,\n                       cmd == BC_REPLY, 0);\n            break;\n        }\n        case BC_REGISTER_LOOPER:\n        case BC_ENTER_LOOPER:\n        case BC_EXIT_LOOPER:\n        case BC_REQUEST_DEATH_NOTIFICATION:\n        case BC_CLEAR_DEATH_NOTIFICATION: \n        case BC_DEAD_BINDER_DONE: \n      ...\n    }\n    return 0;\n}\n// \u56e0\u4e3a\u662fBC_TRANSACTION\uff0c\u5b83\u4ee5copy_from_user\u7cfb\u7edf\u8c03\u7528\u4ece\u7528\u6237\u7a7a\u95f4\u628abinder_transaction_data\u62f7\u8d1d\uff0c\u63a5\u4e0b\u6765\u8fdb\u5165binder_transaction\n\nstatic void binder_transaction(struct binder_proc *proc,\n                   struct binder_thread *thread,\n                   struct binder_transaction_data *tr, int reply,\n                   binder_size_t extra_buffers_size)\n{\n\n    if (reply) {\n        in_reply_to = thread-&gt;transaction_stack;\n        target_proc = target_thread-&gt;proc;\n        target_proc-&gt;tmp_ref++;\n    } else {\n        if (tr-&gt;target.handle) {\n            struct binder_ref *ref;\n            ref = binder_get_ref_olocked(proc, tr-&gt;target.handle,\n                             true);\n                        ref-&gt;node, &amp;target_proc,\n                        &amp;return_error);\n            }\n        } else {\n            target_node = context-&gt;binder_context_mgr_node;\n        }\n        w = list_first_entry_or_null(&amp;thread-&gt;todo,\n                         struct binder_work, entry);\n        if (!(tr-&gt;flags &amp; TF_ONE_WAY) &amp;&amp; thread-&gt;transaction_stack) {\n            struct binder_transaction *tmp;\n\n            tmp = thread-&gt;transaction_stack;\n            while (tmp) {\n                struct binder_thread *from;\n                if (from &amp;&amp; from-&gt;proc == target_proc) {\n                    atomic_inc(&amp;from-&gt;tmp_ref);\n                    target_thread = from;\n                    spin_unlock(&amp;tmp-&gt;lock);\n                    break;\n                }\n            }\n        }\n    }\n    if (target_thread)\n        e-&gt;to_thread = target_thread-&gt;pid;\n    e-&gt;to_proc = target_proc-&gt;pid;\n\n    t = kzalloc(sizeof(*t), GFP_KERNEL);\n\n    INIT_LIST_HEAD(&amp;t-&gt;fd_fixups);\n    tcomplete = kzalloc(sizeof(*tcomplete), GFP_KERNEL);\n\n    if (!reply &amp;&amp; !(tr-&gt;flags &amp; TF_ONE_WAY))\n        t-&gt;from = thread;\n    else\n        t-&gt;from = NULL;\n    t-&gt;to_proc = target_proc;\n    t-&gt;to_thread = target_thread;\n    t-&gt;code = tr-&gt;code;\n    t-&gt;flags = tr-&gt;flags;\n   // \u7ed9\u76ee\u6807\u8fdb\u7a0b\u5206\u914d\u65b0\u7684buffer\u3002\n    t-&gt;buffer = binder_alloc_new_buf(&amp;target_proc-&gt;alloc, tr-&gt;data_size,\n        tr-&gt;offsets_size, extra_buffers_size,\n        !reply &amp;&amp; (t-&gt;flags &amp; TF_ONE_WAY), current-&gt;tgid);\n    t-&gt;buffer-&gt;transaction = t;\n    t-&gt;buffer-&gt;target_node = target_node;\n\n   // \u62f7\u8d1d\u6570\u636e\u5230\u76ee\u6807\u8fdb\u7a0b\u7684buffer\u3002\n    if (binder_alloc_copy_user_to_buffer(\n                &amp;target_proc-&gt;alloc,\n                t-&gt;buffer,\n                ALIGN(tr-&gt;data_size, sizeof(void *)),\n                (const void __user *)\n                    (uintptr_t)tr-&gt;data.ptr.offsets,\n                tr-&gt;offsets_size)) {\n    }\n    for (buffer_offset = off_start_offset; buffer_offset &lt; off_end_offset;\n         buffer_offset += sizeof(binder_size_t)) {\n        struct binder_object_header *hdr;\n        size_t object_size;\n        struct binder_object object;\n        binder_size_t object_offset;\n\n      // \u62f7\u8d1d\u4f4d\u79fb\u91cf\u3002object_offset\u5230\u76ee\u6807Buffer\n        if (binder_alloc_copy_from_buffer(&amp;target_proc-&gt;alloc,\n                          &amp;object_offset,\n                          t-&gt;buffer,\n                          buffer_offset,\n                          sizeof(object_offset))) {\n        }\n        object_size = binder_get_object(target_proc, t-&gt;buffer,\n                        object_offset, &amp;object);\n\n        hdr = &amp;object.hdr;\n        off_min = object_offset + object_size;\n        switch (hdr-&gt;type) {\n        case BINDER_TYPE_BINDER:\n        case BINDER_TYPE_WEAK_BINDER: {\n            struct flat_binder_object *fp;\n\n            fp = to_flat_binder_object(hdr);\n            ret = binder_translate_binder(fp, t, thread);\n\n         // \u62f7\u8d1dfp\u5230\u76ee\u6807Buffer\n            if (ret &lt; 0 ||\n                binder_alloc_copy_to_buffer(&amp;target_proc-&gt;alloc,\n                            t-&gt;buffer,\n                            object_offset,\n                            fp, sizeof(*fp))) {\n            }\n        } break;\n        case BINDER_TYPE_HANDLE:\n        case BINDER_TYPE_WEAK_HANDLE: {\n            struct flat_binder_object *fp;\n\n            fp = to_flat_binder_object(hdr);\n            ret = binder_translate_handle(fp, t, thread);\n            if (ret &lt; 0 ||\n                binder_alloc_copy_to_buffer(&amp;target_proc-&gt;alloc,\n                            t-&gt;buffer,\n                            object_offset,\n                            fp, sizeof(*fp))) {\n            }\n        } break;\n\n    if (reply) {\n      // \u662freply\uff0c\u539f\u7ebf\u7a0b\u6dfb\u52a0work: tcomplete\n        binder_enqueue_thread_work(thread, tcomplete);\n        binder_pop_transaction_ilocked(target_thread, in_reply_to);\n      // \u76ee\u6807\u7ebf\u7a0b\u6dfb\u52a0work: t-&gt;work\n        binder_enqueue_thread_work_ilocked(target_thread, &amp;t-&gt;work);\n        target_proc-&gt;outstanding_txns++;\n      // \u5524\u9192\u76ee\u6807\u7ebf\u7a0b\n        wake_up_interruptible_sync(&amp;target_thread-&gt;wait);\n    } else if (!(t-&gt;flags &amp; TF_ONE_WAY)) {\n      // \u82e5\u4e0d\u662fone way\uff0c\u539f\u7ebf\u7a0b\u6dfb\u52a0work: tcomplete\n        binder_enqueue_deferred_thread_work_ilocked(thread, tcomplete);\n      // \u8bb0\u5f55\u4e8b\u52a1\u6808\uff0c\u4ee5\u5728\u540e\u7eed\u56de\u590d\u65f6\u627e\u5230\u4e0a\u4e0b\u6587\n        t-&gt;need_reply = 1;\n        t-&gt;from_parent = thread-&gt;transaction_stack;\n        thread-&gt;transaction_stack = t;\n      //\u5524\u9192\u76ee\u6807\u8fdb\u7a0b\n        return_error = binder_proc_transaction(t,\n                target_proc, target_thread);\n    } else {\n       // \u662fone way\uff0c\u539f\u7ebf\u7a0b\u6dfb\u52a0work: tcomplete\n        binder_enqueue_thread_work(thread, tcomplete);\n      //\u5524\u9192\u76ee\u6807\u8fdb\u7a0b\n        return_error = binder_proc_transaction(t, target_proc, NULL);\n    }\n    return;\n}\n\n// \u5bf9\u4e8e\u53d1\u8d77\u8fdb\u7a0b\uff0c\u6b64\u65f6\u4e8b\u52a1\u5b8c\u6210\uff0cthread\u4f1a\u88ab\u6dfb\u52a0tcomplete\u7684binder_work\uff0ctype\u4e3aBINDER_WORK_TRANSACTION_COMPLETE\n// \u5bf9\u4e8e\u76ee\u6807\u8fdb\u7a0b\uff0c\u4f1a\u88ab\u6dfb\u52a0t-&gt;work\u7684binder_work\uff0ctype\u4e3aBINDER_WORK_TRANSACTION\u3002 \u4e0b\u9762\u662f\u8bfb\uff1a\nstatic int binder_thread_read(struct binder_proc *proc,\n                  struct binder_thread *thread,\n                  binder_uintptr_t binder_buffer, size_t size,\n                  binder_size_t *consumed, int non_block)\n{\n    void __user *buffer = (void __user *)(uintptr_t)binder_buffer;\n    void __user *ptr = buffer + *consumed;\n    void __user *end = buffer + size;\n    while (1) {\n        uint32_t cmd;\n\n        if (!binder_worklist_empty_ilocked(&amp;thread-&gt;todo))\n            list = &amp;thread-&gt;todo;\n        else if (!binder_worklist_empty_ilocked(&amp;proc-&gt;todo) &amp;&amp;\n               wait_for_proc_work)\n            list = &amp;proc-&gt;todo;\n\n        w = binder_dequeue_work_head_ilocked(list);\n        switch (w-&gt;type) {\n        case BINDER_WORK_TRANSACTION: {\n         //\u76ee\u6807\u8fdb\u7a0b\u88ab\u5524\u8d77\u540e\u8bfb\u53d6\u4efb\u52a1\u4f1a\u8d70\u5230\u8fd9\u91cc\n            binder_inner_proc_unlock(proc);\n            t = container_of(w, struct binder_transaction, work);\n        } break;\n        case BINDER_WORK_TRANSACTION_COMPLETE:\n         //\u8fd9\u4e2a\u662f\u53d1\u8d77\u8fdb\u7a0b\u7684\u5206\u652f\u3002\u5373tcomplete\u7684binder_work\n      case BINDER_WORK_TRANSACTION_ONEWAY_SPAM_SUSPECT: {\n            if (proc-&gt;oneway_spam_detection_enabled &amp;&amp;\n                   w-&gt;type == BINDER_WORK_TRANSACTION_ONEWAY_SPAM_SUSPECT)\n                cmd = BR_ONEWAY_SPAM_SUSPECT;\n            else\n                cmd = BR_TRANSACTION_COMPLETE;\n         //\u5c06cmd\u590d\u5236\u5230\u7528\u6237\u7a7a\u95f4\u3002\u4ee5\u4fbfIPCThreadState\u8bfb\u53d6\u3002      \n            if (put_user(cmd, (uint32_t __user *)ptr))\n            ptr += sizeof(uint32_t);\n\n        } break;\n        ...\n\n        if (t-&gt;buffer-&gt;target_node) {\n            cmd = BR_TRANSACTION;\n        } else {\n            trd-&gt;target.ptr = 0;\n            trd-&gt;cookie = 0;\n            cmd = BR_REPLY;\n        }\n        ptr += sizeof(uint32_t);\n      //\u5c06\u4e8b\u52a1\u590d\u5236\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u5373\u8bfb\u5165\u3002\n        if (copy_to_user(ptr, &amp;tr, trsize)) {\n        }\n        ptr += trsize;\n    }\n    return 0;\n}\n</code></pre> \u7efc\u4e0a\uff0c\u6211\u4eec\u5927\u81f4\u770b\u5b8c\u4e86\u4e00\u6b21Binder\u7684\u901a\u4fe1\u8fc7\u7a0b\u3002</p>"},{"location":"Android/Binder%20IPC/#_5","title":"\u5524\u9192\u65b9\u5f0f","text":"<p>\u5728Linux\u9a71\u52a8\u7a0b\u5e8f\u4e2d\uff0c\u4f1a\u4f7f\u7528<code>wait_list</code>\u6570\u636e\u7ed3\u6784\u6765\u5904\u7406\u3002</p>"},{"location":"Android/Binder%20IPC/#_6","title":"\u6807\u51c6\u573a\u666f\u63cf\u8ff0","text":""},{"location":"Android/Binder%20IPC/#servicemanager","title":"ServiceManager\u542f\u52a8","text":"<p>\u7b2c\u4e00\u4e2a\u88ab\u542f\u52a8\u3002\u9664\u4e86\u5bf9binder\u9a71\u52a8\u8fdb\u884copen, mmap\u4e4b\u5916\uff0c\u8fd8\u4f1a\u901a\u8fc7\u51e0\u6b21<code>ioctl</code>\u6765\u628a\u81ea\u5df1\u8bbe\u7f6e\u4e3acontext manager\u3002\u6b64\u540e\uff0c\u4f1a\u8fdb\u5165binder_loop\u65b9\u6cd5\uff0c\u4e0d\u65ad\u7684\u7b49\u5f85binder\u9a71\u52a8\u6570\u636e\uff0c\u518d\u89e3\u6790\u6267\u884c\u6307\u4ee4\u3002</p>"},{"location":"Android/Binder%20IPC/#_7","title":"\u670d\u52a1\u6ce8\u518c","text":"<p>\u670d\u52a1Servcice B\u6ce8\u518c\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>Service B \u83b7\u53d6ServiceManager\u3002</li> <li>\u8c03\u7528IServiceManager.addService\u3002</li> </ol> <p>\u6b64\u5916\u5b83\u8fd8\u9700\u8981\u81f3\u5c11\u5f00\u542f\u4e00\u4e2a\u7ebf\u7a0b\u6765\u51c6\u5907IPC\u901a\u4fe1\uff0c\u901a\u8fc7<code>ProcessState::startThreadPool</code>  ..<code>ThreadLoop</code>.-&gt;  <code>IPCThreadState.joinThreadPool()</code>\uff0c\u5982<code>main_surfaceflinger.cpp</code>\u7684\u4e3b\u65b9\u6cd5\u3002</p> <p>\u6b64\u8fc7\u7a0b\u4f1a\u5f00\u542f\u4e00\u4e2a\u7ebf\u7a0b\u5b8c\u5168\u7528\u4e8eIPC\u3002\u5b83\u4f1a\u8c03\u7528\u5230<code>IPCThreadState.jinThreadPool</code>\u6765\u7b49\u5f85\u901a\u4fe1\u3002</p> <p><code>IPCThreadState joinThreadPool()</code> \u903b\u8f91\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u6b7b\u5faa\u73af\uff0c\u4e0d\u65ad\u8fdb\u884c <code>IPCThreadState.getAndExecuteCommand()</code>\u3002\u800c\u6b64\u8fc7\u7a0b\u5219\u662f<code>IPCThreadState.talkWithDriver</code>\u6765\u83b7\u53d6\u65b0\u7684\u6307\u4ee4\uff0c\u7136\u540e\u8c03\u7528<code>IPCThreadState.executeCommand</code>\u6765\u6267\u884c\u3002<code>talkWithDriver</code>\u4e0a\u9762<code>transact</code>\u65f6\u5df2\u7ecf\u63d0\u5230\u8fc7\uff0c\u8fd9\u91cc\u4e0d\u518d\u91cd\u590d\u3002<code>executeCommand</code>\u5219\u5982\u4e0b\uff1a</p> <p><pre><code>//\u5927\u5e45\u7cbe\u7b80\nstatus_t IPCThreadState::executeCommand(int32_t cmd)\n{\n    switch ((uint32_t)cmd) {\n    case BR_TRANSACTION:\n        {\n            Parcel reply;\n            status_t error;\n            if (tr.target.ptr) {\n                // We only have a weak reference on the target object, so we must first try to\n                // safely acquire a strong reference before doing anything else with it.\n                if (reinterpret_cast&lt;RefBase::weakref_type*&gt;(\n                        tr.target.ptr)-&gt;attemptIncStrong(this)) {\n                    error = reinterpret_cast&lt;BBinder*&gt;(tr.cookie)-&gt;transact(tr.code, buffer,\n                            &amp;reply, tr.flags);\n                    reinterpret_cast&lt;BBinder*&gt;(tr.cookie)-&gt;decStrong(this);\n                }\n            }\n            if ((tr.flags &amp; TF_ONE_WAY) == 0) {\n                sendReply(reply, (tr.flags &amp; kForwardReplyFlags));\n            }\n        }\n        break;\n      ...\n}\n</code></pre> \u56e0\u4e3a\u670d\u52a1\u7aef\u5bf9\u6211\u4eec\u6765\u8bf4\u6700\u5173\u6ce8\u7684\u662f<code>BR_TRANSACTION</code>\uff0c\u5373Binder\u9a71\u52a8\u53d1\u8d77\u4e8b\u52a1\u6307\u4ee4\uff08\u5bf9\u5e94\u4e4b\u524d\u7684\u53d1\u8d77\u8fdb\u7a0b\u7684<code>BC_TRANSACTION</code>\uff09\u3002\u6b64\u65f6\u4f1a\u770b\u5230\u5b83\u5c06tr.cookie\u5f3a\u8f6c\u4e3aBBinder\u6765\u8c03\u7528<code>transact</code>\u4ece\u800c\u5230<code>BBinder</code>\u89e3\u5305\u6570\u636e\uff0c\u6839\u636ecode\u518d\u5206\u53d1\u5230\u5177\u4f53\u7684\u670d\u52a1\u65b9\u6cd5\u8c03\u7528\u3002\u4ee5\u53ca\u5bf9<code>reply</code>\u7684\u56de\u5199\u3002</p>"},{"location":"Android/Binder%20IPC/#_8","title":"\u5e94\u7528\u8fdb\u7a0b","text":"<p>\u5e94\u7528\u8fdb\u7a0bProc A \u9700\u8981\u901a\u8fc7Binder\u8de8\u8fdb\u7a0b\u6765\u8c03\u7528Service B \u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>Proc A \u83b7\u53d6<code>ServiceManager</code></li> <li>\u6b64\u8fc7\u7a0b\u4ec5\u9700\u8981<code>ProcessState</code>\u53c2\u4e0e\u3002<code>ServiceManager</code>\u4f1a\u6709\u4e00\u4e9b\u672c\u5730\u7684\u5305\u88c5\u7c7b\uff0c\u4ee5\u786e\u4fdd\u5728\u672c\u5730\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a<code>ServiceManagerProxy</code>\u5355\u4f8b\u5373\u53ef\u3002\u7b2c\u4e00\u6b21\u521b\u5efa\u65f6\uff0c\u901a\u8fc7<code>ProcessState::self()-&gt;getStrongProxyForHandle(null)</code>\u5373\u53ef\uff0c\u4e5f\u5c31\u662f\u521b\u5efa\u4e86\u4e00\u4e2a<code>handle:0</code>\u7684<code>BpBinder</code>\u3002</li> <li>\u6ce8\u610f\uff1a\u5927\u90e8\u5206<code>BpBinder</code>\u7684\u521b\u5efa\u90fd\u662f\u7531<code>ProcessState</code>\u8fdb\u884c\u7684\uff0c\u56e0\u4e3a\u5b83\u7ef4\u62a4\u4e86\u5f53\u524d\u8fdb\u7a0b\u4e0b\u7684<code>BpBinder</code>\u5217\u8868</li> <li>Proc A \u8c03\u7528<code>IServiceManager</code>\u7684<code>getService(...)</code>\u65b9\u6cd5\uff0c\u83b7\u53d6Service B\u7684Proxy\u3002</li> <li>\u6b64\u65f6\u56e0\u4e3a<code>ServiceManagerProxy</code>\u7684\u672c\u5730\u7f13\u5b58\u8fd8\u6ca1\u6709\u6b64\u7c7b<code>BpBinder</code>\uff08\u8fd9\u91cc\u7684<code>ServiceManagerProxy</code>\u6cdb\u6307<code>ServiceManager</code>\u7684\u672c\u5730\u5305\u88c5\u7c7b\uff09\uff0c\u9700\u8981\u8fdb\u884cipc\u83b7\u53d6\u3002\u56e0\u6b64\u9700\u8981\u7531<code>IServiceManager</code>\u53d1\u8d77\u4e00\u6b21transact\u6765\u8c03\u7528\u670d\u52a1\u7aef\u7684getService\u65b9\u6cd5\u3002\u5176\u5185\u90e8Code\u662f<code>GET_SERVICE</code>\u3002</li> <li>Proc A\u5728transact\u8fc7\u7a0b\u4e2d\uff0cout\u6570\u636e\u4e3b\u8981\u662f\u8981\u67e5\u8be2\u7684\u670d\u52a1\u540d\u79f0\u3002transact\u7684\u8fc7\u7a0b\u4e3b\u8981\u662f\u5bf9\u65b9\u6cd5\u8c03\u7528\u53c2\u6570parcel\u5e8f\u5217\u5316\uff0c<code>BpBinder.transact-&gt;...IPCThreadState.transact-&gt;talkWithDriver, waitForResponse</code>\u3002\u800c<code>talkWithDriver</code>\u53c8\u662fioctl\u8c03\u7528<code>binder_write_read</code>\u8fc7\u7a0b\uff0c\u6b64\u65f6\u7684\u4e8b\u52a1\u6570\u636e\u5df2\u7ecf\u5c01\u88c5\u4e3a\u4e86bwr(binder_write_read)\u7ed3\u6784\u4f53\u3002</li> <li>binder\u9a71\u52a8\u4fa7\u4f1a\u901a\u8fc7ioctl\u8c03\u7528\u7684\u63cf\u8ff0\u7b26\u53c2\u6570flip\u7684<code>privateData</code>\uff0c\u53d6\u51fa<code>Binder_proc</code>\u7ed3\u6784\u4f53\uff0c\u5b83\u8bb0\u5f55\u4e86Binder\u5728\u8be5\u8fdb\u7a0b\u4e0a\u7684\u4fe1\u606f\u3002\u6b64\u5b57\u6bb5\u521d\u59cb\u5316\u4e0e<code>ProcessState</code>\u7684\u521d\u59cb\u5316\u6709\u5173\uff0c\u8be6\u89c1\u4e0a\u9762\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002\u518d\u4ece<code>binder_proc</code>\u7684\u7ed3\u6784\u4f53\u4e2d\u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\u7ed3\u6784\u4f53\u4fe1\u606f\uff0c\u5b83\u662f\u901a\u8fc7<code>binder_proc</code>\u91cc\u9762\u7684<code>binder_thread</code>\u7ea2\u9ed1\u6811\u8bb0\u5f55\uff0c\u4ee5<code>current-&gt;pid</code>\u6bd4\u5bf9\u3002\u6b64\u65f6\u5df2\u7ecf\u6709<code>\u4e86proc,thread</code>\u4e24\u4e2a\u4e3b\u8981\u73af\u5883\u6570\u636e\uff0c\u7136\u540e\u6839\u636e\u4e0d\u540cioctl\u7684cmd\u6765\u5904\u7406\u3002</li> <li><code>binder_ioctl-&gt;binder_ioctl_write_read</code>\u62f7\u8d1d\u4e86transaction\u6570\u636e\u4e4b\u540e\u8fdb\u5165<code>binder_transaction</code>\u65b9\u6cd5\u3002</li> <li><code>binder_transaction</code>\uff1a<ol> <li>\u83b7\u53d6targetNode, \u4ee5\u6b64\u5f97\u5230targetProc, targetThread, targetBuffer\uff0c\u4e5f\u5c31\u662f\u786e\u5b9a\u8981\u5199\u5165\u7684\u76ee\u6807\u7f13\u5b58\u5730\u5740\u3002<ol> <li>\u5982\u679c\u4e0d\u662f\u56de\u590d\u7ed3\u679c\uff0c\u5219\u770btransactionData\u91cc\u82e5\u6709target.handle\uff0c\u90a3\u4e48\u76f4\u63a5\u5728\u5f53\u524d\u8fdb\u7a0bproc\u7684binder_node\u7ea2\u9ed1\u6811\u8bb0\u5f55\u91cc\u9762\u53bb\u627e\u5c31\u53ef\u4ee5\u4e86\uff0c\u6bd4\u5bf9handle\u3002\u82e5\u6ca1\u6709\uff0c\u4e5f\u5c31\u662f0\uff0c\u6b64\u65f6\u628abinder\u9a71\u52a8\u4e2dcontext_manager\u4e5f\u5c31\u662fserviceManager\u4f5c\u4e3atargetNode\u3002</li> <li>\u82e5\u662f\u56de\u590d\uff0c\u90a3\u4e48\u76f4\u63a5\u4ecethread\u7684transaction_stack\u91cc\u7684From\u5185\u5bb9\u5c31\u53ef\u4ee5\u627e\u5230targetThread\u7b49\u3002</li> </ol> </li> <li>\u5206\u914d\u7a7a\u95f4\uff0c\u62f7\u8d1dtransactionData\u6570\u636e\uff0c\u5230target_proc-&gt;alloc\u3002</li> <li>\u5728proc\uff0ctargetProc\u8bb0\u5f55\u9002\u5f53\u7684binderNode\u3002\u4e3b\u8981\u662f\u5728\u6ce8\u518c\u670d\u52a1\u65f6\uff0cSerivceManager\u8fdb\u7a0b\u7684proc\u8bb0\u5f55\u670d\u52a1\u8fdb\u7a0b\u7684Binder_node_ref\u3002\u4ee5\u53ca\u5728\u83b7\u53d6\u670d\u52a1\u65f6\uff0c\u5728\u8bf7\u6c42\u8fdb\u7a0b\u7684proc\u8bb0\u5f55\u670d\u52a1\u63d0\u4f9b\u8fdb\u7a0b\u7684binder_node_ref\u3002\u4ee5\u6b64\u53ef\u4ee5\u786e\u4fdd\u540e\u9762\u518d\u8fdb\u884cioctl\u7684\u65f6\u5019\uff0cbinder driver\u80fd\u77e5\u9053\u53d1\u8d77\u8fdb\u7a0b\u7684handle\u6240\u6307\u7684\u76ee\u6807binder_node\u5230\u5e95\u662f\u4ec0\u4e48\u3001\u5728\u54ea\u91cc\u3002</li> <li>\u5524\u9192\u76ee\u6807\u7ebf\u7a0b\u3002</li> </ol> </li> <li>\u7b49\u5f85\u7ed3\u679c\u3002\u4e4b\u540e\u8bfb\u53d6\u7ed3\u679c\u6570\u636e\u3002Parcel\u89e3\u5305\u7684\u65f6\u5019\uff0c\u4f1areadStrongBinder-&gt;ProcessState::getStrongProxyForHandle(handle)\uff0cProcessState\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u7ecf\u6709\u7ef4\u62a4\uff0c\u82e5\u6ca1\u6709\uff0c\u5219\u6784\u9020\u4e00\u4e2aBpBinder\u8fd4\u56de\u3002</li> <li>\u5c06BpBinder\u8f6c\u4e3aProxy\uff0c\u5bf9\u4e8enative\u7684\u8f6c\u5316\u501f\u52a9\u5b8f\u548c\u6a21\u677f\uff0c\u5bf9\u4e8ejava\u7684\u8f6c\u5316\uff0c\u501f\u52a9aidl\u751f\u6210\u7684Proxy\u7c7b\u3002\u6b64\u65f6\uff0c\u5c31\u53ef\u4ee5\u5bf9BpBinder\u8c03\u7528\u5176transact\u65b9\u6cd5\uff0c\u6765\u5f97\u5230\u5bf9\u5e94\u7684\u529f\u80fd\u4e86\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528Proxy\u76f4\u63a5\u8c03\u7528\u63a5\u53e3\u65b9\u6cd5\u3002</li> <li>\u7528Proxy\u8c03\u7528Service B \u65b9\u6cd5\u3002</li> <li>\u6b64\u65f6\u6d41\u8f6c\u5230BpBinder-&gt;transact\uff0c\u540c2.2\u3002\u4e0d\u5916\u4e4e\u5199parcel\u548c\u89e3parcel\u65f6\u6570\u636e\u4e0d\u540c\uff0c\u4ee5\u53cahandle\u4e0d\u540c\u4e5f\u5c31\u662f\u5728binder_transaction\u65f6\uff0c\u5f97\u5230\u7684target_node\u4e0d\u540c\uff0c\u5373\u8981\u5199\u5165\u7684\u76ee\u6807\u5730\u5740\u4e0d\u540c\u3001\u5524\u9192\u7684\u7ebf\u7a0b\u4e0d\u540c\u3002</li> </ol>"},{"location":"Android/Binder%20IPC/#_9","title":"\u4e09\u6b21\u590d\u5236\u548c\u4e00\u6b21\u590d\u5236","text":"<p>\u6839\u636e\u5b98\u7f51\u8bf4\u6cd5\uff0c\u5728\u5b89\u53538\u4e4b\u524d\u5176\u5b9eBinderIPC\u662f\u4e09\u6b21\u590d\u5236\uff0c\u5728\u5b89\u53538\u4e4b\u540e\u662f\u4e00\u6b21\u590d\u5236\u3002\u51cf\u53bb\u7684\u4e24\u6b21\u662f\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u3002\u8be6\u89c1\u62d3\u5c55\u9605\u8bfb\u3002\u7528\u56fe\u7247\u6765\u8bf4\u660e\u4e0b\uff1a</p> <p>\u4e09\u6b21\u590d\u5236</p> <p></p> <p>\u5b89\u53538\u4e4b\u540e\u4e00\u6b21\u590d\u5236</p> <p></p>"},{"location":"Android/Binder%20IPC/#_10","title":"\u603b\u7ed3","text":"<p>\u4f17\u6240\u5468\u77e5 Binder IPC \u5728\u5b89\u5353\u7cfb\u7edf\u4e0a\u4f7f\u7528\u5f02\u5e38\u666e\u904d\uff0c\u4ee5\u81f3\u4e8e\u5f88\u591a\u65f6\u5019\u51e0\u4e4e\u4f1a\u5ffd\u7565\u5b83\u80cc\u540e\u7684\u590d\u6742\u6027\u3002\u6211\u5148\u603b\u7ed3\u4e0b\u5b83\u7684\u89e3\u51b3\u65b9\u6848\u6574\u4f53\u601d\u8def\uff0c\u518d\u603b\u7ed3\u7531\u6b64\u5f97\u51fa\u7684\u66f4\u591a\u601d\u8003\u3002</p> <ul> <li>\u4e3a\u4e86\u7ed9\u7528\u6237\u5728\u8de8\u8fdb\u7a0b\u65f6\u66f4\u597d\u7684\u4f7f\u7528\u4f53\u9a8c\uff0c\u51e0\u4e4e\u50cf\u8bbf\u95ee\u672c\u5730\u65b9\u6cd5\u4e00\u6837\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u65b9\u6cd5\u3002\u4e3a\u6b64\u63d0\u4f9b\u4e86\u52a8\u6001\u4ee3\u7406\uff0c\u4e0e\u8c03\u7528\u201c\u5b58\u6839\u201d\u3002\u5c06\u5927\u90e8\u5206\u7684\u8c03\u7528\u62bd\u8c61\u4e3a\u4e8b\u52a1\uff0c\u5c06\u65b9\u6cd5\u7684\u53c2\u6570\u3001\u540d\u79f0\u7b49\u7f16\u7801\u6253\u5305\u3002\u8fdb\u800c\u5728\u8fdc\u7aef\u89e3\u5305\u8fd8\u539f\u51fa\u65b9\u6cd5\u8c03\u7528\u3002</li> <li>\u5bf9\u4e8e\u5b9a\u4f4d\u8fdc\u7a0b\u670d\u52a1\uff0c\u7528\u6237\u4e60\u60ef\u4e8e\u4f7f\u7528\u670d\u52a1\u540d\u79f0\uff0c\u5373\u7c7b\u4f3c\u4e92\u8054\u7f51\u57df\u540d\u4e00\u6837\u3002\u800c\u5bf9\u65b9\u6848\u5185\u90e8\u6765\u8bf4\uff0c\u9700\u8981\u5177\u5907\u628a\u201c\u670d\u52a1\u540d\u201d\u89e3\u6790\u5230\u5177\u4f53\u670d\u52a1\u8fdb\u7a0b\u7684\u80fd\u529b\u3002\u7531\u6b64\u9700\u8981\u5b9e\u73b0\u4e00\u5957\u8fdb\u7a0b\u95f4\u7684\u201c\u670d\u52a1\u5b9a\u4f4d\u5668\u201d\u8bbe\u8ba1\u6a21\u5f0f\u3002\u5373\u63d0\u4f9b\u4e00\u4e2a\u4f17\u505a\u5468\u77e5\u7684\u56fa\u5b9a\u5730\u5740\u4f5c\u4e3a\u7ba1\u7406\u8005\u3001\u670d\u52a1\u5b9a\u4f4d\u8005\u3002\u540e\u7eed\u6240\u6709\u64cd\u4f5c\u7686\u57fa\u4e8e\u6b64\u6765\u4e92\u76f8\u53d1\u73b0\u3002</li> <li>\u8003\u8651\u81f3\u6b64\uff0c\u5176\u5b9e\u5e76\u975e\u4e00\u5b9a\u8981\u7528Binder\uff0c\u5176\u4ed6\u7684Linux\u63d0\u4f9b\u7684IPC\u65b9\u5f0f\u4f9d\u7136\u80fd\u6ee1\u8db3\u8fd9\u4e9b\u8bc9\u6c42\uff0cSocket\u4e5f\u597d\u3001pipeline\u4e5f\u7f62\u7b49\u7b49\u3002\u53ea\u662fBinder\u7ed9\u51fa\u4e86\u4e00\u4e2a\u7406\u8bba\u4e0a\u6027\u80fd\u66f4\u597d\u7684\u9009\u9879\u3002\u4f46\u5b83\u4e0d\u5f97\u4e0d\u501f\u52a9\u81ea\u5b9a\u4e49\u9a71\u52a8\u7a0b\u5e8f\uff0c\u6765\u8ba9\u8fdb\u7a0b\u5185\u7559\u6709\u4e00\u5757\u548c\u8be5\u9a71\u52a8fd\u5173\u8054\u7684mmap\u6620\u5c04\u5730\u5740\u3002\u8fd9\u5757\u5730\u5740\u7528\u6237\u7a7a\u95f4\u53ef\u4ee5\u8bbf\u95ee\uff0c\u800c\u5bf9\u9a71\u52a8\u7a0b\u5e8f\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u6765\u8bf4\uff0c\u5b83\u63a5\u6536\u5230\u901a\u4fe1\u6570\u636e\u540e\uff0c\u53ea\u9700\u8981\u53d6\u51fa\u76ee\u6807\u8fdb\u7a0b\u7684mmap\u6620\u5c04\u5730\u5740\u5199\u5165\u6570\u636e\u5305\u5373\u53ef\u3002</li> </ul> <p>\u56e0\u4e3a\u8fd9\u5957\u65b9\u6848\u590d\u6742\uff0c\u6d89\u53ca\u6240\u6709\u7684\u7ec6\u8282\u51e0\u4e4e\u96be\u4ee5\u505a\u5230\uff0c\u7531\u6b64\u53d7\u5230\u542f\u53d1\u662f\u4ec0\u4e48\uff1f\u66f4\u5bbd\u6cdb\u7684\u601d\u8003\u662f\u4ec0\u4e48\uff1f</p> <ul> <li>\u5176\u5b9e\u662f\u8fdb\u7a0b\u7684\u72ec\u7acb\u73af\u5883\uff0c\u4f7f\u5f97\u4e4b\u95f4\u7684\u901a\u4fe1\u53d8\u5f97\u8f83\u4e3a\u590d\u6742\u3002\u5b89\u5168\u3001\u6c99\u76d2\uff0c\u548c\u66f4\u81ea\u7531\u7684\u901a\u4fe1\uff0c\u8fd9\u4e24\u8005\u6709\u79cd\u535a\u5f08\u7684\u5173\u7cfb\u3002\u5982\u679c\u672a\u6765\u6709\u66f4\u597d\u7684\u65b9\u5f0f\u907f\u514d\u8fdb\u7a0b\u5d29\u6e83\u5bfc\u81f4\u7684\u7a33\u5b9a\u6027\u95ee\u9898\u3001\u4e5f\u6709\u66f4\u597d\u7684\u65b9\u5f0f\u89c4\u907f\u8fdb\u7a0b\u95f4\u4e0d\u5b89\u5168\u7684\u8bbf\u95ee\u95ee\u9898\uff0c\u4f7f\u5f97\u8fdb\u7a0b\u4e4b\u95f4\u7684\u9694\u79bb\u4e0d\u518d\u90a3\u4e48\u6b7b\u677f\uff0c\u81ea\u7136\u5c31\u4f1a\u6709\u66f4\u8f7b\u677e\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002</li> <li>\u8fdb\u7a0b\u901a\u4fe1\u5f80\u5f80\u6d89\u53ca\u5f00\u53d1\u8005\u4f53\u9a8c\u3001\u4e1a\u52a1\u8bc9\u6c42\uff08\u6027\u80fd\u3001\u5b89\u5168\u6027\u3001\u53ef\u76d1\u542c\uff09\u3001\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u7684\u8003\u8651\u3002</li> </ul> <p>\u6682\u65f6\u8fd8\u6ca1\u6709\u4ec0\u4e48\u66f4\u5947\u5999\u7684\u60f3\u6cd5\u4e86\u3002</p>"},{"location":"Android/Binder%20IPC/#_11","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>binder.c</li> <li>binder_alloc.c</li> <li>ProcessState.cpp</li> <li>IPCThreadState.cpp</li> <li>BpBinder.cpp</li> <li>\u826f\u597d\u7684Binder\u6982\u8ff0\uff0c\u5305\u62ec\u5b89\u53538\u7684\u6539\u8fdb</li> <li>\u53e6\u4e00\u7bc7\u6b21\u826f\u597d\u7684\u6982\u8ff0</li> <li>Binder\u5728\u5b89\u53538\u7684\u6539\u8fdb\uff0c\u7531\u4e09\u6b21\u62f7\u8d1d\u53d8\u4e3a\u771f\u6b63\u7684\u4e00\u6b21\u62f7\u8d1d\u3002</li> <li>\u5173\u4e8eLinux\u7cfb\u7edf\u8c03\u7528\u548c\u9a71\u52a8\u7a0b\u5e8f\uff0c\u8bf7\u53c2\u9605\u201c\u64cd\u4f5c\u7cfb\u7edf\u201dsection\u3002</li> </ul>"},{"location":"Android/Dex%20File/","title":"Dex File","text":"<p>\u53c2\u8003 \u53c2\u8003</p> <p>\u4e09\u5927\u533a\uff1a</p> <ul> <li>Header\u533a\uff0c\u6587\u4ef6\u57fa\u672c\u4fe1\u606f\uff0c\u6821\u9a8c\u548c\uff0ctable\u4f4d\u79fb</li> <li>Table\u533a\uff0c\u5982String, Type, Class, Method, Field\u7b49table\uff0c\u5b58\u50a8\u7684\u8981\u4e48\u662fData\u533a\u7684\u504f\u79fb\u91cf\uff08\u7528\u4e8e\u5b9a\u4f4d\u5230\u6570\u636e\u533a\uff09\uff0c\u8981\u4e48\u662fTable\u533a\u7684\u7d22\u5f15\u4ece\u800c\u590d\u7528\u3001\u95f4\u63a5\u5b9a\u4f4d\u5230\u6570\u636e\u533a\u3002</li> <li>Data\u533a\uff0c\u5b58\u50a8\u5b9e\u9645\u6570\u636e\u7684\u5730\u65b9\uff0c\u6bd4\u5982\u5177\u4f53\u5b57\u7b26\u4e32\u6570\u636e\uff0c\u4ee3\u7801\u6570\u636e\u7b49\u3002</li> </ul> <p>\u6ce8\u610f\u533a\u5206dex\u6587\u4ef6\u548c.class\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5316\u7684\u7c7b\u6bd4\u3002\u6ce8\u610fAndroid\u4e0d\u662f\u76f4\u63a5\u5c06Java\u8f6c\u4e3adex\uff0c\u800c\u662f\u5728.class\u7684\u57fa\u7840\u4e0a\u8f6c\u4e3a.dex</p> <p>java -&gt; xxx.class -&gt; classes.dex -&gt; apk         yyy.class    classes2.dex</p> <p>java -&gt; xxx.class -&gt; jar         yyy.class</p>"},{"location":"Android/Glide/","title":"Glide","text":"<p>\u6b64\u6587\u7ae0\u5f85\u5b8c\u5584\u3001\u8f83\u8001</p>"},{"location":"Android/Glide/#engineresource","title":"EngineResource","text":"<ul> <li>\u4f7f\u7528\u8ba1\u6570\u589e\u52a0\u65f6\u673a\uff1a</li> <li>\u4f7f\u7528\u8ba1\u6570\u51cf\u5c11\u65f6\u673a\uff1a</li> </ul>"},{"location":"Android/Glide/#glide_1","title":"Glide\u7f13\u5b58\u6982\u8ff0","text":"<p>\u6309\u4ecb\u8d28\u5206\u5185\u5b58\u7f13\u5b58\u3001\u786c\u76d8\u7f13\u5b58\u3002\u5185\u5b58\u7f13\u5b58\u5206ActiveResources\u548cMemoryCache\uff0c\u786c\u76d8\u7f13\u5b58\u5206ResourceCache\u548cDataCache\u3002</p> <p>\u67e5\u8be2\u987a\u5e8f\u4e5f\u662f\u6309\u4e0a\u9762\u6240\u8bf4\u7684\u987a\u5e8f\u3002</p>"},{"location":"Android/Glide/#activeresources","title":"ActiveResources","text":"<ul> <li>\u4f7f\u7528HashMap+WeakReference(ReferenceQueue)\u6765\u7ef4\u62a4\u3002</li> <li>\u6dfb\u52a0\u65f6\u673a\uff1a\u5f53\u6709\u4efb\u4f55\u8d44\u6e90\u51c6\u5907\u5c31\u7eea\uff0c\u4e14\u4e0d\u5904\u5728\u6b64map\u4e2d\u3002</li> <li>\u5220\u9664\u65f6\u673a\uff1a\u5f53EngineResource\u7684\u4f7f\u7528\u8ba1\u6570\u4e3a0\uff0c\u6216GC\u53d1\u751f\u65f6\uff0cWeakReference\u88ab\u56de\u6536\u65f6\u3002</li> <li>\u5220\u9664\u540e\u4f1a\u653e\u5230MemoryCache\u4e4b\u4e2d</li> <li>\u7d22\u5f15Key</li> </ul>"},{"location":"Android/Glide/#memorycache","title":"MemoryCache","text":"<ul> <li>\u4f7f\u7528LinkedHashMap\u5b9e\u73b0\u7684LruCache\u3002</li> <li>\u6dfb\u52a0\u65f6\u673a\uff1aActiveResources\u5254\u9664\u65f6\u5019\u3002</li> <li>\u5220\u9664\u65f6\u673a\uff1aLru\u5254\u9664\u7b97\u6cd5</li> <li>\u7d22\u5f15Key</li> </ul>"},{"location":"Android/Glide/#resourcecache","title":"ResourceCache","text":""},{"location":"Android/Glide/#datacache","title":"DataCache","text":""},{"location":"Android/Glide/#bitmappool","title":"BitmapPool","text":""},{"location":"Android/Glide/#target","title":"Target","text":""},{"location":"Android/Glide/#_1","title":"\u914d\u7f6e\u65b9\u5f0f\u4ee3\u7801\u8bbe\u8ba1","text":"<ul> <li>\u7531\u4e8e\u662f\u5355\u4f8b\u7684\u8bbe\u8ba1\uff0c\u53ea\u9700\u8981\u4e00\u6b21\u521d\u59cb\u5316\u914d\u7f6e\u3002\u6ce8\u89e3\u6807\u8bb0\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u5b9e\u73b0\u7c7b\u3002\u4f7f\u7528\u4e86APT\u65b9\u6848\u3002</li> </ul>"},{"location":"Android/Glide/#_2","title":"\u52a0\u8f7d\u6a21\u5f0f\u4ee3\u7801\u8bbe\u8ba1","text":"<ul> <li>\u7ef4\u62a4\u4e86\u4e00\u4e2a\u6ce8\u518c\u8868\uff0c\u7528\u4e8e\u67e5\u8be2\u4e0d\u540c\u7684\u52a0\u8f7d\u76ee\u6807\u3001\u6570\u636e\u6e90\u7c7b\u578b\u5bf9\u5e94\u7684\u52a0\u8f7d\u5668\u7c7b\u3002\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6dfb\u52a0\u3001\u66ff\u6362\u5404\u79cd\u52a0\u8f7d\u5668\u7684\u5b9e\u73b0\uff0c\u751a\u81f3\u662f\u6700\u7ec8\u7684<code>GlideUrl.class, InputStream.class</code>\u7684\u5b9e\u73b0\uff0c\u4ece\u800c\u53ef\u4ee5\u628a\u7f51\u7edc\u52a0\u8f7d\u8fc7\u7a0b\u4f7f\u7528\u4e0d\u540c\u7684\u7f51\u7edc\u5e93\u5b9e\u73b0\u3002</li> <li>\u5bf9\u4e8e\u52a0\u8f7d\u5668\u8fdb\u884c\u4e86\u62bd\u8c61\u3001\u52a0\u8f7d\u5668\u5b8c\u6210\u7684callback\u4e5f\u8fdb\u884c\u4e86\u62bd\u8c61\u3002\u4ece\u800c\u53ef\u4ee5\u8ba9Glide\u7684\u7f13\u5b58\u673a\u5236\u8131\u79bb\u4e8e\u52a0\u8f7d\u5668\u7684\u5b9e\u73b0\uff0c\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u3002</li> </ul>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/","title":"Jetpack \u73b0\u4ee3\u5b89\u5353\u5f00\u53d1","text":""},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#_1","title":"\u80cc\u666f","text":"<p>2021\u5e74\uff0c\u5f53\u6211\u518d\u6b21\u5f00\u59cb\u91cd\u65b0\u9762\u5bf9\u5b89\u5353\u5e94\u7528\u5f00\u53d1\u65f6\uff0c\u6211\u60f3\u5fd8\u6389\u4e4b\u524d\u7684\u4e00\u5207\uff0c\u5373\u90a3\u4e9b\u56fa\u6709\u7684\u77e5\u8bc6\uff0c\u60f3\u5c1d\u8bd5\u6309\u7167\u5b98\u65b9\u7684\u6700\u65b0\u5efa\u8bae\u6307\u5bfc\uff0c\u6765\u5f00\u53d1\u4e00\u6b3e\u5e94\u7528\u4f1a\u662f\u4ec0\u4e48\u4f53\u9a8c\u3002\u4e8e\u662f\uff0c\u6211\u4ee5<code>zrek app</code>\u4e3a\u52a8\u673a\uff0c\u5f00\u59cb\u5e7f\u6cdb\u4f7f\u7528\u5b98\u65b9\u6240\u63a8\u5d07\u7684\u6700\u65b0\u7684\u5e93\u3002\u4e5f\u4e3a\u6b64\u4ed8\u51fa\u4e86\u5de8\u5927\u7684\u5b66\u4e60\u6210\u672c\u3002\u6240\u6d89\u53ca\u5230\u7684Jetpack\u5e93\u5305\u542b\uff1a</p> <ul> <li>Navigation</li> <li>Paging</li> <li>Activity, Fragment</li> <li>DataStore</li> <li>Compose</li> <li>android-dagger(\u4e3a\u4e86\u8fdb\u4e00\u6b65\u4e86\u89e3\u672c\u8d28\uff0c\u6ca1\u6709\u76f4\u63a5\u7528hilt)</li> <li>ViewBinding</li> </ul> <p>\u9664\u4e86Jetpack\u7684\u8fd9\u4e9b\u5e93\uff0c\u8fd8\u6709Kotlin\u534f\u7a0b\u7684\u63a8\u5e7f\u4f7f\u7528\u4e5f\u5e26\u7ed9\u6211\u4e0d\u5c11\u5b66\u4e60\u548c\u9002\u5e94\u6210\u672c\uff0c\u5f53\u7136\u5728\u56fe\u7247\u52a0\u8f7d\u8fd9\u5757\uff0ccoil\u7ed9\u4e86\u6211\u60ca\u559c\u3002\u4e0b\u9762\u6765\u5206\u5f00\u63cf\u8ff0</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#navigation","title":"Navigation","text":""},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#_2","title":"\u80cc\u666f","text":"<p>\u5bfc\u822a\u5e93\u662f\u6bd4\u8f83\u65b0\u7684\u73a9\u610f\uff0c\u76ee\u7684\u5728\u4e8e\u63d0\u5021\u5f00\u53d1\u8005\u53bb\u5199nav_graph.xml\uff0c\u800c\u907f\u514d\u53bb\u5199\u590d\u6742\u7684FragmentManager\u7684transaction\u3002\u4e5f\u8fdb\u800c\u89c4\u907f\u6389\u590d\u6742\u7684Fragment\u751f\u547d\u5468\u671f\u5e26\u6765\u7684\u95ee\u9898\u3002\u6b64\u5916\u8fd8\u5bf9DeepLink\u652f\u6301\u53cb\u597d\uff0c\u5bf9\u5bfc\u822a\u65f6\u4f20\u9012\u53c2\u6570\u53cb\u597d\u3002\u5b83\u65b9\u4fbf\u4e8e\u628a\u8fd9\u4e9b\u5bfc\u822a\u65b9\u9762\u7684\u4ee3\u7801\u62bd\u79bb\u3001\u63d0\u70bc\uff0c\u5e76\u4ee5\u53ef\u89c6\u5316\u76f4\u89c2\u7684\u65b9\u5f0f\u7ba1\u7406\u3001\u4fbf\u4e8e\u66f4\u591a\u9879\u76ee\u7ef4\u62a4\u8005\u7406\u89e3\u3002\u4e5f\u63d0\u4f9b\u5bfc\u822a\u56fe\u7684import\uff0c\u4ece\u800c\u53ef\u4ee5\u590d\u7528\u521b\u9020\u66f4\u590d\u6742\u7684\u56fe\u3002</p> <p>\u4f46\u5bfc\u822a\u81ea\u8eab\u662f\u5f88\u5bbd\u6cdb\u7684\u8bdd\u9898\u3002\u957f\u6309\u51fa\u73b0\u4e86\u5f39\u51fa\u83dc\u5355\u3001\u62bd\u5c49\u3001\u5e95\u90e8Tab\u3001\u6253\u5f00\u65b0\u9875\u9762\u3001\u95ea\u5c4f\u3001\u751a\u81f3\u662fView\u7684\u51fa\u73b0\u548c\u6d88\u5931\uff0c\u8fd9\u90fd\u591a\u591a\u5c11\u5c11\u53ef\u4ee5\u7b97\u662f\u5bfc\u822a\u3002\u5f80\u5927\u4e86\u8bf4\uff0c\u662f\u9875\u9762\u4e4b\u95f4\u8df3\u8f6c\uff0c\u5f80\u5c0f\u4e86\u8bf4\uff0c\u751a\u81f3\u662f\u4e00\u4e2a\u9875\u9762\u5185\u7684\u5c0f\u4ea4\u4e92\u3002</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#_3","title":"\u6982\u8ff0","text":"<p>Navigation\u5305\u542b\u4e86\u4e09\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>nav_graph\uff0c\u4e00\u79cd\u65b0\u7684xml\u8d44\u6e90\u3002\u5e76\u63d0\u4f9b\u4e86\u53ef\u89c6\u5316\u7684\u5de5\u5177\uff0c\u7528\u4e8e\u5b9a\u4e49\u5bfc\u822a\u7684\u201c\u76ee\u7684\u5730\u201d\uff0c\u548caction\u5373\u5bfc\u822a\u8def\u5f84\uff0c\u751a\u81f3\u5305\u62ec\u8def\u5f84\u6240\u9700\u8981\u7684\u53c2\u6570\u4f20\u9012\uff0c\u4ee5\u53ca\u5176\u4ed6\u5c5e\u6027\uff08\u6bd4\u5982\u5bf9\u6808\u5982\u4f55pop\u64cd\u4f5c\uff09\uff0c\u4f3c\u4e4e\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5c5e\u6027\u3002</li> <li>navHost\u3002\u5b83\u626e\u6f14\u7740\u53d1\u8d77\u5bfc\u822a\u7684\u89d2\u8272\uff0c\u76ee\u524d\u4e00\u822c\u662f<code>NavigationHostFramgent</code>\uff0cnavHost\u9700\u8981\u5177\u5907<code>navController</code>\u8fd9\u4e2a\u7c7b\u5c06\u63d0\u4f9b<code>navigate(...)</code>\u65b9\u6cd5\uff0c\u6765\u8ba9\u6211\u4eec\u4f20\u9012\u5728xml\u9884\u5b9a\u4e49\u7684\u8def\u5f84id\u3001\u53c2\u6570\uff0c\u4ece\u800c\u6309\u7167\u5bf9\u5e94\u8def\u5f84\u8fdb\u884c\u8df3\u8f6c\u3002</li> <li>navigator\u3002\u5bf9\u5bfc\u822a\u5230\u76ee\u7684\u5730\u7684\u884c\u4e3a\u62bd\u8c61\u3002\u5b83\u6709\u591a\u4e2a\u5b9e\u73b0\u5b50\u7c7b\uff0c\u5982<code>FragmentNavigator</code>, <code>ActivityNavigator</code>\u7b49\u3002\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u76ee\u7684\u5730\u7c7b\u578b\uff0c\u5e76\u521b\u5efa\u5bf9\u5e94\u7684<code>navigator</code>\u5b9e\u73b0\u7c7b\u3002</li> </ul> <p>\u5176\u5185\u90e8\u5de5\u4f5c\u6d41\u7a0b\u4e00\u822c\u662f\uff0c\u9700\u8981\u7ed9<code>NavigationHostFramgent</code>\u5373\u66f4\u5bbd\u6cdb\u8bf4\uff0c\u7ed9<code>navHost</code>\u6307\u5b9a\u4e00\u4efd<code>nav_graph</code>\u5373\u5bfc\u822a\u56fe\u8d44\u6e90\u6765\u89e3\u6790\u3002\u5728\u8c03\u7528<code>navHost</code>\u63d0\u4f9b\u7684<code>navController</code>\u7684<code>navigate</code>\u65b9\u6cd5\u65f6\uff0c\u9700\u8981\u4f20\u9012\u6b64\u5bfc\u822a\u56fe\u5185\u6709\u6548\u7684\u8def\u5f84id\uff0c\u4ee5\u53ca\u6240\u9700\u53c2\u6570\u3002<code>navController</code>\u4f1a\u6839\u636eid\u5339\u914d\u51fa\u8def\u5f84\u5b9a\u4e49\u3001\u627e\u5230\u76ee\u7684\u5730\uff0c\u518d\u67e5\u8be2\u8be5\u76ee\u7684\u5730\u7c7b\u578b\u7684<code>Navigator</code>\uff0c\u5e76\u4f7f\u7528<code>Navigator</code>\u4f20\u5165\u6240\u6709\u4e0a\u4e0b\u6587\u4fe1\u606f\u5b9e\u73b0\u8df3\u8f6c\u3002</p> <p>\u5c3d\u7ba1Navigation\u662f\u60f3\u5bfc\u822a\u4e00\u5207\uff0c\u662f\u4e00\u4e2a\u901a\u7528\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4f46\u82e5\u771f\u7684\u60f3\u5728\u5b9e\u9645\u4f7f\u7528\u4e2d\u652f\u6301\u5404\u79cd\u5927\u5927\u5c0f\u5c0f\u7684\u573a\u666f\uff0c\u662f\u9700\u8981\u82b1\u8d39\u4e0d\u5c0f\u529f\u592b\u7684\u3002</p> <p>\u6bd4\u5982\u6211\u4e3a\u4e86\u5728\u81ea\u5b9a\u4e49\u7684\u5e95\u90e8\u5bfc\u822a\u680f\u7684\u591a\u4e2aTab\u4e2d\uff0c\u4e3a\u4e86\u5207\u6362Fragment\u65f6\u590d\u7528\u6240\u521b\u5efa\u7684\uff0c\u9700\u8981\u4ee5\u81ea\u5b9a\u4e49<code>FragmentNavigator</code>\u6765\u5b8c\u6210\uff0c\u5b98\u65b9\u5e76\u6ca1\u6709\u8fd9\u79cd\u64cd\u4f5c\u7684\u652f\u6301\u3002<code>Navigator</code>\u662f\u5bf9\u5bfc\u822a\u5230\u76ee\u7684\u5730\u7684\u5b9e\u73b0\u62bd\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u5728<code>nav_graph.xml</code>\u5b9a\u4e49\u5404\u79cd\u5404\u6837\u7684\u76ee\u7684\u5730\uff0c\u4f46\u5fc5\u987b\u4e5f\u8981\u5b9e\u73b0\u8fd9\u4e9b\u76ee\u7684\u5730\u7c7b\u578b\u7684<code>navigator</code>\u3002</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#paging","title":"Paging","text":""},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#_4","title":"\u6982\u8ff0","text":"<p>\u51e0\u4e4e\u5bf9\u4e8e\u6240\u6709\u7684\u5217\u8868\u9875\u9762\uff0c\u90fd\u4e0d\u53ef\u907f\u514d\u5730\u9700\u8981\u4f7f\u7528\u5206\u9875\u6570\u636e\u3002<code>Paging</code>\u5219\u662f\u5b98\u65b9\u7ed9\u51fa\u7684\u89e3\u51b3\u65b9\u6848\u3002\u5b83\u65e8\u5728\u63d0\u4f9b\u4e00\u5957\u5f00\u7bb1\u5373\u7528\u7684\u5206\u9875\u5de5\u5177\uff0c\u4f7f\u7528\u65f6\u53ea\u9700\u8981\u5b9a\u4e49<code>PagingSource</code>\uff0c\u7b80\u5355\u8bbe\u7f6e\u4e0b<code>Pager</code>\u5e76\u5f97\u5230\u5206\u9875flow\uff0c\u5e76\u5bf9\u6b64<code>flow.collectLatest { PagingAdapter.submitData(..)}</code>\uff0c\u8fd9\u91cc\u7684PagingAdapter\u7528\u4f5c\u7ed9RecyclerView\u7684Adapter\u5373\u53ef\u5b8c\u6210\u3002</p> <p>\u8fd9\u4e2a\u5e93\u6d89\u53ca\u4e86kotlin <code>flow</code>\u7684\u4f7f\u7528\uff0c\u4e5f\u63d0\u4f9b<code>RxJava</code>\u548c<code>LiveData</code>\u7684\u652f\u6301\u3002\u5176\u5185\u90e8\u5de5\u4f5c\u539f\u7406\u8981\u7a0d\u590d\u6742\u4e9b\uff1a</p> <ul> <li>\u5728ViewModel\u4e2d\u5b9a\u4e49Pager\uff0c\u7ed9\u5b9a<code>PagingConfig</code>\u4ee5\u53ca<code>PagingSource</code>\u540e\u53ef\u4ee5\u83b7\u5f97<code>flow</code>\u3002\u901a\u8fc7<code>flow.collect</code>api\u6765\u4e3a<code>PagingAdapter</code>\u63d0\u4ea4\u6570\u636e\u3002</li> <li><code>PagingAdapter</code>\u5bf9\u4e0b\u6b21\u83b7\u53d6\u5206\u9875\u6570\u636e\u7684\u65f6\u673a\u5e76\u975e\u4f9d\u8d56\u4e8e\u5bf9\u5217\u8868\u53ef\u89c1\u6761\u76ee\u4f4d\u7f6e\u7684\u76d1\u542c\uff0c\u800c\u662f\u6839\u636e<code>getItem</code>\u6765\u5224\u65ad\u3002\u82e5<code>getItem</code>\u65f6\u4f20\u5165\u7684position\u548c\u603bitem\u6570\u91cf\u7684\u5dee\uff0c\u5df2\u7ecf\u5c0f\u4e8e\u4e86<code>PagingConfig</code>\u89c4\u5b9a\u7684\u9608\u503c\uff0c\u5219\u5f00\u59cb\u8c03\u7528<code>PagingSource</code>\u62c9\u53d6\u65b0\u7684\u6570\u636e\u3002</li> <li>\u7ed9<code>PagingAdapter</code>\u63d0\u4ea4\u7684\u6570\u636e\u7c7b\u578b\u662f<code>PagingData</code>\uff0c\u5176\u5c01\u88c5\u4e86\u5177\u4f53\u7684Paging\u4e8b\u4ef6\uff0c\u6bd4\u5982\u52a0\u8f7d\u3001\u5237\u65b0\u3001\u5f02\u5e38\u3002\u8fd9\u4e9b\u4e8b\u4ef6\u5bf9\u4e8e<code>LoadingHeader/Footer</code>\u662f\u6709\u7528\u7684\u3002</li> </ul>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#activityfragmentviewmodel-scope","title":"Activity/Fragment/ViewModel, Scope","text":""},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#_5","title":"\u6982\u8ff0","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u60f3\u8bf4\u7684\u662f\uff0c\u5728\u4e00\u4e24\u5e74\u524d\u8fd8\u89c9\u5f97\u975e\u5e38\u4e0d\u9519\u7684<code>LiveData</code>\u4ee5\u53ca<code>Lifecycle/LifecycleOwner</code>\u51e0\u4e4e\u5feb\u8981\u88ab\u65b0\u7684\u3001\u548cKotlin\u6240\u4e00\u8d77\u63a8\u52a8\u7684<code>lifecycleScope</code>\u3001<code>StateFlow</code>\u53d6\u4ee3\u4e86\u3002</p> <p>\u7531\u8877\u611f\u6168\u8fed\u4ee3\u4e4b\u5feb\u5bb9\u6613\u8ba9\u4eba\u5e94\u63a5\u4e0d\u6687\uff0c\u4e0d\u5f97\u4e0d\u591a\u4ece\u8fd9\u4e9b\u4e8b\u7269\u4e2d\u591a\u5bfb\u627e\u90a3\u4e9b\u4e0d\u53d8\u7684\u672c\u8d28\uff0c\u6765\u66f4\u597d\u5728\u8fd9\u6f6e\u6d41\u91cc\u524d\u884c\u3002</p> <p><code>LifecycleScope</code>\u662f<code>LifecycleOwner</code>\u7684\u62d3\u5c55\u5c5e\u6027\uff0c\u7c7b\u578b\u662f<code>LifecycleCoroutineScope</code>\uff0c\u5728<code>CoroutineScope</code>\u4e0a\u52a0\u4e86\u4e2aLifecycle\u6210\u5458\u3002</p> <p>\u7531\u4e8e\u662f<code>CoroutineScope</code>\uff0c\u5176\u4f5c\u7528\u4e0d\u8a00\u81ea\u660e\uff0c\u6240\u6709\u7684\u9700\u8981\u4e0e\u6b64\u751f\u547d\u5468\u671f\u7ed1\u5b9a\u7684Kotlin\u5f02\u6b65\u4efb\u52a1\uff0c\u90fd\u53ef\u4ee5\u5728\u6b64\u4e0a\u4e0b\u6587\u4e2d\u5c55\u5f00\u3002</p> <p>\u800cViewModel\u4e5f\u63d0\u4f9b\u4e86<code>ViewModelScope</code>\u4e0eViewModel\u7684\u751f\u547d\u5468\u671f\u7ed1\u5b9a\u3002\u5b83\u4eec\u5f80\u5f80\u63d0\u4f9b\u4e86\u4e00\u4e9b<code>launchWhenCreate</code>, <code>launchWhenStart</code>\u65b9\u6cd5\uff0c\u7528\u4e8e\u5728\u7279\u5b9a\u751f\u547d\u5468\u671f\u4e8b\u4ef6\u540e\u5f00\u59cb\u5f02\u6b65\u4efb\u52a1\u3002</p> <p>\u4f7f\u7528\u4f53\u611f\u4e0a\u6765\u8bf4\u4f1a\u6bd4<code>LifecycleObserver</code>\u8fd9\u6837\u7684\u4e1c\u897f\u597d\u7528\u4e0d\u5c11\u3002\u5bf9<code>Lifecycle</code>\u7684\u751f\u547d\u5468\u671f\u89c2\u6d4b\uff0c\u4e5f\u8981\u9010\u6e10\u6c89\u5165\u5386\u53f2\u7684\u6d77\u6d0b\u4e86\u3002\u81f3\u4e8e\u534f\u7a0b\u76f8\u5173\u77e5\u8bc6\uff0c\u8bf7\u53c2\u9605\u201cKotlin\u201dsection.</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#datastore","title":"DataStore","text":""},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#compose","title":"Compose","text":"<p>\u8bf7\u53c2\u9605\u201c\u8de8\u7aef\u6280\u672f\u201dsection</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#android-dagger","title":"android-dagger","text":"<p>\u8bf7\u53c2\u9605\u201c\u8bbe\u8ba1\u6a21\u5f0f\u201dsection</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#view-binding","title":"View Binding","text":""},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#_6","title":"\u6982\u8ff0","text":"<p>\u5728\u6211\u7684\u8ba4\u77e5\u4e2d\uff0c\u5b83\u7684\u6f14\u8fdb\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff1a</p> <p>\u8fdc\u53e4\u65f6\u671f\uff1a <pre><code>iv = (ImageView) container.findViewById(R.id.xxxxxx);\n</code></pre> \u9ec4\u6cb9\u5200ButterKnife\u65f6\u671f\uff08\u5178\u578b\u7684\u4f9d\u8d56\u6ce8\u5165\u7279\u6b8a\u573a\u666f\uff09\uff1a <pre><code>@Bind(R.id.xxxxxx)\nImageView iv;\n\nonCreate(..){xxxx.install(this);}\n</code></pre> Kotlin\u521d\u671f\uff1a <pre><code>val iv by lazy{\n    findViewById&lt;ImageView&gt;(R.id.xxxxxx)\n}\n</code></pre> Kotlin\u7a0d\u540e\u65f6\u671f\uff1a <pre><code>import ..kotlin...activity.some_id_of_image_view as someIv\n</code></pre> \u73b0\u5728(layout xml: some_activity.xml)\uff1a <pre><code>val binding = SomeActivityBinding.inflate(Inflater,...)\nor \nval binding = SomeActivityBinding.bind(View)\n\n\u4f7f\u7528\uff1a\n\nbinding.iv\n</code></pre> \u82e5\u60f3\u67e5\u770b\u81ea\u52a8\u751f\u6210\u7684xxxBinding\u6587\u4ef6\uff0c\u9700\u8981\u5728gradle module\u76ee\u5f55\u4e0b\u7684Build\u91cc\u641c\u7d22\uff0c\u597d\u50cf\u662fviewBinding\u91cc\u3002</p> <p>\u53c8\u662f\u4e00\u6b21\u611f\u53f9\uff0c\u5173\u4e8e\u53ef\u80fd\u4e0d\u5230\u4e00\u5e74\u524d\uff0c\u8fd8\u4f7f\u7528Kotlin\u6240\u81ea\u52a8\u4e3alayout xml\u6240\u751f\u6210\u7684id\u8d44\u6e90\uff0c\u6ca1\u6301\u7eed\u591a\u4e45\uff0c\u73b0\u5728\u53c8\u5df2\u53d8\u6210\u4e86ViewBinding\u3002</p>"},{"location":"Android/Jetpack%20%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/#coil","title":"coil","text":"<p>coil\u662f\u4e00\u4e2a\u57fa\u4e8eKotlin\u5199\u7684\u56fe\u7247\u52a0\u8f7d\u5e93\uff0c\u5b83\u4e3aImageView\u6dfb\u52a0\u4e86\u62d3\u5c55\u65b9\u6cd5\uff0c\u4ece\u800c\u5728\u83b7\u53d6\u5230ImageView\u7684\u65f6\u5019\u5f88\u65b9\u4fbf\u5730\u8c03\u7528<code>imageView.load(\"url\")</code>\u6216\u8005\u5176\u4ed6\u91cd\u8f7d\u65b9\u6cd5\u3002\u5f53\u7136\u4e5f\u63d0\u4f9b\u4e86\u72ec\u7acb\u7684<code>coil</code>\u5c01\u88c5\u5373\u4f5c\u4e3aclient\u6765\u53d1\u8d77\u8bf7\u6c42\uff0c\u83b7\u53d6\u56fe\u7247\u3001drawable\u4e4b\u7c7b\u3002</p> <p>\u6b22\u8fce\u6765\u5230\u65b0\u7684\u65f6\u4ee3~</p>"},{"location":"Android/LeakCanary/","title":"LeakCanary","text":"<p>\u662f\u4e00\u4e2a\u5b89\u5353\u4e0a\u7528\u6765\u68c0\u6d4b\u5185\u5b58\u6cc4\u6f0f\u7684\u5e93\u3002\u6613\u4e8e\u4f7f\u7528\u548c\u5185\u90e8\u8bf8\u591a\u5b9e\u73b0\u539f\u7406\u5bf9\u6027\u80fd\u9886\u57df\u90fd\u662f\u503c\u5f97\u7814\u7a76\u501f\u9274\u7684\u3002</p>"},{"location":"Android/LeakCanary/#_1","title":"\u542f\u52a8\u65b9\u5f0f","text":"<p>\u53ea\u9700\u8981gradle\u5f15\u5165<code>debugImplementation</code>\u4f9d\u8d56\u5373\u53ef\u3002\u5b9e\u9645\u662f<code>ContentProvider</code>\u65b9\u5f0f\u6765\u63d0\u4f9b\u4e86\u521d\u59cb\u5316\u3002\u6e05\u5355\u5b9a\u4e49\uff1a <pre><code>&lt;provider\n    android:name=\"leakcanary.internal.AppWatcherInstaller$MainProcess\"\n    android:authorities=\"${applicationId}.leakcanary-installer\"\n    android:enabled=\"@bool/leak_canary_watcher_auto_install\"\n    android:exported=\"false\"/&gt;\n</code></pre> <code>leakcanary.internal.AppWatcherInstaller$MainProcess</code>\u7684\u5177\u4f53\u5b9a\u4e49\u53ea\u9700\u8981\u5173\u6ce8\uff1a <pre><code>  override fun onCreate(): Boolean {\n    val application = context!!.applicationContext as Application\n    AppWatcher.manualInstall(application)\n    return true\n  }\n</code></pre> \u5177\u4f53\u7684<code>install</code>\u8fc7\u7a0b\u662f\u6307\uff1a <pre><code>      ActivityWatcher(application, reachabilityWatcher),\n      FragmentAndViewModelWatcher(application, reachabilityWatcher),\n      RootViewWatcher(reachabilityWatcher),\n      ServiceWatcher(reachabilityWatcher)\n</code></pre> \u8fd94\u4e2a\u9ed8\u8ba4\u7684watcher\u7684install\u8c03\u7528\u3002\u5206\u5f00\u6765\u770b\uff1a</p>"},{"location":"Android/LeakCanary/#activitywatcher","title":"ActivityWatcher","text":"<pre><code>class ActivityWatcher(...\n) : InstallableWatcher {\n\n  private val lifecycleCallbacks =\n    object : Application.ActivityLifecycleCallbacks by noOpDelegate() {\n      override fun onActivityDestroyed(activity: Activity) {\n          //\u6838\u5fc3\uff0c\u5373\u5728Activity\u9500\u6bc1\u56de\u8c03\u65f6\uff0c\u89e6\u53d1\u4e00\u6b21\u9884\u671f\u5f31\u5f15\u7528\u68c0\u67e5\n        reachabilityWatcher.expectWeaklyReachable(\n          activity, \"${activity::class.java.name} received Activity#onDestroy() callback\"\n        )\n      }\n    }\n\n  override fun install() {\n    application.registerActivityLifecycleCallbacks(lifecycleCallbacks)\n  }\n\n  override fun uninstall() {\n    application.unregisterActivityLifecycleCallbacks(lifecycleCallbacks)\n  }\n}\n</code></pre>"},{"location":"Android/LeakCanary/#fragmentandviewmodelwatcher","title":"FragmentAndViewModelWatcher","text":"<p><pre><code>class FragmentAndViewModelWatcher(\n  private val application: Application,\n  private val reachabilityWatcher: ReachabilityWatcher\n) : InstallableWatcher {\n  private val lifecycleCallbacks =\n    object : Application.ActivityLifecycleCallbacks by noOpDelegate() {\n      override fun onActivityCreated(\n        activity: Activity,\n        savedInstanceState: Bundle?\n      ) {\n        for (watcher in fragmentDestroyWatchers) {\n          watcher(activity)\n        }\n      }\n    }\n\n  override fun install() {\n    application.registerActivityLifecycleCallbacks(lifecycleCallbacks)\n  }\n\n  override fun uninstall() {\n    application.unregisterActivityLifecycleCallbacks(lifecycleCallbacks)\n  }\n}\n</code></pre> \u5176\u4e2d<code>fragmentDestroyWatchers</code>\u5177\u4f53\u662f\u6307<code>AndroidXFragmentDestroyWatcher</code>\u3001<code>AndroidSupportFragmentDestroyWatcher</code> \u5176\u4e2d\u4e4b\u4e00\u3002\u4ee3\u7801\u90fd\u5f88\u76f8\u4f3c\uff0c\u67e5\u770b\u4e00\u4e2a\u5373\u53ef\uff1a <pre><code>internal class AndroidXFragmentDestroyWatcher(\n  private val reachabilityWatcher: ReachabilityWatcher\n) : (Activity) -&gt; Unit {\n\n  private val fragmentLifecycleCallbacks = object : FragmentManager.FragmentLifecycleCallbacks() {\n\n    override fun onFragmentCreated(\n      fm: FragmentManager,\n      fragment: Fragment,\n      savedInstanceState: Bundle?\n    ) {\n      ViewModelClearedWatcher.install(fragment, reachabilityWatcher)\n    }\n\n    override fun onFragmentViewDestroyed(\n      fm: FragmentManager,\n      fragment: Fragment\n    ) {\n      val view = fragment.view\n      if (view != null) {\n        reachabilityWatcher.expectWeaklyReachable(\n          view, \"${fragment::class.java.name} received Fragment#onDestroyView() callback \" +\n          \"(references to its views should be cleared to prevent leaks)\"\n        )\n      }\n    }\n\n    override fun onFragmentDestroyed(\n      fm: FragmentManager,\n      fragment: Fragment\n    ) {\n      reachabilityWatcher.expectWeaklyReachable(\n        fragment, \"${fragment::class.java.name} received Fragment#onDestroy() callback\"\n      )\n    }\n  }\n\n  override fun invoke(activity: Activity) {\n    if (activity is FragmentActivity) {\n      val supportFragmentManager = activity.supportFragmentManager\n      supportFragmentManager.registerFragmentLifecycleCallbacks(fragmentLifecycleCallbacks, true)\n      ViewModelClearedWatcher.install(activity, reachabilityWatcher)\n    }\n  }\n}\n</code></pre> \u5373\u4f7f\u7528<code>FragmentManager.registerFragmentLifecycleCallbacks</code>\u6765\u6ce8\u518c\u751f\u547d\u5468\u671f\u56de\u8c03\uff0c\u5728<code>view</code>\u9500\u6bc1\u65f6\u68c0\u67e5<code>view</code>\uff0c\u5728<code>fragment</code>\u9500\u6bc1\u65f6\uff0c\u68c0\u67e5<code>fragment</code>\u3002</p>"},{"location":"Android/LeakCanary/#viewmodelclearedwatcher","title":"ViewModelClearedWatcher","text":"<p>\u5b83\u4f9d\u8d56\u4e8e<code>AndroidX</code>\u4e0b\u7684<code>ViewModelStoreOwner</code>\uff0c\u5177\u4f53\u5b50\u7c7b\u662f<code>FragmentActivity</code>\u548c<code>Fragment</code>\uff0c\u5b83\u901a\u8fc7<code>ViewModelStoreOwner</code>\u6784\u9020\u4e86<code>ViewModelProvider</code>\u5e76\u521b\u5efa\u4e86\u81ea\u5df1\u7684<code>ViewModel</code>\u4f5c\u4e3a\u76d1\u89c6\u5668\uff0c\u8be5<code>ViewModel.onCleared</code>\u56de\u8c03\u4e2d\uff0c\u4f1a\u53cd\u5c04\u83b7\u53d6<code>ViewModelStoreOwner.viewModelStore</code>\u7684\u79c1\u6709\u6210\u5458<code>mMap</code>\u8fdb\u800c\u5f97\u5230\u6240\u6709\u7684<code>ViewModel</code>\uff0c\u5e76\u68c0\u6d4b\u5b83\u4eec\u662f\u5426\u5904\u4e8e\u5f31\u8bbf\u95ee\u72b6\u6001\u3002</p>"},{"location":"Android/LeakCanary/#rootviewwatcher","title":"RootViewWatcher","text":"<p><pre><code>class RootViewWatcher(\n  private val reachabilityWatcher: ReachabilityWatcher\n) : InstallableWatcher {\n\n  private val listener = OnRootViewAddedListener { rootView -&gt;\n    val trackDetached = when(rootView.windowType) {\n      PHONE_WINDOW -&gt; {\n        when (rootView.phoneWindow?.callback?.wrappedCallback) {\n          // Activities are already tracked by ActivityWatcher\n          is Activity -&gt; false\n          is Dialog -&gt; {\n            // Use app context resources to avoid NotFoundException\n            // https://github.com/square/leakcanary/issues/2137\n            val resources = rootView.context.applicationContext.resources\n            resources.getBoolean(R.bool.leak_canary_watcher_watch_dismissed_dialogs)\n          }\n          // Probably a DreamService\n          else -&gt; true\n        }\n      }\n      // Android widgets keep detached popup window instances around.\n      POPUP_WINDOW -&gt; false\n      TOOLTIP, TOAST, UNKNOWN -&gt; true\n    }\n    if (trackDetached) {\n      rootView.addOnAttachStateChangeListener(object : OnAttachStateChangeListener {\n\n        val watchDetachedView = Runnable {\n          reachabilityWatcher.expectWeaklyReachable(\n            rootView, \"${rootView::class.java.name} received View#onDetachedFromWindow() callback\"\n          )\n        }\n\n        override fun onViewAttachedToWindow(v: View) {\n          mainHandler.removeCallbacks(watchDetachedView)\n        }\n\n        override fun onViewDetachedFromWindow(v: View) {\n          mainHandler.post(watchDetachedView)\n        }\n      })\n    }\n  }\n\n  override fun install() {\n    Curtains.onRootViewsChangedListeners += listener\n  }\n\n  override fun uninstall() {\n    Curtains.onRootViewsChangedListeners -= listener\n  }\n}\n</code></pre> \u8fd9\u91cc\u5728\u9644\u52a0\u8fc7\u7a0b\u4e2d\uff0c\u4f7f\u7528\u4e86<code>Curtains</code>\uff0c\u8fd9\u4e2a\u5de5\u5177\u505a\u4e86\u4e00\u4e2a\u6bd4\u8f83trick\u7684\u4e1c\u897f\uff0c\u5b83\u901a\u8fc7\u53cd\u5c04\u83b7\u53d6\u4e86<code>WindowManagerGlobal</code>\u5e76\u628a<code>mViewList:List&lt;RootViewImpl&gt;</code>\u8fd9\u4e2a\u6210\u5458\u7ed9\u66ff\u6362\u6210\u4e86\u81ea\u5df1\u7684List\u4ee3\u7406\uff0c\u5185\u90e8\u5143\u7d20\u4f9d\u7136\u6ca1\u6709\u6539\u53d8\uff0c\u53ea\u662f\u589e\u52a0\u7684\u8fd9\u4e00\u5c42\u53ef\u4ee5\u83b7\u5f97<code>add</code>, <code>remove</code>\u7684\u5207\u9762\u7531\u6b64\u53ef\u4ee5\u53d1\u9001\u76f8\u5e94\u7684\u76d1\u542c\u4e8b\u4ef6\u3002\u8fd9\u91cc\u76d1\u542c\u8005\u5373\u662f<code>RootViewWatcher</code>\uff0c\u800c\u5b83\u5bf9<code>ViewRootImpl</code>\u6240\u5c5e\u7684Window\u7684\u7c7b\u578b\u505a\u4e86\u4e00\u4e9b\u68c0\u67e5\u3002\u53bb\u8ddf\u4e86\u4e0b\u4ee3\u7801\u5b9e\u73b0\uff0c\u8ba4\u4e3a\u4e0d\u662f\u5f88\u503c\u5f97\u4e86\u89e3\u3002\u8fd9\u4e2a<code>watcher</code>\u4e5f\u5c31\u4f5c\u7f62\u3002</p>"},{"location":"Android/LeakCanary/#objectwatcher","title":"ObjectWatcher","text":"<p>\u5b83\u4e5f\u662f\u626e\u6f14\u771f\u6b63\u68c0\u67e5\u5f15\u7528\u662f\u5426\u88ab\u5408\u7406\u91ca\u653e\u7684\u89d2\u8272\u3002 <pre><code>  @Synchronized override fun expectWeaklyReachable(\n    watchedObject: Any,\n    description: String\n  ) {\n    if (!isEnabled()) {\n      return\n    }\n    //\u7406\u89e3\u4e3apruneList\uff0c\u5373\u89e6\u53d1\u4e00\u6ce2\u5217\u8868\u51c0\u5316\n    removeWeaklyReachableObjects()\n    val key = UUID.randomUUID()\n    val watchUptimeMillis = clock.uptimeMillis()\n    //KeyedWeakRefence\u662fWeakReference\u5b50\u7c7b\uff0c\u589e\u52a0\u4e86\u51e0\u4e2a\u6210\u5458\u53d8\u91cfkey, description, time\n    val reference =\n      KeyedWeakReference(watchedObject, key, description, watchUptimeMillis, queue)\n    //\u6ce8\u518c\u8fdb\u5165\u89c2\u5bdf\u5217\u8868\u3002\n    watchedObjects[key] = reference\n    checkRetainedExecutor.execute {\n      //\u542f\u52a8\u4e00\u6b21\u68c0\u67e5\n      moveToRetained(key)\n    }\n  }\n\n  //\u51c0\u5316\u5217\u8868\uff0c\u5373ReferenceQueue.poll\u4e00\u6ce2\u8fde\u7eed\u975e\u7a7a\u5143\u7d20\u3002\u5bf9\u6bcf\u4e2a\u5143\u7d20\u4ece\u89c2\u5bdf\u5217\u8868\u79fb\u9664\u3002\u56e0\u4e3a\u5904\u4e8eReferenceQueue\u65f6\u8bf4\u660e\u5176\u5df2\u7ecf\u4f1a\u88abGC\u4e86\uff0c\u5c3d\u7ba1\u5c1a\u672aGC\u3002\n  private fun removeWeaklyReachableObjects() {\n    var ref: KeyedWeakReference?\n    do {\n      ref = queue.poll() as KeyedWeakReference?\n      if (ref != null) {\n        watchedObjects.remove(ref.key)\n      }\n    } while (ref != null)\n  }\n\n    @Synchronized private fun moveToRetained(key: String) {\n      //\u89e6\u53d1\u51c0\u5316\u5217\u8868\n    removeWeaklyReachableObjects()\n    val retainedRef = watchedObjects[key]\n    if (retainedRef != null) {\n      //\u5982\u679c\u8fd8\u5904\u5728\u89c2\u5bdf\u5217\u8868\uff0c\u8bb0\u5f55\u9a7b\u7559\u68c0\u6d4b\u65f6\u95f4\u3002\n      retainedRef.retainedUptimeMillis = clock.uptimeMillis()\n      //\u89e6\u53d1\u9a7b\u7559\u4e8b\u4ef6\u56de\u8c03\n      onObjectRetainedListeners.forEach { it.onObjectRetained() }\n    }\n  }\n</code></pre> \u5728LeakCanary\u4e2d\u5bf9\u8c61\u9a7b\u7559\u56de\u8c03\u7684\u5b9e\u73b0\u4e3b\u8981\u5982\u4e0b\uff1a <pre><code>  fun scheduleRetainedObjectCheck() {\n    if (this::heapDumpTrigger.isInitialized) {\n      //\u8c03\u5ea6\u5bf9\u8c61\u9a7b\u7559\u68c0\u6d4b\uff0c\u5176\u5185\u90e8\u4f1a\u5148\u68c0\u6d4b\u82e5\u5df2\u7ecf\u542f\u52a8\uff0c\u5219\u5ffd\u7565\uff0c\u82e5\u6ca1\u6709\u542f\u52a8\u8fc7\uff0c\u5219\u5728\u540e\u53f0\u7ebf\u7a0b\u8c03\u5ea6\u4e00\u6b21\u4efb\u52a1\n      heapDumpTrigger.scheduleRetainedObjectCheck()\n    }\n  }\n  //\u5bf9\u8c61\u9a7b\u7559\u68c0\u6d4b\u7684\u6838\u5fc3\u903b\u8f91\n    private fun checkRetainedObjects() {\n    val iCanHasHeap = HeapDumpControl.iCanHasHeap()\n    val config = configProvider()\n    if (iCanHasHeap is Nope) {\n      ... //\u4e0d\u80fdheap\u5148\u4e0d\u770b\n      return\n    }\n    var retainedReferenceCount = objectWatcher.retainedObjectCount\n\n    if (retainedReferenceCount &gt; 0) {\n      gcTrigger.runGc()\n      retainedReferenceCount = objectWatcher.retainedObjectCount\n    }\n\n    if (checkRetainedCount(retainedReferenceCount, config.retainedVisibleThreshold)) return\n\n    val now = SystemClock.uptimeMillis()\n    val elapsedSinceLastDumpMillis = now - lastHeapDumpUptimeMillis\n    if (elapsedSinceLastDumpMillis &lt; WAIT_BETWEEN_HEAP_DUMPS_MILLIS) {\n      ...//\u91cd\u65b0\u5ef6\u8fdf\u8c03\u5ea6\n      return\n    }\n    dumpHeap(\n      retainedReferenceCount = retainedReferenceCount,\n      retry = true,\n      reason = \"$retainedReferenceCount retained objects, app is $visibility\"\n    )\n  }\n</code></pre></p>"},{"location":"Android/LeakCanary/#gc","title":"GC\u89e6\u53d1","text":"<p>\u8981\u70b9\u662f<code>Runtime.getRuntime().gc()</code>\u800c\u975e<code>System.gc()</code>\uff0c\u524d\u8005\u66f4\u5bb9\u6613\u89e6\u53d1GC\u3002 <pre><code>  object Default : GcTrigger {\n    override fun runGc() {\n      // Code taken from AOSP FinalizationTest:\n      // https://android.googlesource.com/platform/libcore/+/master/support/src/test/java/libcore/\n      // java/lang/ref/FinalizationTester.java\n      // System.gc() does not garbage collect every time. Runtime.gc() is\n      // more likely to perform a gc.\n      Runtime.getRuntime()\n        .gc()\n      enqueueReferences()\n      System.runFinalization()\n    }\n\n    private fun enqueueReferences() {\n      // Hack. We don't have a programmatic way to wait for the reference queue daemon to move\n      // references to the appropriate queues.\n      try {\n        Thread.sleep(100)\n      } catch (e: InterruptedException) {\n        throw AssertionError()\n      }\n    }\n  }\n</code></pre></p>"},{"location":"Android/LeakCanary/#dumpheap","title":"DumpHeap","text":"<p>\u6838\u5fc3\u662f\u4f7f\u7528<code>Debug</code>\u7c7b\uff1a <pre><code>Debug.dumpHprofData(heapDumpFile.absolutePath)\n</code></pre></p> <p>Debug\u7c7b\u4e2d\u6709\u4e0d\u5c11\u6709\u8da3\u7684\u5de5\u5177\uff0c\u5305\u62ec\u7b49\u5f85\u8c03\u8bd5<code>waitForDebugger</code>\u7b49\u3002</p>"},{"location":"Android/LeakCanary/#heapanalyzer","title":"HeapAnalyzer","text":""},{"location":"Android/LeakCanary/#hprof","title":".hprof","text":"<p>hprof\u662fjava\u63d0\u4f9b\u7684\u5de5\u5177\uff0c\u7528\u4e8e\u8fdb\u884ccpu/heap\u7684\u5256\u6790\u3002\u5176\u683c\u5f0f\u5b9a\u4e49\u89c1\u8fd9\u91cc\uff0c\u6216\u8005\u8fd9\u91cc</p>"},{"location":"Android/LeakCanary/#_2","title":"\u66f4\u591a\u65b9\u5f0f","text":"<p>Dump heap\u65b9\u5f0f\u4e0d\u6b62\u4e00\u79cd\uff0c\u6709\u66f4\u591a\u7684\u5de5\u5177\u53ef\u4ee5\u5904\u7406\uff0c\u4f46\u5176\u5185\u90e8\u5de5\u4f5c\u673a\u7406\u5e94\u8be5\u5747\u57fa\u4e8eJVM TI(Tool Interface)\uff0c\u5b83\u63d0\u4f9b\u4e86\u5927\u91cf\u7684JVM \u5185\u90e8\u72b6\u6001\u7684\u8bbf\u95ee\u529f\u80fd\uff0c\u6db5\u76d6\u4e86\u7ebf\u7a0b\u3001\u6808\u5e27\u3001\u5806\u3001\u5c40\u90e8\u53d8\u91cf\u3001\u65ad\u7535\u3001\u89c2\u5bdf\u5b57\u6bb5\u7b49\u7b49\uff0c\u4f30\u8ba1InteliJ\u7684\u8c03\u8bd5\u80fd\u529b\u6ca1\u5c11\u4f9d\u8d56\u8fd9\u4e2a\u3002</p>"},{"location":"Android/LeakCanary/#plumberandroid","title":"PlumberAndroid","text":"<p>\u8fd9\u4e2a\u5305\u540d\u5f88\u6709\u8da3\uff1aPlumber\u5373\u6c34\u7ba1\u5de5\uff0c\u5b83\u662f\u7528\u4e8e\u63d0\u4f9b\u4e00\u7cfb\u5217\u9ed8\u8ba4\u7684\u5b89\u5353\u6846\u67b6\u4e0b\u7684\u5185\u5b58\u6cc4\u6f0f\u4fee\u590d\u3002\u4f9d\u7136\u4f7f\u7528ContentProvider\u7684\u65b9\u5f0f\u6ce8\u5165\u3002\u4f9d\u7136\u8f7b\u91cf\u7ea7\u3002\u6700trick\u548chack\u7684\u5730\u65b9\uff0c\u5df2\u7ecf\u88ab\u5b83\u6240\u6536\u7eb3\u4e86\u3002\u6838\u5fc3\u7c7b\uff1a<code>AndroidLeakFixes</code></p>"},{"location":"Android/LeakCanary/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>hprof\u683c\u5f0f\u8bf4\u660e1</li> <li>hprof\u683c\u5f0f\u8bf4\u660e2</li> <li>Oracle hprof\u8001\u4ecb\u7ecd</li> <li>Oracle JVM TI</li> </ul>"},{"location":"Android/Looper%20Handler/","title":"Looper Handler","text":""},{"location":"Android/Looper%20Handler/#looper","title":"Looper","text":""},{"location":"Android/Looper%20Handler/#_1","title":"\u6982\u8ff0","text":"<p>Looper\u7ed3\u5408\u5185\u90e8\u7684MessageQueue\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u7ebf\u7a0b\u5185\u5355\u4f8b\u7684\u6d88\u606f\u961f\u5217\uff0c\u5b83\u501f\u52a9\u4e86<code>epoll</code>\u7cfb\u7edf\u8c03\u7528\u6765\u7b49\u5f85\u5174\u8da3fd\u5217\u8868\u7684\u4e8b\u4ef6\u3002\u8fd9\u4efd\u5174\u8da3Fd\u5217\u8868\u4e0d\u4ec5\u5305\u542b\u7528\u4e8e\u5176\u4ed6\u7ebf\u7a0b\u5524\u9192\u81ea\u5df1\u7684fd\uff0c\u8fd8\u53ef\u4ee5\u88ab\u6dfb\u52a0\u65b0\u7684\u5173\u6ce8fd\u6216\u8005\u79fb\u9664\u3002\u8fd9\u5bf9\u4e8e\u5173\u6ce8vsync, inputEvent\u7684fd\u90fd\u63d0\u4f9b\u4e86\u65b9\u5f0f\u3002\u6b64\u5916\uff0c\u5b83\u7684\u6d88\u606f\u961f\u5217\u5728native\u4fa7\u548cjava\u4fa7\u662f\u72ec\u7acb\u7684\uff0c\u8fdb\u800c\u53ef\u4ee5\u4e92\u4e0d\u5e72\u6270\u5730\u5bf9\u4e24\u4fa7\u7684\u6d88\u606f\u8fdb\u884c\u5206\u53d1\u3002\u5bf9\u4e8ejava\u4fa7\u7684\u6d88\u606f\u8fd8\u6709\u4e00\u5219\u9650\u5236\uff0c\u5373\u5fc5\u987b\u6709handler\u4f5c\u4e3amessage\u7684target\uff08\u4ec5\u6709\u4e0b\u6587\u63d0\u5230\u7684\u552f\u4e00\u7279\u6b8a\u60c5\u51b5\u4f8b\u5916\uff09\u3002</p>"},{"location":"Android/Looper%20Handler/#_2","title":"\u5b9e\u73b0\u7ec6\u8282","text":"<p>Looper\u6784\u9020\uff0c\u4ec5\u53ef\u901a\u8fc7<code>Looper.prepare()</code>\u6784\u9020\uff0c\u6784\u9020\u65b9\u6cd5\u4e2d\u4f1a\u521b\u5efa\u65b0\u7684<code>MessageQueue</code>\u3002\u5373<code>MessageQueue</code>\u548c<code>Looper</code>\u4e00\u5bf9\u4e00\u3002</p> <p>Looper.prepare\uff0c\u7528\u4e8e\u4e3a\u7ebf\u7a0b\u8bbe\u5b9aLooper\u5355\u4f8b\u3002Looper\u662f\u7ebf\u7a0b\u5185\u5355\u4f8b\u3002cpp\u7684\u4ee3\u7801\u4e3b\u8981\u662f<code>pthread_setspecific(gTLSKey, looper.get());</code>\uff0cjava\u4fa7\u5219\u662f<code>sThreadLocal.set(new Looper(quitAllowed));</code></p> <p><code>Looper.loop</code>\uff0c\u4e00\u4e2a\u6b7b\u5faa\u73af\uff0c\u76f4\u5230\u6709\u9000\u51fa\u6d88\u606f\u3002\u4ece<code>MessageQueue#next</code>\u83b7\u53d6\u4fe1\u606f\uff0c\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u3002 <pre><code>// Looper.java\nloop(){....\n    for (;;) {\n        if (!loopOnce(me, ident, thresholdOverride)) {\n            return;\n        }\n    }\n}\n// \u7cbe\u7b80\u8fc7\u7684LoopOnce\nprivate static boolean loopOnce(final Looper me,\n        final long ident, final int thresholdOverride) {\n    Message msg = me.mQueue.next(); // might block\n    if (msg == null) {\n        // No message indicates that the message queue is quitting.\n        return false;\n    }\n\n    // This must be in a local variable, in case a UI event sets the logger\n    final Printer logging = me.mLogging;\n    if (logging != null) {\n        logging.println(\"&gt;&gt;&gt;&gt;&gt; Dispatching to \" + msg.target + \" \"\n                + msg.callback + \": \" + msg.what);\n    }\n    // Make sure the observer won't change while processing a transaction.\n    final Observer observer = sObserver;\n    try {\n        msg.target.dispatchMessage(msg);\n        if (observer != null) {\n            observer.messageDispatched(token, msg);\n        }\n    } catch (Exception exception) {\n        if (observer != null) {\n            observer.dispatchingThrewException(token, msg, exception);\n        }\n        throw exception;\n    }\n    if (logging != null) {\n        logging.println(\"&lt;&lt;&lt;&lt;&lt; Finished to \" + msg.target + \" \" + msg.callback);\n    }\n    msg.recycleUnchecked();\n    return true;\n}\n</code></pre> \u800c<code>MessageQueue.next</code>\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>// MessageQueue.java \u5df2\u7cbe\u7b80\nMessage next() {\n    // Return here if the message loop has already quit and been disposed.\n    // This can happen if the application tries to restart a looper after quit\n    // which is not supported.\n    final long ptr = mPtr;\n    if (ptr == 0) {\n        return null;\n    }\n\n    for (;;) {\n        nativePollOnce(ptr, nextPollTimeoutMillis);\n        synchronized (this) {\n            // Try to retrieve the next message.  Return if found.\n            final long now = SystemClock.uptimeMillis();\n            Message prevMsg = null;\n            Message msg = mMessages;\n            if (msg != null &amp;&amp; msg.target == null) {\n                // Stalled by a barrier.  Find the next asynchronous message in the queue.\n                do {\n                    prevMsg = msg;\n                    msg = msg.next;\n                } while (msg != null &amp;&amp; !msg.isAsynchronous());\n            }\n            if (msg != null) {\n                if (now &lt; msg.when) {\n                    // Next message is not ready.  Set a timeout to wake up when it is ready.\n                    nextPollTimeoutMillis = (int) Math.min(msg.when - now, Integer.MAX_VALUE);\n                } else {\n                    // Got a message.\n                    mBlocked = false;\n                    if (prevMsg != null) {\n                        prevMsg.next = msg.next;\n                    } else {\n                        mMessages = msg.next;\n                    }\n                    msg.next = null;\n                    if (DEBUG) Log.v(TAG, \"Returning message: \" + msg);\n                    msg.markInUse();\n                    return msg;\n                }\n            } else {\n                // No more messages.\n                nextPollTimeoutMillis = -1;\n            }\n\n            // Process the quit message now that all pending messages have been handled.\n            if (mQuitting) {\n                dispose();\n                return null;\n            }\n\n            // If first time idle, then get the number of idlers to run.\n            // Idle handles only run if the queue is empty or if the first message\n            // in the queue (possibly a barrier) is due to be handled in the future.\n            if (pendingIdleHandlerCount &lt; 0\n                    &amp;&amp; (mMessages == null || now &lt; mMessages.when)) {\n                pendingIdleHandlerCount = mIdleHandlers.size();\n            }\n            if (pendingIdleHandlerCount &lt;= 0) {\n                // No idle handlers to run.  Loop and wait some more.\n                mBlocked = true;\n                continue;\n            }\n\n            if (mPendingIdleHandlers == null) {\n                mPendingIdleHandlers = new IdleHandler[Math.max(pendingIdleHandlerCount, 4)];\n            }\n            mPendingIdleHandlers = mIdleHandlers.toArray(mPendingIdleHandlers);\n        }\n\n        // Run the idle handlers.\n        // We only ever reach this code block during the first iteration.\n        for (int i = 0; i &lt; pendingIdleHandlerCount; i++) {\n            final IdleHandler idler = mPendingIdleHandlers[i];\n            mPendingIdleHandlers[i] = null; // release the reference to the handler\n            boolean keep = false;\n            try {\n                keep = idler.queueIdle();\n            }\n\n            if (!keep) {\n                synchronized (this) {\n                    mIdleHandlers.remove(idler);\n                }\n            }\n        }\n    }\n}\n</code></pre> <code>nativePollOnce</code>\u672c\u8d28\u662f\u8c03\u7528\u4e86<code>Looper#pollOnce</code>-&gt;<code>pollInner</code>\u3002 <pre><code>// Looper.cpp \u5df2\u7cbe\u7b80\nint Looper::pollInner(int timeoutMillis) {\n    mResponses.clear();\n    mResponseIndex = 0;\n    struct epoll_event eventItems[EPOLL_MAX_EVENTS];\n    int eventCount = epoll_wait(mEpollFd.get(), eventItems, EPOLL_MAX_EVENTS, timeoutMillis);\n    mPolling = false;\n    for (int i = 0; i &lt; eventCount; i++) {\n        const SequenceNumber seq = eventItems[i].data.u64;\n        uint32_t epollEvents = eventItems[i].events;\n        if (seq == WAKE_EVENT_FD_SEQ) {\n            if (epollEvents &amp; EPOLLIN) {\n                awoken();\n            } else {\n                ALOGW(\"Ignoring unexpected epoll events 0x%x on wake event fd.\", epollEvents);\n            }\n        } else {\n            const auto&amp; request_it = mRequests.find(seq);\n            if (request_it != mRequests.end()) {\n                const auto&amp; request = request_it-&gt;second;\n                int events = 0;\n                if (epollEvents &amp; EPOLLIN) events |= EVENT_INPUT;\n                if (epollEvents &amp; EPOLLOUT) events |= EVENT_OUTPUT;\n                if (epollEvents &amp; EPOLLERR) events |= EVENT_ERROR;\n                if (epollEvents &amp; EPOLLHUP) events |= EVENT_HANGUP;\n                mResponses.push({.seq = seq, .events = events, .request = request});\n            } else {\n                ALOGW(\"Ignoring unexpected epoll events 0x%x for sequence number %\" PRIu64\n                      \" that is no longer registered.\",\n                      epollEvents, seq);\n            }\n        }\n    }\n    // Invoke pending message callbacks.\n    mNextMessageUptime = LLONG_MAX;\n    while (mMessageEnvelopes.size() != 0) {\n        nsecs_t now = systemTime(SYSTEM_TIME_MONOTONIC);\n        const MessageEnvelope&amp; messageEnvelope = mMessageEnvelopes.itemAt(0);\n        if (messageEnvelope.uptime &lt;= now) {\n            // Remove the envelope from the list.\n            // We keep a strong reference to the handler until the call to handleMessage\n            // finishes.  Then we drop it so that the handler can be deleted *before*\n            // we reacquire our lock.\n            { // obtain handler\n                sp&lt;MessageHandler&gt; handler = messageEnvelope.handler;\n                Message message = messageEnvelope.message;\n                mMessageEnvelopes.removeAt(0);\n                mSendingMessage = true;\n                mLock.unlock();\n                handler-&gt;handleMessage(message);\n            } // release handler\n            mSendingMessage = false;\n            result = POLL_CALLBACK;\n        }\n    }\n    // Invoke all response callbacks.\n    for (size_t i = 0; i &lt; mResponses.size(); i++) {\n        Response&amp; response = mResponses.editItemAt(i);\n        if (response.request.ident == POLL_CALLBACK) {\n            int fd = response.request.fd;\n            int events = response.events;\n            void* data = response.request.data;\n#if DEBUG_POLL_AND_WAKE || DEBUG_CALLBACKS\n            ALOGD(\"%p ~ pollOnce - invoking fd event callback %p: fd=%d, events=0x%x, data=%p\",\n                    this, response.request.callback.get(), fd, events, data);\n#endif\n            // Invoke the callback.  Note that the file descriptor may be closed by\n            // the callback (and potentially even reused) before the function returns so\n            // we need to be a little careful when removing the file descriptor afterwards.\n            int callbackResult = response.request.callback-&gt;handleEvent(fd, events, data);\n            // Clear the callback reference in the response structure promptly because we\n            // will not clear the response vector itself until the next poll.\n            response.request.callback.clear();\n            result = POLL_CALLBACK;\n        }\n    }\n    return result;\n}\n</code></pre></p> <p>\u5373\u672c\u8d28\u662f <code>int eventCount = epoll_wait(mEpollFd.get(), eventItems, EPOLL_MAX_EVENTS, timeoutMillis);</code>\uff0c\u5373epoll\u7cfb\u7edf\u8c03\u7528\uff0c\u53ef\u53c2\u9605\u201cLinux\u201dsection\u3002<code>eventItems</code>\u5c40\u90e8\u53d8\u91cf\u4f1a\u63a5\u6536\u5230\u4e8b\u4ef6\u5217\u8868\u3002\u800c\u6536\u5230\u4e8b\u4ef6\u4e4b\u540e\uff0c\u8fd9\u91cc\u7684\u5904\u7406\u4e3b\u8981\u5206\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u5982\u679c\u662f<code>wake</code>\u4e8b\u4ef6\uff0c\u786e\u8ba4\u65e0\u8bef\u540e\uff0c\u5355\u7eaf\u5524\u9192\u3002</li> <li>\u5982\u679c\u6709<code>mMessageEnvelopes</code>\u5904\u7406\uff0c\u5219\u5904\u7406<code>message</code>\uff0c\u7279\u522b\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684<code>message</code>\u662f\u901a\u8fc7<code>MessageQueue.cpp</code>\u7684<code>postMessage</code>\u6216\u8005\u8c03\u7528\u4e86<code>Looper.cpp</code>\u7684<code>sendMessage</code>\u7cfb\u5217\u65b9\u6cd5\u5165\u961f\u7684\u4fe1\u606f\u3002\u5bf9\u4e8ejava\u4fa7\u7684\u4fe1\u606f\uff0c\u5e76\u4e0d\u4f1a\u5728\u8fd9\u4e2avector\u4e4b\u4e2d\uff08\u8fd9\u4e00\u70b9\u8ba9\u6211\u5f53\u65f6\u56f0\u60d1\u534a\u5929\uff09\u3002\u76f8\u5f53\u4e8enative\u4fa7\u7684<code>handler.postMessage()</code>\u3002</li> <li>\u5982\u679c\u6709<code>mResponses</code>\u5904\u7406\uff0c\u5219\u5904\u7406\u8fd9\u4e9b\u56de\u8c03\u3002\u76f8\u5f53\u4e8enative\u4fa7\u7684<code>postRunnable</code>\u3002</li> </ul> <p>\u800c\u5bf9\u4e8ejava\u4fa7\u7684<code>MessageQueue.enqueueMessage</code>\u65b9\u6cd5\uff0c\u5b83\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>    boolean enqueueMessage(Message msg, long when) {\n        if (msg.target == null) {\n            throw new IllegalArgumentException(\"Message must have a target.\");\n        }\n\n        synchronized (this) {\n            if (msg.isInUse()) {\n                throw new IllegalStateException(msg + \" This message is already in use.\");\n            }\n\n            if (mQuitting) {\n                IllegalStateException e = new IllegalStateException(\n                        msg.target + \" sending message to a Handler on a dead thread\");\n                Log.w(TAG, e.getMessage(), e);\n                msg.recycle();\n                return false;\n            }\n\n            msg.markInUse();\n            msg.when = when;\n            Message p = mMessages;\n            boolean needWake;\n            if (p == null || when == 0 || when &lt; p.when) {\n                // New head, wake up the event queue if blocked.\n                msg.next = p;\n                mMessages = msg;\n                needWake = mBlocked;\n            } else {\n                // Inserted within the middle of the queue.  Usually we don't have to wake\n                // up the event queue unless there is a barrier at the head of the queue\n                // and the message is the earliest asynchronous message in the queue.\n                needWake = mBlocked &amp;&amp; p.target == null &amp;&amp; msg.isAsynchronous();\n                Message prev;\n                for (;;) {\n                    prev = p;\n                    p = p.next;\n                    if (p == null || when &lt; p.when) {\n                        break;\n                    }\n                    if (needWake &amp;&amp; p.isAsynchronous()) {\n                        needWake = false;\n                    }\n                }\n                msg.next = p; // invariant: p == prev.next\n                prev.next = msg;\n            }\n\n            // We can assume mPtr != 0 because mQuitting is false.\n            if (needWake) {\n                nativeWake(mPtr);\n            }\n        }\n        return true;\n    }\n</code></pre> \u5373\u672c\u8d28\u4e0a\u538b\u6839\u4e0d\u6d89\u53canative\u4fa7\u7684\u4e1c\u897f\uff0c\u53ea\u6709\u6700\u540e\u7684<code>nativeWake</code>\u3002\u800c<code>nativeWake</code>\u6700\u7ec8\u4f1a\u8c03\u7528\u5230<code>Looper.cpp</code>\u7684<code>wake</code>\u65b9\u6cd5\uff1a <pre><code>void Looper::wake() {\n    uint64_t inc = 1;\n    ssize_t nWrite = TEMP_FAILURE_RETRY(write(mWakeEventFd.get(), &amp;inc, sizeof(uint64_t)));\n    ...\n}\n</code></pre> \u800c<code>mWakeEventFd</code>\u6beb\u65e0\u7591\u95ee\u662f<code>epoll_wait</code>\u611f\u5174\u8da3\u7684fd\u4e4b\u4e00\uff0c\u7531\u6b64\u7ed3\u5408\u524d\u9762<code>MessageQueue.java</code>\u7684<code>next</code>\u65b9\u6cd5\uff0c\u53ef\u4ee5\u770b\u5230\uff0c<code>mMessages</code>\u94fe\u8868\u8868\u5934\u662f\u76f4\u63a5\u5728<code>java</code>\u4fa7\u5b8c\u6210\u7684\u591a\u7ebf\u7a0b\u4fee\u6539\uff0c\u4ec5\u4ec5\u53ea\u662f\u501f\u52a9native\u4fa7\u5728<code>wake</code>\u7684fd\u4e0a\u5199\u5165\u4e0bwake\u4e8b\u4ef6\u800c\u5df2\u3002</p>"},{"location":"Android/Looper%20Handler/#handler","title":"Handler","text":""},{"location":"Android/Looper%20Handler/#_3","title":"\u6982\u8ff0","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u6982\u8ff0\u4e0bHandler\u548cLooper\u7684\u5173\u7cfb\u3002\u4e00\u4e2aLooper\u53ef\u4ee5\u5bf9\u5e94\u591a\u4e2aHandler\u3002Handler\u6784\u9020\u65f6\u9700\u8981\u4f20\u5165Looper\uff0c\u4ee5\u660e\u786eHandler\u7684\u5de5\u4f5cMessageQueue\u3002\u540e\u7eed\u4f7f\u7528Handler\u65f6\uff0c\u5373\u53ef\u5b8c\u6210\u4ece<code>Handler.send/postMessage</code>\u7684\u8bf8\u591a\u7b7e\u540d\u65b9\u6cd5\u8c03\u7528\u53d1\u8d77\u7ebf\u7a0b\uff0c\u53d1\u9001\u6d88\u606f\u5230\u6b64<code>Handler</code>\u5173\u8054\u7684Looper\u6240\u5728\u7684\u7ebf\u7a0b\u3002\u6b64\u6d88\u606f\u7684target\u4f9d\u7136\u662f\u81ea\u8eab<code>handler</code>\u5b9e\u4f8b\uff0c\u5373\u6b64<code>handler</code>\u5b9e\u4f8b\u4ece\u7ebf\u7a0bA\u8c03\u7528\u4e86<code>send/post</code>\u7b49\u65b9\u6cd5\u540e\u5728\u5176\u5bf9\u5e94Looper\u7ebf\u7a0b\u4e2d\u5f97\u5230\u56de\u8c03\u6267\u884c\u3002</p> <p>Handler\u53ef\u4ee5\u5728\u4efb\u610f\u7ebf\u7a0b\u53d1\u8d77\u4fe1\u606f\u3001Callback\u5230\u5176\u5b9a\u4e49\u65f6\u6240\u58f0\u660e\u7684\u6240\u5904\u7ebf\u7a0b\u5904\u7406\u6d88\u606f\u3001\u6267\u884c\u56de\u8c03\u3002</p>"},{"location":"Android/Looper%20Handler/#async-sync","title":"Async \u4e0e Sync\u533a\u522b","text":"<p>Handler\u6709async\u548csync\u4e24\u79cd\u65b9\u5f0f\uff0c\u5728\u521b\u5efa\u65f6\u6307\u5b9a\u3002\u8fd9\u4e2a\u5c5e\u6027\u6700\u7ec8\u4f1a\u53cd\u6620\u5728\u6b64handler\u6240\u53d1\u9001\u7684<code>Message</code>\u5b9e\u4f8b\u7684<code>flag</code>\u4e0a\u7528\u4e8e\u6807\u8bc6<code>Message</code>\u7684async\u548csync\u533a\u5206\u3002</p> <p>async \u548c sync\u7684message\u5177\u4f53\u4f5c\u7528\u4f9d\u8d56\u4e8e<code>MesssageQueue#PostSyncBarrier</code>\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5b9e\u9645\u4e0a\u662f\u63d2\u5165\u4e00\u4e2amessage\uff0ctarget\u4e3a\u7a7a\uff08message.target\u4e3a\u7a7a\u4e5f\u5c31\u8fd9\u4e00\u79cd\u60c5\u51b5\uff09\u3002\u5728<code>MessageQueue#next</code>\u65b9\u6cd5\u91cc\uff0c\u5982\u679c\u53d1\u73b0\u4e86target=null\u7684message\uff0c\u5219\u4f1a\u8ba4\u4e3a\u662f\u9047\u5230\u4e86\u201c\u540c\u6b65\u6805\u680f\u201d\u5373syncBarrier\uff0c\u4f1a\u904d\u5386\u94fe\u8868\u627e\u5230async\u4e3atrue\u7684message\u6765\u5904\u7406\u3002\u800c\u4e0d\u518d\u5904\u7406\u540c\u6b65\u6d88\u606f\u3002\u76f4\u5230MessageQueue#removeSyncBarrier\u53d1\u751f\u3002</p> <p></p>"},{"location":"Android/Looper%20Handler/#message","title":"Message","text":""},{"location":"Android/Looper%20Handler/#_4","title":"\u6982\u8ff0","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u60f3\u63d0\u4e00\u4e0b<code>Message.obtain</code>\uff0cMessage\u7c7b\u7ef4\u62a4\u4e86\u9759\u6001\u7684\u94fe\u8868\u4f5c\u4e3a\u590d\u7528\u6c60\uff0c\u6c60\u5b50\u5c3a\u5bf8\u4e0a\u965050\u4e2a\u3002</p>"},{"location":"Android/Looper%20Handler/#_5","title":"\u56de\u7b54\u66fe\u7ecf\u7684\u4e00\u4e2a\u7591\u95ee","text":"<p>\u4e00\u5f00\u59cb\u6211\u4ee5\u4e3aHandler/Looper\u51fa\u73b0\u4ec5\u662f\u4e3a\u4e86\u89e3\u51b3\u7ebf\u7a0b\u4e4b\u95f4\u901a\u4fe1\u3002\u4f46\u8003\u8651\u5230\u6709\u7c7b\u4f3c<code>BlockingQueue</code>\u8fd9\u79cdjdk\u7684\u7ebf\u7a0b\u96c6\u5408\uff0c\u4e3a\u4f55\u4e0d\u80fd\u7528\u6b64\u6765\u901a\u4fe1\u5462\uff1f</p> <p>\u6211\u8ba4\u4e3a\u5305\u542b\u5982\u4e0b\u51e0\u70b9\u539f\u56e0\uff1a</p> <ul> <li>Looper\u7684\u673a\u5236\u6db5\u76d6\u4e86java\u548cnative\u4e24\u4fa7\u7684\u7ebf\u7a0b\u95f4\u901a\u4fe1\u3002\u5bf9\u4e8e\u4e0d\u5305\u542bjvm\u7684\u8fdb\u7a0b\u4e0b\uff0c\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u6b64\u673a\u5236\uff08\u5f53\u7136\u8fd9\u4e2a\u7406\u7531\u8fd8\u4e0d\u4e3b\u8981\uff09\u3002</li> <li>fd\u7684\u8ba2\u9605\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7528\u4e8e\u65b9\u4fbf\u6355\u83b7\u66f4\u591aIO\u4e8b\u4ef6\u3002\u6bd4\u5982Vsync, input\u3002</li> <li>\u4e24\u8005\u5f02\u6b65\u7684\u539f\u7406\u4e5f\u5e76\u4e0d\u76f8\u540c(epoll vs \u7ebf\u7a0b\u72b6\u6001\u94fe\u8868+park/unpark)\uff0c\u8fd9\u91cc\u7684\u4f18\u52a3\u6211\u6682\u65f6\u65e0\u6cd5\u5f97\u51fa\u8bc4\u5224\u3002<code>BlockingQueue</code>\u7684\u4ecb\u7ecd\u8bf7\u53c2\u9605\u201cJava\u201dsection\u3002</li> </ul>"},{"location":"Android/Looper%20Handler/#_6","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Looper MessageQueue\u7684\u6e90\u7801\u4eec\u3002</li> <li>async sync\u7684message\u5dee\u5f02</li> </ul>"},{"location":"Android/MMKV/","title":"MMKV","text":""},{"location":"Android/MMKV/#_1","title":"\u539f\u7406\u6982\u8ff0","text":"<p>MMKV\u662f\u4e00\u5957\u57fa\u672c\u57fa\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u3001\u652f\u6301\u591a\u8fdb\u7a0b\u7684KV\u5b58\u50a8\u65b9\u6848\u3002\u5b83\u4ee5<code>mmap</code>\u5f62\u5f0f\u5728\u8fdb\u7a0b\u95f4\u5171\u4eab\u865a\u62df\u5185\u5b58\uff0c<code>mmap</code>\u7684\u6587\u4ef6\u6765\u6e90\u6709\u4e24\u79cd\uff1a\u771f\u5b9e\u6587\u4ef6\u3001\u533f\u540d\u5185\u5b58fd<code>/dev/ashmem</code>\u3002\u540e\u8005\u662fAndroid Ndk\u6240\u63d0\u4f9b\u7684\u5de5\u5177\u4e4b\u4e00\u3002\u5185\u5b58\u5e03\u5c40\u662f\u4e00\u5957\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f\uff0c\u7c7b\u4f3c\u4e8eProtobuf\u3002\u5bf9\u4e8e\u5e76\u53d1\u6027\u95ee\u9898\uff0c\u5bf9\u771f\u5b9e\u6587\u4ef6\u91c7\u53d6\u7684\u662f<code>flock</code>\u6587\u4ef6\u9501\uff0c\u5bf9\u533f\u540d\u5185\u5b58\u91c7\u53d6\u7684\u662f<code>fcntl</code>\u201c\u6587\u4ef6\u8bb0\u5f55\u9501\u201d\u3002</p>"},{"location":"Android/MMKV/#_2","title":"\u76f8\u6bd4\u4e8e\u5176\u4ed6\u65b9\u6848","text":"<ul> <li>SharePreference\u4e0d\u652f\u6301\u591a\u8fdb\u7a0b\uff0c\u6ca1\u6709\u4efb\u4f55\u673a\u5236\u3001\u63aa\u65bd\u53ef\u4ee5\u786e\u4fdd\u591a\u8fdb\u7a0b\u540c\u6b65\u3002</li> <li>\u6309MMKV\u6587\u6863\u4ecb\u7ecd\uff0cContentProvider\u4e00\u4e2a\u5355\u72ec\u8fdb\u7a0b\u7ba1\u7406\u6570\u636e\uff0c\u4f46\u662f\u542f\u52a8\u6162\u3001\u8bbf\u95ee\u6162\u3002\u5176\u4ed6socket, pipe, message queue\u8981\u81f3\u5c112\u6b21\u5185\u5b58\u62f7\u8d1d\u3002</li> <li>\u4f7f\u7528Protobuf\u5f62\u5f0f\u7f16\u7801\u4e3a\u4e86\u66f4\u597d\u7684\u6027\u80fd\u548c\u66f4\u5c0f\u7684\u7a7a\u95f4\u3002\uff08\u76f8\u6bd4Json, xml\uff09\uff0c\u4e00\u822ckv\u5b58\u50a8\u6587\u4ef6\u4e5f\u4e0d\u9700\u8981\u8003\u8651\u4eba\u7c7b\u53ef\u8bfb\u6027\u3002</li> </ul>"},{"location":"Android/MMKV/#_3","title":"\u4ee3\u7801\u7ec6\u8282","text":""},{"location":"Android/MMKV/#_4","title":"\u521d\u59cb\u5316","text":"<p>\u9996\u5148\u770b<code>MMKV.initialize</code>\uff0c\u4f1a\u52a0\u8f7d<code>mmkv</code>jni lib\u3002<code>mmkv</code>jni lib\u5728\u88ab\u52a0\u8f7d\u65f6\u6709\u5982\u4e0b\u5de5\u4f5c\uff1a <pre><code>// native-bridge.cpp\nextern \"C\" JNIEXPORT JNICALL jint JNI_OnLoad(JavaVM *vm, void *reserved) {\n    g_currentJVM = vm;\n    // \u83b7\u53d6MMKV java\u4fa7\u5355\u4f8b\uff0c\u6ce8\u518c\u4e3a\u5168\u5c40\u5bf9\u8c61\uff0c\n    static const char *clsName = \"com/tencent/mmkv/MMKV\";\n    jclass instance = env-&gt;FindClass(clsName);\n    g_cls = reinterpret_cast&lt;jclass&gt;(env-&gt;NewGlobalRef(instance));\n\n    // \u6ce8\u518cMMKC.java\u91cc\u7684\u6240\u6709native\u65b9\u6cd5\uff0c\u4e3b\u8981\u7ed1\u5b9a\u5230\u4e86native-bridge.cpp\u4e0a\uff0c\u5b9e\u9645\u5904\u7406\u5219\u518d\u95f4\u63a5\u4ea4\u7ed9MMKV.cpp\u3002\n    int ret = registerNativeMethods(env, g_cls);\n    g_fileID = env-&gt;GetFieldID(g_cls, \"nativeHandle\", \"J\");\n\n    // \u83b7\u53d6crcCheckFail, fileLengthError, contentChange\u8fd9\u51e0\u4e2a\u5728MMKV.java\u4e2d\u7684\u56de\u8c03\u65b9\u6cd5\u5f15\u7528\u3002\u540e\u7eed\u7531native\u89e6\u53d1\u3002\n    g_callbackOnCRCFailID = env-&gt;GetStaticMethodID(g_cls, \"onMMKVCRCCheckFail\", \"(Ljava/lang/String;)I\");\n    g_callbackOnFileLengthErrorID = env-&gt;GetStaticMethodID(g_cls, \"onMMKVFileLengthError\", \"(Ljava/lang/String;)I\");\n    g_callbackOnContentChange =\n        env-&gt;GetStaticMethodID(g_cls, \"onContentChangedByOuterProcess\", \"(Ljava/lang/String;)V\");\n    ...\n}\n</code></pre> \u4e0b\u9762\u6765\u770b\u4f7f\u7528\uff0c\u9996\u5148\u9700\u8981\u83b7\u53d6MMKV\u5b9e\u4f8b\uff0cMMKV\u63d0\u4f9b\u4e86\u6307\u5b9a<code>mmkvId</code>\u4ee5\u53ca<code>mode</code>\u6765\u6784\u9020MMKV\u3002<code>mode</code>\u5305\u62ec<code>SINGLE_PROCESS_MODE</code>\uff0c<code>MULTI_PROCESS_MODE</code>\uff0c\u8fd9\u4e24\u8005\u4e8c\u9009\u4e00\uff0c\u5e76\u7ec4\u5408\u4e0a<code>ASHMEM_MODE</code>\u6765\u4f7f\u7528\u533f\u540d\u5185\u5b58\u5de5\u4f5c\uff0c\u5426\u5219\u662f\u4ee5\u5b9e\u9645\u6587\u4ef6\u6a21\u5f0f\u5de5\u4f5c\u3002\u6b64\u8fc7\u7a0b\u7684native\u90e8\u5206\u4f1a\u7531<code>native-bridge</code>\u4ea4\u7ed9<code>MMKV.cpp</code>\u7684\u82e5\u5e72\u5de5\u5177\u65b9\u6cd5\u6784\u9020\u3002\u7cbe\u7b80\u5982\u4e0b\uff1a <pre><code>MMKV::MMKV(const string &amp;mmapID, int size, MMKVMode mode, string *cryptKey, string *rootPath)\n    : m_mmapID(mmapedKVKey(mmapID, rootPath)) // historically Android mistakenly use mmapKey as mmapID\n    , m_path(mappedKVPathWithID(m_mmapID, mode, rootPath))\n    , m_crcPath(crcPathWithID(m_mmapID, mode, rootPath))\n    , m_file(new MemoryFile(m_path, size, (mode &amp; MMKV_ASHMEM) ? MMFILE_TYPE_ASHMEM : MMFILE_TYPE_FILE))\n    , m_metaFile(new MemoryFile(m_crcPath, DEFAULT_MMAP_SIZE, m_file-&gt;m_fileType))\n    , m_metaInfo(new MMKVMetaInfo())\n    , m_lock(new ThreadLock())\n    , m_fileLock(new FileLock(m_metaFile-&gt;getFd(), (mode &amp; MMKV_ASHMEM)))\n    , m_sharedProcessLock(new InterProcessLock(m_fileLock, SharedLockType))\n    , m_exclusiveProcessLock(new InterProcessLock(m_fileLock, ExclusiveLockType))\n    , m_isInterProcess((mode &amp; MMKV_MULTI_PROCESS) != 0 || (mode &amp; CONTEXT_MODE_MULTI_PROCESS) != 0) {\n    // force use fcntl(), otherwise will conflict with MemoryFile::reloadFromFile()\n    m_fileModeLock = new FileLock(m_file-&gt;getFd(), true);\n    m_sharedProcessModeLock = new InterProcessLock(m_fileModeLock, SharedLockType);\n    m_exclusiveProcessModeLock = nullptr;\n    {\n        m_dic = new MMKVMap();\n    }\n    m_sharedProcessLock-&gt;m_enable = m_isInterProcess;\n    m_exclusiveProcessLock-&gt;m_enable = m_isInterProcess;\n    // sensitive zone\n    {\n        SCOPED_LOCK(m_sharedProcessLock);\n        loadFromFile();\n    }\n}\n</code></pre> \u5373\u6784\u9020\u65f6\u4e5f\u4f1a\u6784\u9020<code>MemoryFile</code>\u3001<code>MMKVMetaInfo</code>\u3001\u7ebf\u7a0b\u9501\u3001\u6587\u4ef6\u9501\u3001\u8fdb\u7a0b\u8bfb\u9501\uff08\u5171\u4eab\u9501\uff09\u3001\u8fdb\u7a0b\u5199\u9501\uff08\u4e92\u65a5\u9501\uff09\u3002\u6784\u9020<code>MemoryFile</code>\u8fc7\u7a0b\u7cbe\u7b80\u5982\u4e0b\uff1a <pre><code>// \u771f\u5b9e\u6587\u4ef6\u6a21\u5f0f\nMemoryFile::MemoryFile(const string &amp;path, size_t size, FileType fileType)\n    : m_name(path), m_fd(-1), m_ptr(nullptr), m_size(0), m_fileType(fileType) {\n    if (m_fileType == MMFILE_TYPE_FILE) {\n        //\u4ece\u6587\u4ef6\u5f00\u59cb\u52a0\u8f7d\n        reloadFromFile();\n    } else {\n        //\u8fd9\u91cc\u4e3b\u8981\u662f\u4e0d\u6307\u5b9aashmemFD\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u4e86\u533f\u540d\u5185\u5b58\u6a21\u5f0f\uff0c\u4f1a\u9700\u8981\u624b\u52a8\u521b\u5efa\u533f\u540d\u5185\u5b58\n    }\n}\n// \u533f\u540d\u5185\u5b58\u6a21\u5f0f\nMemoryFile::MemoryFile(int ashmemFD)\n    : m_name(\"\"), m_fd(ashmemFD), m_ptr(nullptr), m_size(0), m_fileType(MMFILE_TYPE_ASHMEM) {\n        m_name = ASharedMemory_getName(m_fd);\n        m_size = ASharedMemory_getSize(m_fd);\n        auto ret = mmap();\n    }\n}\nvoid MemoryFile::reloadFromFile() {\n    m_fd = open(m_name.c_str(), O_RDWR | O_CREAT | O_CLOEXEC, S_IRWXU);\n        FileLock fileLock(m_fd);\n        InterProcessLock lock(&amp;fileLock, ExclusiveLockType);\n        SCOPED_LOCK(&amp;lock);\n\n        mmkv::getFileSize(m_fd, m_size);\n        // round up to (n * pagesize)\n        if (m_size &lt; DEFAULT_MMAP_SIZE || (m_size % DEFAULT_MMAP_SIZE != 0)) {\n            size_t roundSize = ((m_size / DEFAULT_MMAP_SIZE) + 1) * DEFAULT_MMAP_SIZE;\n            truncate(roundSize);\n        } else {\n            auto ret = mmap();\n    }\n}\nbool MemoryFile::mmap() {\n    m_ptr = (char *) ::mmap(m_ptr, m_size, PROT_READ | PROT_WRITE, MAP_SHARED, m_fd, 0);\n}\n</code></pre> \u5373\u6253\u5f00\u63cf\u8ff0\u7b26\uff0c\u5bf9\u6307\u5b9a\u5c3a\u5bf8\u5305\u88f9\u4e3aPAGE_SIZE\u7684\u500d\u6570\uff0c\u7136\u540e\u7528\u6b64fd\u8c03\u7528mmap\u8fdb\u884c\u865a\u62df\u5185\u5b58\u6620\u5c04\uff0c\u6a21\u5f0f\u53ef\u8bfb\u5199\u4e14\u53ef\u591a\u8fdb\u7a0b\u5171\u4eab\u3002\u4fdd\u5b58\u865a\u62df\u5185\u5b58\u5730\u5740\u3002</p> <p>\u7ebf\u7a0b\u9501\u4f7f\u7528ndk\u7684\u5de5\u5177<code>pthread_mutex</code>\uff0c\u6587\u4ef6\u9501<code>FileLock</code>\u662f\u81ea\u5b9a\u4e49\u7684\u5de5\u5177\uff0c\u4f1a\u5224\u65ad\u662f\u533f\u540d\u5185\u5b58\u8fd8\u662f\u6587\u4ef6\u6a21\u5f0f\u3002\u5bf9\u4e8e\u6587\u4ef6\u6a21\u5f0f\u4f7f\u7528<code>flock</code>\u5bf9\u4e8e\u533f\u540d\u5185\u5b58\u4f7f\u7528<code>fcntl</code>\uff08\u867d\u7136\u7406\u8bba\u4e0a\u8fd9\u4e24\u8005\u548c\u6587\u4ef6\u6a21\u5f0f\u5e94\u8be5\u6ca1\u6709\u5173\u7cfb\uff09\u3002\u8fdb\u7a0b\u9501<code>InterProcessLock</code>\u5b9e\u73b0\u57fa\u4e8e<code>FileLock</code>\uff0c\u5e76\u6dfb\u52a0\u4e86\u5f00\u5173\uff0c\u5728\u5355\u8fdb\u7a0b\u6a21\u5f0f\u65f6\u5173\u95ed\u5b9e\u9645\u7684\u4e0a\u9501\u903b\u8f91\u3002</p> <p><code>MMKV</code>\u6784\u9020\u51fd\u6570\u6700\u540e\u83b7\u53d6\u5171\u4eab\u9501\uff08\u8bfb\uff09\uff0c<code>loadFromFile</code>\u6765\u586b\u5145kv\u5185\u5bb9\u3002</p>"},{"location":"Android/MMKV/#_5","title":"\u5199\u5165\u6d41\u7a0b","text":"<p>\u770b\u4e0b<code>mmkv.putString</code>\uff0c\u8fd9\u4f1a\u8f6c\u81f3<code>native-bridge.encodeString</code>\uff0c\u5c06\u6570\u636e\u4ecejni\u7c7b\u578b\u8f6c\u4e3anative\u7c7b\u578b\u540e\uff0c\u8c03\u7528<code>MMKV.cpp</code>\u7684<code>set</code>\u6216\u8005<code>removeValueForKey</code>\uff08\u82e5\u6ca1\u6709value\u65f6\uff09\u3002<code>MMKV.cpp</code>\u7684<code>set</code>\u4f1a\u8fdb\u800c\u628avalue\u5c01\u88c5\u4e3a<code>MMKVBuffer</code>\u5e76\u8c03\u7528<code>setDataForKey</code>\uff0c\u4ee3\u7801\u7cbe\u7b80\u5982\u4e0b\uff1a <pre><code>// MMKV_IO.cpp\nbool MMKV::setDataForKey(MMBuffer &amp;&amp;data, MMKVKey_t key, bool isDataHolder) {\n    // \u4e0a\u7ebf\u7a0b\u9501\u3001\u8fdb\u7a0b\u4e92\u65a5\u9501\uff08\u5199\u9501\uff09\n    SCOPED_LOCK(m_lock);\n    SCOPED_LOCK(m_exclusiveProcessLock);\n    // \u540c\u6b65\u4e0b\u6570\u636e\uff0c\u53ef\u80fd\u4f1a\u53d1\u9001\u6570\u636e\u66f4\u65b0\u901a\u77e5\n    checkLoadData();\n        auto itr = m_dic-&gt;find(key);\n        if (itr != m_dic-&gt;end()) {\n            //\u82e5\u6709\u6b64key\n            auto ret = appendDataWithKey(data, itr-&gt;second, isDataHolder);\n            itr-&gt;second = std::move(ret.second);\n        } else {\n            //\u82e5\u65e0\u6b64key\n            auto ret = appendDataWithKey(data, key, isDataHolder);\n            m_dic-&gt;emplace(key, std::move(ret.second));\n        }\n    m_hasFullWriteback = false;\n}\n</code></pre></p>"},{"location":"Android/MMKV/#_6","title":"\u66f4\u65b0\u901a\u77e5","text":"<pre><code>void MMKV::checkLoadData() {\n    if (m_needLoadFromFile) {\n        SCOPED_LOCK(m_sharedProcessLock);\n        m_needLoadFromFile = false;\n        loadFromFile();\n        return;\n    }\n    if (!m_isInterProcess) {\n        return;\n    }\n    if (!m_metaFile-&gt;isFileValid()) {\n        return;\n    }\n    SCOPED_LOCK(m_sharedProcessLock);\n    metaInfo.read(m_metaFile-&gt;getMemory());\n    if (m_metaInfo-&gt;m_sequence != metaInfo.m_sequence) {\n        // m_sequence\u4ee3\u8868\u5168\u91cf\u5199\u56de\u7684\u7f16\u53f7\uff0c\u5982\u679c\u4e0d\u540c\u4ee3\u8868\u6709\u65b0\u7684\u5168\u91cf\u5199\u5165\u3002\u6b64\u65f6\u91cd\u65b0\u52a0\u8f7d\n        SCOPED_LOCK(m_sharedProcessLock);\n\n        clearMemoryCache();\n        loadFromFile();\n        notifyContentChanged();\n    } else if (m_metaInfo-&gt;m_crcDigest != metaInfo.m_crcDigest) {\n        // \u5e8f\u53f7\u4e00\u81f4\uff0c\u6ca1\u6709\u65b0\u7684\u5168\u91cf\u5199\u56de\uff0c\u4f46\u6458\u8981\u4e0d\u540c\uff0c\u8981\u4e48\u6570\u636e\u66f4\u65b0\u4e86\uff0c\u8981\u4e48\n        SCOPED_LOCK(m_sharedProcessLock);\n        size_t fileSize = m_file-&gt;getActualFileSize();\n        if (m_file-&gt;getFileSize() != fileSize) {\n            // \u6587\u4ef6\u5c3a\u5bf8\u6709\u53d8\u5316\uff0c\u53d1\u751f\u4e86\u6587\u4ef6\u622a\u65ad\u5904\u7406\uff0c\u6bd4\u5982\u6269\u5bb9\u3002\u5168\u90e8\u8bfb\u53d6\n            clearMemoryCache();\n            loadFromFile();\n        } else {\n            // \u5c40\u90e8\u8bfb\u53d6\uff0c\u5373\u53ea\u9700\u8981\u8bfb\u53d6\u65b0\u589e\u6570\u636e\u5185\u5bb9\uff0c\u6b64\u65f6\u7406\u8bba\u4e0am_actualSize &lt; fileSize\u3002\n            partialLoadFromFile();\n        }\n        notifyContentChanged();\n    } // \u5176\u4ed6\u60c5\u51b5\u6ca1\u6709\u53d8\u66f4\n}\n</code></pre>"},{"location":"Android/MMKV/#_7","title":"\u5f00\u59cb\u5199\u5165","text":"<p>\u6765\u770b\u4e0b\u8ffd\u52a0\u6570\u636e\u7684\u8fc7\u7a0b\uff1a <pre><code>MMKV::doAppendDataWithKey(const MMBuffer &amp;data, const MMBuffer &amp;keyData, bool isDataHolder, uint32_t originKeyLength) {\n    ...\n    SCOPED_LOCK(m_exclusiveProcessLock);\n    // \u6839\u636e\u9700\u8981\u6269\u5bb9\u5185\u5b58\n    bool hasEnoughSize = ensureMemorySize(size);\n    // \u5199\u5165\n    m_output-&gt;writeData(keyData);\n    m_output-&gt;writeData(data); // note: write size of data\n    auto ptr = (uint8_t *) m_file-&gt;getMemory() + Fixed32Size + m_actualSize;\n    m_actualSize += size;\n    // \u66f4\u65b0\u6458\u8981\n    updateCRCDigest(ptr, size);\n    ...\n}\n</code></pre></p>"},{"location":"Android/MMKV/#_8","title":"\u6587\u4ef6\u622a\u65ad\u3001\u6269\u5bb9","text":"<pre><code>bool MMKV::ensureMemorySize(size_t newSize) {\n    if (newSize &gt;= m_output-&gt;spaceLeft() || (m_crypter ? m_dicCrypt-&gt;empty() : m_dic-&gt;empty())) {\n        // try a full rewrite to make space\n        // 1. no space for a full rewrite, double it\n        // 2. or space is not large enough for future usage, double it to avoid frequently full rewrite\n        if (lenNeeded &gt;= fileSize || (lenNeeded + futureUsage) &gt;= fileSize) {\n            size_t oldSize = fileSize;\n            do {\n                fileSize *= 2;\n            } while (lenNeeded + futureUsage &gt;= fileSize);\n            // if we can't extend size, rollback to old state\n            if (!m_file-&gt;truncate(fileSize)) {\n            }\n        }\n        return doFullWriteBack(move(preparedData), nullptr);\n    }\n    return true;\n}\n// \u6309\u6307\u5b9a\u5c3a\u5bf8\u622a\u65ad\u6587\u4ef6\uff0c\u5bf9\u533f\u540d\u5185\u5b58\u4f1a\u5931\u8d25\uff0c\u5bf9\u771f\u5b9e\u6587\u4ef6\u5219\u4f7f\u7528`ftruncate`\uff0c\u4e4b\u540e\u4e3a\u65b0\u5185\u5b58\u586b0\uff0c\u91cd\u65b0\u6620\u5c04\u865a\u62df\u5185\u5b58\u3002\nbool MemoryFile::truncate(size_t size) {\n    if (m_fd &lt; 0) {\n        return false;\n    }\n    if (size == m_size) {\n        return true;\n    }\n#    ifdef MMKV_ANDROID\n        if (size &gt; m_size) {\n            MMKVError(\"ashmem %s reach size limit:%zu, consider configure with larger size\", m_name.c_str(), m_size);\n        }\n        return false;\n    }\n#    endif // MMKV_ANDROID\n\n    auto oldSize = m_size;\n    m_size = size;\n    // round up to (n * pagesize)\n    if (m_size &lt; DEFAULT_MMAP_SIZE || (m_size % DEFAULT_MMAP_SIZE != 0)) {\n        m_size = ((m_size / DEFAULT_MMAP_SIZE) + 1) * DEFAULT_MMAP_SIZE;\n    }\n\n    if (::ftruncate(m_fd, static_cast&lt;off_t&gt;(m_size)) != 0) {\n    }\n    if (m_size &gt; oldSize) {\n        if (!zeroFillFile(m_fd, oldSize, m_size - oldSize)) {\n        }\n    }\n\n    if (m_ptr) {\n        if (munmap(m_ptr, oldSize) != 0) {\n    }\n    auto ret = mmap();\n}\n</code></pre>"},{"location":"Android/MMKV/#_9","title":"\u603b\u7ed3","text":"<p>MMKV\u5145\u5206\u5229\u7528\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u57fa\u672c\u80fd\u529b\uff0c\u4ee5\u53ca\u9488\u5bf9\u79fb\u52a8\u7aef\u5e94\u7528\u7684\u573a\u666f\u4e4b\u4e0b\uff0c\u8bbe\u8ba1\u4e86\u6b64KV\u5b58\u50a8\u5e93\uff0c\u6027\u80fd\u5feb\u3001\u7a7a\u95f4\u6548\u7387\u9ad8\u3001\u591a\u8fdb\u7a0b\u53cb\u597d\u3002\u4e5f\u652f\u6301\u52a0\u5bc6\u6570\u636e\u5b58\u50a8\uff0c\u5bf9\u5b89\u5168\u6027\u4e0a\u4e5f\u8865\u5f3a\u4e86\u652f\u6301\u3002\u662f\u4e00\u6b3e\u4f18\u79c0\u7684kv\u65b9\u6848\u548c\u601d\u8def\u3002\u82e5\u60f3\u8ba4\u771f\u7814\u8bfb\u6b64\u5e93\u6700\u597d\u5bf9Linux\u6807\u51c6\u5e93\u7684\u8c03\u7528\u6709\u4e00\u5b9a\u7ecf\u9a8c\uff0c\u76ee\u524d\u5bf9\u6211\u662f\u6bd4\u8f83\u7f3a\u5931\u7684\u3002</p>"},{"location":"Android/MMKV/#_10","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>MMKV Github</li> <li>MMKV Github \u591a\u8fdb\u7a0bWIKI</li> <li>Memory Android Ndk</li> <li>CRC</li> <li>protobuf\u8bf7\u53c2\u9605\u201c\u7f16\u7801\u201dsection\u3002</li> <li>mmap\u3001flock\u3001fcntl\u3001ftruncate \u8bf7\u53c2\u9605\u201c\u64cd\u4f5c\u7cfb\u7edf\u201dsection\u3002</li> </ul>"},{"location":"Android/MultiDex/","title":"MultiDex","text":""},{"location":"Android/MultiDex/#multidex","title":"MultiDex","text":"<p>\u6b64\u6587\u7ae0\u8f83\u8001</p> <p>\u6838\u5fc3\u70b9\uff1a</p> <ul> <li>\u6839\u636esp\u4ee5\u53ca\u4e4b\u524d\u89e3\u538b\u7684\u6587\u4ef6\u76ee\u5f55\u5224\u65ad\u662f\u5426\u9700\u8981\u91cd\u65b0\u89e3\u538b\uff0c\u9700\u8981\u7684\u8bdd\uff0c\u6309\u89c4\u5219\u4ecedata/app\u4e0b\u7684apk\u6587\u4ef6\uff08applicationInfo.sourceDir\uff09\u4e2d\u901a\u8fc7\u7c7b\u4f3cclasses2.dex\u5bfb\u627eZipEntry\uff0c\u5e76\u89e3\u538b\u5230applicationInfo.dataDir\u5373app\u7684\u6570\u636e\u76ee\u5f55\u4e0b\u7279\u5b9a\u5b50\u76ee\u5f55\u5b58\u653e\uff08\u65b9\u4fbf\u4e4b\u540e\u4f7f\u7528\u800c\u4e0d\u662f\u6bcf\u6b21\u90fd\u89e3\u538b\uff09</li> <li>\u518d\u4f9d\u8d56\u53cd\u5c04\u4f7f\u7528PathClassLoader\u4e0b\u7684pathList\u7684makeDexElement\u65b9\u6cd5\u751f\u6210dex\u5143\u7d20</li> <li>\u6700\u540e\u901a\u8fc7\u53cd\u5c04\u83b7\u53d6\u628a\u8ffd\u52a0\u7684\u3001\u5b8c\u6574\u7684dexElement\u8d4b\u503c\u7ed9pathList\u7684dexElements\u3002\u4ece\u800c\u5b8c\u6210\u3002</li> </ul>"},{"location":"Android/MultiDex/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>MultiDex</li> </ul>"},{"location":"Android/OkHttp/","title":"OkHttp","text":"<p>OkHttp\u662f\u4e00\u4e2a\u57fa\u4e8eJDK\u7684\u7f51\u7edc\u5ba2\u6237\u7aef\u3002\u5b83\u56e0\u5176\u62e6\u622a\u94fe\u7684\u8bbe\u8ba1\u80fd\u88ab\u7b80\u5355\u9ad8\u6548\u5730\u5b9a\u5236\u62d3\u5c55\u3002\u7ed3\u5408\u5176\u5305\u542bConnection\u7684\u590d\u7528\uff0c\u5bf9Http2\u7684\u652f\u6301\u7b49\uff0c\u90fd\u4f7f\u5f97\u5b83\u6210\u4e3a\u5b89\u5353\u5f00\u53d1\u4e2d\u6240\u88ab\u8ffd\u6367\u4f7f\u7528\u7684\u3002\u5b83\u672c\u8eab\u662f\u4e0d\u5305\u542b\u6784\u5efa\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u6765\u53d1\u8d77\u8bf7\u6c42\u3001\u89e3\u6790\u54cd\u5e94\u7684\u5de5\u5177\u7684\u3002\u800c\u662f\u53ea\u5305\u542b<code>Request</code>\u548c<code>Response</code>\u7684\u539f\u59cb\u63cf\u8ff0\u548c\u529f\u80fd\u3002</p>"},{"location":"Android/OkHttp/#_1","title":"\u62e6\u622a\u94fe","text":"<p><pre><code>class RealInterceptorChain(\n  internal val call: RealCall,\n  private val interceptors: List&lt;Interceptor&gt;,\n  private val index: Int,\n  internal val exchange: Exchange?,\n  internal val request: Request,\n  internal val connectTimeoutMillis: Int,\n  internal val readTimeoutMillis: Int,\n  internal val writeTimeoutMillis: Int\n) : Interceptor.Chain\n</code></pre> \u5728\u6bcf\u6b21<code>process</code>\u7684\u65f6\u5019\uff0c\u90fd\u4f1a<code>copy</code>\u5176\u5b9e\u5c31\u662f\u66f4\u6539\u4e0bindex\u548crequest\uff0c\u5176\u4ed6\u6210\u5458\u4e0d\u53d8\uff0c\u6784\u9020\u51fa\u4e00\u4e2a\u65b0\u7684\u5b50<code>Chain</code>\u4ea4\u7ed9\u4e0b\u4e2a<code>Interceptor</code>\u5904\u7406\u3002\u9012\u5f52\u601d\u60f3\uff0c\u4e14\u56e0\u4e3a\u6b64\u5b9e\u4f8b\u76f8\u5bf9\u8f7b\u91cf\uff0c\u8fd9\u6837\u5b50copy\u6210\u672c\u4e0d\u5927\u3002 <pre><code>// \u5df2\u7cbe\u7b80\n override fun proceed(request: Request): Response {\n    check(index &lt; interceptors.size)\n    // Call the next interceptor in the chain.\n    val next = copy(index = index + 1, request = request)\n    val interceptor = interceptors[index]\n\n    val response = interceptor.intercept(next) ?: throw NullPointerException(\n        \"interceptor $interceptor returned null\")\n    return response\n  }\n</code></pre> \u8fd9\u4e2a\u8bbe\u8ba1\u6a21\u5f0f\u672c\u8d28\u4e0a\u662f\u65b9\u6cd5\u7684\u9012\u5f52\u8c03\u7528\uff0c\u9012\u5f52\u7684\u6761\u4ef6\u5728\u4e8e\uff0c\u904d\u5386\u6240\u6709\u7684\u5904\u7406\u5668\u3002</p> <p><pre><code>class Processor{\n    Result process(int index, Processor[] processors, Request request){\n        if(index&lt;processor.length){\n            Processor p = processors[index]\n            p.process(index+1, processors, request)\n        }else{\n            // no more processor, must give result now.\n            throw Exception()\n        }\n    }\n}\n</code></pre> \u5b50\u7c7b\u81ea\u5b9a\u4e49Processor\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u590d\u5199<code>process</code>\uff0c\u82e5\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\uff0c\u5219\u8fd4\u56de\u7ed3\u679c\uff0c\u82e5\u9700\u8981\u7b49\u5f85\u540e\u9762\u5904\u7406\u5668\u7684\u7ed3\u679c\uff0c\u5219\u8c03\u7528<code>super.process(...)</code>\u5373\u53ef\u3002\u4f46\u6216\u8bb8\u6b64\u65b9\u5f0f\u4e0d\u591f\u4f18\u96c5\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5c01\u88c5\u4e3a\u7c7b\u4f3c\u7684<code>Chain</code>\uff0c\u800c\u628a<code>process</code>\u5b9a\u4e49\u4e3a<code>intercept</code>\u3002<code>Chain</code>\u63d0\u4f9b<code>process</code>\u65b9\u6cd5\u6765\u5b8c\u6210\u4e0a\u9762\u7684\u5185\u7f6e\u9012\u5f52\u903b\u8f91\u3002</p> <p>\u82e5\u6539\u5199\u4e3a\u5faa\u73af\u65b9\u5f0f <pre><code>for(Processor p: processors){\n    Result r = p.process(request)\n    if(r.isOk) return r;\n}\n</code></pre> \u5176\u5b9e\u8fd9\u6837\u4f1a\u65e0\u6cd5\u6784\u6210\u94fe\uff0c\u5373Processor\u65e0\u6cd5\u83b7\u53d6\u540e\u7eedProcessor\u7684\u5904\u7406\u7ed3\u679c\u5e76\u52a0\u4ee5\u4fee\u6539\u7b49\u3002\u5bf9\u7279\u6027\u662f\u7f3a\u5931\u7684\u3002\u800c\u4e00\u65e6\u4f9d\u8d56\u540e\u7eed\u7ed3\u679c\uff0c\u52bf\u5fc5\u8fd8\u662f\u4f7f\u7528\u9012\u5f52\u66f4\u52a0\u7b80\u5355\u3002</p>"},{"location":"Android/OkHttp/#realcall","title":"RealCall","text":"<pre><code>// RealCall.kt \u5df2\u7cbe\u7b80\n  internal fun getResponseWithInterceptorChain(): Response {\n    // Build a full stack of interceptors.\n    val interceptors = mutableListOf&lt;Interceptor&gt;()\n    // \u81ea\u5b9a\u4e49\u7684interceptor\n    interceptors += client.interceptors\n    // \u5931\u8d25\u65f6\u91cd\u8bd5\uff0c\u6216\u8005code\u662f\u91cd\u5b9a\u5411\u7cfb\u5217\u5219\u53d1\u8d77\u65b0\u7684\u8bf7\u6c42\u3002\n    interceptors += RetryAndFollowUpInterceptor(client)\n    interceptors += BridgeInterceptor(client.cookieJar)\n    // \u68c0\u67e5\u7f13\u5b58\u3002Http cache\u89c4\u8303\n    interceptors += CacheInterceptor(client.cache)\n    // \u8d1f\u8d23\u8fde\u63a5\uff0c\u89c1\u540e\u6587\n    interceptors += ConnectInterceptor\n    if (!forWebSocket) {\n        // \u81ea\u5b9a\u4e49\u7684networkInterceptor\n      interceptors += client.networkInterceptors\n    }\n    // \u5199\u5165\u8bf7\u6c42\u3001\u8bfb\u53d6\u54cd\u5e94\u5904\u7406\u8005\u3002\n    interceptors += CallServerInterceptor(forWebSocket)\n\n    val chain = RealInterceptorChain(...)\n    try {\n      val response = chain.proceed(originalRequest)\n      if (isCanceled()) {\n        response.closeQuietly()\n        throw IOException(\"Canceled\")\n      }\n      return response\n    }\n  }\n</code></pre>"},{"location":"Android/OkHttp/#connection","title":"Connection\u521b\u5efa\u548c\u590d\u7528","text":"<p>\u5728<code>ConnectInterceptor</code>\u62e6\u622a\u5668\u4e2d\uff0c\u4f1a\u8fdb\u5165\u5230<code>ExchangeFinder#findConnection</code>\u65b9\u6cd5\uff0c\u6765\u5bfb\u627e\u4e00\u4e2a\u53ef\u7528\u7684\u8fde\u63a5\u3002\u5b83\u7684\u7b56\u7565\u5df2\u7ecf\u4f53\u73b0\u5728\u6ce8\u91ca\u4e2d\uff1a <pre><code>  /**\n   * Returns a connection to host a new stream. This prefers the existing connection if it exists,\n   * then the pool, finally building a new connection.\n   * \u5373\u4f18\u5148\u4ececall\u73b0\u6709\u7684connection\u53d6\uff0c\u5176\u6b21\u4ece\u6c60\u91cc\u53d6\uff0c\u6700\u540e\u662f\u5efa\u7acb\u65b0\u8fde\u63a5\n   **/\n</code></pre> <code>RealConnectionPool</code>\u662f\u5bf9\u5e94\u7684\u6c60\u5b50\u7ef4\u62a4\u8005\u3002<code>connections = ConcurrentLinkedQueue&lt;RealConnection&gt;()</code>\u662f\u5b58\u50a8\u65b9\u5f0f\uff08\u5e76\u53d1\u96c6\u5408\u8bf7\u53c2\u9605\u201cJava\u201dsection\uff09\u3002</p> <p>\u521b\u5efa\u8fde\u63a5\u7684\u8fc7\u7a0b\u8bf7\u89c1\u4e0b\u6587\u3002</p>"},{"location":"Android/OkHttp/#socket","title":"Socket\u521b\u5efa","text":"<p>\u8fde\u63a5\u5efa\u7acb\u662f\u5728<code>RealConnection</code>\u7c7b\u6838\u5fc3\u65b9\u6cd5<code>connect</code>: <pre><code>// \u5df2\u7cbe\u7b80\n  fun connect(...) {\n    val connectionSpecs = route.address.connectionSpecs\n    val connectionSpecSelector = ConnectionSpecSelector(connectionSpecs)\n\n    if (route.address.sslSocketFactory == null) {\n      val host = route.address.url.host\n      if (!Platform.get().isCleartextTrafficPermitted(host)) {\n        throw RouteException(UnknownServiceException(\n            \"CLEARTEXT communication to $host not permitted by network security policy\"))\n      }\n    }\n\n    while (true) {\n        connectSocket(connectTimeout, readTimeout, call, eventListener)\n        establishProtocol(connectionSpecSelector, pingIntervalMillis, call, eventListener)\n        break\n      }\n    }\n  }\n</code></pre></p> <p>\u8fd9\u91cc\u4f1a\u770b\u662f\u5426\u6709<code>sslSocketFactory</code>\uff0c\u82e5\u6ca1\u6709\u5219\u610f\u5473\u7740\u8981\u8fdb\u884c\u660e\u6587\u4f20\u8f93\uff0c\u4f1a\u68c0\u67e5\u4e00\u4e0b\u5e73\u53f0\u7684\u660e\u6587\u4f20\u8f93\u662f\u5426\u5141\u8bb8\uff0c\u4e0d\u5141\u8bb8\u5219\u5f02\u5e38\u3002\u4e4b\u540e\u4f1a\u8fde\u63a5\u5957\u63a5\u5b57\uff0c\u5efa\u7acb\u534f\u8bae\u5c42\u3002\u8fd9\u4e24\u4e2a\u8fc7\u7a0b\u6bd4\u8f83\u91cd\u8981\uff1a <pre><code>  private fun connectSocket(...) {\n    val proxy = route.proxy\n    val address = route.address\n\n    val rawSocket = when (proxy.type()) {\n      Proxy.Type.DIRECT, Proxy.Type.HTTP -&gt; address.socketFactory.createSocket()!!\n      else -&gt; Socket(proxy)\n    }\n    this.rawSocket = rawSocket\n      Platform.get().connectSocket(rawSocket, route.socketAddress, connectTimeout)\n\n      source = rawSocket.source().buffer()\n      sink = rawSocket.sink().buffer()\n    }\n  }\n</code></pre> \u5373\u6839\u636e\u4ee3\u7406\u60c5\u51b5\u4ece\u5e73\u53f0\u5c42\u521b\u5efa<code>socket</code>\uff0c\u8fd9\u91cc\u5b89\u5353\u5bf9\u5e94\u7684\u5c31\u662fjdk\u7684\u5b9e\u73b0\uff0c\u540e\u7eed\u4f1a\u518d\u4f7f\u7528\u5e73\u53f0\u5c42\uff0c\u8fde\u63a5<code>socket</code>\u5e76\u4f20\u5165\u76ee\u6807ip\uff0c\u518d\u6784\u9020\u6b64<code>socket</code>\u7684\u8f93\u5165\u8f93\u51fa\u6d41\u3002\u8865\u5145\u8bf4\u660e\u5982\u4e0b\u51e0\u70b9\uff1a</p> <ul> <li>\u8fde\u63a5socket\u6240\u4f7f\u7528\u7684ip\u6765\u81ea\u4e8e<code>RouteSelector#resetNextInetSocketAddress</code>\uff0c\u800c\u5b83\u6700\u7ec8\u4f1a\u4f7f\u7528<code>OkHttpClient.dns</code>\u6765\u67e5\u8be2\u3002<ul> <li><code>Dns.SYSTEM</code>\u662f\u9ed8\u8ba4\u5b9e\u73b0\uff0c\u501f\u52a9\u4e86jdk\u7684<code>InetAddress.getAllByName(hostname)</code>\u5373\u53ef\u83b7\u53d6\u89e3\u6790\u5230\u7684ip\u5217\u8868\u3002</li> <li><code>DnsOverHttps</code>\u662fHttpsDns\u534f\u8bae\u7684\u5b9e\u73b0\u3002\u5b83\u6bd4\u4f20\u7edf\u7684dns\u66f4\u52a0\u5b89\u5168\u3002\u56e0\u4e3a\u4f20\u7edf\u7684DNS\u53ef\u4ee5\u88ab\u7f51\u7edc\u8def\u5f84\u4e2d\u7684\u4efb\u610f\u8282\u70b9\u52ab\u6301\u3001\u4ea6\u6216\u8005\u8ffd\u8e2a\uff0c\u800c\u6b64\u65b9\u5f0f\u53ef\u4ee5\u89c4\u907f\u3002\u8be6\u89c1\u201c\u8ba1\u7b97\u673a\u7f51\u7edc\u201dsection.</li> </ul> </li> <li>\u6b64\u65f6\u7684<code>Connection</code>\u8fd8\u4e0d\u662f\u5b89\u5168\u7684\u3002\u8fd8\u6ca1\u6709\u6784\u5efa\u534f\u8bae\u3002</li> <li><code>socket</code>\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528\u662f\u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\u4e4b\u4e00\uff0c\u5b83\u4e5f\u662f\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u652f\u6301\u5e38\u89c1\u7684IO\u64cd\u4f5c\u3002\u8be6\u89c1\u201c\u64cd\u4f5c\u7cfb\u7edf\u201dsection\u3002</li> </ul> <p><pre><code>  private fun establishProtocol(\n    connectionSpecSelector: ConnectionSpecSelector,\n    pingIntervalMillis: Int,\n    call: Call,\n    eventListener: EventListener\n  ) {\n    if (route.address.sslSocketFactory == null) {\n      if (Protocol.H2_PRIOR_KNOWLEDGE in route.address.protocols) {\n        socket = rawSocket\n        protocol = Protocol.H2_PRIOR_KNOWLEDGE\n        startHttp2(pingIntervalMillis)\n        return\n      }\n\n      socket = rawSocket\n      protocol = Protocol.HTTP_1_1\n      return\n    }\n\n    connectTls(connectionSpecSelector)\n\n    if (protocol === Protocol.HTTP_2) {\n      startHttp2(pingIntervalMillis)\n    }\n  }\n</code></pre> \u5efa\u7acb\u534f\u8bae\u7684\u65f6\u5019\uff0c\u82e5\u6ca1\u6709<code>sslSocketFactory</code>\u90a3\u4e48\u6839\u636e\u9700\u8981\u5efa\u7acb<code>http2</code>\u534f\u8bae\u6216<code>Http1.1</code>\u534f\u8bae\u3002\u82e5\u6709<code>sslSocketFactory</code>\u5219\u5148\u5efa\u7acb<code>tls</code>\u8fde\u63a5\uff0c\u518d\u6309\u9700\u5efa\u7acb<code>http2</code>\u534f\u8bae\u3002 <pre><code>  private fun connectTls(connectionSpecSelector: ConnectionSpecSelector) {\n    val address = route.address\n    val sslSocketFactory = address.sslSocketFactory\n    var success = false\n    var sslSocket: SSLSocket? = null\n    try {\n      // Create the wrapper over the connected socket.\n      sslSocket = sslSocketFactory!!.createSocket(\n          rawSocket, address.url.host, address.url.port, true /* autoClose */) as SSLSocket\n\n      // Configure the socket's ciphers, TLS versions, and extensions.\n      val connectionSpec = connectionSpecSelector.configureSecureSocket(sslSocket)\n      if (connectionSpec.supportsTlsExtensions) {\n        Platform.get().configureTlsExtensions(sslSocket, address.url.host, address.protocols)\n      }\n\n      // Force handshake. This can throw!\n      sslSocket.startHandshake()\n      // block for session establishment\n      val sslSocketSession = sslSocket.session\n      val unverifiedHandshake = sslSocketSession.handshake()\n\n      // Verify that the socket's certificates are acceptable for the target host.\n      if (!address.hostnameVerifier!!.verify(address.url.host, sslSocketSession)) {\n        val peerCertificates = unverifiedHandshake.peerCertificates\n        if (peerCertificates.isNotEmpty()) {\n          val cert = peerCertificates[0] as X509Certificate\n          throw SSLPeerUnverifiedException(\"\"\"\n              |Hostname ${address.url.host} not verified:\n              |    certificate: ${CertificatePinner.pin(cert)}\n              |    DN: ${cert.subjectDN.name}\n              |    subjectAltNames: ${OkHostnameVerifier.allSubjectAltNames(cert)}\n              \"\"\".trimMargin())\n        } else {\n          throw SSLPeerUnverifiedException(\n              \"Hostname ${address.url.host} not verified (no certificates)\")\n        }\n      }\n\n      val certificatePinner = address.certificatePinner!!\n\n      handshake = Handshake(unverifiedHandshake.tlsVersion, unverifiedHandshake.cipherSuite,\n          unverifiedHandshake.localCertificates) {\n        certificatePinner.certificateChainCleaner!!.clean(unverifiedHandshake.peerCertificates,\n            address.url.host)\n      }\n\n      // Check that the certificate pinner is satisfied by the certificates presented.\n      certificatePinner.check(address.url.host) {\n        handshake!!.peerCertificates.map { it as X509Certificate }\n      }\n\n      // Success! Save the handshake and the ALPN protocol.\n      val maybeProtocol = if (connectionSpec.supportsTlsExtensions) {\n        Platform.get().getSelectedProtocol(sslSocket)\n      } else {\n        null\n      }\n      socket = sslSocket\n      source = sslSocket.source().buffer()\n      sink = sslSocket.sink().buffer()\n      protocol = if (maybeProtocol != null) Protocol.get(maybeProtocol) else Protocol.HTTP_1_1\n      success = true\n    } finally {\n      if (sslSocket != null) {\n        Platform.get().afterHandshake(sslSocket)\n      }\n      if (!success) {\n        sslSocket?.closeQuietly()\n      }\n    }\n  }\n</code></pre> \u8fd9\u91cc\u662f<code>tsl</code>\u7684\u5efa\u7acb\u8fc7\u7a0b\uff0c\u5982\u679c\u719f\u6089<code>Https</code>\u7684\u63e1\u624b\u8fc7\u7a0b\uff0c\u770b\u5230\u8fd9\u91cc\u5e94\u8be5\u4e0d\u4f1a\u964c\u751f\u3002\u9996\u5148\u9700\u8981<code>sslSocketFactory.connectSocket</code>\u8fd9\u91cc\u5b89\u5353\u4e5f\u662f\u4f7f\u7528jdk\u63d0\u4f9b\u7684\u5b9e\u73b0\uff0c\u7136\u540e\u4f9d\u9760<code>SSLSocket.startHandshake</code>\u5b8c\u6210<code>tsl</code>\u63e1\u624b\uff0c\u5b83\u8ba4\u53ef\u7684\u8bc1\u4e66\u6765\u6e90\u4e8e\u6784\u9020<code>SSLSocketFactory</code>\u7684\u65f6\u5019\u6240\u4f20\u5165\u7684<code>TrustManager</code>\uff0c\u8fd9\u4e9b\u90fd\u5c5e\u4e8ejdk\u7684\u8303\u7574\uff0c\u8be6\u60c5\u89c1\u62d3\u5c55\u9605\u8bfb\u7684<code>SSLSesion</code>\uff0c\u5b83\u4f1a\u4fdd\u5b58tsl\u4f1a\u8bdd\u4e2d\u7684\u5404\u79cd\u5173\u952e\u4fe1\u606f\u5305\u62ec\u672c\u5730\u7684\u8bc1\u4e66\u3001\u5bf9\u65b9\u7684\u8bc1\u4e66\u3001\u5efa\u7acb\u7684\u79d8\u94a5\u7b97\u6cd5\u7b49\u3002\u5728\u6b64\u4e4b\u540e\uff0cOkHttp\u8865\u5145\u4e86\u51e0\u4e2a\u989d\u5916\u7684\u9a8c\u8bc1\uff1a</p> <ul> <li><code>HostnameVerifer</code>\uff0c\u7528\u4e8e\u9a8c\u8bc1tsl\u4f1a\u8bdd\u4e2d\u7684\u5bf9\u65b9\u8bc1\u4e66\u662f\u5426\u88ab\u6b64\u4e3b\u673a\u63a5\u53d7\u3002\u5177\u4f53\u903b\u8f91\u89c1<code>OkHostnameVerifer</code>\u3002</li> <li><code>CertificatePinner</code>\uff0c\u5982\u679c\u6709\u56fa\u5b9a\u8bc1\u4e66\u5668\uff0c\u5219\u68c0\u67e5\u56fa\u5b9a\u8bc1\u4e66\u5668\u9700\u8981\u68c0\u67e5\u76ee\u524d\u7684\u5bf9\u65b9\u8bc1\u4e66\u662f\u5426\u6ee1\u8db3\u3002</li> </ul>"},{"location":"Android/OkHttp/#https","title":"\u81ea\u5b9a\u4e49Https","text":"<p>\u5230\u6b64\uff0c\u518d\u63d0\u4e00\u53e5\u5173\u4e8e\u81ea\u5b9a\u4e49\u4fe1\u4efb\u7684\u95ee\u9898\uff0c\u5982Stackoverflow\u4e0a\u7684\u56de\u7b54\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7\u5728\u6784\u9020<code>OkHttpClient</code>\u65f6\u4f20\u5165\u4f7f\u7528\u81ea\u5b9a\u4e49<code>TrustManager</code>\u6784\u9020\u7684<code>SSLSocketFactory</code>\u3001\u81ea\u5b9a\u4e49\u7684<code>HostnameVerifier</code>\uff0c\u4ee5\u53ca\u53ef\u9009\u7684\u56fa\u5b9a\u8bc1\u4e66\u68c0\u67e5\u5668\u5373\u53ef\u3002</p>"},{"location":"Android/OkHttp/#_2","title":"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668","text":"<p>\u5e38\u7528\u4e8e\u4ee5\u4e0b\u60c5\u666f\uff1a</p> <ul> <li>\u8ba4\u8bc1\u9274\u6743\uff0c\u6bd4\u5982\u6dfb\u52a0\u901a\u7528\u7684\u9274\u6743\u8bf7\u6c42\u53c2\u6570\u3002</li> <li>\u652f\u6301\u538b\u7f29\u7f16\u7801\u683c\u5f0f</li> <li>\u6253\u5370\u65e5\u5fd7</li> <li>\u81ea\u52a8\u5316\u6d4b\u8bd5\u3001Mock\u3002</li> </ul>"},{"location":"Android/OkHttp/#events","title":"Events","text":"<p>\u5373\u53ef\u4ee5\u6dfb\u52a0<code>EventListener</code>\u6765\u76d1\u542c\u5404\u4e2a\u5173\u952e\u8282\u70b9\u7684\u4e8b\u4ef6\u56de\u8c03\u3002\u5982\u56fe\uff1a</p> <p></p>"},{"location":"Android/OkHttp/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>JDK SSLSesion</li> <li>\u201c\u8ba1\u7b97\u673a\u7f51\u7edc\u201dsection</li> <li>\u201c\u64cd\u4f5c\u7cfb\u7edf\u201dsection</li> </ul>"},{"location":"Android/Retrofit/","title":"Retrofit","text":"<p>Retrofit\u662f\u4e00\u4e2a\u5728\u5b89\u5353\u5e73\u53f0\u4e0a\u6d41\u884c\u4f7f\u7528\u7684\u58f0\u660e\u7f51\u7edc\u8bf7\u6c42\u63a5\u53e3\u7684\u5e93\u3002\u5b83\u63d0\u4f9b\u4e86\u826f\u597d\u7684\u9002\u914d\u62d3\u5c55\uff0c\u4f7f\u5f97\u5176\u80fd\u591f\u4e0d\u4ec5\u826f\u597d\u5730\u58f0\u660e\u9759\u6001\u63a5\u53e3\uff0c\u8fd8\u53ef\u4ee5\u9ad8\u6548\u83b7\u5f97\u5404\u79cd\u8bf7\u6c42\u7c7b\u578b\u3001\u8fd4\u56de\u6570\u636e\u7ed3\u679c\u7684\u9002\u914d\u652f\u6301\u3002</p>"},{"location":"Android/Retrofit/#_1","title":"\u63a5\u53e3\u58f0\u660e","text":"<p>\u5728<code>Retrofit</code>\u4e2d\uff0c\u63a5\u53e3\u4ee5<code>interface</code>\u7ed3\u5408\u6ce8\u89e3\u6765\u58f0\u660e\u3002\u89c1<code>retrofit2.http</code>\u5305\uff0c\u5b83\u5305\u542b\u4e86\u8bb8\u591a\u6ce8\u89e3\u7528\u4e8e\u63cf\u8ff0\u63a5\u53e3\u3002\u4eceHttp\u7684\u65b9\u6cd5\uff0c\u5230\u8def\u5f84\u3001\u53c2\u6570\u3001Header\u3001\u4ee5\u53ca\u8868\u5355\u683c\u5f0f\u7b49\u652f\u6301\u3002</p> <p>\u6ce8\u610f\u8fd9\u4e9b\u6ce8\u89e3\u90fd\u662f<code>Runtime</code>\u4fdd\u7559\u7684\uff0c\u56e0\u4e3aRetrofit\u4f9d\u8d56\u8fd0\u884c\u65f6\u89e3\u6790\u6ce8\u89e3\u3002\u800c\u975e<code>apt</code>\u7b49\u65b9\u5f0f\u3002</p>"},{"location":"Android/Retrofit/#_2","title":"\u52a8\u6001\u4ee3\u7406","text":"<p>\u4f7f\u7528<code>retrofit.create(Class)</code>\u6765\u521b\u9020\u63a5\u53e3\u5b9e\u73b0\u5b9e\u4f8b\u65f6\uff0cRetrofit\u4f7f\u7528\u4e86\u52a8\u6001\u4ee3\u7406\u3002</p> <p><pre><code>  public &lt;T&gt; T create(final Class&lt;T&gt; service) {\n    validateServiceInterface(service);\n    return (T)\n        Proxy.newProxyInstance(\n            service.getClassLoader(),\n            new Class&lt;?&gt;[] {service},\n            new InvocationHandler() {\n              private final Object[] emptyArgs = new Object[0];\n\n              @Override\n              public @Nullable Object invoke(Object proxy, Method method, @Nullable Object[] args)\n                  throws Throwable {\n                // If the method is a method from Object then defer to normal invocation.\n                if (method.getDeclaringClass() == Object.class) {\n                  return method.invoke(this, args);\n                }\n                args = args != null ? args : emptyArgs;\n                Platform platform = Platform.get();\n                return platform.isDefaultMethod(method)\n                    ? platform.invokeDefaultMethod(method, service, proxy, args)\n                    : loadServiceMethod(method).invoke(args);\n              }\n            });\n  }\n</code></pre> \u5373\u5bf9\u8be5\u63a5\u53e3\u7684\u65b9\u6cd5\u8c03\u7528\u4f1a\u5206\u4e3a\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>Object\u7c7b\u65b9\u6cd5\uff0c\u4ee5\u6b64\u533f\u540d<code>InvocationHandler</code>\u4f5c\u4e3a\u5bf9\u8c61\u76f4\u63a5\u6267\u884c\u3002</li> <li>\u9ed8\u8ba4\u65b9\u6cd5\uff0c\u5bf9\u4e8e\u9ad8\u7248\u672c\u7684java\u53ef\u4ee5\u5bf9\u63a5\u53e3\u63d0\u4f9b\u9ed8\u8ba4\u5b9e\u73b0\u3002\u82e5\u662f\u8fd9\u79cd\u60c5\u51b5\uff0c\u5219\u8c03\u7528\u9ed8\u8ba4\u65b9\u6cd5\u5b9e\u73b0\u3002</li> <li>\u58f0\u660e\u7684\u63a5\u53e3\u65b9\u6cd5\uff0c\u8fd9\u662f\u6838\u5fc3\u529f\u80fd\u6240\u5728\u3002\u8fc7\u7a0b\u5982\u4e0b\u3002</li> </ul> <p>\u5148\u83b7\u53d6\u6b64<code>method</code>\u5bf9\u8c61\u5bf9\u5e94\u7684\u6ce8\u89e3\u89e3\u6790\u7ed3\u679c\u5305\u88c5\u5bf9\u8c61\uff0c\u4f18\u5148\u4f7f\u7528\u7f13\u5b58\u7684\uff0c\u5426\u5219\u9996\u6b21\u89e3\u6790\u6b64\u5bf9\u8c61\u3002\u5176\u8fc7\u7a0b\u5206\u4e3a\uff1a\u65b9\u6cd5\u6ce8\u89e3\u89e3\u6790\uff0c\u65b9\u6cd5\u53c2\u6570\u6ce8\u89e3\u89e3\u6790\uff0c\u8fd4\u56de\u7c7b\u578b\u89e3\u6790\u3002</p> <p>\u5176\u4e2d\uff0c\u65b9\u6cd5\u53c2\u6570\u89e3\u6790\u65f6\uff0c\u5982\u679c\u53d1\u73b0\u6709\u53c2\u6570\u662f<code>Continuation</code>\u7c7b\u578b\uff0c\u5219\u8ba4\u4e3a\u662f<code>suspend</code>\u65b9\u6cd5\u3002\u6700\u540e\u4f1a\u6839\u636e\u662f\u5426\u662f<code>suspend</code>\u65b9\u6cd5\uff0c\u7ed9\u51fa\u4e0d\u540c\u7684\u5c01\u88c5\u5bf9\u8c61\uff0c\u91cc\u9762\u5305\u542b\u4e86<code>requestFactory</code>\uff0c<code>callAdapter</code>\u3002<code>responseConverter</code></p> <p><pre><code>    Converter&lt;ResponseBody, ResponseT&gt; responseConverter =\n        createResponseConverter(retrofit, method, responseType);\n\n    okhttp3.Call.Factory callFactory = retrofit.callFactory;\n    if (!isKotlinSuspendFunction) {\n      return new CallAdapted&lt;&gt;(requestFactory, callFactory, responseConverter, callAdapter);\n    } else if (continuationWantsResponse) {\n      //noinspection unchecked Kotlin compiler guarantees ReturnT to be Object.\n      return (HttpServiceMethod&lt;ResponseT, ReturnT&gt;)\n          new SuspendForResponse&lt;&gt;(\n              requestFactory,\n              callFactory,\n              responseConverter,\n              (CallAdapter&lt;ResponseT, Call&lt;ResponseT&gt;&gt;) callAdapter);\n    } else {\n      //noinspection unchecked Kotlin compiler guarantees ReturnT to be Object.\n      return (HttpServiceMethod&lt;ResponseT, ReturnT&gt;)\n          new SuspendForBody&lt;&gt;(\n              requestFactory,\n              callFactory,\n              responseConverter,\n              (CallAdapter&lt;ResponseT, Call&lt;ResponseT&gt;&gt;) callAdapter,\n              continuationBodyNullable);\n    }\n</code></pre> \u4e0b\u9762\u6765\u770b\u5177\u4f53\u8c03\u7528\u3002</p> <pre><code>  final @Nullable ReturnT invoke(Object[] args) {\n    Call&lt;ResponseT&gt; call = new OkHttpCall&lt;&gt;(requestFactory, args, callFactory, responseConverter);\n    return adapt(call, args);\n  }\n\n    //\u5bf9\u4e8esuspend\n    protected Object adapt(Call&lt;ResponseT&gt; call, Object[] args) {\n      call = callAdapter.adapt(call);\n\n      // Continuation\u5fc5\u7136\u662f\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u3002\n      Continuation&lt;Response&lt;ResponseT&gt;&gt; continuation =\n          (Continuation&lt;Response&lt;ResponseT&gt;&gt;) args[args.length - 1];\n\n      // See SuspendForBody for explanation about this try/catch.\n      try {\n        return KotlinExtensions.awaitResponse(call, continuation);\n      } catch (Exception e) {\n        return KotlinExtensions.suspendAndThrow(e, continuation);\n      }\n    }\n\n// OkHttpCall\u8f6c\u534f\u7a0b\u3002\u5373call\u5165\u5217\uff0c\u5b8c\u6210\u65f6\u53d1\u9001resume\u3002\nsuspend fun &lt;T&gt; Call&lt;T&gt;.awaitResponse(): Response&lt;T&gt; {\n  return suspendCancellableCoroutine { continuation -&gt;\n    continuation.invokeOnCancellation {\n      cancel()\n    }\n    enqueue(object : Callback&lt;T&gt; {\n      override fun onResponse(call: Call&lt;T&gt;, response: Response&lt;T&gt;) {\n        continuation.resume(response)\n      }\n\n      override fun onFailure(call: Call&lt;T&gt;, t: Throwable) {\n        continuation.resumeWithException(t)\n      }\n    })\n  }\n}\n\n    //\u5bf9\u4e8e\u666e\u901a\u7684\u76f4\u63a5\u4f7f\u7528callAdapter\u5b8c\u6210\u3002\n    @Override\n    protected ReturnT adapt(Call&lt;ResponseT&gt; call, Object[] args) {\n      return callAdapter.adapt(call);\n    }\n</code></pre>"},{"location":"Android/Retrofit/#calladapter","title":"CallAdapter","text":"<p>\u82e5\u63d0\u4f9b\u81ea\u5b9a\u4e49\u7684\u201c\u8bf7\u6c42\u8c03\u7528\u201d\u5bf9\u8c61\uff0c\u6bd4\u5982\u9664\u4e86\u5185\u7f6e\u7684<code>retrofit2.Call</code>\uff0c\u8981\u63d0\u4f9bjava\u7684<code>CompletableFuture</code>\u4f5c\u4e3a\u63a5\u53e3\u65b9\u6cd5\u8fd4\u56de\u7c7b\u578b\u3002\u5219\u9700\u8981\u63d0\u4f9b<code>CallAdapter.Factory</code>\u3002\u5982\u4e0b\uff1a <pre><code>public final class Java8CallAdapterFactory extends CallAdapter.Factory {\n    // CallAdapter.Factory\u7684\u62bd\u8c61\u65b9\u6cd5\u9700\u8981\u5b9e\u73b0\u3002\u5373\u63d0\u4f9bCallAdapter\u5b9e\u4f8b\n  @Override\n  public @Nullable CallAdapter&lt;?, ?&gt; get(\n      Type returnType, Annotation[] annotations, Retrofit retrofit) {\n          // \u786e\u8ba4\u8fd4\u56de\u7c7b\u578b\u662f\u8981\u5904\u7406\u7684\u7c7b\u578b\n    if (getRawType(returnType) != CompletableFuture.class) {\n      return null;\n    }\n        // \u786e\u8ba4CompletableFuture\u5305\u542b\u4e86\u7c7b\u578b\u53c2\u6570\uff0c\u5373\u6cdb\u578b\u6709\u4f20\u5165\n    if (!(returnType instanceof ParameterizedType)) {\n      throw new IllegalStateException(\n          \"CompletableFuture return type must be parameterized\"\n              + \" as CompletableFuture&lt;Foo&gt; or CompletableFuture&lt;? extends Foo&gt;\");\n    }\n    Type innerType = getParameterUpperBound(0, (ParameterizedType) returnType);\n\n        // \u82e5\u6cdb\u578b\u4e0d\u662f`retrofit2.Response`\uff0c\u5219\u4f7f\u7528BodyCallAdapter\u6b64\u81ea\u5b9a\u4e49CallAdapter\n    if (getRawType(innerType) != Response.class) {\n      return new BodyCallAdapter&lt;&gt;(innerType);\n    }\n\n    // \u82e5\u6cdb\u578b\u662f`retrofit2.Response`\uff0c\u5219\u786e\u8ba4\u5b83\u7684\u6cdb\u578b\u53c2\u6570\u6709\u4f20\u5165\n    if (!(innerType instanceof ParameterizedType)) {\n      throw new IllegalStateException(\n          \"Response must be parameterized\" + \" as Response&lt;Foo&gt; or Response&lt;? extends Foo&gt;\");\n    }\n    // \u83b7\u53d6Response\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u6784\u9020ResponseCallAdapter\n    Type responseType = getParameterUpperBound(0, (ParameterizedType) innerType);\n    return new ResponseCallAdapter&lt;&gt;(responseType);\n  }\n\n  private static final class BodyCallAdapter&lt;R&gt; implements CallAdapter&lt;R, CompletableFuture&lt;R&gt;&gt; {\n    private final Type responseType;\n\n    BodyCallAdapter(Type responseType) {\n      this.responseType = responseType;\n    }\n\n    // CallAdapter\u9700\u8981\u5b9e\u73b0\u7684\u65b9\u6cd5\uff0c\u8fd4\u56de\u6570\u636e\u7ed3\u679c\u7c7b\u578b\u3002\u5373\u5177\u4f53\u7684\u6570\u636e\u5b9e\u4f53\u7c7b\u3002SomeData\u5bf9\u5e94\u7684\u7c7b\u578b\n    @Override\n    public Type responseType() {\n      return responseType;\n    }\n\n    // CallAdapter\u9700\u8981\u5b9e\u73b0\u7684\u65b9\u6cd5\uff0c\u628aretorif2.Call\u8f6c\u4e3aCompletableFuture\u5373\u81ea\u5b9a\u4e49\u7684\u8bf7\u6c42\u5c01\u88c5\u7ed3\u6784\u3002\n    @Override\n    public CompletableFuture&lt;R&gt; adapt(final Call&lt;R&gt; call) {\n      final CompletableFuture&lt;R&gt; future =\n          new CompletableFuture&lt;R&gt;() {\n            @Override\n            public boolean cancel(boolean mayInterruptIfRunning) {\n              if (mayInterruptIfRunning) {\n                call.cancel();\n              }\n              return super.cancel(mayInterruptIfRunning);\n            }\n          };\n\n      call.enqueue(\n          new Callback&lt;R&gt;() {\n            @Override\n            public void onResponse(Call&lt;R&gt; call, Response&lt;R&gt; response) {\n              if (response.isSuccessful()) {\n\n                  //\u8fd9\u91cc\u4f7f\u7528call.body\n                future.complete(response.body());\n              } else {\n                future.completeExceptionally(new HttpException(response));\n              }\n            }\n\n            @Override\n            public void onFailure(Call&lt;R&gt; call, Throwable t) {\n              future.completeExceptionally(t);\n            }\n          });\n\n      return future;\n    }\n  }\n\n// \u5927\u90e8\u5206\u540c\u4e0a\uff0c\u8fd9\u91cc\u53ea\u4fdd\u7559\u4e86response\u4f5c\u4e3a\u7ed3\u679c\u3002\n  private static final class ResponseCallAdapter&lt;R&gt;\n      implements CallAdapter&lt;R, CompletableFuture&lt;Response&lt;R&gt;&gt;&gt; {\n    private final Type responseType;\n    @Override\n    public CompletableFuture&lt;Response&lt;R&gt;&gt; adapt(final Call&lt;R&gt; call) {\n      call.enqueue(\n          new Callback&lt;R&gt;() {\n            @Override\n            public void onResponse(Call&lt;R&gt; call, Response&lt;R&gt; response) {\n              future.complete(response);\n            }\n          });\n      return future;\n    }\n  }\n}\n</code></pre></p>"},{"location":"Android/Retrofit/#callfactory","title":"CallFactory","text":"<p>\u5728\u8fd9\u91cc\u5148\u5f97\u8bf4\u5b83\u548cOkHttp\u7684\u5173\u7cfb\u662f\u591a\u4e48\u7d27\u5bc6\u3002</p>"},{"location":"Android/Retrofit/#okhttp","title":"OkHttp\u5173\u8054","text":"<p>\u867d\u7136\u5b83\u6709<code>retrofit2.Call</code>\uff0c\u5176\u5728<code>retroft</code>\u4e2d\u7684\u5185\u7f6e\u5b9e\u73b0\u5176\u5b9e\u662f<code>OkHttpCall</code>\u987e\u540d\u601d\u4e49\uff0c\u7528OkHttp\u5b9e\u73b0\u4e86<code>retrofit2.Call</code>\uff0c\u6b64\u5b9e\u73b0\u662f\u65e0\u6cd5\u88ab\u66ff\u6362\u7684\u3002\u6211\u4eec\u80fd\u66ff\u6362\u7684\u53ea\u6709<code>okhttp3.Call.Factory</code>\uff0c\u5b83\u5b9a\u4e49\u5982\u4e0b\uff1a <pre><code>  interface Factory {\n    Call newCall(Request request);\n  }\n</code></pre> \u5373\u6211\u4eec\u9700\u8981\u8fd9\u4e9bOkHttp\u7684\u7c7b\u6765\u6784\u9020\u4e00\u4e2a<code>okhttp</code>\u7684<code>Call</code>\u63a5\u53e3\u5b9e\u73b0\uff0c\u4ee5\u6b64\u5b9e\u73b0\u81ea\u5b9a\u4e49\u8bf7\u6c42\u8fc7\u7a0b\u3002\u800c<code>okhttp.OkHttpClient</code>\u5b9e\u73b0\u4e86<code>Call.Factory</code>\u7531\u6b64\u6211\u4eec\u66ff\u6362\u65f6\uff0c\u5f80\u5f80\u53ea\u9700\u8981\u6784\u9020\u4e00\u4e2a\u81ea\u5b9a\u4e49\u914d\u7f6e\u7684<code>OkHttpClient</code>\u6765\u66ff\u6362\u5373\u53ef\uff0c\u4e00\u822c\u4e0d\u9700\u8981\u6df1\u5ea6\u91cd\u65b0\u5b9e\u73b0<code>okhttp.Call</code>\u3002</p>"},{"location":"Android/Retrofit/#converter","title":"Converter","text":"<p>\u5982\u4e0a\u9762\u6240\u8bf4\uff0c\u5bf9\u4e8e\u4e0d\u53ef\u66ff\u6362\u7684<code>OkHttpCall</code>\uff0c\u5b83\u4f7f\u7528<code>okhttp</code>\u7684\u7c7b\u6765\u62bd\u8c61\u8bf7\u6c42\u8bbf\u95ee\u548c\u6570\u636e\u54cd\u5e94\u3002\u6b64\u8fc7\u7a0b\u5bf9\u5e94<code>okhttp</code>\u5185\u7684<code>Request</code>\u548c<code>Response</code>\u3002\u8fd9\u4e24\u8005\u81ea\u8eab\u6ca1\u6709\u4efb\u4f55\u5bf9\u7ed3\u6784\u5316\u6570\u636e\u7684\u652f\u6301\uff0c\u8fd9\u91cc\u9700\u8981\u5de5\u5177\u5c01\u88c5\u3002\u5728<code>retrofit</code>\u4e2d\uff0c\u4fbf\u662f\u901a\u8fc7<code>Converter</code>\u63a5\u53e3\u3002\u5728\u81ea\u5b9a\u4e49\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u63d0\u4f9b<code>Converter.Factory</code>\u7684\u5b50\u7c7b\u5373\u53ef\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>    /**\n     * Returns a {@link Converter} for converting an HTTP response body to {@code type}, or null if\n     * {@code type} cannot be handled by this factory. This is used to create converters for\n     * response types such as {@code SimpleResponse} from a {@code Call&lt;SimpleResponse&gt;}\n     * declaration.\n     */\n    public @Nullable Converter&lt;ResponseBody, ?&gt; responseBodyConverter(\n        Type type, Annotation[] annotations, Retrofit retrofit) {\n      return null;\n    }\n\n    /**\n     * Returns a {@link Converter} for converting {@code type} to an HTTP request body, or null if\n     * {@code type} cannot be handled by this factory. This is used to create converters for types\n     * specified by {@link Body @Body}, {@link Part @Part}, and {@link PartMap @PartMap} values.\n     */\n    public @Nullable Converter&lt;?, RequestBody&gt; requestBodyConverter(\n        Type type,\n        Annotation[] parameterAnnotations,\n        Annotation[] methodAnnotations,\n        Retrofit retrofit) {\n      return null;\n    }\n</code></pre> \u5373\u8fd4\u56de\u7a7a\u4ee3\u8868\u6ca1\u6cd5\u8f6c\u6362\u3002\u5bf9\u4e8eRetrofit\u53ef\u4ee5\u6dfb\u52a0\u4e00\u7ec4<code>Converter.Factory</code>\u7531\u6b64\u53ef\u4ee5\u5411\u4e0b\u7ee7\u7eed\u67e5\u8be2\u3002</p>"},{"location":"Android/Retrofit/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>retrofit github</li> </ul>"},{"location":"Android/Shared%20Preference/","title":"Shared Preferences","text":"<p>\u5b83\u662f\u4e00\u4e2a\u4ee5XML\u683c\u5f0f\u63d0\u4f9b\u6301\u4e45\u5316KV\u5b58\u50a8\u7684\u5b89\u5353\u6846\u67b6\u5185\u7f6e\u65b9\u6848\u3002</p> <p>\u5b83\u7531<code>ContextImpl</code>\u8d1f\u8d23\u521b\u5efa\uff0c\u8fdb\u7a0b\u5185\u6bcf\u4e2a<code>SharedPreference</code>\u6587\u4ef6\u90fd\u4f1a\u5bf9\u5e94\u4e00\u4e2a<code>SharedPrefences</code>\u5b9e\u4f8b\u3002\u7531\u6b64\u53ef\u4ee5\u8bf4\uff0c<code>SharedPrefencesImpl</code>\u5b9e\u4f8b\u5728\u8fdb\u7a0b\u5185\u548c\u6587\u4ef6\u4e00\u5bf9\u4e00\u5b58\u5728\u3002\u5b83\u591a\u8fdb\u7a0b\u4e0b\u65e0\u6cd5\u4fdd\u8bc1\u5b89\u5168\u3002\u5b98\u65b9\u5efa\u8bae\u7684\u8de8\u8fdb\u7a0b\u8bbf\u95ee\u9700\u8981\u4f7f\u7528<code>ContentProvider</code>\uff0c\u7531\u6b64\uff0c\u5b83\u7684mode\u53c2\u6570\u5df2\u7ecf\u57fa\u672c\u65e0\u610f\u4e49\u3002</p>"},{"location":"Android/Shared%20Preference/#_1","title":"\u5de5\u4f5c\u673a\u7406","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4e3b\u8981\u8ba8\u8bba\u7684\u662f\u8bfb\u53d6\u78c1\u76d8\u3001\u548c\u5199\u5165\u78c1\u76d8\u8fc7\u7a0b\u3002\u5982\u540c\u5f88\u591a\u6d89\u53ca\u6587\u4ef6\u4fee\u6539\u5b58\u50a8\u6240\u7528\u7684\u6280\u5de7\u4e00\u6837\uff0csp\u4f1a\u6709\u4e00\u4efd\u5907\u4efd\u6587\u4ef6\uff0c\u7528\u4e8e\u786e\u4fdd\u5199\u5165\u4e8b\u52a1\u80fd\u539f\u5b50\u5b8c\u6210\u3002\u6b64\u6280\u5de7\u5f80\u5f80\u662f\u5728\u5f00\u59cb\u5199\u5165\u6587\u4ef6\u6570\u636e\u524d\uff0c\u5148\u5bf9\u65e7\u6587\u4ef6\u91cd\u547d\u540d\u3002\u56e0\u4e3a\u91cd\u547d\u540d\u662f\u8db3\u591f\u5feb\u7684\uff0c\u6b64\u65f6\u518d\u8fdb\u884c\u8017\u65f6\u7684\u5199\u5165\u65b0\u6587\u4ef6\u8fc7\u7a0b\u3002\u5982\u679c\u5199\u5165\u6210\u529f\uff0c\u6b64\u65f6\u4f1a\u62e5\u6709\u4e24\u4e2a\u6587\u4ef6\uff0c\u4fbf\u518d\u5220\u9664\u65e7\u7684\u91cd\u547d\u540d\u7684\u6587\u4ef6\u5373\u53ef\u3002\u82e5\u5199\u5165\u5931\u8d25\uff0c\u5219\u8fd9\u4efd\u91cd\u547d\u540d\u7684\u65e7\u6587\u4ef6\u5c06\u4f5c\u4e3a\u6062\u590d\u70b9\uff0c\u5373\u65e0\u8bba\u5982\u4f55\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u6574\u4e2a\u6587\u4ef6\u5904\u4e8e\u4e0d\u5b8c\u6574\u7684\u4fee\u6539\u72b6\u6001\uff0c\u6bd4\u5982\u82e5\u5728\u76f4\u63a5\u5bf9\u539f\u6587\u4ef6\u66f4\u65b0\uff0c\u66f4\u65b0\u4e86\u4e00\u534a\u540e\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u6587\u4ef6\u4f1a\u5904\u4e8e\u4e0d\u53ef\u9884\u6599\u7684\u72b6\u6001\u3002</p> <p>\u5728\u6784\u5efa\u65f6\u4f1a\u4ece\u78c1\u76d8\u8bfb\u53d6\uff0c\u82e5\u5907\u4efd\u6587\u4ef6\u5b58\u5728\uff0c\u8bf4\u660e\u4e4b\u524d\u7684\u5199\u5165\u662f\u5931\u8d25\u7684\u3002\u56e0\u4e3a\u6210\u529f\u7684\u5199\u5165\u4f1a\u4ee5\u5220\u9664\u5907\u4efd\u6587\u4ef6\u4f5c\u4e3a\u7ed3\u675f\u3002\u6b64\u65f6\uff0c\u4f1a\u5220\u9664\u539f\u6587\u4ef6\uff0c\u5e76\u628a\u5907\u4efd\u6587\u4ef6\u91cd\u547d\u540d\u4e3a\u539f\u6587\u4ef6\u3002</p> <p>\u5728\u5199\u5165\u4efb\u52a1\u65f6\uff0c\u4f1a\u5148\u628a\u539f\u6587\u4ef6\u91cd\u547d\u540d\u4e3a\u5907\u4efd\u6587\u4ef6\u540d\uff0c\u7136\u540e\u4ee5\u6700\u65b0\u7684map\u6570\u636e\u5199\u5165\u539f\u6587\u4ef6\uff08\u6b64\u65f6\u610f\u5473\u7740\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u540d\u5b57\u548c\u539f\u6587\u4ef6\u540d\u76f8\u540c\uff09\u3002\u6210\u529f\u540e\u518d\u5220\u9664\u5907\u4efd\u6587\u4ef6\u5373\u53ef\u3002\u7531\u6b64\u7ed3\u5408\u4e0a\u9762\u6240\u8ff0\u903b\u8f91\uff0c\u53ef\u4ee5\u786e\u4fdd\u5bf9\u6587\u4ef6\u7684\u66f4\u6539\u662f\u539f\u5b50\u6027\u7684\u3002</p> <p>sp\u4f7f\u7528\u4e86\u5f88\u591asynchronize\u4ee3\u7801\u5757\uff08\u4e0d\u662f\u76f4\u63a5\u4fee\u9970\u65b9\u6cd5\uff09\uff0c\u6765\u786e\u4fdd\u591a\u7ebf\u7a0b\u540c\u6b65\u3002\u6b64\u5916\uff0capply\u548ccommit\u5206\u522b\u5f02\u6b65/\u540c\u6b65\u628a\u53d8\u66f4\u5199\u56de\u5230\u6587\u4ef6\u3002</p>"},{"location":"Android/Shared%20Preference/#_2","title":"\u62d3\u5c55\u9605\u8bfb","text":""},{"location":"Android/TextureView%2C%20SurfaceView/","title":"TextureView, SurfaceView","text":""},{"location":"Android/TextureView%2C%20SurfaceView/#_1","title":"\u6982\u8ff0","text":"<p><code>TextureView</code>\u548c<code>SurfaceView</code>\u4e3b\u8981\u7528\u4e8e\u63d0\u4f9b\u4ee5\u66f4\u4f4e\u7ea7\u7684<code>OpenGLES</code>\u65b9\u5f0f\u8fdb\u884c\u6e32\u67d3\u3002\u5f53\u7136\uff0c\u6709\u65f6\u5019\u5bf9<code>OpenGLES</code>\u7684\u8c03\u7528\u5e76\u4e0d\u5b8c\u5168\u5904\u5728<code>Java</code>\u4fa7\uff0c\u66f4\u5e38\u89c1\u662f\u5728<code>jni</code>\u7684\u5f15\u5165\u4e86<code>ndk</code>\u7684<code>native</code>\u4fa7\u3002\u800c<code>TextureView</code>\u548c<code>SurfaceView</code>\u4e3b\u8981\u533a\u522b\u5728\u4e8e\u5728View tree\u4e2d\u7684\u7ed8\u5236\u5dee\u5f02\u3002\u5b83\u4eec\u5747\u53ef\u4ee5\u5728UI\u7ebf\u7a0b\u3001\u6216\u72ec\u7acb\u7684\u6e32\u67d3\u7ebf\u7a0b\u901a\u8fc7<code>OpenGLES</code>\u66f4\u65b0\u7ed8\u5236\u3002</p>"},{"location":"Android/TextureView%2C%20SurfaceView/#textureview","title":"TextureView","text":"<p><code>TextureView</code>\u5bf9SurfaceTexture\u7684\u7ed8\u5236\u662f\u4f1a\u88ab\u6dfb\u52a0\u5728View tree\u4e2d\u6240\u6e32\u67d3\u7684\u3002UI\u7ebf\u7a0b\u3001\u72ec\u7acb\u6e32\u67d3\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u901a\u8fc7<code>OpenGLES</code>\u66f4\u65b0\u7ed8\u5236\u3002\u6b64\u5916\u6b64\u65b9\u5f0f\u53ea\u80fd\u5728\u786c\u4ef6\u52a0\u901f\u6a21\u5f0f\u4e0b\u7684window\u9002\u7528\u3002</p>"},{"location":"Android/TextureView%2C%20SurfaceView/#surfaceview","title":"SurfaceView","text":"<p><code>SurfaceView</code>\u5bf9SurfaceTexture\u7684\u7ed8\u5236\u4e00\u822c\u662f\u8131\u79bbView tree\u7684\uff0c\u9ed8\u8ba4\u7684<code>SurfaceView</code>\u7684<code>onDraw</code>\u91cc\uff0c<code>canvas</code>\u4f1a\u5728\u6b64view\u7684\u533a\u57df\u6316\u7a7a\u6389\u3002\u4e0d\u505a\u7ed8\u5236\u3002\u6b64\u5916\uff0c<code>SurfaceView</code>\u4f1a\u5bf9\u5e94\u4e00\u4e2a\u72ec\u7acb\u7684Surface\uff0c\u548c<code>ViewRootImpl</code>\u6240\u6301\u6709\u7684\u5404\u81ea\u72ec\u7acb\u3002\u7531\u6b64\uff0c\u5b83\u4e00\u822c\u7528\u4f5c\u72ec\u7acb\u7ebf\u7a0b\u8fdb\u884c\u6e32\u67d3\u3002</p> <p>\u4e00\u822c\u5c42\u7ea7\u4e0a\u548c<code>ViewRootImpl</code>\u7684\u5173\u7cfb\u5c3d\u53ef\u80fd\u7b80\u5355\u3002\u8981\u4e48\u5728\u5176\u4e0a\uff08\u901a\u8fc7<code>setZOrderTop(true)</code>\uff0c\u8981\u4e48\u5728\u5176\u4e0b\uff08\u9ed8\u8ba4\uff09\u3002\u8fd9\u4e5f\u662f\u4e3a\u4f55<code>SurfaceView</code>\u5728<code>onDraw</code>\u4e2d\u5bf9View tree\u5143\u7d20\u4e0a\u7684\u7ed8\u5236\u64cd\u4f5c\u662f\u6316\u6d1e\u3002\u8fd9\u610f\u5473\u7740\u9ed8\u8ba4\u65f6\u5b83\u5904\u4e8e<code>ViewRootImpl</code>\u7684Surface\u4e4b\u4e0b\uff0c\u4f46\u6b64\u533a\u57df\u53ef\u4ee5\u88ab\u6b63\u786e\u9732\u51fa\u6765\u6240\u770b\u5230\u3002\u4f46\u5982\u679c\u8bbe\u7f6e\u4e86\u80cc\u666f\u8272<code>setBackgroundColor</code>\u6216\u524d\u666f\u3001\u6216\u91cd\u5199\u4e86<code>onDraw</code>\uff0c\u5219\u53ef\u80fd\u4f1a\u4f7f\u5f97<code>SurfaceView</code>\u7684\u533a\u57df\u88ab\u8986\u76d6\u65e0\u6cd5\u53ef\u89c1\u3002</p> <p>\u800c\u5982\u679c<code>setZOrderTop(true)</code>\u540e\uff0c\u5b83\u7684\u533a\u57df\u4f1a\u8986\u76d6<code>ViewRootImpl</code>\uff0c\u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e<code>EGLConfig</code>\uff0c\u6765\u8ba9\u6b64window\u662f\u534a\u900f\u660e\u7684\uff08\u5e26\u900f\u660e\u7ef4\u5ea6\uff09\u3002\u4ece\u800c\u4e5f\u53ef\u4ee5\u8ba9\u6ca1\u6709\u7ed8\u5236\u7684\u533a\u57df\u9732\u51fa\u4e0b\u9762\u7684<code>ViewRootImpl</code>\u3002</p> <p>\u5f53\u5f15\u5165\u4e86\u4e0d\u6b62\u4e00\u4e2a\u7ebf\u7a0b\u6765\u6e32\u67d3\u9875\u9762\u65f6\uff0c\u9875\u9762\u5f80\u5f80\u4f1a\u9762\u4e34\u4e0d\u5c11\u7ebf\u7a0b\u540c\u6b65\u7684\u6311\u6218\u3002\u5bf9\u4e8eSurfaceView\u5c24\u5176\u5982\u6b64\u3002\u6e32\u67d3\u7ebf\u7a0b\u4e4b\u95f4\u65e0\u6cd5\u4fdd\u8bc1\u540c\u6b65\u51e0\u4e4e\u662f\u65e0\u6bd4\u5e38\u89c1\u7684\u60c5\u51b5\u3002\u76ee\u524d\u4e5f\u65e0\u5408\u7406\u7684\u624b\u6bb5\u963b\u6b62\u8fd9\u79cd\u95ee\u9898\u3002</p>"},{"location":"Android/TextureView%2C%20SurfaceView/#opengles","title":"OpenGLES","text":"<p>Java\u4fa7\u64cd\u4f5c<code>OpenGLES</code>\u65f6\uff0c\u4e5f\u6709\u4e00\u5957\u5e38\u89c4\u7684\u987a\u5e8f\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u9700\u8981\u9009\u62e9<code>EGLDisplay</code>, <code>EGLConfig</code>, \u4ece\u800c\u521b\u5efa<code>EGLContext</code>\uff0c\u7136\u540e\u4e00\u822c\u9700\u8981\u521b\u5efa<code>VertextShader</code>, <code>FragmentShader</code>\uff0c\u7f16\u8bd1\u5e76\u94fe\u63a5\u8fd9\u4e24\u7c7b\u7740\u8272\u5668\u3001\u914d\u7f6e\u4f20\u5165\u5c5e\u6027\u3001\u5b9a\u70b9\u3001\u989c\u8272\u6570\u636e\u7f13\u51b2\u3002\u51c6\u5907\u5de5\u4f5c\u5c31\u7eea\u540e\uff0c\u5728\u6e32\u67d3\u5faa\u73af\u4e2d\uff0c\u4e00\u822c\u4f1a\u5148<code>glClearColor</code>\uff0c\u7136\u540e\u66f4\u65b0\u5c5e\u6027\uff0c\u7ed8\u5236\u5b9a\u70b9\uff0c\u66f4\u65b0\u6807\u5fd7\u4f4d<code>glClear</code>\uff0c\u6700\u540e\u63d0\u4ea4<code>eglSwapBuffers</code>\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cwindow\u548ceglContext\u7684\u5173\u7cfb\u662f\u53ef\u4ee5\u591a\u5bf9\u591a\u7684\uff0c\u7531\u6b64\u9700\u8981<code>eglMakeCurrent</code>\u6765\u6307\u5b9a\u5f53\u524d\u7684\u6e32\u67d3\u4e0a\u4e0b\u6587\u3002</p> <p>\u4e3a\u4f55\u9700\u8981\u4e0a\u4e0b\u6587\uff1f\u56e0\u4e3a<code>OpenGL</code>\u57fa\u672c\u662f\u9762\u5411\u201c\u51fd\u6570\u201d\u7684\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u6a21\u5f0f\u4e0b\u5982\u679c\u9700\u8981\u7ef4\u62a4\u4e00\u7cfb\u5217\u73af\u5883\u4fe1\u606f\uff0c\u6bd4\u5982\u5c4f\u5e55\u3001\u7eb9\u7406id\u3001\u5b9a\u70b9Buffer id\u3001\u7740\u8272\u5668id\u3001\u9519\u8bef\u4fe1\u606f\u7b49\u7b49\uff0c\u90fd\u9700\u8981\u5173\u8054\u4e00\u4e2aContext\uff0c\u4ece\u800c\u907f\u514d\u548c\u540c\u8fdb\u7a0b\u91cc\u7684\u5176\u4ed6\u5b9e\u4f8b\u6df7\u6dc6\u3002\u7531\u6b64\uff0c\u4e00\u822c\u9762\u5411\u201d\u51fd\u6570\u201c\u4f1a\u63d0\u4f9b\u4e24\u79cd\u65b9\u5f0f\u89e3\u51b3\uff1a</p> <ul> <li>\u4e0a\u4e0b\u6587\u5b9e\u4f8b\u4f5c\u4e3a\u5165\u53c2\uff08\u4e00\u822c\u662f\u9996\u4e2a\u53c2\u6570\uff09\uff0c\u7c7b\u4f3c\u9762\u5411\u5bf9\u8c61\u4e2d\u9690\u5f0f\u4ee5\"this\"\u4f5c\u4e3a\u9996\u53c2\u3002</li> <li>\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\u660e\u786e\u7ed1\u5b9a\u5f53\u524d\u7684\u4e0a\u4e0b\u6587\u5b9e\u4f8b\u3002\u5e76\u9009\u62e9\u4e00\u5b9a\u7684\u673a\u5236\u8ba9\u5176\u5f97\u5230\u91ca\u653e\u3002</li> </ul> <p><code>OpenGLES</code>\u9009\u62e9\u7684\u662f\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u3002</p>"},{"location":"Android/TextureView%2C%20SurfaceView/#glsurfaceview","title":"GLSurfaceView","text":"<p>\u56e0\u4e3a\u4e0a\u8ff0\u7684<code>OpenGLES</code>\u7684\u64cd\u4f5c\u6d41\u7a0b\u6bd4\u8f83\u56fa\u5b9a\uff0c\u6240\u4ee5\u5b98\u65b9\u5185\u7f6e\u4e86\u4e00\u4e2a<code>GLSurfaceView</code>\u5176\u5df2\u7ecf\u5305\u542b\u4e86<code>GLThread</code>\u548c\u4e0a\u8ff0\u7684\u5927\u90e8\u5206\u529f\u80fd\uff0c\u5e76\u63d0\u4f9b\u4e86<code>Renderer</code>\u63a5\u53e3\uff0c\u65b9\u4fbf\u5916\u90e8\u53ea\u9700\u8981\u5b9e\u73b0<code>Renderer</code>\u5e76<code>setRenderer</code>\u5373\u53ef\u5728\u6e32\u67d3\u65b9\u6cd5\u4e2d\u5b9e\u73b0\u81ea\u5df1\u7684\u6e32\u67d3\u903b\u8f91\u3002</p>"},{"location":"Android/TextureView%2C%20SurfaceView/#textureview_1","title":"\u793a\u4f8b\uff1aTextureView","text":"<pre><code>class MyTextureView @JvmOverloads constructor(\n    context: Context, attrs: AttributeSet? = null\n) : TextureView(context, attrs) {\n\n    init {\n        surfaceTextureListener = object : SurfaceTextureListener {\n            override fun onSurfaceTextureAvailable(\n                surface: SurfaceTexture,\n                width: Int,\n                height: Int\n            ) {\n                RenderThread(surface).start()\n            }\n\n            override fun onSurfaceTextureSizeChanged(\n                surface: SurfaceTexture,\n                width: Int,\n                height: Int\n            ) {\n            }\n\n            override fun onSurfaceTextureDestroyed(surface: SurfaceTexture): Boolean {\n                return true\n            }\n\n            override fun onSurfaceTextureUpdated(surface: SurfaceTexture) {\n                Log.d(\"zrz\", \"update\")\n            }\n\n        }\n    }\n\n    class RenderThread(val surfaceTexture: SurfaceTexture) : Thread() {\n\n        private val config = intArrayOf(\n            EGL_RENDERABLE_TYPE,\n            EGL_OPENGL_ES2_BIT,\n            EGL_RED_SIZE, 8,\n            EGL_GREEN_SIZE, 8,\n            EGL_BLUE_SIZE, 8,\n            EGL_ALPHA_SIZE, 8,\n            EGL_DEPTH_SIZE, 0,\n            EGL_STENCIL_SIZE, 0,\n            EGL_NONE\n        )\n\n        override fun run() {\n            super.run()\n            val egl = EGLContext.getEGL() as EGL10\n            val eglDisplay = egl.eglGetDisplay(EGL_DEFAULT_DISPLAY)\n            egl.eglInitialize(eglDisplay, intArrayOf(0, 0))\n\n            val configsCount = intArrayOf(0);\n            val configs = arrayOfNulls&lt;EGLConfig?&gt;(1);\n            egl.eglChooseConfig(eglDisplay, config, configs, 1, configsCount)\n            val eglConfig = configs[0]!!\n\n            val eglContext = egl.eglCreateContext(\n                eglDisplay,\n                eglConfig,\n                EGL_NO_CONTEXT,\n                intArrayOf(EGL_CONTEXT_CLIENT_VERSION, 2, EGL_NONE)\n            )\n            val startTime = System.currentTimeMillis()\n            val eglSurface = egl.eglCreateWindowSurface(eglDisplay, eglConfig, surfaceTexture, null)\n            while (egl.eglGetError() == EGL_SUCCESS) {\n                egl.eglMakeCurrent(eglDisplay, eglSurface, eglSurface, eglContext)\n                val time = (System.currentTimeMillis() - startTime) * 0.001f\n                Log.d(\"zrz\", \"$time, ${sin(time + 0f)}\")\n                GLES20.glClearColor(\n                    abs(sin(0f + time)),\n                    abs(sin(1f + time)),\n                    abs(sin(2f + time)),\n                    1f\n                )\n                GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT)\n                egl.eglSwapBuffers(eglDisplay, eglSurface)\n                sleep(10)\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"Android/TextureView%2C%20SurfaceView/#glsurfaceview_1","title":"\u793a\u4f8b\uff1aGLSurfaceView","text":"<pre><code>class MySurfaceView @JvmOverloads constructor(\n    context: Context, attrs: AttributeSet? = null\n) : GLSurfaceView(context, attrs) {\n\n\n    init {\n        setEGLContextClientVersion(2)\n        setZOrderOnTop(true)\n        val holder = holder\n        setEGLConfigChooser( 8, 8, 8, 8, 16, 0 )\n        holder.setFormat(PixelFormat.RGBA_8888)\n        setRenderer(MyRendererFromLesson1())\n    }\n}\n\n\npublic class MyRendererFromLesson1 implements GLSurfaceView.Renderer {\n    /**\n     * Store the model matrix. This matrix is used to move models from object space (where each model can be thought\n     * of being located at the center of the universe) to world space.\n     */\n    private float[] mModelMatrix = new float[16];\n\n    /**\n     * Store the view matrix. This can be thought of as our camera. This matrix transforms world space to eye space;\n     * it positions things relative to our eye.\n     */\n    private float[] mViewMatrix = new float[16];\n\n    /**\n     * Store the projection matrix. This is used to project the scene onto a 2D viewport.\n     */\n    private float[] mProjectionMatrix = new float[16];\n\n    /**\n     * Allocate storage for the final combined matrix. This will be passed into the shader program.\n     */\n    private float[] mMVPMatrix = new float[16];\n\n    /**\n     * Store our model data in a float buffer.\n     */\n    private final FloatBuffer mTriangle1Vertices;\n    private final FloatBuffer mTriangle2Vertices;\n    private final FloatBuffer mTriangle3Vertices;\n\n    /**\n     * This will be used to pass in the transformation matrix.\n     */\n    private int mMVPMatrixHandle;\n\n    /**\n     * This will be used to pass in model position information.\n     */\n    private int mPositionHandle;\n\n    /**\n     * This will be used to pass in model color information.\n     */\n    private int mColorHandle;\n\n    /**\n     * How many bytes per float.\n     */\n    private final int mBytesPerFloat = 4;\n\n    /**\n     * How many elements per vertex.\n     */\n    private final int mStrideBytes = 7 * mBytesPerFloat;\n\n    /**\n     * Offset of the position data.\n     */\n    private final int mPositionOffset = 0;\n\n    /**\n     * Size of the position data in elements.\n     */\n    private final int mPositionDataSize = 3;\n\n    /**\n     * Offset of the color data.\n     */\n    private final int mColorOffset = 3;\n\n    /**\n     * Size of the color data in elements.\n     */\n    private final int mColorDataSize = 4;\n\n    /**\n     * Initialize the model data.\n     */\n    public MyRendererFromLesson1() {\n        // Define points for equilateral triangles.\n\n        // This triangle is red, green, and blue.\n        final float[] triangle1VerticesData = {\n                // X, Y, Z,\n                // R, G, B, A\n                -0.5f, -0.25f, 0.0f,\n                1.0f, 0.0f, 0.0f, 1.0f,\n\n                0.5f, -0.25f, 0.0f,\n                0.0f, 0.0f, 1.0f, 1.0f,\n\n                0.0f, 0.559016994f, 0.0f,\n                0.0f, 1.0f, 0.0f, 1.0f};\n\n        // This triangle is yellow, cyan, and magenta.\n        final float[] triangle2VerticesData = {\n                // X, Y, Z,\n                // R, G, B, A\n                -0.5f, -0.25f, 0.0f,\n                1.0f, 1.0f, 0.0f, 1.0f,\n\n                0.5f, -0.25f, 0.0f,\n                0.0f, 1.0f, 1.0f, 1.0f,\n\n                0.0f, 0.559016994f, 0.0f,\n                1.0f, 0.0f, 1.0f, 1.0f};\n\n        // This triangle is white, gray, and black.\n        final float[] triangle3VerticesData = {\n                // X, Y, Z,\n                // R, G, B, A\n                -0.5f, -0.25f, 0.0f,\n                1.0f, 1.0f, 1.0f, 1.0f,\n\n                0.5f, -0.25f, 0.0f,\n                0.5f, 0.5f, 0.5f, 1.0f,\n\n                0.0f, 0.559016994f, 0.0f,\n                0.0f, 0.0f, 0.0f, 1.0f};\n\n        // Initialize the buffers.\n        mTriangle1Vertices = ByteBuffer.allocateDirect(triangle1VerticesData.length * mBytesPerFloat)\n                .order(ByteOrder.nativeOrder()).asFloatBuffer();\n        mTriangle2Vertices = ByteBuffer.allocateDirect(triangle2VerticesData.length * mBytesPerFloat)\n                .order(ByteOrder.nativeOrder()).asFloatBuffer();\n        mTriangle3Vertices = ByteBuffer.allocateDirect(triangle3VerticesData.length * mBytesPerFloat)\n                .order(ByteOrder.nativeOrder()).asFloatBuffer();\n\n        mTriangle1Vertices.put(triangle1VerticesData).position(0);\n        mTriangle2Vertices.put(triangle2VerticesData).position(0);\n        mTriangle3Vertices.put(triangle3VerticesData).position(0);\n    }\n\n    @Override\n    public void onSurfaceCreated(GL10 glUnused, EGLConfig config) {\n        // Set the background clear color to gray.\n//        GLES20.glClearColor(0.5f, 0.5f, 0.5f, 0.5f);\n\n        // Position the eye behind the origin.\n        final float eyeX = 0.0f;\n        final float eyeY = 0.0f;\n        final float eyeZ = 1.5f;\n\n        // We are looking toward the distance\n        final float lookX = 0.0f;\n        final float lookY = 0.0f;\n        final float lookZ = -5.0f;\n\n        // Set our up vector. This is where our head would be pointing were we holding the camera.\n        final float upX = 0.0f;\n        final float upY = 1.0f;\n        final float upZ = 0.0f;\n\n        // Set the view matrix. This matrix can be said to represent the camera position.\n        // NOTE: In OpenGL 1, a ModelView matrix is used, which is a combination of a model and\n        // view matrix. In OpenGL 2, we can keep track of these matrices separately if we choose.\n        Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, lookX, lookY, lookZ, upX, upY, upZ);\n\n        final String vertexShader =\n                \"uniform mat4 u_MVPMatrix;      \\n\"        // A constant representing the combined model/view/projection matrix.\n\n                        + \"attribute vec4 a_Position;     \\n\"        // Per-vertex position information we will pass in.\n                        + \"attribute vec4 a_Color;        \\n\"        // Per-vertex color information we will pass in.\n\n                        + \"varying vec4 v_Color;          \\n\"        // This will be passed into the fragment shader.\n\n                        + \"void main()                    \\n\"        // The entry point for our vertex shader.\n                        + \"{                              \\n\"\n                        + \"   v_Color = a_Color;          \\n\"        // Pass the color through to the fragment shader.\n                        // It will be interpolated across the triangle.\n                        + \"   gl_Position =    \\n\"    // gl_Position is a special variable used to store the final position.\n                        + \"               a_Position;   \\n\"     // Multiply the vertex by the matrix to get the final point in\n                        + \"}                              \\n\";    // normalized screen coordinates.\n\n        final String fragmentShader =\n                \"precision mediump float;       \\n\"        // Set the default precision to medium. We don't need as high of a\n                        // precision in the fragment shader.\n                        + \"varying vec4 v_Color;          \\n\"        // This is the color from the vertex shader interpolated across the\n                        // triangle per fragment.\n                        + \"void main()                    \\n\"        // The entry point for our fragment shader.\n                        + \"{                              \\n\"\n                        + \"   gl_FragColor = v_Color;     \\n\"        // Pass the color directly through the pipeline.\n                        + \"}                              \\n\";\n\n        // Load in the vertex shader.\n        int vertexShaderHandle = GLES20.glCreateShader(GLES20.GL_VERTEX_SHADER);\n\n        if (vertexShaderHandle != 0) {\n            // Pass in the shader source.\n            GLES20.glShaderSource(vertexShaderHandle, vertexShader);\n\n            // Compile the shader.\n            GLES20.glCompileShader(vertexShaderHandle);\n\n            // Get the compilation status.\n            final int[] compileStatus = new int[1];\n            GLES20.glGetShaderiv(vertexShaderHandle, GLES20.GL_COMPILE_STATUS, compileStatus, 0);\n\n            // If the compilation failed, delete the shader.\n            if (compileStatus[0] == 0) {\n                GLES20.glDeleteShader(vertexShaderHandle);\n                vertexShaderHandle = 0;\n            }\n        }\n\n        if (vertexShaderHandle == 0) {\n            throw new RuntimeException(\"Error creating vertex shader.\");\n        }\n\n        // Load in the fragment shader shader.\n        int fragmentShaderHandle = GLES20.glCreateShader(GLES20.GL_FRAGMENT_SHADER);\n\n        if (fragmentShaderHandle != 0) {\n            // Pass in the shader source.\n            GLES20.glShaderSource(fragmentShaderHandle, fragmentShader);\n\n            // Compile the shader.\n            GLES20.glCompileShader(fragmentShaderHandle);\n\n            // Get the compilation status.\n            final int[] compileStatus = new int[1];\n            GLES20.glGetShaderiv(fragmentShaderHandle, GLES20.GL_COMPILE_STATUS, compileStatus, 0);\n\n            // If the compilation failed, delete the shader.\n            if (compileStatus[0] == 0) {\n                GLES20.glDeleteShader(fragmentShaderHandle);\n                fragmentShaderHandle = 0;\n            }\n        }\n\n        if (fragmentShaderHandle == 0) {\n            throw new RuntimeException(\"Error creating fragment shader.\");\n        }\n\n        // Create a program object and store the handle to it.\n        int programHandle = GLES20.glCreateProgram();\n\n        if (programHandle != 0) {\n            GLES20.glAttachShader(programHandle, vertexShaderHandle);\n            GLES20.glAttachShader(programHandle, fragmentShaderHandle);\n\n            // Bind attributes\n            GLES20.glBindAttribLocation(programHandle, 0, \"a_Position\");\n            GLES20.glBindAttribLocation(programHandle, 1, \"a_Color\");\n            GLES20.glLinkProgram(programHandle);\n\n            // Get the link status.\n            final int[] linkStatus = new int[1];\n            GLES20.glGetProgramiv(programHandle, GLES20.GL_LINK_STATUS, linkStatus, 0);\n\n            // If the link failed, delete the program.\n            if (linkStatus[0] == 0) {\n                GLES20.glDeleteProgram(programHandle);\n                programHandle = 0;\n            }\n        }\n\n        if (programHandle == 0) {\n            throw new RuntimeException(\"Error creating program.\");\n        }\n\n        // Set program handles. These will later be used to pass in values to the program.\n        mMVPMatrixHandle = GLES20.glGetUniformLocation(programHandle, \"u_MVPMatrix\");\n        mPositionHandle = GLES20.glGetAttribLocation(programHandle, \"a_Position\");\n        mColorHandle = GLES20.glGetAttribLocation(programHandle, \"a_Color\");\n\n        // Tell OpenGL to use this program when rendering.\n        GLES20.glUseProgram(programHandle);\n    }\n\n    @Override\n    public void onSurfaceChanged(GL10 glUnused, int width, int height) {\n        // Set the OpenGL viewport to the same size as the surface.\n        GLES20.glViewport(0, 0, width, height);\n\n        // Create a new perspective projection matrix. The height will stay the same\n        // while the width will vary as per aspect ratio.\n        final float ratio = (float) width / height;\n        final float left = -ratio;\n        final float right = ratio;\n        final float bottom = -1.0f;\n        final float top = 1.0f;\n        final float near = 1.0f;\n        final float far = 10.0f;\n\n        Matrix.frustumM(mProjectionMatrix, 0, left, right, bottom, top, near, far);\n    }\n\n    @Override\n    public void onDrawFrame(GL10 glUnused) {\n        GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);\n\n        // Do a complete rotation every 10 seconds.\n        long time = SystemClock.uptimeMillis() % 10000L;\n        float angleInDegrees = (360.0f / 10000.0f) * ((int) time);\n\n        // Draw the triangle facing straight on.\n        Matrix.setIdentityM(mModelMatrix, 0);\n        Matrix.rotateM(mModelMatrix, 0, angleInDegrees, 0.0f, 0.0f, 1.0f);\n        drawTriangle(mTriangle1Vertices);\n\n        // Draw one translated a bit down and rotated to be flat on the ground.\n        Matrix.setIdentityM(mModelMatrix, 0);\n        Matrix.translateM(mModelMatrix, 0, 0.0f, -1.0f, 0.0f);\n        Matrix.rotateM(mModelMatrix, 0, 90.0f, 1.0f, 0.0f, 0.0f);\n        Matrix.rotateM(mModelMatrix, 0, angleInDegrees, 0.0f, 0.0f, 1.0f);\n        drawTriangle(mTriangle2Vertices);\n\n        // Draw one translated a bit to the right and rotated to be facing to the left.\n        Matrix.setIdentityM(mModelMatrix, 0);\n        Matrix.translateM(mModelMatrix, 0, 1.0f, 0.0f, 0.0f);\n        Matrix.rotateM(mModelMatrix, 0, 90.0f, 0.0f, 1.0f, 0.0f);\n        Matrix.rotateM(mModelMatrix, 0, angleInDegrees, 0.0f, 0.0f, 1.0f);\n        drawTriangle(mTriangle3Vertices);\n    }\n\n    /**\n     * Draws a triangle from the given vertex data.\n     *\n     * @param aTriangleBuffer The buffer containing the vertex data.\n     */\n    private void drawTriangle(final FloatBuffer aTriangleBuffer) {\n        // Pass in the position information\n        aTriangleBuffer.position(mPositionOffset);\n        GLES20.glVertexAttribPointer(mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, false,\n                mStrideBytes, aTriangleBuffer);\n\n        GLES20.glEnableVertexAttribArray(mPositionHandle);\n\n        // Pass in the color information\n        aTriangleBuffer.position(mColorOffset);\n        GLES20.glVertexAttribPointer(mColorHandle, mColorDataSize, GLES20.GL_FLOAT, false,\n                mStrideBytes, aTriangleBuffer);\n\n        GLES20.glEnableVertexAttribArray(mColorHandle);\n\n        // This multiplies the view matrix by the model matrix, and stores the result in the MVP matrix\n        // (which currently contains model * view).\n        Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);\n\n        // This multiplies the modelview matrix by the projection matrix, and stores the result in the MVP matrix\n        // (which now contains model * view * projection).\n        Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);\n\n        GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);\n        GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, 3);\n    }\n}\n</code></pre>"},{"location":"Android/TextureView%2C%20SurfaceView/#surfaceview-jni","title":"\u793a\u4f8b\uff1aSurfaceView jni \u76f4\u63a5\u5199\u5165\u50cf\u7d20\u6570\u636e","text":"<p><pre><code>#include &lt;jni.h&gt;\n#include &lt;android/log.h&gt;\n#include &lt;android/native_window.h&gt;\n#include &lt;android/native_window_jni.h&gt;\n#include &lt;android/rect.h&gt;\n#include &lt;memory&gt;\n\nbool _checkException(JNIEnv *env) {\n    if (!env) {\n        return false;\n    }\n    if (env-&gt;ExceptionCheck()) {\n        env-&gt;ExceptionDescribe();\n        env-&gt;ExceptionClear();\n        return true;\n    }\n    return false;\n}\n\nextern \"C\" jint\nJava_me_zrz_eglplayground_SurfaceNative_00024Companion_onSurfaceCreated(JNIEnv *env,\n                                                                        jobject thiz,\n                                                                        jobject holder) {\n    jclass clz = env-&gt;GetObjectClass(holder);\n    jmethodID methodId = env-&gt;GetMethodID(clz, \"getSurface\", \"()Landroid/view/Surface;\");\n    if (_checkException(env)) {\n        __android_log_print(ANDROID_LOG_DEBUG, \"zrz\", \"failed to get method id\");\n        return -1;\n    }\n    jobject surface = env-&gt;CallObjectMethod(holder, methodId);\n    ANativeWindow *window = ANativeWindow_fromSurface(env, surface);\n    __android_log_print(ANDROID_LOG_DEBUG, \"zrz\", \"width: %d, height: %d\",\n                        ANativeWindow_getWidth(window), ANativeWindow_getHeight(window));\n\n    ARect *dirty = new ARect();\n    dirty-&gt;left = 100;\n    dirty-&gt;top = 100;\n    dirty-&gt;bottom = 500;\n    dirty-&gt;right = 400;\n    ANativeWindow_Buffer buf = {0};\n    int32_t err;\n    err = ANativeWindow_lock(window, &amp;buf, nullptr);\n    if (err != 0) {\n        __android_log_print(ANDROID_LOG_DEBUG, \"zrz\", \"failed to lock.\");\n        return err;\n    }\n    __android_log_print(ANDROID_LOG_DEBUG, \"zrz\", \"buf{format: %d, w: %d, h: %d, stride: %d} \",\n                        buf.format, buf.width,\n                        buf.height, buf.stride);\n\n    uint8_t *bits = (uint8_t *) buf.bits;\n    for (int row = 0; row &lt; buf.height; row++) {\n        for (int col = 0; col &lt; buf.stride; col++) {\n            *bits = col&amp;0xff;\n            bits++;\n            *bits = row&amp;0xff;\n            bits++;\n            *bits = rand()&amp;0xff;\n            bits++;\n        }\n    }\n    err = ANativeWindow_unlockAndPost(window);\n\n    if (err != 0) {\n        __android_log_print(ANDROID_LOG_DEBUG, \"zrz\", \"failed to unlock.\");\n        return err;\n    }\n\n    return 0;\n}\n</code></pre> \u7f16\u8bd1\u65f6\uff0c\u9700\u8981\u5728<code>target_link_libraries</code>\u4e2d\u6dfb\u52a0<code>-landroid</code>\uff0c\u5982\u679cminSdkVersion\u591f\u9ad8\uff0c\u4e5f\u53ef\u4ee5<code>-lnativewindow</code>\u3002</p>"},{"location":"Android/UUID/","title":"UUID","text":"<p>\u5bf9\u4e8e\u53ea\u9700\u8981\u5728\u201c\u5b89\u88c5\u5468\u671f\u201d\u5185\u552f\u4e00\u7684id\uff0c\u4f7f\u7528UUID\u5373\u53ef\u3002 <pre><code>UUID.randomUUID()\n</code></pre></p> <p>\u5bf9\u4e8e\u9700\u8981\u5728\u201c\u8bbe\u5907\u5468\u671f\u201d\u5185\u552f\u4e00\u7684id(\u5373\u9664\u4e86\u6062\u590d\u51fa\u5382\u8bbe\u7f6e\u65f6\u4f1a\u91cd\u7f6e\u7684id\uff09\uff0c\u4f7f\u7528SSAID\u3002 <pre><code>String androidId = Settings.Secure.getString(getContentResolver(),\n                     Settings.Secure.ANDROID_ID);\n</code></pre> \u6b64id\u66f4\u9002\u5408\u914d\u7f6e\u5b9e\u9a8c\u548c\u9ed1\u767d\u540d\u5355\u7b49\u3002</p> <p></p>"},{"location":"Android/UUID/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>\u6700\u4f73\u5b9e\u8df5</li> <li>5\u79cd\u65b9\u6cd5</li> <li>UUID</li> <li>SSAID</li> </ul>"},{"location":"Android/ViewModel/","title":"ViewModel","text":"<p>ViewModel\u7528\u4e8e\u89e3\u51b3Activity/Fragment\uff08\u4f9d\u9644\u4e8eActivity\uff09\u5728<code>ConfigurationChanged</code>\u6216\u7cfb\u7edf\u9500\u6bc1\u3001\u81ea\u52a8\u6062\u590d\u65f6\uff0c\u8de8\u5b9e\u4f8b\u573a\u666f\u4e0b\uff0c\u8ba9\u6570\u636e\u5f97\u5230\u66f4\u597d\u6301\u4e45\u5316\u7684\u65b9\u6848\u3002\u4f7f\u5176\u5468\u671f\u548c\u201c\u903b\u8f91\u9875\u9762\u201d\u4fdd\u6301\u4e00\u81f4\uff0c\u4ece\u800c\u907f\u514d\u7c7b\u4f3c\u65cb\u8f6c\u4e86\u5c4f\u5e55\u5c31\u4f1a\u5bfc\u81f4\u9875\u9762\u6062\u590d\u521d\u59cb\u6548\u679c\u7684\u60c5\u51b5\u3002\u751f\u547d\u5468\u671f\u5982\u4e0b\u56fe\u8bf4\u660e\uff1a</p> <p></p>"},{"location":"Android/service/","title":"Service","text":""},{"location":"Android/service/#startservice-bindservice","title":"startService, bindService","text":"<p>\u5f53\u9700\u8981\u548cservice\u901a\u4fe1\u7684\u65f6\u5019\uff0c\u4f7f\u7528bind\uff0c\u5982\u679c\u53ea\u662f\u5355\u7eaf\u542f\u52a8\uff0c\u4f7f\u7528start.</p>"},{"location":"Android/service/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Binder IPC\u8bf7\u53c2\u9605\u201c\u5b89\u5353\u201dsection\u3002</li> </ul>"},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/","title":"\u4e8b\u4ef6\u5206\u53d1","text":"<p>\u8f93\u5165\u4e8b\u4ef6\u7684\u5206\u53d1\u662f\u4e2a\u7ecf\u5178\u7684\u8bdd\u9898\u3002\u6211\u5c06\u5b83\u5206\u4e3a\u201c\u5e94\u7528\u8fdb\u7a0b\u5185\u201d\u548c\u201c\u5e94\u7528\u8fdb\u7a0b\u5916\u201d\u6765\u8bf4\u660e\u3002</p>"},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/#_1","title":"\u5e94\u7528\u8fdb\u7a0b\u5185","text":""},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/#_2","title":"\u6982\u8ff0","text":"<p>\u7531\u4e3b\u7ebf\u7a0b\u7684looper\u6536\u5230\u4e8b\u4ef6\u540e\uff0c\u9010\u6b65\u4ea4\u7531<code>ViewRootImpl</code>\u7684<code>inputStage</code>\u5904\u7406\u94fe\u5904\u7406\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4f1a\u7531<code>ViewPostImeInputStage</code>\u6b64\u8282\u70b9\u6765\u5904\u7406\uff1a <pre><code>        private int processPointerEvent(QueuedInputEvent q) {\n            final MotionEvent event = (MotionEvent)q.mEvent;\n            ...\n            boolean handled = mView.dispatchPointerEvent(event);\n            ...\n            return handled ? FINISH_HANDLED : FORWARD;\n        }\n</code></pre> \u4e4b\u540e\u4f1a\u7531<code>DecorView</code>\u7684<code>dispatchTouchEvent</code>\u6765\u5904\u7406\uff1a <pre><code>    public boolean dispatchTouchEvent(MotionEvent ev) {\n        final Window.Callback cb = mWindow.getCallback();\n        return cb != null &amp;&amp; !mWindow.isDestroyed() &amp;&amp; mFeatureId &lt; 0\n                ? cb.dispatchTouchEvent(ev) : super.dispatchTouchEvent(ev);\n    }\n</code></pre> \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c<code>Activity</code>, <code>Dialog</code>\u5728\u6784\u9020\u65f6\u4f1a<code>window.setCallback</code>\u7531\u6b64\u53ef\u4ee5\u5728<code>activity</code>, <code>dialog</code>\u7684\u5b50\u7c7b\u91cc\u590d\u5199<code>dispatchXxxEvent</code>\uff1a <pre><code>    public boolean dispatchTouchEvent(MotionEvent ev) {\n        if (ev.getAction() == MotionEvent.ACTION_DOWN) {\n            onUserInteraction();\n        }\n        if (getWindow().superDispatchTouchEvent(ev)) {\n            return true;\n        }\n        return onTouchEvent(ev);\n    }\n</code></pre> \u5982\u679c\u4e0d\u8003\u8651\u5b50\u7c7b\u8986\u76d6\uff0c<code>Activity</code>\u4f1a\u5148\u9075\u4ece<code>Window</code>\u7684\u610f\u613f\uff1a <pre><code>    @Override\n    public boolean superDispatchTouchEvent(MotionEvent event) {\n        return mDecor.superDispatchTouchEvent(event);\n    }\n</code></pre> \u5373\u4f1a\u8fdb\u884c<code>ViewGroup</code>\u7684\u89e6\u6478\u4e8b\u4ef6\u5206\u53d1\uff1a <pre><code>    public boolean superDispatchTouchEvent(MotionEvent event) {\n        return super.dispatchTouchEvent(event);\n    }\n</code></pre> \u6700\u540e<code>Activity</code>\u7684<code>onTouchEvent</code>\u662f\uff1a <pre><code>    public boolean onTouchEvent(MotionEvent event) {\n        if (mWindow.shouldCloseOnTouch(this, event)) {\n            finish();\n            return true;\n        }\n\n        return false;\n    }\n</code></pre> \u7531\u6b64\u6765\u603b\u7ed3\u4e00\u4e0b\uff1a\u4e8b\u4ef6\u5206\u53d1\u65f6\uff0c\u4f18\u5148\u4ea4\u7ed9window#callback#dispatchTouchEvent\uff08\u53ef\u4ee5\u590d\u5199Activity, Dialog\u6b64\u65b9\u6cd5\uff09\uff0c\u5176\u6b21\u5728ViewGroup\u4e2d\u5206\u53d1\uff08\u524d\u63d0\u53d6\u51b3\u4e8eDispatchTouchEvent\u7684\u903b\u8f91\uff09\u3002</p>"},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/#viewtouch","title":"View\u7684Touch\u4e8b\u4ef6\u5206\u53d1\u6846\u67b6\u6982\u8ff0","text":"<p>\u5728View\u7684\u5c42\u7ea7\u7ed3\u6784\u91cc\uff0c\u4f1a\u4ece\u4e0a\u5230\u4e0b\uff0c\u5373\u4ece\u7236View\u5230\u5b50View\u4f9d\u6b21\u5206\u53d1\u89e6\u6478\u4e8b\u4ef6\u3002\u4e00\u822c\u6309ViewGroup\u7684\u884c\u4e3a\u6765\u8bb2\uff0c\u4f1a\u68c0\u6d4b\u53ef\u89c1\u7684\u5b50View\u7684\u8fb9\u754c\u662f\u5426\u548c\u89e6\u6478\u4e8b\u4ef6\u5750\u6807\u76f8\u4ea4\uff0c\u5728\u76f8\u4ea4\u7684\u524d\u63d0\u4e0b\u624d\u4f1a\u7ee7\u7eed\u5206\u53d1\u3002</p> <p>\u4e8b\u4ef6\u5206\u53d1\u8fc7\u7a0b\u4e3b\u8981\u6d89\u53ca\u7684\u65b9\u6cd5\u5305\u542b\uff1a</p> <p>\u5206\u53d1\u5904\u7406\u76f8\u5173\uff1a</p> <ul> <li>View#dispatchTouchEvent</li> <li>ViewGroup#dispathTransformedTouchEvent</li> <li>View#onTouchListner.onTouch</li> <li>View#onTouchEvent\uff0c\u53ef\u80fd\u7ee7\u800c\u89e6\u53d1clickListener.onClick\u7b49</li> </ul> <p>\u62e6\u622a\u76f8\u5173\uff1a</p> <ul> <li>ViewGroup#onInterceptTouchEvent</li> <li>ViewGroup#requestDisallowInterceptTouchEvent</li> </ul> <p>\u5d4c\u5957\u6eda\u52a8\u76f8\u5173\uff1a</p> <ul> <li>View#startNestedScroll</li> <li>ViewGroup#onStartNestedScroll</li> </ul> <p>\u5178\u578b\u7684\u89e6\u6478\u4e8b\u4ef6\u6d41\uff08\u5373\u4e00\u7cfb\u5217\u8981\u5206\u53d1\u7684\u89e6\u6478\u4e8b\u4ef6\uff09\u662f(*\u4ee3\u8868\u53ef\u9009)\uff1a</p> <ul> <li>ACTION_DOWN</li> <li>ACTION_MOVE / ACTION_DOWN(\u591a\u70b9\u89e6\u6478\uff0c\u53ef\u6839\u636epointerIndex\u5224\u65ad\u89e6\u6478\u70b9\u7f16\u53f7)</li> <li>ACTION_CANCEL / ACTION_UP\uff08\u82e5\u662f\u591a\u70b9\u89e6\u6478\u5219\u4f1a\u6709\u591a\u6b21\uff09</li> </ul> <p>\u5373<code>ACTION_DOWN</code>\u4f5c\u4e3a\u8d77\u59cb\uff0c<code>ACTION_UP</code>\u4f5c\u4e3a\u7ed3\u675f\uff0c\u5982\u679c\u6709\u610f\u5916\u53d1\u751f\uff0c\u5219\u4f1a\u4ee5\u4e00\u4e2a<code>ACTION_CANCEL</code>\u4f5c\u4e3a\u7ed3\u675f\u3002\u4e4b\u95f4\u53ef\u4ee5\u51fa\u73b0\u591a\u6b21<code>ACTION_MOVE</code>\u4ee5\u53ca\u5b50\u5e8f\u5217\uff08\u9664\u4e86<code>ACTION_CANCEL</code>\u7684\u60c5\u51b5\uff09</p> <p>\u82e5\u9700\u8981\u4fdd\u7559<code>MotionEvent</code>\u5b9e\u4f8b\uff0c\u8bf7\u4f7f\u7528<code>MotionEvent.obtain(MotionEvent)</code>\u65b9\u6cd5\uff0c\u800c\u4e0d\u8981\u4f5c\u4e3a\u6210\u5458\u53d8\u91cf\uff0c\u56e0\u4e3a<code>MotionEvent</code>\u5b9e\u4f8b\u662f\u88ab\u9ad8\u5ea6\u590d\u7528\u7684\u3002</p> <p>\u5206\u53d1\u7684\u673a\u5236\u5982\u4e0b\uff1a</p> <ul> <li>\u5bf9\u4e8eDown\u4e8b\u4ef6\uff0c\u7236View\u6309\u9ed8\u8ba4\u7684\u884c\u4e3a\uff0c\u5728<code>dispatchTouchEvent</code>\u4e2d\u5206\u53d1\u7ed9\u53ef\u4ee5\u83b7\u53d6\u7126\u70b9\u3001\u53ef\u89c1\u3001\u4e14\u89e6\u6478\u4f4d\u4e8e\u5176\u8fb9\u754c\u5185\u3001\u5c42\u7ea7\u66f4\u9ad8\u7684\u5b50View\u3002\u82e5\u8fd4\u56de\u4e86<code>true</code>\u5219\u4ee3\u8868\u6d88\u8d39\u6b64\u4e8b\u4ef6\uff0c\u5e76\u4f1a\u7ee7\u7eed\u6d88\u8d39\u540e\u7eed\u4e8b\u4ef6\u3002\u82e5\u8fd4\u56de<code>false</code>\uff0c\u5219\u540e\u7eed\u4e8b\u4ef6\u5c06\u4e0d\u518d\u5206\u53d1\u81f3\u6b64\u3002\u5373\uff0c\u4efb\u4f55View\u5fc5\u987b\u5728<code>Down</code>\u4e8b\u4ef6\u51b3\u5b9a\u662f\u5426\u63a5\u6536\u540e\u7eed\u4e8b\u4ef6\u6d41\u3002</li> <li>\u5bf9\u4e8e\u786e\u8ba4\u6d88\u8d39\u4e8b\u4ef6\u6d41\u7684\u5b50View\uff0c\u88ab\u8ba4\u5b9a\u4e3a\u4e8b\u4ef6\u5206\u53d1\u76ee\u6807\u3002\u5728\u5b83\u5c42\u7ea7\u4e4b\u4e0a\u7684\u7236View\u5728\u540e\u7eed\u89e6\u6478\u4e8b\u4ef6\u4e2d\uff0c<code>dispatchTouchEvent</code>\u4f9d\u7136\u4f1a\u89e6\u53d1\uff08\u56e0\u4e3a\u5b83\u5728Down\u4e8b\u4ef6\u8fd4\u56de\u7684\u503c\u5c31\u662f\u76ee\u6807\u5b50View\u8fd4\u56de\u7684true\uff09\uff0c\u6b64\u5916\uff0c\u5b83\u7684<code>onInterceptTouchEvent</code>\u4e5f\u4f1a\u88ab\u8c03\u7528\uff0c\u9664\u975e\u5206\u53d1\u76ee\u6807View\u6b63\u662f\u81ea\u5df1\u3002\u5728<code>onInterceptTouchEvent</code>\u4e2d\u82e5\u8fd4\u56de\u4e86<code>true</code>\uff0c\u5219\u4ee3\u8868\u7236View\u62e6\u622a\u4e86\u540e\u7eed\u6240\u6709\u4e8b\u4ef6\u3002\u5b50View\u5c06\u65e0\u6cd5\u6536\u5230\u6b64\u6b21\u4e8b\u4ef6\uff0c\u8f6c\u800c\u4f1a\u6536\u5230<code>ACTION_CANCEL</code>\u4e8b\u4ef6\uff08\u5373\u62e6\u622a\u5224\u65ad\u53d1\u751f\u5728\u5206\u53d1\u7ed9\u76ee\u6807View\u4e4b\u524d\uff09\u3002</li> <li>\u5b50View\u53ef\u4ee5\u901a\u8fc7<code>requestDisallowInterceptTouchEvent</code>\u6765\u963b\u6b62\u7236View\u5bf9\u89e6\u6478\u4e8b\u4ef6\u62e6\u622a\u3002\u5f53\u7136\uff0c\u6b64\u8c03\u7528\u5fc5\u987b\u53d1\u751f\u5730\u5c3d\u53ef\u80fd\u65e9\u3002\u82e5\u7236View\u5df2\u7ecf\u5f00\u59cb\u62e6\u622a\u65f6\u6b64\u8c03\u7528\u65e0\u610f\u4e49\u3002</li> <li>\u6b64\u5916\uff0c\u5b50View\u53ef\u4ee5\u901a\u8fc7<code>startNestedScroll</code>\u8868\u793a\u81ea\u5df1\u8fdb\u884c\u4e86\u5d4c\u5957\u6eda\u52a8\u3002\u8fd9\u66f4\u7c7b\u4f3c\u4e00\u79cd<code>hint</code>\u673a\u5236\uff0c\u7236View\u7684<code>onStartNestedScroll</code>\u4f1a\u6309\u5c42\u7ea7\u5f97\u5230\u56de\u8c03\u3002\u82e5\u8fd4\u56de<code>true</code>\u8868\u793a\u63a5\u53d7\uff0c<code>false</code>\u8868\u793a\u62d2\u7edd\u3002\u82e5\u63a5\u53d7\u4e86\uff0c\u4e00\u822c\u9690\u542b\u610f\u601d\u662f\uff0c\u5c06\u4e0d\u518d\u62e6\u622a\u3002</li> <li>View\u53ef\u4ee5\u6dfb\u52a0<code>onTouchListner</code>\u548c<code>onClickListener</code>\uff0c\u4ee5\u53ca<code>onLongClickListener</code>\u7b49\uff0cView\u4e5f\u6709<code>onTouchEvent</code>\u56de\u8c03\u3002\u5b83\u4eec\u7684\u5173\u7cfb\u662f\uff0c\u4f18\u5148\u7531<code>onTouchListener</code>\u5224\u65ad\u662f\u5426\u5904\u7406\u89e6\u6478\u4e8b\u4ef6\u3002\u82e5\u4e0d\u5904\u7406\uff0c\u5219\u518d\u4ea4\u7ed9<code>View#onTouchEvent</code>\u56de\u8c03\uff0c\u800c\u8fd9\u4e2a\u56de\u8c03\u4e2d\u4f1a\u5305\u542b\u4e00\u7cfb\u5217\u7684\u624b\u52bf\u68c0\u6d4b\uff0c\u5bf9\u4e8e<code>ACTION_UP</code>\u65f6\uff0c\u5219\u4f1a\u8bd5\u56fe\u8c03\u7528<code>onClickListener</code>\u3002\u5b83\u4e5f\u4f1a\u8bb0\u5f55\u6309\u538b\u65f6\u957f\uff0c\u4ece\u800c\u5728\u91ca\u653e\u65f6\u6839\u636e\u9700\u8981\u8c03\u7528<code>onLongClickListener</code>\u3002</li> </ul>"},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/#_3","title":"\u6eda\u52a8\u68c0\u6d4b","text":"<p>\u4e00\u822c\u4f1a\u4ee5<code>GestureDetector</code>\u5b9e\u4f8b\uff0c\u5728<code>onDispatchTouchEvent</code>\u4e2d\u4e3a\u5176\u4f20\u9012\u89e6\u6478\u4e8b\u4ef6\uff0c\u5e76\u63d0\u4f9b\u4e0d\u540c\u624b\u52bf\u89e6\u53d1\u7684\u56de\u8c03\u5b9e\u73b0\uff0c\u6765\u5b8c\u6210\u624b\u52bf\u68c0\u6d4b\u3002\u4f46\u6709\u65f6\u5019\u9700\u8981\u624b\u52a8\u68c0\u6d4b\u65f6\uff0c\u6b65\u9aa4\u4e00\u822c\u5982\u4e0b\uff1a</p> <ul> <li>\u5728ACTION_DOWN\u4e2d\u8fd4\u56detrue\uff0c\u4ece\u800c\u53ef\u4ee5\u5f97\u5230\u540e\u7eed\u4e8b\u4ef6\uff0c\u5e76\u8bb0\u5f55DOWN\u4e8b\u4ef6\u7684\u5750\u6807\u3002</li> <li>\u5728ACTION_MOVE\u65f6\uff0c\u548cDOWN\u4e8b\u4ef6\u5750\u6807\u5bf9\u6bd4\u5f97\u51fa\u624b\u6307\u79fb\u52a8\u504f\u79fb\u91cf\uff0c\u548c<code>ViewConfiguration.TOUCH_SLOP</code>\u6216\u5176\u4ed6\u53c2\u8003\u503c\u5bf9\u6bd4\uff0c\u6765\u786e\u8ba4\u662f\u5426\u53ef\u4ee5\u8ba4\u4e3a\u53d1\u751f\u4e86\u6eda\u52a8\u3002</li> </ul>"},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/#_4","title":"\u5d4c\u5957\u6eda\u52a8\u6848\u4f8b","text":"<p>\u4e0b\u9762\u6765\u4e3e\u4e00\u4e2a\u5d4c\u5957\u6eda\u52a8\u7684\u573a\u666f\u3002\u6709\u4e00\u4e2a\u53ef\u6eda\u52a8\u5bb9\u5668A\uff0c\u5185\u90e8\u5305\u542b\u4e86\u4e00\u4e2a\u5185\u90e8\u4e5f\u53ef\u4ee5\u4e0a\u4e0b\u6eda\u52a8\u7684view B\u3002\u5f53View B\u5185\u90e8\u4e0a\u4e0b\u6eda\u52a8\u5230\u8fb9\u754c\u65f6\uff0c\u5916\u90e8\u5bb9\u5668A\u7ee7\u7eed\u6eda\u52a8\u3002</p> <p>\u89e3\u51b3\u6b64\u573a\u666f\u7c7b\u4f3c\u4e8e<code>NestedScrollView</code>\u4e2d\u5bf9<code>onInterceptTouchEvent</code>\u7684\u5904\u7406\uff0c\u5373\u5b50View\u82e5\u5224\u65ad\u51fa\u4e86\u662f\u7ad6\u76f4\u6eda\u52a8\uff0c\u82e5\u53ef\u4ee5\u6eda\u52a8\uff0c\u5219\u8c03\u7528<code>startNestedScroll</code>\uff0c\u800c\u7236View\u9664\u4e86\u590d\u5199<code>onNestedScroll</code>\u4ee5\u63a5\u53d7\u5d4c\u5957\u6eda\u52a8\u5916\uff0c\u5728<code>onInterceptTouchEvent</code>\u4e2d\u7684<code>ACTION_MOVE</code>\u4e2d\u9700\u8981\u901a\u8fc7<code>getNestedScrollAxis</code>\u6765\u68c0\u67e5\u662f\u5426\u6709\u7ad6\u76f4\u65b9\u5411\u7684\u5d4c\u5957\u6eda\u52a8\u6b63\u5728\u8fdb\u884c\uff0c\u82e5\u6709\uff0c\u5219\u4e0d\u5e94\u8be5\u62e6\u622a\uff0c\u5426\u5219\uff0c\u53ef\u4ee5\u5728\u5b83\u4e5f\u5224\u65ad\u51fa\u662f\u7ad6\u76f4\u65b9\u5411\u6eda\u52a8\u65f6\uff0c\u8fd4\u56de<code>true</code>\u62e6\u622a\u6b64\u4e8b\u4ef6\u3002\u4e00\u65e6\u62e6\u622a\u540e\uff0c\u5b50View\u5c06\u4e0d\u518d\u6536\u5230\u4e8b\u4ef6\u3002</p>"},{"location":"Android/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/#_5","title":"\u5e94\u7528\u8fdb\u7a0b\u5916","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u8ba8\u8bba\u8f93\u5165\u4e8b\u4ef6\u662f\u5982\u4f55\u5206\u53d1\u5230\u5e94\u7528\u8fdb\u7a0b\u4e2d</p> <p>todo \u5f85\u8865\u5145</p> <p>dispatchTouchEvent\u8c03\u7528\u6808 <pre><code>dispatchTouchEvent:53, MainActivity$TestView (org.tu.android)\ndispatchTransformedTouchEvent:3131, ViewGroup (android.view)\ndispatchTouchEvent:2731, ViewGroup (android.view)\ndispatchTransformedTouchEvent:3131, ViewGroup (android.view)\ndispatchTouchEvent:2731, ViewGroup (android.view)\nsuperDispatchTouchEvent:528, DecorView (com.android.internal.policy)\nsuperDispatchTouchEvent:1857, PhoneWindow (com.android.internal.policy)\ndispatchTouchEvent:4105, Activity (android.app)\ndispatchTouchEvent:69, WindowCallbackWrapper (androidx.appcompat.view)\ndispatchTouchEvent:478, DecorView (com.android.internal.policy)\ndispatchPointerEvent:13887, View (android.view)\nprocessPointerEvent:6209, ViewRootImpl$ViewPostImeInputStage (android.view)\nonProcess:5947, ViewRootImpl$ViewPostImeInputStage (android.view)\ndeliver:5400, ViewRootImpl$InputStage (android.view)\nonDeliverToNext:5460, ViewRootImpl$InputStage (android.view)\nforward:5419, ViewRootImpl$InputStage (android.view)\nforward:5584, ViewRootImpl$AsyncInputStage (android.view)\napply:5427, ViewRootImpl$InputStage (android.view)\napply:5641, ViewRootImpl$AsyncInputStage (android.view)\ndeliver:5400, ViewRootImpl$InputStage (android.view)\nonDeliverToNext:5460, ViewRootImpl$InputStage (android.view)\nforward:5419, ViewRootImpl$InputStage (android.view)\napply:5427, ViewRootImpl$InputStage (android.view)\ndeliver:5400, ViewRootImpl$InputStage (android.view)\ndeliverInputEvent:8356, ViewRootImpl (android.view)\ndoProcessInputEvents:8325, ViewRootImpl (android.view)\nenqueueInputEvent:8276, ViewRootImpl (android.view)\nonInputEvent:8495, ViewRootImpl$WindowInputEventReceiver (android.view)\ndispatchInputEvent:188, InputEventReceiver (android.view)\nnativePollOnce:-1, MessageQueue (android.os)\nnext:336, MessageQueue (android.os)\nloop:184, Looper (android.os)\nmain:7830, ActivityThread (android.app)\ninvoke:-1, Method (java.lang.reflect)\nrun:492, RuntimeInit$MethodAndArgsCaller (com.android.internal.os)\nmain:1040, ZygoteInit (com.android.internal.os)\n</code></pre></p>"},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/","title":"\u5305\u7b7e\u540d\u3001\u9a8c\u8bc1\u3001\u52a0\u56fa","text":""},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/#_1","title":"\u5305\u7b7e\u540d\u9a8c\u8bc1","text":""},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/#v1","title":"v1\u7b7e\u540d","text":"<p>\u56e0\u4e3aAPK\u672c\u8d28\u662fJAR\u66f4\u662fZIP\u6587\u4ef6\uff0c\u56e0\u6b64\u63d0\u4f9b\u4e86\u7c7b\u4f3cjarsigner\u7684\u5de5\u5177\u2014\u2014apksigner\uff0c\u4e0ejarsigner\u529f\u80fd\u975e\u5e38\u76f8\u4f3c\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e\u9664\u4e86\u76f4\u63a5\u63d0\u4f9bjks\u7684keystore\u6587\u4ef6\u65b9\u5f0f\u5916\uff0c\u8fd8\u53ef\u4ee5\u5355\u72ec\u63d0\u4f9bPKCS #8 \u683c\u5f0f\u7684\u79c1\u94a5\u6587\u4ef6\u548cx.509\u7684\u8bc1\u4e66\u6587\u4ef6\uff08\u8be6\u89c1\uff09\u3002</p> <p>\u5173\u4e8ejar\u7684\u7b7e\u540d\uff0c\u8bf7\u53c2\u89c1\u201cJava\u201dsection\u3002</p> <p>\u5bf9\u4e8e\u66f4\u65b0\u5b89\u88c5apk\uff0c\u7cfb\u7edf\u53ea\u9700\u8981\u786e\u4fdd\u65b0\u7684apk\u80fd\u591f\u5b8c\u6210\u7b7e\u540d\u9a8c\u8bc1\uff0c\u5e76\u4e14\u662f\u7531\u540c\u4e00\u4e2a\u5b9e\u4f53\uff08\u516c\u94a5\uff09\u63d0\u4f9b\u7684\u7b7e\u540d\u5373\u53ef</p>"},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/#v2","title":"v2\u7b7e\u540d","text":"<p>\u7531\u4e8ev1\u7b7e\u540d\u7684\u9a8c\u8bc1\u9700\u8981\u89e3\u538b\u7f29\u624d\u80fd\u8fdb\u884c\uff0c\u5bf9\u4e8e\u52a8\u8f84\u4e0a\u767eM\u7684\u5305\u5e76\u4e0d\u53cb\u597d\u3002\u4e14\u65e0\u6cd5\u4fdd\u62a4zip\u7684\u5143\u6570\u636e\u90e8\u5206\u3002\u4ecev2\u7b7e\u540d\u5f00\u59cb\u63d0\u4f9b\u4e86\u65b0\u7684\u65b9\u5f0f\u3002</p> <p>\u5728zip\u6587\u4ef6\u4e2d\u589e\u52a0\u4e86apk\u7b7e\u540d\u5206\u5757\u3002\u6b64\u5206\u5757\u7684\u6570\u636e\u5305\u542b\u591a\u4e2a\u201cID - \u503c\u201d\u5bf9\u7ec4\u6210\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7b7e\u540d\u8005\uff0c\u4f1a\u5b58\u50a8\uff1a</p> <ul> <li>\uff08\u7b7e\u540d\u7b97\u6cd5\u3001\u6458\u8981\u3001\u7b7e\u540d\uff09\u5143\u7ec4\u3002\u6458\u8981\u4f1a\u5b58\u50a8\u8d77\u6765\uff0c\u4ee5\u4fbf\u5c06\u7b7e\u540d\u9a8c\u8bc1\u548c APK \u5185\u5bb9\u5b8c\u6574\u6027\u68c0\u67e5\u62c6\u5f00\u8fdb\u884c\u3002</li> <li>\u8868\u793a\u7b7e\u540d\u8005\u8eab\u4efd\u7684 X.509 \u8bc1\u4e66\u94fe\u3002</li> <li>\u91c7\u7528\u952e\u503c\u5bf9\u5f62\u5f0f\u7684\u5176\u4ed6\u5c5e\u6027\u3002</li> </ul> <p>\u5177\u4f53\u683c\u5f0f\u548cID\u53d6\u503c\u89c1\u5b98\u65b9\u6587\u6863\u3002\u9a8c\u8bc1\u65f6\uff0c\u4f1a\u5bf9zip\u7684\u5176\u4ed6\u5206\u5757\u62c6\u5206\u6210\u5927\u5c0f\u4e3a1MB\u7684\u8fde\u7eed\u5757\uff0c\u5bf9\u6bcf\u4e2a\u62c6\u5206\u5757\u8ba1\u7b97\u6458\u8981\uff0c\u5e76\u548c\u7b7e\u540d\u5206\u5757\u4e2d\u7684\u6458\u8981\u5bf9\u6bd4\u3002\u6b64\u8fc7\u7a0b\u53ef\u4ee5\u66f4\u597d\u5229\u7528\u5e76\u53d1\u6765\u52a0\u901f\u9a8c\u8bc1\u3002</p> <p></p>"},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/#v3","title":"v3\u7b7e\u540d","text":"<p>\u4ece\u5b89\u53539\u5f00\u59cb\u63d0\u4f9b\u4e86v3\u65b9\u6848\u3002\u5f62\u5f0f\u4f9d\u7136\u91c7\u7528v2\u7684\u5f62\u5f0f\uff0c\u4f46\u5728\u5206\u5757\u4e2d\u53c8\u589e\u52a0\u4e86\u66f4\u591a\u7684\u201cID - \u503c\u201d\u5bf9\uff0c\u7528\u4e8e\u652f\u6301\u201cAPK\u79d8\u94a5\u8f6e\u66ff\u201d\u7279\u6027\u3002</p>"},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/#_2","title":"\u5305\u52a0\u56fa","text":"<p>\u7c7b\u52a0\u8f7d\u5b57\u8282\u6570\u7ec4\u52a0\u5bc6\u89e3\u5bc6</p>"},{"location":"Android/%E5%8C%85%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E8%AF%81%E3%80%81%E5%8A%A0%E5%9B%BA/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>v1\u7b7e\u540d</li> <li>v2\u7b7e\u540d</li> <li>v3\u7b7e\u540d</li> <li>apksigner</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u5316","text":""},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_1","title":"\u6027\u80fd\u76d1\u63a7","text":"<p>Java\u4fa7\u53ef\u4ee5\u4f7f\u7528<code>Debug.startMethodTracing</code>\u6216<code>Debug.startMethodTracingSampling</code>\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e5f\u90fd\u662fAndroid Studio Profiler\u91cccpu record\u5b9e\u9645\u6240\u7528\u5de5\u5177\u3002\u5982\u679c\u9700\u8981\u624b\u52a8\u76d1\u63a7\uff0c\u5219\u4e00\u822c\u8003\u8651AOP\u7684\u65b9\u5f0f\uff0c\u4e00\u822c\u4f1a\u5728Gradle Plugin\u4e2d\u4f9d\u9760Android gradle plugin\u7684Transform API\u6765\u5b8c\u6210\u3002AOP\u5e38\u7528\u7684\u5e93\u6709<code>asm</code>, <code>javaassist</code>\u3002\u901a\u8fc7AOP\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>\u5728\u65b9\u6cd5\u524d\u540e\u7684\u63d2\u6869\uff0c\u4ee5\u6b64\u68c0\u6d4b\u6162\u65b9\u6cd5\u3002</li> <li>\u5728\u67d0\u4e9b\u751f\u547d\u5468\u671f\u4e8b\u4ef6\u63d2\u6869\uff0c\u4ee5\u68c0\u6d4b\u5173\u952e\u4e8b\u4ef6\u3002</li> <li>\u5bf9\u7f51\u7edc\u8bf7\u6c42\u5982Retrofit.Builder\u63d2\u6869\uff0c\u589e\u52a0\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\uff0c\u6765\u5b8c\u6210\u7f51\u7edc\u8bf7\u6c42\u6027\u80fd\u68c0\u6d4b\u3002</li> </ul> <p>\u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u5e38\u89c1\u5176\u4ed6\u65b9\u5f0f\u5982\uff1a</p> <ul> <li>\u68c0\u6d4bCpu\u5360\u7528\uff0c<code>ps</code>\u6216<code>top</code>linux\u5de5\u5177\u3002</li> <li>\u540e\u53f0\u7ebf\u7a0b\u53ef\u4ee5\u5468\u671f\u68c0\u67e5\u5185\u5b58\u4fe1\u606f\uff0c<code>Debug.getMemoryInfo</code>\u3002</li> <li>\u67d0\u4e9b\u6761\u4ef6\u4e0b\u9700\u8981\u8f6c\u50a8\u5185\u5b58\u505a\u8fdb\u4e00\u6b65\u5206\u6790\uff0c<code>Debug.dumpHprofData</code>\u3002</li> <li>\u67d0\u4e9b\u6761\u4ef6\u4e0b\u9700\u8981\u6253\u5370\u7cfb\u7edf\u670d\u52a1\u7edf\u8ba1\uff0c<code>Debug.dumpService</code>\u3002</li> <li>Choreographer\u5468\u671f\u68c0\u6d4b\u5e27\u7387\u3002\u5361\u987f\u3002</li> <li>\u4e3b\u7ebf\u7a0b\u5468\u671f\u68c0\u6d4bStackTrace, \u901a\u8fc7<code>thread.stacktrace()</code>\u65b9\u6cd5\u3002\u6765\u91c7\u6837\u4e3b\u7ebf\u7a0b\u65b9\u6cd5\u3002</li> <li>Anr\u53ef\u4ee5\u901a\u8fc7<code>/data/anr/trace.txt</code>\u68c0\u6d4b\uff0c\u5e76\u501f\u52a9<code>FileObserver</code>API\u3002</li> <li>\u6d41\u91cf\u76d1\u63a7\uff0c<code>context.getSystemService(Context.NETWORK_STATS_SERVICE)</code>\u7cfb\u7edf\u670d\u52a1\u3002</li> </ul> <p>\u6700\u540e\uff0c\u8fd8\u6709\u9ad8\u7ea7\u65b9\u5f0f\uff0c\u5373\u4f7f\u7528JVM TI\u3002\u8fd9\u91cc\u53ef\u4ee5\u53c2\u9605\u201cjava\u201dsection</p>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_2","title":"\u901f\u5ea6","text":"<ul> <li>\u9884\u52a0\u8f7d</li> <li>\u61d2\u52a0\u8f7d</li> <li>\u9884\u8fde\u63a5\uff0c\u8282\u70b9\u9009\u4f18</li> <li>AsyncInflate, viewStub,</li> <li>\u4ee3\u7801\u7ec6\u8282\uff0clog toString</li> <li>\u4f18\u5148\u7ea7\u961f\u5217</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_3","title":"\u5185\u5b58","text":"<ul> <li>\u7ebf\u7a0b\u7ba1\u7406</li> <li>\u5185\u5b58\u6cc4\u6f0f</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_4","title":"\u5305\u5927\u5c0f","text":"<ul> <li>\u6df7\u6dc6</li> <li>\u63d2\u4ef6\u3001\u5f02\u6b65\u4e0b\u53d1</li> <li>\u77e2\u91cf</li> <li>\u4f7f\u7528R8\u4f18\u5316\u5e94\u7528</li> <li>\u4f18\u5316\u4ee3\u7801\uff08\u6e05\u9664\u672a\u4f7f\u7528\u7684\u6761\u4ef6\u8bed\u53e5\u7b49\uff09</li> <li>\u7f29\u51cf\u4ee3\u7801\uff08\u6e05\u9664\u672a\u4f7f\u7528\u7684\u4f9d\u8d56\u4ee3\u7801\uff09</li> <li>\u7f29\u51cf\u8d44\u6e90\uff08\u6e05\u9664\u672a\u4f7f\u7528\u8d44\u6e90\uff09</li> <li>\u6df7\u6dc6\u4ee3\u7801\uff08\u7f29\u77ed\u7c7b\u540d\uff09</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_5","title":"\u8bbe\u5907","text":"<ul> <li>\u8bbe\u5907\u4f30\u5206\uff0c\u52a8\u753b\u76f8\u5173</li> <li>lite\u7248\u672c</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_6","title":"\u7f51\u7edc","text":"<ul> <li>\u589e\u52a0\u538b\u7f29\u8bf7\u6c42\u3001\u54cd\u5e94\u7f16\u7801</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_7","title":"\u6e32\u67d3","text":"<ul> <li>RecyclerView DiffUtils...</li> </ul>"},{"location":"Android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#_8","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>rabbit-client</li> </ul>"},{"location":"Android/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%96%B9%E6%A1%88/","title":"\u63d2\u4ef6\u5316\u65b9\u6848","text":"<p>\u6b64\u6587\u7ae0\u5f85\u5b8c\u5584</p>"},{"location":"Android/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%96%B9%E6%A1%88/#_2","title":"\u8d44\u6e90\u63d2\u4ef6\u5316","text":"<p>\u6362\u80a4\u65b9\u6848\u4e4b AssetManager\u52a0\u8f7d\u672a\u5b89\u88c5apk\u7684\u8d44\u6e90\uff0c\u83b7\u53d6Resource</p> <p>\u6838\u5fc3\u662fAssetManager#addAssetPath\uff0c\u518d\u901a\u8fc7\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u63d2\u4ef6apk\u91cc\u7684R\u8d44\u6e90\uff0c\u901a\u8fc7\u53cd\u5c04\u65b9\u5f0f\u83b7\u53d6\u76ee\u6807resId\uff0c\u7ed3\u5408AssetManager\u548cResource\u7684api\u6700\u7ec8\u53ef\u4ee5\u83b7\u53d6\u5230\u8d44\u6e90\u3002</p>"},{"location":"Android/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%96%B9%E6%A1%88/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>\u52a8\u6001\u52a0\u8f7d\u65b9\u6848\u6982\u8ff0</li> <li>\u53c2\u8003</li> </ul>"},{"location":"Android/%E6%9B%9D%E5%85%89%E5%9F%8B%E7%82%B9%E6%96%B9%E6%A1%88/","title":"\u66dd\u5149\u57cb\u70b9\u65b9\u6848","text":"<p>\u53d1\u89c9\u4e4b\u524d\u5728\u5de5\u4f5c\u4e2d\u5199\u7684\u5e93\u8fd8\u662f\u88ab\u5f04\u4e22\u4e86\u3002\u51ed\u73b0\u5728\u7684\u56de\u5fc6\u5c3d\u5feb\u590d\u539f\u4e0b\u6574\u4f53\u601d\u8def\uff0c\u4ee5\u4fbf\u540e\u7eed\u9700\u8981\u65f6\u5019\u53c2\u8003\u3002</p>"},{"location":"Android/%E6%9B%9D%E5%85%89%E5%9F%8B%E7%82%B9%E6%96%B9%E6%A1%88/#_1","title":"\u601d\u8def","text":"<p>\u5b9a\u4e49\u5982\u4e0b\u7684\u5de5\u5177\u5165\u53e3\u65b9\u6cd5\uff1a</p> <p><code>sendExposureEvent(view, config)</code></p> <p>\u73b0\u5728\u56e0\u4e3akotlin\u7684\u6d41\u884c\uff0c\u53ef\u4ee5\u6539\u4e3aView\u7684\u62d3\u5c55\u65b9\u6cd5\u4e86\uff0c\u5373<code>View.sendExposureEvent(config)</code></p> <p>\u5185\u90e8\u4f1a\u8fdb\u884c\uff1a<code>view.setOnVibilityChangeListener(...)</code>\uff0c\u5b83\u4e5f\u662f\u4e00\u4e2a\u62d3\u5c55\u65b9\u6cd5\u6216\u8005java\u7684\u5de5\u5177\u65b9\u6cd5\uff0c\u5176\u76d1\u542c\u56de\u8c03\u63a5\u53e3\u5b9a\u4e49\u6bd4\u5982\uff1a</p> <p><pre><code>interface OnVisibilityChange{\n    void onChanged(Rect visibleRect, boolean isVisible, Boolean oldIsVisible)\n}\n</code></pre> \u800c\u66dd\u5149\u57cb\u70b9\u53d1\u9001\u903b\u8f91\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u6b64\u63a5\u53e3\u6765\u5b8c\u6210\u3002\u6bd4\u5982\uff1a <pre><code>OnVisibilityChange{ visibleRect, isVisible, oldIsVisible-&gt;\n    if(isVisible) lastVisibleTime = System.currentMileseconds();\n    if(!isVisble &amp;&amp; System.currentMilseconds()-lastVisibleTime &gt; exposureConfig.duration){\n        exposureConfig.eventTrigger.trigger()\n    } \n}\n</code></pre> \u5373\u6211\u4eec\u8bb0\u5f55\u6700\u540e\u4e00\u6b21\u53ef\u89c1\u65f6\u5019\u7684\u65f6\u95f4\uff0c\u5f53\u53d8\u4e3a\u4e0d\u53ef\u89c1\u65f6\uff0c\u5bf9\u6bd4\u4e0a\u6b21\u53ef\u89c1\u7684\u65f6\u95f4\u5982\u679c\u5927\u4e8e\u9608\u503c\uff0c\u5219\u89e6\u53d1\u66dd\u5149\u4e8b\u4ef6\u3002\u800c<code>setOnVisiblityChange</code>\u7684\u5b9e\u73b0\u5219\u5305\u542b\uff1a</p> <pre><code>view.getVisbilityMonitor()//\u9700\u8981\u5148\u83b7\u53d6\u4e00\u4e2a\u548cview\u6240\u5728Activity\u5173\u8054\u7684Monitor\n//Monitor\u82e5\u662f\u521d\u6b21\u521b\u5efa\uff0c\u5219\u8981\u6ce8\u518c\u7684\u4e8b\u4ef6\u5305\u62ec\uff1a\n// \u5b83\u7528\u4e8e\u76d1\u6d4b\u5168\u5c40\u6eda\u52a8\u4e8b\u4ef6\uff0c\u5305\u62ecpager, recyclerview\u7b49\nmonitor.rootView.viewTreeObserver.addOnScrollChangedListener\n// \u5b83\u7528\u4e8e\u76d1\u6d4b\u5168\u5c40\u5e03\u5c40\u4e8b\u4ef6\uff0c\u5305\u62ec\u53ef\u89c1\u6027\u53d8\u52a8\u3001\u8282\u70b9\u64cd\u4f5c\u5982add/remove\u7b49\nmonitor.rootView.viewTreeObserver.addOnGlobalLayoutListener\n// \u5b83\u7528\u4e8e\u76d1\u6d4b\u9875\u9762\u8fdb\u5165\u5176\u4ed6\u58f0\u660e\u5468\u671f\u72b6\u6001\u6bd4\u5982\u6682\u505c\u7b49\u3002\nmonitor.getAttachedActivity().registerActivityLifecycleCallbacks\n// \u5728\u8fd9\u4e9b\u4e8b\u4ef6\u4e2d\uff0c\u4f1a\u904d\u5386Monitor\u5185\u90e8\u7684\u76d1\u6d4b\u5217\u8868\n\nclass VisibilityMonitor{\n    List&lt;WeakReference&lt;ViewTarget&gt;&gt; monitorViewList;\n    WeakRefence&lt;Activity&gt; activity;\n\n    class ViewTarget(WeakRefence view, VisibleState state, OnVisibilityChange eventListener)\n\n    void doCheckVisibility(){\n        pruneList();\n        for(ref in monitorViewList){\n            ref.get()?.apply{\n                isVisible = false\n                if(isShown() &amp;&amp; getGlobalVisibleRect(rect)?.run{rect.width*rect.height / view.width / view.height &gt; threshold}){\n                    isVisible = true\n                }\n                if(isVisible!= state){\n                    eventListener?.onVisiblityChanged(rect, isVisible, state)\n                    state = isVisible\n                }\n            }\n        }\n    }\n\n    void pruneList(){\n        val newList = ArrayList()\n        for(ref in monitorViewList){\n            ref.get()?.apply{\n                newList.add(it)\n            }\n        }\n        setList(newList)\n    }\n}\n</code></pre> <p>\u81f3\u6b64\u57fa\u672c\u628a\u76d1\u6d4b\u7684\u90e8\u5206\u63cf\u8ff0\u5b8c\u4e86\u3002\u9664\u4e86\u8fd9\u4e9b\uff0c\u5f53\u65f6\u8fd8\u6709\u4e00\u4e2a\u8bbe\u8ba1\u5728\u4e8e\u4e8b\u4ef6\u4e0a\u4e0b\u6587\u3002</p>"},{"location":"Android/%E6%9B%9D%E5%85%89%E5%9F%8B%E7%82%B9%E6%96%B9%E6%A1%88/#_2","title":"\u57cb\u70b9\u4e8b\u4ef6\u4e0a\u4e0b\u6587","text":"<p>\u5b83\u4f9d\u6258\u4e8e<code>view.setTag</code>\u4ee5\u53caview\u7684\u6811\u5f62\u7ed3\u6784\u3002\u5728\u7ed9\u5b9a\u4e00\u4e2aview\u8282\u70b9\u9700\u8981\u66dd\u5149\u65f6\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u83b7\u53d6\u5176\u6240\u6709\u7236\u8282\u70b9\u7684View\u3002\u7531\u6b64\uff0c\u53ef\u4ee5\u83b7\u5f97\u67d0\u4e9b\u5e38\u91cf<code>tag</code>\u7684\u5185\u5bb9\uff0c\u8fd9\u4e9b<code>tag</code>\u7528\u4e8e\u5b58\u50a8\u4e00\u4e9b\u57cb\u70b9\u4e0a\u4e0b\u6570\u636e\u4f1a\u5f88\u6709\u7528\u3002\u6bd4\u5982\u67d0\u4e2a\u5b50view\u7684\u57cb\u70b9\u53c2\u6570\u91cc\u9700\u8981\u7236view\u3001\u66f4\u66f4\u4e0a\u7ea7\u7684<code>page</code>view\u7684\u6570\u636e\uff0c\u6b64\u65f6\u5c31\u53ef\u4ee5\u501f\u52a9\u57cb\u70b9\u4e0a\u4e0b\u6587\u7684\u8fd9\u4e2a\u5b9e\u73b0\u6765\u89e3\u51b3\u3002</p> <pre><code>fun View.findEventInfoContext(someDataClass: Class&lt;T&gt;):T?{\n    return getTag(EVENT_INFO_LIKE_MAP)[someDataClass]?:getParent().run{\n        when{\n            is View -&gt; findEventInfoContext(someDataClass)\n            else null\n        }\n    }\n}\n</code></pre> <p>\u5927\u81f4\u6a21\u578b\u5982\u4e0a\u3002</p>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/","title":"\u6784\u5efa\u4f18\u5316","text":"<p>\u6b64\u6587\u4ef6\u8f83\u8001\uff0c\u4ec5\u4f5c\u4e3a\u9057\u7559\u4ea7\u7269</p>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/#_1","title":"\u6784\u5efa\u4f18\u5316","text":"<p>\u4ee5\u4e0b\u8fd9\u4e9b\u70b9\uff0c\u662f\u5bf9\u7ec4\u4ef6\u5316\u9879\u76ee\u5b9e\u65bd\u540e\u7684\u4e00\u4e9b\u4f18\u5316\u9009\u62e9\u3002</p>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/#_2","title":"\u4f9d\u8d56\u51b2\u7a81\u63d0\u9192","text":"<p>\u5728\u590d\u6742\u7684\u5de5\u7a0b\u4e2d\uff0c\u4f9d\u8d56\u51b2\u7a81\u7684\u95ee\u9898\u66f4\u9700\u8981\u5173\u6ce8\u3002\u5371\u9669\u7684\u4f9d\u8d56\u51b2\u7a81\u4f1a\u5bfc\u81f4\u4e0d\u517c\u5bb9\u7684\u95ee\u9898\uff0c\u4ece\u800c\u53d1\u751f\u8fd0\u884c\u65f6\u5d29\u6e83\uff0c\u800c\u65e0\u6cd5\u5728\u7f16\u8bd1\u671f\u95f4\u611f\u77e5\u3002\u4f9d\u8d56\u51b2\u7a81\u63d0\u9192\u662f\u4e00\u4e2a\u57fa\u4e8eGradle Dependencies\u7684\u811a\u672c\uff0c\u5468\u671f\u8fd0\u884c\uff0c\u7528\u4e8e\u5206\u6790\u68c0\u67e5\u4e00\u4e9b\u5904\u4e8e\u201c\u76d1\u89c6\u5217\u8868\u201d\u4e2d\u7684\u6a21\u5757\u6240\u4f7f\u7528\u7684\u4f9d\u8d56\u662f\u5426\u53d1\u751f\u4e86\u51b2\u7a81\u3002\u4f1a\u901a\u8fc7\u90ae\u4ef6\u53d1\u51fa\u51b2\u7a81\u63d0\u9192\u4ee5\u53ca\u6539\u8fdb\u5efa\u8bae\u7763\u4fc3\u6a21\u5757\u5f00\u53d1\u8005\u8ddf\u8fdb\u4f9d\u8d56\u7edf\u4e00\u3002'\u4e25\u683c'\u6216'\u5bbd\u677e'\u6a21\u5f0f\u4e0b\u5c06\u610f\u5473\u7740\u53d1\u73b0\u4e0a\u8ff0\u60c5\u51b5\u65f6\uff0c\u5c06\u76f4\u63a5\u62d2\u7edd\u6784\u5efa\u6216\u4ec5\u4ec5\u53ea\u662f\u53d1\u9001\u63d0\u9192\u3002</p>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/#_3","title":"\u5173\u7cfb\u6784\u5efa\uff08\u81ea\u5e95\u800c\u4e0a\uff09","text":"<p>\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u6784\u5efa\u811a\u672c\u3002\u5468\u671f\u8fd0\u884c\uff0c\u65e8\u5728\u4ee5\u67d0\u79cd\u7279\u5b9a\u7684\u6784\u5efa\u65b9\u5f0f\u53bb\u5206\u6790\u68c0\u67e5\u5404\u4e2a\u6a21\u5757\u7684\u95ee\u9898\u3002</p>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/#_4","title":"\u4ed3\u5e93\u8fc7\u6ee4\u914d\u7f6e","text":"<p>\u4f7f\u7528gradle5.1\u589e\u52a0\u7684\u4ed3\u5e93\u8fc7\u6ee4\u914d\u7f6e\uff0c\u53ef\u4ee5\u9488\u5bf9JdGroup\u8fd9\u7c7b\u5f88\u660e\u786e\u7684\u4f9d\u8d56\u9879\u505a\u8fc7\u6ee4\u3002\u53ef\u5927\u5e45\u52a0\u5febGradle Sync\u7684\u65f6\u95f4\u6210\u672c\u3002\u5bf9\u4e8e\u590d\u6742\u7684\u5de5\u7a0b\uff0c\u65f6\u95f4\u4ece2min+\u7f29\u51cf\u523030s\u3002</p>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/#flavor","title":"\u6784\u5efa\u73af\u5883\u53d8\u91cf\uff0c\u629b\u5f03\u65e0\u610f\u4e49\u7684Flavor","text":"<p>\u901a\u8fc7AGP\u5728Build.gradle\u4e2d\u589e\u52a0BuildConfig\u5b57\u6bb5\u652f\u6301\u3002\u8bfb\u5165\u914d\u7f6e\u6765\u6e90\u53ef\u4ee5\u662f\u811a\u672c\u6ce8\u5165gradle.properties\u6216\u7f16\u8bd1\u5668\u53c2\u6570\u3002</p> <p>\u51cf\u5c11\u4e86\u65e0\u610f\u4e49\u7684\u6253\u5305\u5206\u652f\u3002\u51cf\u5c11\u4e86\u65e0\u610f\u4e49\u7684\u6784\u5efa\u914d\u7f6e\u4ee3\u7801\u63d0\u4ea4\u3002\u7ed3\u5408\u65e0\u610f\u4e49\u7684Flavor\uff0c\u751a\u81f3\u662f\u4f18\u5316\u6389\u4e86\u6ca1\u6709\u7279\u522b\u610f\u4e49\u7684Flavor\uff0c\u6784\u5efa\u65f6\u95f4\u7f29\u5c1140%\u3002\u4e3a\u6253\u5305\u8282\u7701\u7684\u65f6\u95f4\u548c\u7ef4\u62a4\u6210\u672c\u6bcf\u4e2a\u7248\u672c\u51cf\u5c11\u4e86\u5e94\u8be5\u4ee5\u5c0f\u65f6\u30011\u5929\u6765\u8ba1\u4e86\u3002</p> <ul> <li>\u7f51\u5173\u73af\u5883\uff1a\u7ebf\u4e0a\uff0c\u9884\u53d1\uff0c\u6d4b\u8bd5</li> <li>\u6293\u5305\u7279\u6027\uff1a\u652f\u6301\u6293\u5305\uff0c\u4e0d\u652f\u6301\u6293\u5305</li> <li>\u5b89\u5168\u7279\u6027\uff1a\u52a0\u56fa\uff0c\u4e0d\u52a0\u56fa</li> <li>\u7b7e\u540d\u7279\u6027\uff1a\u6b63\u5f0f\u7b7e\u540d\uff0c\u975e\u6b63\u5f0f\u7b7e\u540d</li> <li>\u5206\u652f\u9009\u62e9\u3001\u7248\u672c\u7ba1\u7406\u3002</li> </ul>"},{"location":"Android/%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/#_5","title":"\u6d4b\u8bd5\u68c0\u67e5","text":"<p>\u5468\u671f\u6027\u8fd0\u884c\u7684\u6784\u5efa\u68c0\u67e5\u3001\u5185\u5b58\u6cc4\u6f0f\u68c0\u67e5\u3001\u517c\u5bb9\u6027\u68c0\u67e5\u3001\u5b89\u5168\u68c0\u67e5\u3001\u4e1a\u52a1\u81ea\u52a8\u5316\u56de\u5f52\u68c0\u67e5\u3001\u5355\u5143\u6d4b\u8bd5\u68c0\u67e5\u7b49\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/","title":"\u6e32\u67d3\u673a\u5236","text":"<p>\u6216\u8bb8\u4e5f\u60f3\u9605\u8bfb<code>\u6e32\u67d3\u67b6\u6784</code></p> <p>\u6e32\u67d3\u662f\u4e00\u4e2a\u590d\u6742\u4e14\u5bbd\u6cdb\u7684\u8bdd\u9898\u3002\u5bf9\u5b83\u63cf\u8ff0\u65f6\u4e0d\u5f97\u4e0d\u5206\u6210\u591a\u5c42\uff1a</p> <ul> <li>\u5e94\u7528\u5c42\uff08\u5373\u6211\u4eec\u7f16\u5199\u7684App\uff09</li> <li>\u6e32\u67d3\u6846\u67b6\u5c42\uff08\u7531\u5e94\u7528\u5f15\u5165\uff0c\u6bd4\u5982\u539f\u751f\u7684View/\u8de8\u7aef\u7684Compose/Flutter/RN/etc...\uff09</li> <li>\u5e73\u53f0\u6e32\u67d3\u6846\u67b6\u5c42\uff08\u4ece\u5e94\u7528\u8fdb\u7a0b\u5185\u7684\u5e73\u53f0\u6846\u67b6\u5230\u7cfb\u7edf\u670d\u52a1\u8fdb\u7a0b\u5185\u7684\u670d\u52a1\uff09</li> <li>OpenGL/Vulkan &amp; \u7cfb\u7edf\u5185\u6838\u5c42 &amp; \u786c\u4ef6\u5c42</li> </ul> <p>\u800c\u672c\u6587\u5185\u5bb9\u4e3b\u8981\u8ba8\u8bba\u5176\u4e2d\u7684\u7b2c\u4e09\u5c42\uff0c\u5bf9\u4e8e\u7b2c\u4e8c\u5c42\u7684\u6e32\u67d3\u6846\u67b6\uff0c\u53ef\u4ee5\u53c2\u9605\u201c\u8de8\u7aef\u6280\u672f\u201dsection\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_1","title":"\u5e94\u7528\u8fdb\u7a0b\u5185","text":"<p>\u5148\u8bb0\u5f55\u51e0\u4e2a\u91cd\u8981\u7684\u5806\u6808\uff0c\u65b9\u4fbf\u5feb\u901f\u53c2\u8003\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#activity","title":"activity\u9996\u6b21\u6e32\u67d3\u8c03\u7528\u6808","text":"<p>\u4e5f\u5c31\u662f\u5728activityThread#handleResumeActivity\u7684\u65f6\u5019\uff0c\u6ce8\u610f\u5e76\u975e\u662f\u5728\u5176\u4ed6Activity\u751f\u547d\u5468\u671f\uff0c\u800c\u662fResume\u3002</p> <pre><code>scheduleTraversals:1946, ViewRootImpl (android.view)        \nrequestLayout:1632, ViewRootImpl (android.view)\nsetView:981, ViewRootImpl (android.view)\naddView:399, WindowManagerGlobal (android.view)\naddView:95, WindowManagerImpl (android.view)\nhandleResumeActivity:4638, ActivityThread (android.app)     &lt;------\u91cd\u70b9\u5f00\u59cb\nexecute:52, ResumeActivityItem (android.app.servertransaction)\nexecuteLifecycleState:181, TransactionExecutor (android.app.servertransaction)\nexecute:102, TransactionExecutor (android.app.servertransaction)\nhandleMessage:2239, ActivityThread$H (android.app)\ndispatchMessage:107, Handler (android.os)\nloop:237, Looper (android.os)\nmain:7830, ActivityThread (android.app)\ninvoke:-1, Method (java.lang.reflect)\nrun:492, RuntimeInit$MethodAndArgsCaller (com.android.internal.os)\nmain:1040, ZygoteInit (com.android.internal.os)\n</code></pre>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#viewdraw","title":"View.draw\u7684\u4e00\u822c\u8c03\u7528\u6808","text":"<pre><code>onDraw:43, MainActivity$TestView (org.tu.android)\ndraw:21813, View (android.view)\nupdateDisplayListIfDirty:20642, View (android.view)\ndraw:21525, View (android.view)\ndrawChild:4542, ViewGroup (android.view)\ndispatchDraw:4279, ViewGroup (android.view)\ndraw:21820, View (android.view)\ndraw:869, DecorView (com.android.internal.policy)\nupdateDisplayListIfDirty:20642, View (android.view)\nupdateViewTreeDisplayList:575, ThreadedRenderer (android.view)\nupdateRootDisplayList:581, ThreadedRenderer (android.view)\ndraw:654, ThreadedRenderer (android.view)\ndraw:4129, ViewRootImpl (android.view)\nperformDraw:3917, ViewRootImpl (android.view)\nperformTraversals:3223, ViewRootImpl (android.view)\ndoTraversal:2054, ViewRootImpl (android.view)\nrun:8459, ViewRootImpl$TraversalRunnable (android.view)\nrun:1065, Choreographer$CallbackRecord (android.view)\ndoCallbacks:889, Choreographer (android.view)\ndoFrame:816, Choreographer (android.view)             &lt;------\u91cd\u70b9\u5f00\u59cb\nrun:1050, Choreographer$FrameDisplayEventReceiver (android.view)\nhandleCallback:883, Handler (android.os)\ndispatchMessage:100, Handler (android.os)\nloop:237, Looper (android.os)\nmain:7830, ActivityThread (android.app)\ninvoke:-1, Method (java.lang.reflect)\nrun:492, RuntimeInit$MethodAndArgsCaller (com.android.internal.os)\nmain:1040, ZygoteInit (com.android.internal.os)\n</code></pre>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#choreographer","title":"choreographer \u6e32\u67d3\u65f6\u673a","text":"<p>\u800c\u4e0a\u9762\u7684<code>doFrame</code>\u662f\u5982\u4f55\u6765\u7684\u5462:</p> <p><code>ViewRootImpl#scheduleTraversals</code> -&gt; <code>choreographer.postCallback</code> -&gt; <code>choreographer#scheduleVsync</code> ...-&gt;  <code>dispatchVsync(from native, activity thread, message queue, next.)</code></p> <p><pre><code>onVsync:1042, Choreographer$FrameDisplayEventReceiver (android.view)\ndispatchVsync:187, DisplayEventReceiver (android.view)           &lt;------\u91cd\u70b9\u5f00\u59cb\nnativePollOnce:-1, MessageQueue (android.os)\nnext:336, MessageQueue (android.os)\nloop:184, Looper (android.os)\nmain:7830, ActivityThread (android.app)\ninvoke:-1, Method (java.lang.reflect)\nrun:492, RuntimeInit$MethodAndArgsCaller (com.android.internal.os)\nmain:1040, ZygoteInit (com.android.internal.os)\n</code></pre> \u5728<code>onVsync</code>\u4e4b\u540e\u4f1a\u7ecf\u8fc7\u5982\u4e0b\u8c03\u7528\u76f4\u5230\u53d1\u8d77<code>doFrame</code></p> <p><code>choreographer#onVsync</code> -&gt; <code>FrameHandler.message(\u8ba1\u7b97\u65f6\u95f4\u5ef6\u8fdf)</code> -&gt; <code>FrameDisplayEventReceiver#onRun</code> -&gt; <code>doFrame</code></p> <p>\u6b64Vsync\u4e8b\u4ef6\u6765\u81ea\u4e8eSurfacefingler/Scheduler/EventThread#dispatchEvent</p> <p>\u63d0\u9192\u4e00\u4e0b:</p> <p>ActivityThread\u7684looper\u4e5f\u5c31\u662fmainLooper\u662f\u4f1a\u88ab\u591a\u4e2ahandler\u6240\u4f7f\u7528\u3002\u4e5f\u5c31\u662f\u5c3d\u7ba1\u90fd\u590d\u7528\u7740\u4e00\u4e2amessageQueue\uff0c\u4f46\u662fmessage\u7684target\u4e0d\u540c\uff08handler\u4e0d\u540c\uff09\u3002</p> <p>\u51e0\u4e2a\u5e38\u89c1\u7684Handler:</p> <ul> <li>ActivityThread#H \u7528\u4e8e\u5904\u7406\u591a\u4e2aActivity\u751f\u547d\u5468\u671f\u3001application\u5468\u671f\u76f8\u5173\u4e8b\u60c5</li> <li>Choregrapher#FrameHandler \u7528\u4e8escheduleVsync, doFrame</li> </ul>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_2","title":"\u6d41\u7a0b\u63cf\u8ff0","text":"<p>\u7efc\u4e0a\u5185\u5bb9</p> <ul> <li><code>context.getSystemService</code>\u662f\u6765\u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u7684\u7cfb\u7edf\u670d\u52a1\u201c\u5ba2\u6237\u7aef\u201d\uff0c\u4e00\u822c\u662fxxServiceImpl\uff0c\u800c\u7cfb\u7edf\u670d\u52a1\u7684\u201c\u670d\u52a1\u7aef\u201d\u662f\u5728\u4ed6\u4eec\u81ea\u5df1\u7684\u8fdb\u7a0b\u4e4b\u4e2d\uff0c\u4e00\u822c\u662f\u201cxxManagerService\u201d\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u901a\u4fe1\u4e00\u822c\u4f7f\u7528binder\u673a\u5236\uff0ctransact-&gt;onTransact-&gt;\u670d\u52a1\u7aef\u65b9\u6cd5\u5b9e\u73b0</li> <li>\u5bf9\u4e8eactivity\u4e5f\u597d\uff0cdialog\u4e5f\u597d\uff0c\u6216\u8005\u662f\u7c7b\u4f3c\u60ac\u6d6e\u7a97\u8fd9\u79cd\u9700\u8981\u5728window\u6dfb\u52a0\u81ea\u5b9a\u4e49view\u7684\uff0c\u672c\u8d28\u4e0a\u90fd\u662f<code>windowManagerService#addView(View, WParam)</code>\uff0c\u8fd9\u4e2aView\u5bf9\u4e8eactivity\u548cdialog\u6765\u8bf4\u90fd\u662fdecorView\uff0c\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u6d6e\u7a97\u6765\u8bf4\u5c31\u662f\u81ea\u5df1\u7684view\u3002</li> <li>\u5728<code>WindowManager#addView</code>\u8fd9\u4e2a\u65b9\u6cd5\u91cc\uff0c\u4f1a\u901a\u8fc7\u8fdb\u7a0b\u5185\u7684\u5355\u4f8b<code>WindowManagerGlobal</code>\u6765\u5b8c\u6210\u5177\u4f53\u5b9e\u73b0\u3002\u4e3b\u8981\u5305\u62ec\u521b\u5efaViewRootImpl, WParam\u51c6\u5907\uff0c\u7136\u540e\u8bb0\u5f55\u5230list(View), list(ViewRootImpl), list(WParam)\u3002\u6700\u540e\u4f1a\u8c03\u7528<code>ViewRootImpl#setView</code>.  \u4e5f\u5c31\u662f\u8bf4\uff0c\u65e0\u8bba\u662factivity, dialog\u8fd8\u662f\u81ea\u5df1\u7684view\uff0c\u5176\u5b9e\u5728wm\u7684Add\u8fc7\u7a0b\u4e2d\u90fd\u4f1a\u88ab\u521b\u5efa\u4e00\u4e2a<code>ViewRootImpl</code>\uff0c\u4e0d\u8fc7\u5bf9\u4e8eactivity\u6765\u8bf4\uff0c\u662f\u5728<code>handleResumeActivity</code>\u7684\u65f6\u5019\u3002\u5e76\u4e14\u4f1a\u8bb0\u5f55\u53ea\u9700\u8981\u521b\u5efa\u4e00\u6b21\uff0c\u53ea\u6709\u5728<code>handleDestroyActivity</code>\u7684\u65f6\u5019\u624d\u8c03\u7528<code>wm#removeView</code>\u4e0e\u4e4b\u5bf9\u5e94\u3002\u800c\u975epause\u7684\u65f6\u5019\u3002</li> <li>\u5728<code>ViewRootImpl#setView</code>\u7684\u65f6\u5019\uff0c\u4f1a\u5904\u7406\u5f88\u591a\u4e8b\u60c5\uff0c\u5305\u62ec<code>requestLayout</code>\u3001<code>mWindowSession.addToDisplayAsUser</code>\u3001\u51c6\u5907\u4e8b\u4ef6\u5206\u53d1stage\u3002</li> <li><code>requestLayout-&gt;scheduleTranversals-&gt;Choreographer.postCallback-&gt;Choreographer#scheduleVsync</code>\uff0c\u7b49\u5f85\u4e0b\u4e00\u4e2aChoreographer\u7684<code>dispatchVsync\uff08\u4f1a\u7531\u4e3b\u7ebf\u7a0b\u7684looper\u7684messageQueue\u7684next\u7684native\u6765\u89e6\u53d1\u56de\u8c03\uff09</code> -&gt; <code>Choreographer#doFrame</code> ...-&gt; <code>ViewRootImpl#performTraversals</code>(scheduleTraversals\u65b9\u6cd5\u7528\u5230\u4e86MessageQueue\u5f02\u6b65message, \u53d1\u9001\u4e86\u540c\u6b65\u6805\u680f\uff0c\u800c\u5728doTraversals\u7684\u65f6\u5019\u5220\u9664\u4e86\u6805\u680f)\u3002</li> <li><code>mWindowSession.addToDisplayAsUser</code>\u7684<code>mWindowSeesion</code>\u7531<code>WindowManagerGlobal#getSession</code>\u83b7\u53d6\uff0c\u5728\u8fdb\u7a0b\u5185\u4e5f\u552f\u4e00\uff0c\u9996\u6b21\u83b7\u53d6\u4f1a\u901a\u8fc7<code>IWindowManager</code>\u5373<code>WindowManagerService</code>\u7684\u63a5\u53e3\u6765<code>openSession</code>\uff0c\u5b83\u662f\u4e00\u4e2aIPC\u63a5\u53e3\uff0c\u5176<code>addToDisplay</code>\u7684\u5b9e\u73b0\u4e2d\u4f1a\u8c03\u7528\u5230<code>WindowManagerService#addWindow(WindowSession, IWindow...)</code>\u6765\u5b8c\u6210Window\u7684\u6dfb\u52a0\u3002\u5176\u4e2d<code>IWindow</code>\u662f\u670d\u52a1\u7aef\u5bf9\u5ba2\u6237\u7aef\u8c03\u7528\u63a5\u53e3\uff0c\u5b83\u7684\u5b9e\u73b0\u662f<code>ViewRootImpl#W</code>\u8fd9\u4e2a\u7c7b\uff0c\u4e3b\u8981\u901a\u77e5\u4e00\u4e9b\u7a97\u53e3\u7684\u53d8\u66f4\u4e8b\u4ef6\u3002</li> <li>\u5728<code>ViewRootImpl#performTraversals</code>\u7684\u65f6\u5019\uff0c\u4f1a\u8fdb\u884cview\u7684measure, layout, draw\u3002draw\u7684\u65f6\u5019\uff0c\u786c\u4ef6\u7ed8\u5236\u4f1a\u53bbThreadedRenderer\u6765\u8fdb\u884c\uff0c\u5176\u8fc7\u7a0b\u5305\u62ec\uff0c<code>ThreadedRenderer#updateRootDisplayList</code>\u3001<code>syncAndDrawFrame(native)</code>\uff0c\u5982\u5176\u6240\u8ff0\uff0c\u5148\u66f4\u65b0displayList\uff0c\u518d\u505anativeSync\u3002\u8f6f\u7ed8\u7684\u65f6\u5019\u662fsurface\u7684lockCanvas\u6765\u8fdb\u884c\uff0c\u89c1<code>ViewRootImpl#drawSoftware</code>\u3002</li> <li>displayList\u5176\u5b9e\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4e3a\u4e86\u5728\u786c\u7ed8\u65f6\u8bb0\u5f55\u7ed8\u5236\u6307\u4ee4\u3002\u8fd9\u5757\u7684canvas\u662f\u901a\u8fc7<code>RenderNode#beginRecording</code>\u6765\u83b7\u5f97\u7684<code>RecordingCanvas(extends DisplayListCanvas)</code>.</li> <li>\u65e0\u8bba\u662f\u8f6f\u7ed8\uff0c\u8fd8\u662f\u786c\u7ed8\uff0c\u8fd9\u91cc\u6240\u8ff0\u5176\u5b9e\u90fd\u662f\u57fa\u4e8ecanvas\u7684api\u7684\u7ed8\u5236\u3002\u4ee5\u53ca\u5982\u679c\u53d1\u73b0\u5f00\u542f\u4e86\u786c\u4ef6\u52a0\u901f\u7684\u65f6\u5019 <pre><code>mAttachInfo.mThreadedRenderer = ThreadedRenderer.create(mContext, translucent,attrs.getTitle().toString());\n</code></pre> \u8fd9\u91cc\u4f1a\u76f4\u63a5\u8d70\u5230\u5b83\u7684\u6784\u9020\u65b9\u6cd5ThreadedRenderer: HardwareRenderer\uff0c\u642c\u8fd0\u4e00\u4e0b\u6ce8\u91ca\uff1a <p>\u521b\u5efa\u786c\u4ef6\u52a0\u901f\u6e32\u67d3\u5668\u7684\u5b9e\u4f8b\u3002 \u8fd9\u7528\u4e8e\u5c06\u4eceRenderNode\u6784\u5efa\u7684\u573a\u666f\u6e32\u67d3\u5230\u8f93\u51faSurface \u3002 \u53ef\u4ee5\u6839\u636e\u9700\u8981\u6709\u4efb\u610f\u6570\u91cf\u7684HardwareRenderer\u5b9e\u4f8b\u3002 \u8d44\u6e90\u548c\u751f\u547d\u5468\u671f \u6240\u6709HardwareRenderer\u5b9e\u4f8b\u5171\u4eab\u4e00\u4e2a\u516c\u5171\u7684\u6e32\u67d3\u7ebf\u7a0b\u3002 \u6e32\u67d3\u7ebf\u7a0b\u5305\u542b\u6267\u884cGPU\u52a0\u901f\u6e32\u67d3\u6240\u9700\u7684GPU\u4e0a\u4e0b\u6587\u548c\u8d44\u6e90\u3002 \u8fd9\u6837\uff0c\u521b\u5efa\u7684\u7b2c\u4e00\u4e2aHardwareRenderer\u5e26\u6709\u521b\u5efa\u5173\u8054\u7684GPU\u4e0a\u4e0b\u6587\u7684\u6210\u672c\uff0c\u4f46\u662f\u6b64\u540e\u6bcf\u4e2a\u589e\u91cf\u7684HardwareRenderer\u90fd\u76f8\u5f53\u4fbf\u5b9c\u3002 \u9884\u671f\u7684\u7528\u6cd5\u662f\u4e3a\u6bcf\u4e2a\u6d3b\u52a8\u7684Surface\u90fd\u6709\u4e00\u4e2aHardwareRenderer\u5b9e\u4f8b\u3002 \u4f8b\u5982\uff0c\u5f53\u201c\u6d3b\u52a8\u201d\u663e\u793a\u201c\u5bf9\u8bdd\u6846\u201d\u65f6\uff0c\u7cfb\u7edf\u5185\u90e8\u5c06\u4f7f\u75282\u4e2a\u786c\u4ef6\u6e32\u67d3\u5668\uff0c\u8fd9\u4e24\u4e2a\u6e32\u67d3\u5668\u53ef\u80fd\u540c\u65f6\u7ed8\u5236\u3002 \u6ce8\u610f\uff1a\u7531\u4e8e\u6e32\u67d3\u7ebf\u7a0b\u5177\u6709\u5171\u4eab\uff0c\u534f\u4f5c\u7684\u6027\u8d28\uff0c\u56e0\u6b64\u81f3\u5173\u91cd\u8981\u7684\u662f\uff0c\u6240\u4f7f\u7528\u7684\u4efb\u4f55Surface\u5fc5\u987b\u5177\u6709\u8fc5\u901f\uff0c\u53ef\u9760\u7684\u4f7f\u7528\u65b9\u3002 \u7cfb\u7edf\u63d0\u4f9b\u7684\u4f7f\u7528\u8005\uff0c\u4f8b\u5982android.view.SurfaceView \uff0candroid.view.Window.takeSurface(SurfaceHolder.Callback2)\u6216android.view.TextureView\u5747\u7b26\u5408\u6b64\u8981\u6c42\u3002 \u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528\u81ea\u5b9a\u4e49\u4f7f\u7528\u8005\uff08\u4f8b\u5982\u5728\u4f7f\u7528SurfaceTexture\u6216android.media.ImageReader \uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u6709\u8d23\u4efb\u786e\u4fdd\u4ed6\u4eec\u8fc5\u901f\uff0c\u8fc5\u901f\u5730\u4f7f\u7528\u66f4\u65b0\u3002 \u5426\u5219\uff0c\u5c06\u5bfc\u81f4\u6e32\u67d3\u7ebf\u7a0b\u505c\u6ede\u5728\u8be5\u8868\u9762\u4e0a\uff0c\u4ece\u800c\u963b\u585e\u6240\u6709HardwareRenderer\u5b9e\u4f8b</p> </li> </ul> <p>\u6240\u4ee5PhoneWindow\u53c8\u662f\u6709\u4f55\u7528\uff1f\u5173\u4e8ewindow\u7684\u6ce8\u91ca\uff1a</p> <p>\u9876\u7ea7\u7a97\u53e3\u5916\u89c2\u548c\u884c\u4e3a\u7b56\u7565\u7684\u62bd\u8c61\u57fa\u7c7b\u3002 \u6b64\u7c7b\u7684\u5b9e\u4f8b\u5e94\u7528\u4f5c\u6dfb\u52a0\u5230\u7a97\u53e3\u7ba1\u7406\u5668\u7684\u9876\u7ea7\u89c6\u56fe\u3002 \u5b83\u63d0\u4f9b\u4e86\u6807\u51c6\u7684UI\u7b56\u7565\uff0c\u4f8b\u5982\u80cc\u666f\uff0c\u6807\u9898\u533a\u57df\uff0c\u9ed8\u8ba4\u952e\u5904\u7406\u7b49\u3002</p> <p>\u6b64\u62bd\u8c61\u7c7b\u7684\u552f\u4e00\u73b0\u6709\u5b9e\u73b0\u662fandroid.view.PhoneWindow\uff0c\u60a8\u9700\u8981\u5728\u9700\u8981Window\u65f6\u5b9e\u4f8b\u5316\u8be5\u5b9e\u4f8b \u601d\u8003\u4e0b\u6211\u4eec\u5e73\u65f6\u5f00\u53d1\u4e2d\uff0c\u5173\u4e8ephoneWindow\u7684\u4f7f\u7528\u4e5f\u4e3b\u8981\u662f\uff0c<code>activity#getWindow#getDecorView</code>, \u6216\u8005<code>activity#getWindow#getAttributes#....</code>\u56e0\u6b64\uff0c\u5f88\u5bb9\u6613\u770b\u51fa\u6765\uff0cPhoneWindow\u5176\u5b9e\u4e3b\u8981\u662f\u7528\u4e8e\u7ba1\u7406View\u7ed3\u6784\u548c\u7a97\u53e3\u7684\u4e00\u4e9b\u5c5e\u6027\u7684(\u6807\u9898\u3001\u80cc\u666f\u8272\u3001action_bar..)\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#window-viewrootimpl-decorview","title":"window, viewRootImpl, decorView\u5173\u7cfb","text":"<ul> <li>Activity {window, decorView}</li> <li>DecorView {viewRootImpl}</li> <li>WindowManagerGlobal {list(decorView), list(ViewRootImpl)}</li> <li>Window {DecorView}</li> <li>ViewRootImpl {mWindow: W: IWindow.Stub}</li> </ul>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_3","title":"\u5e94\u7528\u8fdb\u7a0b\u5916","text":""},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#bufferqueue","title":"\u751f\u4ea7\u8005\u6d88\u8d39\u8005\uff0cBufferQueue","text":"<p>\u4e0b\u9762\u8bf4\u8bf4Surface, SurfaceFlinger\u3002\u56e0\u4e3a\u5728\u6d4f\u89c8\u6e90\u7801\u65f6\u53d1\u73b0\u548c\u4e00\u4e9b\u6587\u7ae0\u5df2\u7ecf\u5bf9\u5e94\u4e0d\u4e0a\u3002\u7d22\u6027\u4ee5\u6700\u65b0\u7684\u6e90\u7801\uff082021\u5e7410\u6708\u770b\u5230\u7684\uff09\u6765\u634b\u4e00\u4e0b\u91cc\u9762\u7684\u73af\u8282\u3002</p> <p>\u4e0d\u4f1a\u53d8\u7684\u662f\uff0c\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b\uff0c\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\uff0c\u8fde\u63a5\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u7684\u201c\u4f20\u9001\u5e26\u201d\u662f<code>BufferQueue</code>\uff0c\u521b\u5efa<code>BufferQueue</code>\u4e00\u822c\u6240\u7528\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a <pre><code>void BufferQueue::createBufferQueue(sp&lt;IGraphicBufferProducer&gt;* outProducer,\n        sp&lt;IGraphicBufferConsumer&gt;* outConsumer,\n        bool consumerIsSurfaceFlinger) {\n    ...\n    sp&lt;BufferQueueCore&gt; core(new BufferQueueCore());\n    sp&lt;IGraphicBufferProducer&gt; producer(new BufferQueueProducer(core, consumerIsSurfaceFlinger));\n    sp&lt;IGraphicBufferConsumer&gt; consumer(new BufferQueueConsumer(core));\n    *outProducer = producer;\n    *outConsumer = consumer;\n    ...\n}\n</code></pre> \u5373\u4f1a\u8fd4\u56de\u4e24\u4e2a\u5bf9\u8c61producer\u548cconsumer\u6765\u4f7f\u7528\u3002\u5bf9\u4e8eproducer\uff0c\u4e00\u822c\u4f7f\u7528<code>dequeueBuffer</code>\u83b7\u53d6buffer\u6765\u88c5\u586b\u6570\u636e\uff0c\u518d<code>enqueueBuffer</code>\u5165\u5217\u3002\u5bf9\u4e8econsumer\uff0c\u4e00\u822c\u4f7f\u7528<code>acquireBuffer</code>\u83b7\u53d6buffer\u6570\u636e\u7528\u4e8e\u5c55\u793a\u3001\u6216\u5176\u4ed6\u6d88\u8d39\uff0c\u518d<code>releaseBuffer</code>\u91ca\u653e\u3002</p> <p></p> <p>\u5e38\u89c1\u7684\u751f\u4ea7\u8005\u5305\u542b\uff1a</p> <ul> <li>Surface\uff0c\u5982window\uff0cSurfaceView</li> <li>\u76f8\u673a\u8bbe\u5907</li> <li>\u5a92\u4f53\u89e3\u7801\u5668</li> <li>\u5c4f\u5e55\u5f55\u5236</li> </ul> <p>\u5e38\u89c1\u7684\u6d88\u8d39\u8005\u5305\u542b\uff1a</p> <ul> <li>ComposeEngine\uff0c\u7528\u4e8e\u5408\u6210\u5c42\u7684</li> <li>ImageReader</li> <li>\u5176\u4ed6\u7c7b\u578b\u7684Callback\u3002</li> </ul> <p>\u8fd9\u4e9b\u4f7f\u7528\u573a\u666f\u53ef\u4ee5\u641c\u7d22<code>BufferQueue::createBufferQueue</code>\u7684\u8c03\u7528\u6765\u67e5\u9605\u3002\u6b64\u5916\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c<code>IGraphicBufferProducer/Consumer</code>\u7b49\u90fd\u662f<code>IInterface</code>\u5b50\u7c7b\uff0c\u90fd\u662f\u53ef\u7528\u4e8e\u8de8\u8fdb\u7a0b\u7684\u63a5\u53e3\u3002\u4e5f\u5c31\u662f\u8bf4\u4e0a\u8ff0\u7684\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u5f88\u591a\u60c5\u51b5\u4e0b\u80cc\u540e\u90fd\u662f\u9760Binder\u5728\u8fdb\u884cIPC\u901a\u4fe1\u7684\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_4","title":"\u751f\u4ea7\u73af\u8282","text":""},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#surface-surfacecontrol-surfacesession","title":"Surface, SurfaceControl, SurfaceSession\u5173\u7cfb","text":"<p>Surface\u63a5\u6536\u4e00\u4e2aIGraphicBufferProducer\uff0c\u5b83\u4e00\u822c\u4ece\u4e24\u79cd\u65b9\u5f0f\u521b\u5efa\uff0c<code>SurfaceControl</code>\uff0c<code>SurfaceTexture</code> <pre><code>static jlong nativeCreateFromSurfaceControl(JNIEnv* env, jclass clazz,\n        jlong surfaceControlNativeObj) {\n    sp&lt;SurfaceControl&gt; ctrl(reinterpret_cast&lt;SurfaceControl *&gt;(surfaceControlNativeObj));\n    sp&lt;Surface&gt; surface(ctrl-&gt;createSurface());\n    if (surface != NULL) {\n        surface-&gt;incStrong(&amp;sRefBaseOwner);\n    }\n    return reinterpret_cast&lt;jlong&gt;(surface.get());\n}\n</code></pre></p> <p><pre><code>static jlong nativeCreateFromSurfaceTexture(JNIEnv* env, jclass clazz,\n        jobject surfaceTextureObj) {\n    sp&lt;IGraphicBufferProducer&gt; producer(SurfaceTexture_getProducer(env, surfaceTextureObj));\n    ...\n    sp&lt;Surface&gt; surface(new Surface(producer, true));\n    ...\n}\n</code></pre> \u4e3b\u8981\u662f\u83b7\u53d6\u5230\u4e86<code>IGraphicBufferProducer</code>\uff0c\u7531\u6b64\u5176\u4e3b\u8981\u529f\u80fd\u4e5f\u662f\u7528\u4e8e\u751f\u4ea7\u56fe\u50cf\u6570\u636e\u3002</p> <p><code>SurfaceContrl</code>\u5219\u662f\u7528\u4e8e\u63a5\u53d7WindowManager\u7ba1\u7406Surface\u53e5\u67c4\uff0c\u4ece\u8fd9\u91cc\u83b7\u5f97\u7684Surface\u53ef\u4ee5\u7528\u4e8e\u5411\u5408\u6210\u5668\u63d0\u4ea4\u6570\u636e\uff0c\u5b83\u4f1a\u6709\u5c42\u7ea7\u7ed3\u6784\uff0c\u5373\u62e5\u6709\u7236\u5b50\u5173\u7cfb\u3002\u642c\u8fd0\u4e0b\u6ce8\u91ca\uff1a <pre><code>/**\n * Handle to an on-screen Surface managed by the system compositor. The SurfaceControl is\n * a combination of a buffer source, and metadata about how to display the buffers.\n * By constructing a {@link Surface} from this SurfaceControl you can submit buffers to be\n * composited. Using {@link SurfaceControl.Transaction} you can manipulate various\n * properties of how the buffer will be displayed on-screen. SurfaceControl's are\n * arranged into a scene-graph like hierarchy, and as such any SurfaceControl may have\n * a parent. Geometric properties like transform, crop, and Z-ordering will be inherited\n * from the parent, as if the child were content in the parents buffer stream.\n */\n public final class SurfaceControl implements Parcelable {\n</code></pre></p> <p>\u800c\u771f\u6b63\u548c\u7cfb\u7edf<code>WindowManagerService</code>\u6253\u4ea4\u9053\u7684\u4e5f\u662f<code>SurfaceControl</code>\uff0c\u68c0\u67e5\u4e86\u4e0b<code>IWindowManager.aidl</code>\u548c<code>IWindowSession.aidl</code>\u91cc\u4e5f\u53ea\u6709<code>relayout</code>\u4e2d\u7528\u4e86<code>SurfaceControl</code>\u7684\u7c7b\uff0c\u5176\u4ed6\u65b9\u6cd5\u5747\u4e3a\u6d89\u53ca<code>Surface</code>\u3002</p> <p><code>SurfaceSession</code>\u4ee3\u8868\u4e86\u548c<code>SurfaceFligner</code>\u7684\u4e00\u4e2a\u8fde\u63a5\u3002\u5b83\u7684\u521d\u59cb\u5316\u4e2d\u53ea\u6709\u5173\u952e\u7684\u4e00\u53e5<code>client = new SurfaceComposerClient();</code>\uff0c\u8fd9\u4e2aclient\u63d0\u4f9b\u4e86<code>ISurfaceComposerClient</code>\u63a5\u53e3\u8bbf\u95ee\uff0c\u800c\u5b83\u4e5f\u662f<code>IInterface</code>\u5b50\u7c7b\uff0c\u6beb\u65e0\u7591\u95ee\uff0c\u6b64client\u9700\u8981Binder IPC\u53bb\u8c03\u7528<code>SurfaceFlingerClient</code>\u7684\u529f\u80fd\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#viewrootimplsurface","title":"ViewRootImpl\u521b\u5efaSurface","text":"<p>\u6d41\u7a0b\u5927\u81f4\u662f\uff1a</p> <ul> <li>ViewRootImpl#performTraversals</li> <li>ViewRootImpl#relayoutWindow(\u5728performMeasure\u4e4b\u524d)\u6b64\u65f6\u8fc7\u7a0b\u6700\u7ec8\u4f1a\u5f97\u5230\u6709\u6548\u7684SurfaceControl\uff0c\u800cSurface\u4fbf\u662f\u53d6\u81ea\u6b64SurfaceControl\u3002</li> <li>Session#relayout</li> <li>WindowManagerService#relayoutWindow</li> <li>session.createSurfaceControl</li> <li>WindowManagerService#createSurfaceControl</li> <li>WindowStateAnimator#createSurfaceLocked</li> <li>SurfaceControl.Builder()....build()-&gt;new SurfaceControl-&gt;SurfaceControl#nativeCreate</li> <li>SurfaceComposerClient#createSurfaceChecked</li> <li>surfaceflinger.Client.cpp#createSurface</li> <li>SurfaceFlinger.cpp#createLayer.\u6839\u636e\u7c7b\u578b\u9009\u62e9\u521b\u5efa\u7684Layer\u3002</li> <li>getFactory()#createBufferQueueLayer\u3002</li> </ul> <p>\u5feb\u901f\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\uff0cViewRootImpl\u4f1a\u81f3\u5c11\u5305\u542b\u4e00\u4e2aSurface\uff0cSurface\u7684\u521b\u5efa\u4f1a\u901a\u8fc7WindowManagerGloabl.getSession().createSurfaceControl()\uff0c\u8fdb\u800c\u5b9e\u9645\u662fSurfaceControl.Builder.build()\uff0c\u6700\u540e\u7531Surfaceflinger.Client.createSurface\u6765\u8c03\u7528\u5230SurfaceFlinger.createLayer/createBufferQueueLayer\u6765\u5b8c\u6210\u3002\u5373Surface\u5bf9\u5e94\u4e86SurfaceFlinger\u7684Layer\u3002\u5e76\u4e14\u6709\u5efa\u7acbBufferQueue\uff0c\u6d88\u8d39\u8005\u662fBufferQueueConsumer\uff0c\u5373surfaceFligner\u4fa7\uff0c\u751f\u4ea7\u8005\u662fViewRootImpl\u4fa7\u3002wms\u6709\u4e9b\u7c7b\u4f3c\u626e\u6f14\u4e86\u6865\u6881\u7684\u4f5c\u7528\u3002</p> <p>\u8fd9\u91cc\u9700\u8981\u6d89\u53ca\u4e00\u4e0b\u6d88\u8d39\u8005\uff0c\u5728BufferQueueLayer::onFirstRef()\u4e2d\uff0c\u4f1a\u6709</p> <pre><code>void BufferQueueLayer::onFirstRef() {\n    BufferLayer::onFirstRef();\n\n    // Creates a custom BufferQueue for SurfaceFlingerConsumer to use\n    sp&lt;IGraphicBufferProducer&gt; producer;\n    sp&lt;IGraphicBufferConsumer&gt; consumer;\n    mFlinger-&gt;getFactory().createBufferQueue(&amp;producer, &amp;consumer, true);\n    mProducer = mFlinger-&gt;getFactory().createMonitoredProducer(producer, mFlinger, this);\n    mConsumer =\n            mFlinger-&gt;getFactory().createBufferLayerConsumer(consumer, mFlinger-&gt;getRenderEngine(),\n                                                             mTextureName, this);\n    mConsumer-&gt;setConsumerUsageBits(getEffectiveUsage(0));\n\n    mContentsChangedListener = new ContentsChangedListener(this);\n    mConsumer-&gt;setContentsChangedListener(mContentsChangedListener);\n    mConsumer-&gt;setName(String8(mName.data(), mName.size()));\n\n    mProducer-&gt;setMaxDequeuedBufferCount(2);\n}\n</code></pre> <p>\u5373\u4e3a\u6b64<code>BufferQueueLayer</code>\u521b\u5efa\u4e86<code>BufferQueue</code>\uff0c\u5e76\u628aconsumer\u8bbe\u5b9a\u4e3a<code>BufferLayerConsumer</code>\uff08\u6ce8\u610f\u53ea\u6709<code>BufferQueueLayer</code>\u6709\u8fd9\u4e2a\u79c1\u6709\u6210\u5458\uff0c<code>BufferLayerConsumer</code>\uff09\uff0c\u800c\u8fd9\u4e2aconsumer\u4f1a\u5728<code>updateTextImage</code>\u65f6\u8c03\u7528<code>acquireBuffer</code>\uff0c\u5982\u4e0b\uff1a</p> <p><pre><code>status_t BufferLayerConsumer::updateTexImage(BufferRejecter* rejecter, nsecs_t expectedPresentTime,\n                                             bool* autoRefresh, bool* queuedBuffer,\n                                             uint64_t maxFrameNumber) {\n    ...\n    status_t err = acquireBufferLocked(&amp;item, expectedPresentTime, maxFrameNumber);\n    ...\n}\n</code></pre> \u6545\u800c\u53ef\u4ee5\u628a\u6700\u65b0\u7684BufferQueue\u91cc\u7684Buffer\u66f4\u65b0\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_5","title":"\u6d88\u8d39\u73af\u8282","text":"<p>\u5728SurfaceFlinger\u6d88\u8d39\u65f6\uff0c\u4f9d\u7136\u9700\u8981\u7b49\u5f85Vsync\u7684\u4fe1\u53f7\u3002\u5b83\u662f\u5728surfaceflinger/MessageQueue#initVsync\u7684\u65f6\u5019\uff0c\u6ce8\u518c\u7684Vsync\u56de\u8c03\uff0c\u5728\u56de\u8c03\u91cc\u53d1\u9001Invalidate\u4fe1\u606f\uff0c\u8fdb\u800c\u5206\u53d1\u5230<code>SurfaceFlinger#handleMessageInvalidate</code>: <pre><code>bool SurfaceFlinger::handleMessageInvalidate() {\n    ATRACE_CALL();\n    bool refreshNeeded = handlePageFlip();\n\n    // Send on commit callbacks\n    mTransactionCallbackInvoker.sendCallbacks();\n\n    if (mVisibleRegionsDirty) {\n        computeLayerBounds();\n    }\n\n    for (auto&amp; layer : mLayersPendingRefresh) {\n        Region visibleReg;\n        visibleReg.set(layer-&gt;getScreenBounds());\n        invalidateLayerStack(layer, visibleReg);\n    }\n    mLayersPendingRefresh.clear();\n    return refreshNeeded;\n}\n</code></pre></p> <p>\u5982\u679c\u9700\u8981\u5237\u65b0\uff0c\u8fdb\u800c\u89e6\u53d1\uff1a</p> <p><pre><code>SurfaceFlinger::onMessageRefresh(){\n    ...\n    mCompositionEngine-&gt;present(refreshArgs);           &lt;-----\u91cd\u70b9\n    mTimeStats-&gt;recordFrameDuration(mFrameStartTime, systemTime());\n    // Reset the frame start time now that we've recorded this frame.\n    mFrameStartTime = 0;\n\n    mScheduler-&gt;onDisplayRefreshed(presentTime);\n\n    postFrame();\n    postComposition();\n}\n</code></pre> <pre><code>void CompositionEngine::present(CompositionRefreshArgs&amp; args) {\n    ATRACE_CALL();\n    ALOGV(__FUNCTION__);\n\n    preComposition(args);\n\n    {\n        // latchedLayers is used to track the set of front-end layer state that\n        // has been latched across all outputs for the prepare step, and is not\n        // needed for anything else.\n        LayerFESet latchedLayers;\n\n        for (const auto&amp; output : args.outputs) {\n            output-&gt;prepare(args, latchedLayers);\n        }\n    }\n\n    updateLayerStateFromFE(args);\n\n    for (const auto&amp; output : args.outputs) {\n        output-&gt;present(args);                           &lt;-----\u91cd\u70b9\n    }\n}\n</code></pre> <pre><code>void Output::present(const compositionengine::CompositionRefreshArgs&amp; refreshArgs) {\n    ATRACE_CALL();\n    ALOGV(__FUNCTION__);\n\n    updateColorProfile(refreshArgs);\n    updateCompositionState(refreshArgs);\n    planComposition();\n    writeCompositionState(refreshArgs);\n    setColorTransform(refreshArgs);\n    beginFrame();\n    prepareFrame();\n    devOptRepaintFlash(refreshArgs);\n    finishFrame(refreshArgs);\n    postFramebuffer();\n    renderCachedSets(refreshArgs);\n}\n</code></pre> \u5230\u8fd9\u91cc\uff0c\u53bb\u8ddf\u4e00\u4e0b\u8fd9\u51e0\u4e2a\u65b9\u6cd5\u4fbf\u80fd\u770b\u5230\u4e0a\u5c4f\u64cd\u4f5c\u3002 <pre><code>void RenderSurface::queueBuffer(base::unique_fd readyFence) {\n    ...\n    mNativeWindow-&gt;queueBuffer(mNativeWindow.get(),\n                mTexture-&gt;getBuffer()-&gt;getNativeBuffer(),\n                dup(readyFence)); \n    mDisplaySurface-&gt;advanceFrame();\n    ...\n}\n</code></pre> \u5176\u4e2d<code>queueBuffer</code>\u7528\u4e8e\u63d0\u4ea4\u3002 <pre><code>/*\n* Hook called by EGL when modifications to the render buffer are done.\n* This unlocks and post the buffer.\n*\n* The window holds a reference to the buffer between dequeueBuffer and\n* either queueBuffer or cancelBuffer, so clients only need their own\n* reference if they might use the buffer after queueing or canceling it.\n* Holding a reference to a buffer after queueing or canceling it is only\n* allowed if a specific buffer count has been set.\n*...\n*/\nint  (*queueBuffer)(struct ANativeWindow* window,\n        struct ANativeWindowBuffer* buffer, int fenceFd);\n</code></pre></p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_6","title":"\u603b\u7ed3","text":"<p>\u5982\u679c\u53bb\u8ffd\u7a76\u4ee3\u7801\u7ec6\u8282\u7684\u8bdd\uff0c\u8fd8\u662f\u6709\u8bf8\u591a\u7684\u70b9\u8fd8\u9700\u8981\u8fdb\u4e00\u6b65\u62c9\u901a\u3002\u8fd9\u4e9b\u5177\u4f53\u7684\u5b9e\u73b0\u7ec6\u8282\u70b9\u6d89\u53ca\u5230\u4ee3\u7801\u67b6\u6784\u7684\u8bbe\u8ba1\uff0c\u5728\u4e0d\u4e3b\u653b\u8fd9\u4e00\u5757\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u5fc5\u8fc7\u4e8e\u6df1\u7a76\u3002\u4ece\u6bd4\u8f83\u5b8f\u89c2\u7684\u89d2\u5ea6\u6765\u518d\u6b21\u603b\u7ed3\u4e00\u4e0b\uff1a</p> <ul> <li>\u6bcf\u4e2a\u5e94\u7528\u7684\u9875\u9762\uff0c\u4ee5\u53ca\u9875\u9762\u5185\u7684\u5f39\u7a97\uff0c\u9996\u5148\u90fd\u662f\u57fa\u4e8eView\u7684\u4e00\u5c42\u5c01\u88c5\uff08\u5305\u62ecDecorView\uff09\u3002</li> <li>\u5728\u8fd9\u4e2aView\u7684\u80cc\u540e\u5b9e\u9645\u662f\u7531<code>ViewRootImpl</code>\u6240\u638c\u7ba1\u3002<code>ViewRootImpl</code>\u91cc\u5b9e\u73b0\u4e86Surface\u7684\u5efa\u7acb\uff0c\u8f93\u5165\u4e8b\u4ef6\uff0c\u7a97\u53e3\u5ba2\u6237\u7aef\uff08\u7a97\u53e3\u91cd\u65b0\u5e03\u5c40\u4e8b\u4ef6\u7b49\uff09\uff0c\u4ee5\u53ca\u5bf9View\u7ed3\u6784\u7684\u6d4b\u91cf\u7ed8\u5236\u6d41\u7a0b\u3002\u7b80\u5355\u6765\u8bf4\uff0c<code>ViewRootImpl</code>\u80a9\u8d1f\u4e86View\u6846\u67b6\u548c\u5b89\u5353<code>WindowManagerService</code>\u6846\u67b6\u5c42\u7684\u534f\u8c03\u3001\u4ee5\u53caView\u6846\u67b6\u7684\u6e32\u67d3\u673a\u5236\u3001\u4e8b\u4ef6\u673a\u5236\u8fd0\u8f6c\u3002\u524d\u8005\u66f4\u504f\u5411\u7cfb\u7edf\u5185\u90e8\uff0c\u540e\u8005\u66f4\u504f\u5411\u5f00\u53d1\u8005\u5916\u4fa7\u3002</li> <li>Surface\u7684\u7ba1\u7406\u548cWindow\u7684\u8bf8\u591a\u4e8b\u4ef6\u56de\u8c03\uff0c\u4ee5\u53ca\u771f\u6b63\u7684\u6dfb\u52a0\u8fc7\u7a0b\uff0c\u90fd\u56f4\u7ed5<code>WindowManagerService</code>\u3002\u800c\u5b89\u5353\u4e2d\u5e76\u975e\u7531\u5e94\u7528\u4ee3\u7801\u76f4\u63a5\u4e0e\u7cfb\u7edf\u670d\u52a1\u4ea4\u4e92\uff0c\u800c\u662f\u95f4\u63a5\u4f7f\u7528\u4f4d\u4e8e\u5e94\u7528\u8fdb\u7a0b\u7684\u7cfb\u7edf\u670d\u52a1\u5ba2\u6237\u7aef\u6846\u67b6\u5c01\u88c5\uff0c\u6765\u59d4\u6258\u5b83\u4eec\u53bb\u548c\u7cfb\u7edf\u670d\u52a1\u901a\u4fe1\u3002</li> <li>\u4ece\u5e94\u7528\u4fa7\u6765\u8bb2\uff0c\u6e32\u67d3\u673a\u5236\u9700\u8981\u6784\u5efa\u4e8e\u201c\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u201d\u4e4b\u4e0a\uff0c\u5b83\u4eec\u662f\u8de8\u8fdb\u7a0b\u7684\u3002\u5e94\u7528\u751f\u4ea7\u6e32\u67d3\u6570\u636e\uff0c\u7cfb\u7edf\u670d\u52a1\u8d1f\u8d23\u6d88\u8d39\u6e32\u67d3\u6570\u636e\u3002\u5176\u5b9e\u73b0\u662f<code>BufferQueue/BufferQueueProducer/BufferQueueConsumer</code>\u3002</li> <li>\u5bf9\u4e8e\u5e94\u7528\u4fa7\u7684Surface\u5c31\u662fSurfaceFlinger\u4fa7\u7684Layer\uff0cLayer\u4e0d\u53ea\u4e00\u79cd\u7c7b\u578b\uff0c\u5e38\u7528\u7684\u662f<code>BufferQueueLayer</code>\uff0c\u5b83\u5305\u542b\u4e86\u81ea\u5df1\u7684BufferQueue\u4ee5\u53caBufferQueueConsumer\u3002</li> <li>\u5e94\u7528\u4fa7\u63d0\u4ea4\u6e32\u67d3\u6307\u4ee4\uff0c\u53d1\u751f\u5728Choreographer\u7684onVsync\u4e8b\u4ef6\u56de\u8c03\uff0c\u8fdb\u4e00\u6b65\u4ea4\u7531\u5230<code>ViewRootImpl</code>\u3002\u8fdb\u4e00\u6b65\u7531<code>ThreadedRenderer(HardwareRenderer)</code>\u4e2d\u63d0\u4ea4\u5230<code>SkiaOpenGLPipeLine</code>\u6216\u8005<code>SkiaVulkanPipeline</code>\u3002</li> <li>\u7cfb\u7edfSurfaceFligner\u4fa7\u5904\u7406Buffer\u65f6\uff0c\u4e5f\u53d1\u751f\u5728\u5bf9Vsync\u6ce8\u518c\u7684\u56de\u8c03\u4e2d\uff0c\u4f1a\u6309\u9700\u5bf9Layer\u66f4\u65b0\u3001\u5408\u6210\u3002\u6700\u540e\u901a\u8fc7OpenGL\u7684\u6307\u4ee4\u4ea4\u6362\u7f13\u51b2\u533a\uff0c\u5b8c\u6210\u4e0a\u5c4f\u3002</li> <li>\u53e6\u5916\u5bf9\u4e8e\u8de8\u8fdb\u7a0b\u4e4b\u95f4\u5e7f\u6cdb\u4f7f\u7528\u4e86Binder IPC\u3002\u751a\u81f3\u8bf4\uff0c\u51e0\u4e4e\u6ca1\u6709\u600e\u4e48\u4f7f\u7528\u5176\u4ed6\u7684\u65b9\u5f0f\u505aIPC\u901a\u4fe1\u3002</li> </ul>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/#_7","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>ViewRootImpl</li> <li>IWindowManager.aidl</li> <li>WindowManagerService</li> <li>WindowManagerGlobal\uff0c\u5e94\u7528\u8fdb\u7a0b\u5185\u5355\u4f8b\uff0c\u8d1f\u8d23\u548c\u5e95\u5c42\u7684\u7cfb\u7edf\u670d\u52a1WindowManagerService\u901a\u4fe1\u3002\u5176\u83b7\u53d6SystemService\u7684\u65b9\u5f0f\u662f<code>IWindowManager.Stub.asInterface(ServiceManager.getService(\"window\"));</code>\uff0c\u5bf9\u6211\u4eec\u6765\u8bf4\uff0c\u5e73\u65f6\u83b7\u53d6\u7cfb\u7edf\u670d\u52a1\u662f<code>Context#getSystemService(...)</code>\uff0c\u56e0\u6b64\u5176\u5b9e\u65e0\u8bba\u662fAIDL\u751f\u6210\u7684\u8f6c\u63a5\u53e3\u7684\u7c7b\uff0c\u8fd8\u662f<code>ServiceManager</code>\u6211\u4eec\u90fd\u65e0\u6cd5\u62ff\u5230\uff0c\u8fdb\u800c\u65e0\u6cd5\u4e0e\u7cfb\u7edf\u670d\u52a1\u76f4\u63a5\u901a\u4fe1\u3002\u8f6c\u800c\u90fd\u662f\u9760\u5b89\u5353\u6846\u67b6\u5c42\u4f4d\u4e8e\u5e94\u7528\u8fdb\u7a0b\u4e2d\u7684\u8fd9\u4e9b\u8fd0\u884c\u65f6\u5e93\u6765\u95f4\u63a5\u83b7\u53d6\u670d\u52a1\u3002</li> <li>IWindowSession\uff0c\u4e5f\u662f\u8fdb\u7a0b\u5185\u5355\u4f8b\u3002</li> <li>Surface Flinger\u53c2\u8003\u8d44\u6e90\uff0c\u5df2\u65e0\u6cd5\u5bf9\u5e94\u6e90\u7801</li> <li>Surface Flinger\u7b80\u5355\u63cf\u8ff0\uff0cmedium</li> <li>IGraphicBufferProducer</li> <li>CompositionEngine</li> <li>SurfaceFlinger.cpp</li> <li>BufferQueue.cpp</li> <li>SkiaOpenGLPipeline</li> </ul>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/","title":"\u6e32\u67d3\u67b6\u6784","text":"<p>\u6211\u4eec\u5c06\u4ece\u5e95\u5411\u4e0a\u6765\u63cf\u8ff0\u5b89\u5353\u7684\u6e32\u67d3\u67b6\u6784\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#_1","title":"\u5408\u6210","text":"<p>\u5408\u6210\u662fSurfaceFlinger\u4e3b\u8981\u7531SurfaceFlinger\u8fdb\u884c\uff0c\u5305\u62ecGPU\u548cHWC\u4e24\u79cd\u65b9\u5f0f\u7ed3\u5408\uff0c\u4ea6\u6216\u5355\u79cd\u65b9\u5f0f\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#gpu","title":"GPU","text":"<p>Android \u4f7f\u7528 OpenGL ES (GLES) API \u6e32\u67d3\u56fe\u5f62\u3002\u4e3a\u4e86\u521b\u5efa GLES \u4e0a\u4e0b\u6587\u5e76\u4e3a GLES \u6e32\u67d3\u63d0\u4f9b\u7a97\u53e3\u7cfb\u7edf\uff0cAndroid \u4f7f\u7528 EGL \u5e93\u3002GLES \u8c03\u7528\u7528\u4e8e\u6e32\u67d3\u7eb9\u7406\u591a\u8fb9\u5f62\uff0c\u800c EGL \u8c03\u7528\u7528\u4e8e\u5c06\u6e32\u67d3\u653e\u5230\u5c4f\u5e55\u4e0a\u3002</p> <p>\u5373\uff0c\u5728\u5b89\u5353\u4e0a\uff1a</p> <ul> <li>\u786c\u4ef6\u52a0\u901f\u7684\u7ed8\u5236\u64cd\u4f5c\uff0c\u4f7f\u7528OpenGL ES(GLES)\u5e93</li> <li>\u7cfb\u7edf\u539f\u751f\u7a97\u53e3\u7ba1\u7406\uff0c\u4f7f\u7528EGL\u5e93</li> </ul> <p>EGL\u2122 \u662f Khronos \u6e32\u67d3 API\uff08\u5982 OpenGL ES \u6216 OpenVG\uff09\u4e0e\u5e95\u5c42\u539f\u751f\u5e73\u53f0\u7a97\u53e3\u7cfb\u7edf\u4e4b\u95f4\u7684\u63a5\u53e3\u3002\u5b83\u5904\u7406\u56fe\u5f62\u4e0a\u4e0b\u6587\u7ba1\u7406\u3001\u8868\u9762/\u7f13\u51b2\u533a\u7ed1\u5b9a\u548c\u6e32\u67d3\u540c\u6b65\uff0c\u5e76\u4f7f\u7528\u5176\u4ed6 Khronos API \u5b9e\u73b0\u9ad8\u6027\u80fd\u3001\u52a0\u901f\u3001\u6df7\u5408\u6a21\u5f0f\u7684 2D \u548c 3D \u6e32\u67d3\u3002EGL \u8fd8\u63d0\u4f9b Khronos \u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u529f\u80fd\uff0c\u4ee5\u5b9e\u73b0 API \u4e4b\u95f4\u7684\u6570\u636e\u9ad8\u6548\u4f20\u8f93\u2014\u2014\u4f8b\u5982\u5728\u8fd0\u884c OpenMAX AL \u7684\u89c6\u9891\u5b50\u7cfb\u7edf\u548c\u8fd0\u884c OpenGL ES \u7684 GPU \u4e4b\u95f4\u3002</p> <p>\u518d\u6362\u53e5\u8bdd\u8bf4\uff0c\u7ed8\u5236\u64cd\u4f5c\u662fOpenGL ES\u5e93\uff0c\u800c\u7ed8\u5236\u4e0a\u4e0b\u6587\u3001\u7a97\u53e3\u3001\u914d\u7f6e\u7ba1\u7406\u662fEGL\u5e93\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#hwc","title":"HWC","text":"<p>\u5728\u67b6\u6784\u4e0a\uff0c\u5b89\u5353\u5e76\u6ca1\u6709\u5b8c\u5168\u91c7\u7528GPU\u4e00\u79cd\u5f62\u5f0f\u4e0a\u5c4f\uff0c\u800c\u662f\u8fd8\u63d0\u4f9b\u4e86HAL\uff08\u786c\u4ef6\u6df7\u5408\u6e32\u67d3\u5668\uff09\u3002\u4f5c\u4e3a HAL\uff0c\u5176\u5b9e\u73b0\u662f\u7279\u5b9a\u4e8e\u8bbe\u5907\u7684\uff0c\u800c\u4e14\u901a\u5e38\u7531\u663e\u793a\u786c\u4ef6\u539f\u59cb\u8bbe\u5907\u5236\u9020\u5546 (OEM) \u5b8c\u6210\u3002</p> <p>\u663e\u793a\u5904\u7406\u5668\u529f\u80fd\u5dee\u5f02\u5f88\u5927\u3002\u53e0\u52a0\u5c42\u7684\u6570\u91cf\uff08\u65e0\u8bba\u5c42\u662f\u5426\u53ef\u4ee5\u65cb\u8f6c\u6216\u6df7\u5408\uff09\u4ee5\u53ca\u5bf9\u5b9a\u4f4d\u548c\u91cd\u53e0\u7684\u9650\u5236\u5f88\u96be\u901a\u8fc7 API \u8868\u8fbe\u3002\u4e3a\u4e86\u9002\u5e94\u8fd9\u4e9b\u9009\u9879\uff0cHWC \u4f1a\u6267\u884c\u4ee5\u4e0b\u8ba1\u7b97\uff1a</p> <ul> <li>SurfaceFlinger \u5411 HWC \u63d0\u4f9b\u4e00\u4e2a\u5b8c\u6574\u7684\u5c42\u5217\u8868\uff0c\u5e76\u8be2\u95ee\u201c\u60a8\u5e0c\u671b\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u5c42\uff1f\u201d</li> <li>HWC \u7684\u54cd\u5e94\u65b9\u5f0f\u662f\u5c06\u6bcf\u4e2a\u5c42\u6807\u8bb0\u4e3a\u8bbe\u5907\u6216\u5ba2\u6237\u7aef\u5408\u6210\u3002</li> <li>SurfaceFlinger \u4f1a\u5904\u7406\u6240\u6709\u5ba2\u6237\u7aef\uff0c\u5c06\u8f93\u51fa\u7f13\u51b2\u533a\u4f20\u9001\u5230 HWC\uff0c\u5e76\u8ba9 HWC \u5904\u7406\u5176\u4f59\u90e8\u5206\u3002</li> </ul> <p>\u7531\u4e8e\u786c\u4ef6\u4f9b\u5e94\u5546\u53ef\u4ee5\u5b9a\u5236\u51b3\u7b56\u4ee3\u7801\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u6bcf\u53f0\u8bbe\u5907\u4e0a\u5b9e\u73b0\u6700\u4f73\u6027\u80fd\u3002\u8be6\u89c1\u8fd9\u91cc\u3002</p> <p>\u7531\u6b64\uff0c\u6700\u7ec8\u5bf9\u663e\u793a\u5668\u8bbe\u5907\u7684<code>FrameBuffer</code>\u64cd\u4f5c\u5bf9\u4e8e\u6bcf\u4e00\u5e27\u5176\u5b9e\u4f1a\u5206\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>GLES - GPU \u5408\u6210\u6240\u6709\u56fe\u5c42\uff0c\u76f4\u63a5\u5199\u5165\u8f93\u51fa\u7f13\u51b2\u533a\u3002HWC \u4e0d\u53c2\u4e0e\u5408\u6210\u3002</li> <li>MIXED - GPU \u5c06\u4e00\u4e9b\u56fe\u5c42\u5408\u6210\u5230\u5e27\u7f13\u51b2\u533a\uff0c\u7531 HWC \u5408\u6210\u5e27\u7f13\u51b2\u533a\u548c\u5269\u4f59\u7684\u56fe\u5c42\uff0c\u76f4\u63a5\u5199\u5165\u8f93\u51fa\u7f13\u51b2\u533a\u3002</li> <li>HWC - HWC \u5408\u6210\u6240\u6709\u56fe\u5c42\u5e76\u76f4\u63a5\u5199\u5165\u8f93\u51fa\u7f13\u51b2\u533a\u3002</li> </ul> <p>\u5bf9\u4e8eHWC\u65e0\u6cd5\u5904\u7406\u7684\u5c42\uff0c\u9700\u8981SurfaceFlinger\u901a\u8fc7GPU\u4ee5OpenGLES\u6765\u5408\u6210\u3002\u6b64\u65f6SurfaceFlinger \u53ea\u662f\u5145\u5f53\u53e6\u4e00\u4e2a OpenGL ES \u5ba2\u6237\u7aef\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#vsync","title":"VSync","text":"<p>\u8be5\u4e8b\u4ef6\u7531HWC\u6765\u751f\u6210\uff0c\u53d1\u9001\u7ed9SurfaceFlinger\uff0c\u8be6\u89c1.</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#_2","title":"\u751f\u4ea7\u4e0e\u6d88\u8d39","text":""},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#surfaceflinger","title":"SurfaceFlinger","text":"<p>SurfaceFlinger\u4e3a\u5e94\u7528\u7684\u7a97\u53e3\u521b\u5efa\u201c\u5c42\u201d\uff0c\u5c42\u5305\u62ec\u4e86<code>BufferQueue</code>\u4ee5\u53ca<code>SurfaceControl</code>\uff0c\u524d\u8005\u7528\u4e8e\u63d0\u4f9b\u4e00\u4e2a\u8de8\u8fdb\u7a0b\u3001\u96f6\u62f7\u8d1d\u7684\u56fe\u5f62\u5e27\u961f\u5217\uff0c\u540e\u8005\u63d0\u4f9b\u4e00\u4e9b\u63a7\u5236\u76f8\u5173\u64cd\u4f5c\u3002\u540e\u8005\u4e00\u822c\u4ea4\u7531<code>windowManagerSerivce</code>\u7ba1\u7406\uff0c\u800c\u524d\u8005\u4e00\u822c\u6700\u540e\u5c01\u88c5\u4e3a\u5e94\u7528\u8fdb\u7a0b\u5185\u7684<code>Surface</code>\u4e5f\u5373ndk\u4e2d\u7684<code>ANativeWindow</code>\uff0c\u6765\u7531\u5e94\u7528\u8fdb\u7a0b\u5185\u8d1f\u8d23\u63d0\u4f9b\u751f\u4ea7\u6570\u636e\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#bufferqueue","title":"BufferQueue","text":"<p>BufferQueue\u662f\u4e00\u4e2a\u8fde\u63a5\u56fe\u5f62\u6570\u636e\u7684\u751f\u4ea7\u8005\u3001\u6d88\u8d39\u8005\u7684\u7ebd\u5e26\uff0c\u5b83\u6309\u9700\u5206\u914d\u56fe\u5f62\u7f13\u51b2\u533a\uff0c\u6bd4\u5982\u751f\u4ea7\u8005\u901f\u5ea6\u5927\u4e8e\u6d88\u8d39\u8005\u65f6\uff0c\u9700\u8981\u5206\u914d\u66f4\u591a\u56fe\u5f62\u7f13\u51b2\u533a\u6765\u5165\u5217\u3002\u56fe\u5f62\u7f13\u51b2\u533a\u7531HAL\u7684<code>gralloc</code>\u6765\u5206\u914d\uff0c\u5206\u914d\u540e\u7684\u56fe\u5f62\u7f13\u51b2\u533a\u4ee5\u53e5\u67c4\u7684\u5f62\u5f0f\u53ef\u4ee5\u5728<code>binder</code> IPC\u4e2d\u8de8\u8fdb\u7a0b\u4f20\u9012\u3002\u7531\u6b64\u5b83\u81ea\u8eab\u4e0d\u4f1a\u4ea7\u751f\u62f7\u8d1d\u64cd\u4f5c\u3002\u5b83\u63d0\u4f9b\u4e09\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff1a\u540c\u6b65\u963b\u585e\uff08\u751f\u4ea7\u8005\u751f\u4ea7\u5165\u5217\u540e\u963b\u585e\u7b49\u5f85\u6d88\u8d39\u8005\u6d88\u8d39\u540e\u53ef\u4ee5\u83b7\u53d6\u65b0\u7684\u7f13\u51b2\u533a\uff09\u3001\u975e\u963b\u585e\uff08\u53ef\u4ee5\u4e0d\u65ad\u83b7\u53d6\u65b0\u7684\u7f13\u51b2\u533a\u76f4\u5230\u4e0a\u9650\u65f6\u6355\u83b7\u9519\u8bef\uff09\u3001\u4e22\u5f03\uff08\u53ef\u4ee5\u4e0d\u65ad\u83b7\u53d6\u7f13\u51b2\u533a\uff0c\u4f46\u4ec5\u6700\u65b0\u7684\u4f1a\u88ab\u6d88\u8d39\uff0c\u4e4b\u524d\u672a\u88ab\u6d88\u8d39\u7684\u4f1a\u88ab\u4e22\u5f03\uff09\u3002</p> <p><code>BufferQueue</code>\u961f\u91cc\u4e2d\u7684\u56fe\u5f62\u7f13\u51b2\u533a\u7684\u6570\u636e\u6838\u5fc3\u662f<code>GraphicBuffer</code>\uff0c\u800c\u5b83\u4e5f\u53ef\u4ee5\u7531<code>ANativeWindow</code>\u6240\u8bbf\u95ee\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#_3","title":"\u5e94\u7528\u8fdb\u7a0b\u751f\u4ea7","text":"<p>\u5728\u5e94\u7528\u8fdb\u7a0b\u4e2d\uff0c\u751f\u4ea7\u56fe\u5f62\u6570\u636e\u53ef\u4ee5\u6709\u5982\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>ViewRootImpl\u7684Surface\uff0c\u4f1a\u5bf9\u5e94\u5230View tree\u4e0b\u7684Java\u4fa7\u7684Canvas API\u3002</li> <li>SurfaceView\uff0c\u7533\u8bf7\u4e00\u4e2a\u72ec\u7acb\u7684Surface\u3002</li> <li>TextureView\uff0c\u5b83\u9700\u8981SurfaceTexture\uff0c\u4e00\u79cd\u5c06Surface\u7684\u56fe\u50cf\u751f\u4ea7\u8f6c\u4e3aGLES\u7684\u7eb9\u7406\uff0c\u5e76\u53ef\u88ab\u540e\u7eed\u7ee7\u7eed\u4f7f\u7528\u3002</li> </ul> <p>\u4ece\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c\u59cb\u7ec8\u662f\u4f9d\u9760Surface\u6765\u6784\u5efa\u56fe\u5f62\u751f\u4ea7\u3002</p> <p><code>Surface#lockHardwareCanvas</code>\u6216<code>Surface#lockCanvas</code>\u6765\u83b7\u5f97Canvas API\uff0cCanvas API\u662f\u5bf9Skia\u7684Java\u4fa7\u5305\u88c5\u3002\u5728native\u4e0b\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528Skia\u3002\u76f8\u5173\u793a\u4f8b\u53ef\u4ee5\u53c2\u89c1<code>SurfaceView, TextureView</code>\u3002</p>"},{"location":"Android/%E6%B8%B2%E6%9F%93%E6%9E%B6%E6%9E%84/#surfacecanvasapi","title":"Surface\u4fa7\u83b7\u53d6CanvasAPI","text":"<p>Surface\u4fa7\u83b7\u53d6CanvasAPI\uff0c\u4ee5\u6700\u65b0\u7684\u5b9e\u73b0\u6765\u770b\uff0c\u4f1a\u6784\u5efa\u4e00\u4e2a<code>HardwareRenderer</code>:</p> <p><pre><code>class Surface {\n    ...\n    private final class HwuiContext {\n        private final RenderNode mRenderNode;\n        private HardwareRenderer mHardwareRenderer;\n        private RecordingCanvas mCanvas;\n        private final boolean mIsWideColorGamut;\n\n        HwuiContext(boolean isWideColorGamut) {\n            mRenderNode = RenderNode.create(\"HwuiCanvas\", null);\n            mHardwareRenderer = new HardwareRenderer();\n            mHardwareRenderer.setContentRoot(mRenderNode);\n            mHardwareRenderer.setSurface(Surface.this, true);\n            ...\n        }\n\n        Canvas lockCanvas(int width, int height) {\n            mCanvas = mRenderNode.beginRecording(width, height);\n            return mCanvas;\n        }\n\n        void unlockAndPost(Canvas canvas) {\n            ...\n            mRenderNode.endRecording();\n            mHardwareRenderer.createRenderRequest()\n                    .setVsyncTime(System.nanoTime())\n                    .syncAndDraw();\n        }\n    ...\n    }\n}\n</code></pre> \u5b83\u5185\u90e8\u6301\u6709\u4e00\u4e2a<code>rootNode: RenderNode</code>\u4f5c\u4e3a\u6839\u8282\u70b9\uff0c\u8fd8\u4f1a\u6784\u9020<code>RenderProxy</code>\uff1a <pre><code>    public HardwareRenderer() {\n        mRootNode = RenderNode.adopt(nCreateRootRenderNode());\n        mNativeProxy = nCreateProxy(!mOpaque, mRootNode.mNativeRenderNode);\n        ...\n    }\n</code></pre> <code>RenderProxy</code>\u6784\u9020\uff1a <pre><code>RenderProxy::RenderProxy(bool translucent, RenderNode* rootRenderNode,\n                         IContextFactory* contextFactory)\n        : mRenderThread(RenderThread::getInstance()), mContext(nullptr) {\n    mContext = mRenderThread.queue().runSync([&amp;]() -&gt; CanvasContext* {\n        return CanvasContext::create(mRenderThread, translucent, rootRenderNode, contextFactory);\n    });\n    mDrawFrameTask.setContext(&amp;mRenderThread, mContext, rootRenderNode,\n                              pthread_gettid_np(pthread_self()), getRenderThreadTid());\n}\n</code></pre> \u8fd9\u91cc\u4f1a\u521b\u5efa<code>CanvasContext</code>, \u5e76\u5173\u8054\u5230<code>DrawFrameTask</code>\u3002\u4e4b\u540e\u5728\u7ed8\u5236\u65f6\uff0c\u4f1a\u7531<code>DrawFrameTask</code>\u6765\u6267\u884c\uff1a <pre><code>void DrawFrameTask::run() {\n    ...\n    if (CC_LIKELY(canDrawThisFrame)) {\n        dequeueBufferDuration = context-&gt;draw();\n    }\n    ...\n}\n</code></pre> \u518d\u770b<code>CanvasContext</code>\u7684<code>draw</code>\uff1a <pre><code>nsecs_t CanvasContext::draw() {\n    bool drew = mRenderPipeline-&gt;draw(frame, windowDirty, dirty, mLightGeometry, &amp;mLayerUpdateQueue,\n                                      mContentDrawBounds, mOpaque, mLightInfo, mRenderNodes,\n                                      &amp;(profiler()));\n    waitOnFences();\n\n    bool didSwap =\n            mRenderPipeline-&gt;swapBuffers(frame, drew, windowDirty, mCurrentFrameInfo, &amp;requireSwap);\n    ...\n}\n</code></pre> \u5373\u5de5\u4f5c\u662f\u7531<code>mRenderPipeline</code>\u627f\u5305\u3002\u5b83\u662f\u7531\u7cfb\u7edf\u5c5e\u6027\u51b3\u5b9a\u521b\u5efa\u7684\uff0c\u540c\u65f6\u4e5f\u662f\u5728<code>CanvasContext</code>\u6784\u9020\u65f6\u5c31\u521b\u5efa\u4e86\u7684\u3002\u6211\u4eec\u6765\u770b<code>SkiaOpenGLPipeline</code>\u7684\u5904\u7406\uff1a</p> <p><pre><code>bool SkiaOpenGLPipeline::draw(const Frame&amp; frame, const SkRect&amp; screenDirty, const SkRect&amp; dirty,\n                              const LightGeometry&amp; lightGeometry,\n                              LayerUpdateQueue* layerUpdateQueue, const Rect&amp; contentDrawBounds,\n                              bool opaque, const LightInfo&amp; lightInfo,\n                              const std::vector&lt;sp&lt;RenderNode&gt;&gt;&amp; renderNodes,\n                              FrameInfoVisualizer* profiler) {\n    ...\n    SkASSERT(mRenderThread.getGrContext() != nullptr);\n    sk_sp&lt;SkSurface&gt; surface(SkSurface::MakeFromBackendRenderTarget(\n            mRenderThread.getGrContext(), backendRT, this-&gt;getSurfaceOrigin(), colorType,\n            mSurfaceColorSpace, &amp;props));\n\n    renderFrame(*layerUpdateQueue, dirty, renderNodes, opaque, contentDrawBounds, surface,\n                SkMatrix::I());\n    ...\n\n    {\n        ATRACE_NAME(\"flush commands\");\n        surface-&gt;flushAndSubmit();\n    }\n    ...\n    return true;\n}\n</code></pre> \u5982\u679c\u4f60\u5bf9<code>skia</code>\u6709\u6240\u4e86\u89e3\uff0c\u8fd9\u91cc\u5c31\u5f88\u597d\u61c2\u4e86\uff0c\u8fd9\u91cc\u4f1a\u5148\u6784\u9020\u4e00\u4e2a<code>SkSurface</code>\uff0c\u5b83\u662f\u7531<code>grContext</code>\u4f5c\u4e3a\u540e\u7aef\u7684\u3002\u4e4b\u540e\u8fdb\u5165<code>renderFrame</code>\uff1a <pre><code>void SkiaPipeline::renderFrame(const LayerUpdateQueue&amp; layers, const SkRect&amp; clip,\n                               const std::vector&lt;sp&lt;RenderNode&gt;&gt;&amp; nodes, bool opaque,\n                               const Rect&amp; contentDrawBounds, sk_sp&lt;SkSurface&gt; surface,\n                               const SkMatrix&amp; preTransform) {\n    // Initialize the canvas for the current frame, that might be a recording canvas if SKP\n    // capture is enabled.\n    SkCanvas* canvas = tryCapture(surface.get(), nodes[0].get(), layers);\n\n    // draw all layers up front\n    renderLayersImpl(layers, opaque);\n\n    renderFrameImpl(clip, nodes, opaque, contentDrawBounds, canvas, preTransform);\n\n    endCapture(surface.get());\n\n    Properties::skpCaptureEnabled = previousSkpEnabled;\n}\n</code></pre></p> <p>\u8fd9\u91cc\u4e3b\u8981\u662f\u8981\u5bf9<code>RenderNode nodes</code>\u56de\u653e\u3002\u800c<code>RenderNodes</code>\u662f\u7531CanvasAPI\u6839\u636e\u7ed8\u5236\u6307\u4ee4\u6765\u64cd\u4f5c\u7684\u3002<code>swap</code>\u7b80\u5355\u770b\u4e00\u4e0b\uff1a <pre><code>bool SkiaOpenGLPipeline::swapBuffers(const Frame&amp; frame, bool drew, const SkRect&amp; screenDirty,\n                                     FrameInfo* currentFrameInfo, bool* requireSwap) {\n    *requireSwap = drew || mEglManager.damageRequiresSwap();\n...\n    return *requireSwap;\n}\n\nbool EglManager::swapBuffers(const Frame&amp; frame, const SkRect&amp; screenDirty) {\n    eglSwapBuffersWithDamageKHR(mEglDisplay, frame.mSurface, rects, screenDirty.isEmpty() ? 0 : 1);\n\n    EGLint err = eglGetError();\n    if (CC_LIKELY(err == EGL_SUCCESS)) {\n        return true;\n    }\n    ...\n}\n</code></pre> \u5176\u5b9e\u548c\u6211\u4eec\u8c03\u7528<code>eglSwapBuffer(eglDisplay, eglSurface)</code>\u5df2\u7ecf\u7c7b\u4f3c\u4e86\u3002\u6700\u540e\u770b\u4e0bCanvasAPI\u5427\uff1a <pre><code>    public @NonNull RecordingCanvas beginRecording(int width, int height) {\n        ...\n        mCurrentRecordingCanvas = RecordingCanvas.obtain(this, width, height);\n        return mCurrentRecordingCanvas;\n    }\n\n    static RecordingCanvas obtain(@NonNull RenderNode node, int width, int height) {\n        ...\n            canvas = new RecordingCanvas(node, width, height);\n        return canvas;\n    }\n    private RecordingCanvas(@NonNull RenderNode node, int width, int height) {\n        super(nCreateDisplayListCanvas(node.mNativeRenderNode, width, height));\n        mDensity = 0; // disable bitmap density scaling\n    }\n\nstatic jlong android_view_DisplayListCanvas_createDisplayListCanvas(CRITICAL_JNI_PARAMS_COMMA jlong renderNodePtr,\n        jint width, jint height) {\n    RenderNode* renderNode = reinterpret_cast&lt;RenderNode*&gt;(renderNodePtr);\n    return reinterpret_cast&lt;jlong&gt;(Canvas::create_recording_canvas(width, height, renderNode));\n}\n\nCanvas* Canvas::create_recording_canvas(int width, int height, uirenderer::RenderNode* renderNode) {\n    return new uirenderer::skiapipeline::SkiaRecordingCanvas(renderNode, width, height);\n}\n\n    explicit SkiaRecordingCanvas(uirenderer::RenderNode* renderNode, int width, int height) {\n        initDisplayList(renderNode, width, height);\n    }\n\nvoid SkiaRecordingCanvas::initDisplayList(uirenderer::RenderNode* renderNode, int width,\n                                          int height) {\n    mCurrentBarrier = nullptr;\n    SkASSERT(mDisplayList.get() == nullptr);\n\n    if (renderNode) {\n        mDisplayList = renderNode-&gt;detachAvailableList();\n    }\n    if (!mDisplayList) {\n        mDisplayList.reset(new SkiaDisplayList());\n    }\n\n    mDisplayList-&gt;attachRecorder(&amp;mRecorder, SkIRect::MakeWH(width, height));\n    SkiaCanvas::reset(&amp;mRecorder);\n    mDisplayList-&gt;setHasHolePunches(false);\n}\n</code></pre> \u4e5f\u5c31\u662f\uff0c<code>RenderNode#beginRecording</code>\u6700\u540e\u5f97\u5230\u7684\u662fJava\u4fa7<code>RecordingCanvas</code>\u5b9e\u4f8b\uff0c\u5b83\u6301\u6709\u4e00\u4e2a<code>SkiaRecordingCanvas</code>native\u7684\u5b9e\u4f8b\u3002<code>SkiaRecordingCanvas</code>\u5219\u6709\u5982\u4e0b\u7ee7\u627f\uff1a<code>SkiaCanvas:Canvas</code>\u3002 <pre><code>    explicit SkiaCanvas(const SkBitmap&amp; bitmap);\n    explicit SkiaCanvas(SkCanvas* canvas);\n</code></pre> <code>SkiaCanvas</code>\u4f1a\u6301\u6709\u4e00\u4e2a<code>SkCanvas</code>\uff0c\u5bf9\u4e8e<code>SkiaRecordingCanvas</code>\uff0c\u5176\u6301\u6709\u7684<code>SkCanvas</code>\u662f<code>RecordingCanvas:SkCanvasVirtualEnforcer&lt;SkNoDrawCanvas&gt;</code>\uff0c\u5b83\u5b9e\u9645\u4e0a\u7ee7\u627f\u4e8e<code>SkNoDrawCanvas</code>\u3002</p> <p>\u6765\u770b\u4e00\u4e2a<code>drawRect</code>\u8c03\u7528 <pre><code>    @Override\n    public final void drawRect(float left, float top, float right, float bottom,\n            @NonNull Paint paint) {\n        nDrawRect(mNativeCanvasWrapper, left, top, right, bottom, paint.getNativeInstance());\n    }\n</code></pre> \u662f\u5982\u4e0b\u65b9\u5f0f\u88ab\u6ce8\u518cjni\u7684\uff1a <pre><code>static const JNINativeMethod gDrawMethods[] = {\n    {\"nDrawColor\",\"(JII)V\", (void*) CanvasJNI::drawColor},\n    {\"nDrawColor\",\"(JJJI)V\", (void*) CanvasJNI::drawColorLong},\n    {\"nDrawPaint\",\"(JJ)V\", (void*) CanvasJNI::drawPaint},\n    {\"nDrawPoint\", \"(JFFJ)V\", (void*) CanvasJNI::drawPoint},\n    {\"nDrawPoints\", \"(J[FIIJ)V\", (void*) CanvasJNI::drawPoints},\n    {\"nDrawLine\", \"(JFFFFJ)V\", (void*) CanvasJNI::drawLine},\n    {\"nDrawLines\", \"(J[FIIJ)V\", (void*) CanvasJNI::drawLines},\n    {\"nDrawRect\",\"(JFFFFJ)V\", (void*) CanvasJNI::drawRect},\n    {\"nDrawRegion\", \"(JJJ)V\", (void*) CanvasJNI::drawRegion },\n    {\"nDrawRoundRect\",\"(JFFFFFFJ)V\", (void*) CanvasJNI::drawRoundRect},\n    {\"nDrawDoubleRoundRect\", \"(JFFFFFFFFFFFFJ)V\", (void*) CanvasJNI::drawDoubleRoundRectXY},\n    {\"nDrawDoubleRoundRect\", \"(JFFFF[FFFFF[FJ)V\", (void*) CanvasJNI::drawDoubleRoundRectRadii},\n    {\"nDrawCircle\",\"(JFFFJ)V\", (void*) CanvasJNI::drawCircle},\n    {\"nDrawOval\",\"(JFFFFJ)V\", (void*) CanvasJNI::drawOval},\n    {\"nDrawArc\",\"(JFFFFFFZJ)V\", (void*) CanvasJNI::drawArc},\n    {\"nDrawPath\",\"(JJJ)V\", (void*) CanvasJNI::drawPath},\n    {\"nDrawVertices\", \"(JII[FI[FI[II[SIIJ)V\", (void*)CanvasJNI::drawVertices},\n    {\"nDrawNinePatch\", \"(JJJFFFFJII)V\", (void*)CanvasJNI::drawNinePatch},\n    {\"nDrawBitmapMatrix\", \"(JJJJ)V\", (void*)CanvasJNI::drawBitmapMatrix},\n    {\"nDrawBitmapMesh\", \"(JJII[FI[IIJ)V\", (void*)CanvasJNI::drawBitmapMesh},\n    {\"nDrawBitmap\",\"(JJFFJIII)V\", (void*) CanvasJNI::drawBitmap},\n    {\"nDrawBitmap\",\"(JJFFFFFFFFJII)V\", (void*) CanvasJNI::drawBitmapRect},\n    {\"nDrawBitmap\", \"(J[IIIFFIIZJ)V\", (void*)CanvasJNI::drawBitmapArray},\n    {\"nDrawGlyphs\", \"(J[I[FIIIJJ)V\", (void*)CanvasJNI::drawGlyphs},\n    {\"nDrawText\",\"(J[CIIFFIJ)V\", (void*) CanvasJNI::drawTextChars},\n    {\"nDrawText\",\"(JLjava/lang/String;IIFFIJ)V\", (void*) CanvasJNI::drawTextString},\n    {\"nDrawTextRun\",\"(J[CIIIIFFZJJ)V\", (void*) CanvasJNI::drawTextRunChars},\n    {\"nDrawTextRun\",\"(JLjava/lang/String;IIIIFFZJ)V\", (void*) CanvasJNI::drawTextRunString},\n    {\"nDrawTextOnPath\",\"(J[CIIJFFIJ)V\", (void*) CanvasJNI::drawTextOnPathChars},\n    {\"nDrawTextOnPath\",\"(JLjava/lang/String;JFFIJ)V\", (void*) CanvasJNI::drawTextOnPathString},\n    {\"nPunchHole\", \"(JFFFFFF)V\", (void*) CanvasJNI::punchHole}\n};\n\nint register_android_graphics_Canvas(JNIEnv* env) {\n    int ret = 0;\n    ret |= RegisterMethodsOrDie(env, \"android/graphics/Canvas\", gMethods, NELEM(gMethods));\n    ret |= RegisterMethodsOrDie(env, \"android/graphics/BaseCanvas\", gDrawMethods, NELEM(gDrawMethods));\n    ret |= RegisterMethodsOrDie(env, \"android/graphics/BaseRecordingCanvas\", gDrawMethods, NELEM(gDrawMethods));\n    return ret;\n}\n</code></pre> \u5b9e\u73b0\uff1a <pre><code>static void drawRect(JNIEnv* env, jobject, jlong canvasHandle, jfloat left, jfloat top,\n                     jfloat right, jfloat bottom, jlong paintHandle) {\n    const Paint* paint = reinterpret_cast&lt;Paint*&gt;(paintHandle);\n    get_canvas(canvasHandle)-&gt;drawRect(left, top, right, bottom, *paint);\n}\n</code></pre> \u5373\u8c03\u7528\u4e86<code>SkiaRecordingCanvas</code>\u7684<code>drawRect</code>\uff0c\u800c\u53c8\u8c03\u7528\u4e86<code>SkiaCanvas</code>\u6301\u6709\u7684<code>SkCanvas</code>\u7684<code>drawRect</code>\u5373native\u4fa7\u7684<code>RecordingCanvas:SkCanvasVirtualEnforcer&lt;SkNoDrawCanvas&gt;</code>\u7684<code>drawRect</code>\uff0c\u800c<code>SkNoDrawCanvas:SkCanvas</code>\uff1a <pre><code>void SkCanvas::drawRect(const SkRect&amp; r, const SkPaint&amp; paint) {\n    TRACE_EVENT0(\"skia\", TRACE_FUNC);\n    // To avoid redundant logic in our culling code and various backends, we always sort rects\n    // before passing them along.\n    this-&gt;onDrawRect(r.makeSorted(), paint);\n}\n</code></pre> \u4f46native\u4fa7\u7684<code>RecordingCanvas</code>\u590d\u5199\u4e86<code>onDrawRect</code>\uff1a <pre><code>void RecordingCanvas::onDrawRect(const SkRect&amp; rect, const SkPaint&amp; paint) {\n    fDL-&gt;drawRect(rect, paint);\n}\nvoid DisplayListData::drawRect(const SkRect&amp; rect, const SkPaint&amp; paint) {\n    this-&gt;push&lt;DrawRect&gt;(0, rect, paint);\n}\n</code></pre> <code>DisplayListData::push</code>\u662f\u6a21\u677f\u65b9\u6cd5\uff0c\u800c<code>DrawRect</code>\u7c7b\u5219\u662f<code>drawRect</code>\u64cd\u4f5c\u5bf9\u5e94\u7684\u8bb0\u5f55\u6570\u636e\u7ed3\u6784\uff1a <pre><code>struct DrawRect final : Op {\n    static const auto kType = Type::DrawRect;\n    DrawRect(const SkRect&amp; rect, const SkPaint&amp; paint) : rect(rect), paint(paint) {}\n    SkRect rect;\n    SkPaint paint;\n    void draw(SkCanvas* c, const SkMatrix&amp;) const { c-&gt;drawRect(rect, paint); }\n};\n</code></pre></p> <p>\u6700\u540e<code>RenderNode</code>\u662f\u7528\u4e8e\u786c\u4ef6\u52a0\u901f\u65f6\u6784\u9020View\u7ed3\u6784\u7684\u8282\u70b9\u3002\u4e3b\u8981\u5305\u542b<code>DisplayList</code>\u548c\u4e00\u7ec4\u5c5e\u6027\uff08\u63cf\u8ff0\u4f4d\u7f6e\u3001\u7f29\u653e\u3001\u900f\u660e\u7b49\uff09.\u6bcf\u4e2a<code>View</code>\u5728\u6784\u9020\u65f6\u90fd\u4e5f\u4f1a\u6784\u9020<code>RenderNode</code>\u3002</p> <p>\u603b\u7684\u6765\u770b\uff0cCanvasAPI\u6574\u4f53\u8fd8\u662f\u548cSkia\u7ed1\u5b9a\u6bd4\u8f83\u7d27\u3002</p>"},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/","title":"\u70ed\u4fee\u590d\u65b9\u6848","text":"<p>\u70ed\u4fee\u590d\u6307\u7684\u662f\u5728\u4e0d\u53d1\u7248\u7684\u524d\u63d0\u4e0b\u4fee\u590d\u4ee3\u7801\u95ee\u9898\u3002\u6ce8\u610f\uff0cAndroid\u4e0a\u65e0\u6cd5\u5b9e\u73b0\u7c7b\u5378\u8f7d\u3002\u4f46\u5728Android 8\u5df2\u7ecf\u53ef\u4ee5\u91cd\u65b0\u52a0\u8f7d\u7c7b\u4e86\u3002\u8be6\u89c1Android Studio Apply Changes</p> <ul> <li>\u70ed\u542f\u52a8\u70edJava\u5c42\u4fee\u590d</li> <li>\u70ed\u542f\u52a8\u5e95\u5c42\u66ff\u6362\u4fee\u590d</li> <li>\u51b7\u542f\u52a8\u70ed\u4fee\u590d</li> <li>\u8d44\u6e90\u70ed\u4fee\u590d</li> </ul> <p>\u6574\u4f53\u6765\u8bf4\uff0c\u8981\u4e48\u5bf9\u7c7b\u52a0\u8f7d\u5668\u7740\u624b\uff08\u53cd\u5c04\u83b7\u53d6pathList\uff0c\u589e\u52a0patch.dex\u5230\u961f\u5934\uff0c\u6216\u66f4\u6539dex\u5143\u7d20\uff09\uff0c\u8981\u4e48\u5bf9JVM\u7740\u624b\uff08\u4fee\u6539\u65b9\u6cd5\u6307\u9488\uff09\uff0c\u8981\u4e48\u63d2\u6869\uff08AOP\uff09\uff0c\u8981\u4e48\u53ef\u4ee5\u76f4\u63a5\u652f\u6301\u91cd\u65b0\u52a0\u8f7d\u3002</p>"},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/#_2","title":"\u70ed\u542f\u52a8\u4fee\u590d","text":""},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/#java","title":"Java\u5c42\u70ed\u542f\u52a8\u4fee\u590d","text":"<p>\u63d0\u524d\u5728\u4fee\u590d\u70b9\u6253\u6869\uff0c\u6839\u636e\u540e\u53f0\u4e0b\u53d1\u4fee\u590d\u60c5\u51b5\uff0c\u4e0b\u8f7d\u4e0d\u540c\u7684\u8fdc\u7a0bdex\u7b49\u6587\u4ef6\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u5373\u53ef\u52a0\u8f7d\uff0c\u53d8\u66f4\u524d\u7aef\u903b\u8f91\u3002\u52a0\u8f7d\u8c03\u7528\u534f\u8bae\u9700\u8981\u63d0\u524d\u89c4\u5b9a\u8bbe\u8ba1\u3002(Robust)</p>"},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/#_3","title":"\u5e95\u5c42\u70ed\u542f\u52a8\u4fee\u590d","text":"<p>\u4ee5art\u865a\u62df\u673a\u4e3a\u4f8b\uff0c\u4f9d\u9760jni\uff0c\u901a\u8fc7\u66f4\u6539artMethod\u4fe1\u606f\uff0c\u5373\u4ee3\u7801\u7684\u8bbf\u95ee\u6743\u9650\u3001\u6267\u884c\u5730\u5740\u7b49\uff0c\u4f7f\u5f97\u5728\u4e0d\u7834\u574f\u539f\u6709\u4ee3\u7801\u65b9\u6cd5\u8c03\u7528\u4e0a\uff0c\u4f7f\u7528\u4e86\u65b0\u7684\u65b9\u6cd5\u5b9e\u73b0\u7b49\u3002</p> <ul> <li>Andfix\u4f7f\u7528\u6b64\u65b9\u6848</li> <li>\u5982\u679c\u5382\u5bb6\u5b9a\u5236\u4e86\u4e0d\u540c\u7684art\u5b9e\u73b0\uff0c\u90a3\u4e48\u6b64\u65b9\u6848\u4f1a\u51fa\u73b0\u517c\u5bb9\u6027\u95ee\u9898</li> <li>\u5b9e\u9645\u4e0a\u6709\u4e00\u4e9b\u540e\u6765\u7684Hook\u65b9\u6848\uff0c\u4e0d\u4f9d\u8d56\u7c7b\u4f3cXposed\u6846\u67b6\uff0c\u5176\u5b9e\u73b0\u539f\u7406\u4e5f\u662f\u5982\u6b64\uff0c\u901a\u8fc7jni\u5bf9artMethod\u8fdb\u884c\u4fee\u6539\uff0c\u5728hook\u70b9\u4e0a\u8c03\u7528\u4e86\u81ea\u5df1\u7684Hook\u65b9\u6cd5\u3002</li> </ul>"},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/#_4","title":"\u51b7\u542f\u52a8\u70ed\u4fee\u590d","text":"<ul> <li>\u4e5f\u53ef\u4ee5\u540c\u524d\u9762\u7b2c\u4e00\u4e2a\u65b9\u6848\uff0c\u4e0b\u8f7d\u8fdc\u7a0b\u7684dex\u6587\u4ef6\u540e\uff0c\u5728\u4e0b\u6b21\u542f\u52a8\u65f6\u52a0\u8f7d\u3002</li> <li>\u4fee\u590d\u65b9\u6848\u63d0\u4f9b\u5dee\u91cfdex\u6587\u4ef6\uff0c\u4fee\u590d\u65b9\u6848\u901a\u8fc7\u5c06\u5176\u4e0e\u5f53\u524d\u7684dex\u5408\u5e76\uff0c\u4e4b\u540e\u5728\u4e0b\u6b21\u542f\u52a8\u65f6\u5373\u53ef\u52a0\u8f7d\u4e86\u65b0\u7684dex\u6587\u4ef6\u3002(Tinker)</li> </ul>"},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/#_5","title":"\u8d44\u6e90\u70ed\u4fee\u590d","text":"<p>\u53ef\u53c2\u89c1\u63d2\u4ef6\u5316\u65b9\u6848\u7406\u89e3\u4e2d\u7684\u8d44\u6e90\u63d2\u4ef6\u65b9\u6848\u3002</p>"},{"location":"Android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88/#instantrun-vs-apply-changes","title":"InstantRun vs Apply Changes","text":"<p>InstantRun\u7406\u89e3</p> <p>\u589e\u52a0gradle transform task\uff0c\u5bf9\u6240\u6709\u7c7b\u3001application\u505a\u8f6c\u5316\u3002\u6bcf\u4e2a\u7c7b\u90fd\u589e\u52a0\u4e86\u4e00\u4e2aIncrementalChanges\u6210\u5458\u53d8\u91cf\uff0c\u6bcf\u4e2a\u7c7b\u7684\u65b9\u6cd5\u90fd\u4f1a\u68c0\u67e5\u8fd9\u4e2a\u6210\u5458\u53d8\u91cf\uff0c\u82e5\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8c03\u7528\u5b83\u7684access$dispatch\u65b9\u6cd5\uff0c\u53c2\u65701\u662f\u65b9\u6cd5\u7b7e\u540dstring\uff0c\u53c2\u65702\u662f\u53c2\u6570\u5217\u8868\u6570\u7ec4\u3002application\u542f\u52a8\u65f6\u540c\u65f6\u542f\u52a8local socket\u548candroid studio\u901a\u4fe1\uff0c\u4ee5\u6b64\u83b7\u53d6changes list\u3002\u83b7\u53d6\u540e\uff0c\u5982\u679c\u662f\u70ed\u66f4\u65b0\uff08android studio\u8d1f\u8d23\u8bb0\u5f55\u5206\u6790\u54ea\u4e9b\u4ee3\u7801\u53d1\u751f\u53d8\u5316\uff0c\u505a\u589e\u91cf\u7f16\u8bd1\uff0c\u4ee5\u53ca\u63a7\u5236\u66f4\u65b0\u6a21\u5f0f\uff09\uff0c\u90a3\u4e48app server \u901a\u8fc7socket\u83b7\u53d6\u5230\u53d8\u66f4\u540e\uff0c\u52a0\u8f7d\u8be5\u7c7b\uff08\u4e00\u822c\u8865\u4e01\u7c7b\u7684\u540d\u79f0\u662f\u539f\u7c7b\u7684\u540d\u79f0+$override\u3002\u8fd9\u91cc\u8003\u8651\u5982\u679c\u591a\u6b21\u8865\u4e01\uff0c\u90a3\u4e48\u4e3a\u4e86\u8ba9\u5176\u80fd\u52a0\u8f7d\u65b0\u7684\u540c\u540d\u7c7b\uff0c\u5b9e\u9645\u4e0a\u6bcf\u6b21\u52a0\u8f7d\u7684\u65f6\u5019\u90fd\u9700\u8981\u751f\u6210\u65b0\u7684classloader\u52a0\u8f7d\uff08\u56e0\u4e3a\u4e0d\u540c\u7684classloader\u52a0\u8f7d\u7684\u7c7b\u88ab\u8ba4\u4e3a\u4e0d\u540c\uff0c\u800c\u5728\u8f6c\u5316\u8fc7\u7684application\u4e2d\uff0c\u4e5f\u5bf9classloader\u5305\u88c5\u4e86\u4e00\u5c42\uff0c\u6dfb\u52a0\u4e86\u4e00\u5c42\u59d4\u6258\uff0c\u5728\u8fd9\u5c42\u4e2d\u4ece\u800c\u6765\u63a7\u5236overide\u7684\u7c7b\u52a0\u8f7d\u95ee\u9898\u3002\u8fd9\u91cc\u6709\u5f88\u591aclassloader\u4e0a\u8981\u6ce8\u610f\u7684\u6280\u5de7\uff09\u3002\u6700\u7ec8\u5bf9\u76ee\u6807\u7c7b\u7684IncrementalChanges\u6210\u5458\u53d8\u91cf\u8d4b\u503c\u3002\u8fd9\u4e2a\u4e3b\u8981\u662fhot swap\u7684\u60c5\u51b5\u3002</p> <p>\u5176\u4ed6\u7684warm swap\uff0ccold swap\u7c7b\u4f3c\u3002\u53ef\u4ee5\u67e5\u770b\u539f\u6587\u3002</p> <p>Apply Changes\u7406\u89e3 </p> <p>\u501f\u52a9\u5b89\u53538\u7c7b\u91cd\u65b0\u52a0\u8f7d+\u6570\u636e\u5e93dex\u7c7b\u7f13\u5b58\u6821\u9a8capk\u5dee\u5f02\u7c7b+delta push</p>"},{"location":"Android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/","title":"\u81ea\u52a8\u5316\u6d4b\u8bd5","text":""},{"location":"Android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/#_1","title":"\u5185\u5b58\u6cc4\u6f0f\u6d4b\u8bd5","text":"<p>\u6b64\u6587\u6863\u662f\u5f88\u4e45\u4ee5\u524d\u5199\u7684\uff0c\u9700\u8981\u66f4\u591a\u8865\u5145</p> <p>LeakCanary\u652f\u6301InstrumentalTest\u4e2d\u6dfb\u52a0\u76f8\u5e94\u7684TestRule\uff0c\u9664\u6b64\u4ee5\u5916\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u58f0\u660e\u5468\u671f\u8303\u56f4\u8865\u5145\u6d4b\u8bd5\uff0c\u6839\u636e\u9700\u8981\u6765\u770b\u3002</p>"},{"location":"Android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/#mock","title":"\u4ee5\u5b9e\u9645\u6570\u636e\u4f5c\u4e3aMock\u6e90\u8fdb\u884c\u6d4b\u8bd5","text":"<p>\u6b64\u6587\u6863\u662f\u5f88\u4e45\u4ee5\u524d\u5199\u7684\uff0c\u4ec5\u4f5c\u4e3a\u9057\u7559\u4ea7\u7269</p> <p>\u6700\u8fd1\u4e00\u4e2a\u540c\u4e8b\u63d0\u4e86\u4e2a\u901a\u8fc7MockResponse\u6765\u5e2e\u52a9\u6d4b\u8bd5\u4e00\u4e9b\u4e0d\u597d\u8fdb\u884c\u5b9e\u9645\u7f51\u7edc\u8bf7\u6c42\u7684\u6d4b\u8bd5\uff0c\u8bb0\u5f55\u4e00\u4e0b\u3002</p> <p>\u5176\u601d\u8def\u662f\u9996\u5148\u4f7f\u7528FileLogger\u8fd9\u6837\u4e00\u4e2aOkHttp\u7684\u62e6\u622a\u5668\u628a\u6240\u6709\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u4ee5json\u5f62\u5f0f\u5199\u5165\u5230\u624b\u673a\u672c\u5730\u6587\u4ef6\u4e0a\u3002\u518d\u901a\u8fc7adb\u8f6c\u79fb\u5230\u9879\u76ee\u7684androidTest\u7684asset\u76ee\u5f55\u4e0b\u3002\u6b64\u65f6\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u7528\u4f8b\u7684\u540d\u5b57\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u518d\u6309\u67d0\u4e9b\u540d\u79f0\u89c4\u5219\u6807\u8bb0\u521a\u624d\u8bb0\u5f55\u7684json\u6570\u636e\uff0c\u4ece\u800c\u53ef\u4ee5\u6309\u4e00\u4e2a\u7279\u5b9a\u7684\u987a\u5e8f\u4f9d\u6b21\u54cd\u5e94\uff08\u4e3b\u8981\u662f\u540c\u4e00\u4e2a\u8bf7\u6c42\u4e0b\uff0c\u524d\u540e\u987a\u5e8f\u53ef\u80fd\u4f1a\u654f\u611f\uff09\u3002</p> <p>\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u5728\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u4e00\u4e2aMockResponse\u7684\u62e6\u622a\u5668\uff0c\u53e6\u5916\u8fd8\u9700\u8981\u5148\u52a0\u8f7d\u5bf9\u5e94\u7684asset\u76ee\u5f55\u4e0b\u7684\u54cd\u5e94\u7f13\u5b58\u6587\u4ef6\uff0c\u91cc\u9762\u5305\u542b\u7684request\u4fe1\u606f\u3002\u6b64\u65f6\u53ef\u4ee5\u8986\u76d6MockResponse\u7684\u65b9\u6cd5\uff0c\u81ea\u5b9a\u4e49\u4e00\u4e9b\u903b\u8f91\u51b3\u5b9a\u6b64\u6d4b\u8bd5\u7528\u4f8b\u4e2dokHttp\u53d1\u9001\u7684\u54ea\u4e9b\u8bf7\u6c42\u4f1a\u88abMockResponse\u62e6\u622a\uff0c\u751a\u81f3\u51b3\u5b9a\u5982\u4f55\u4f7f\u7528\u8fd9\u4e9b\u7f13\u5b58\u7684\u6570\u636e\u3002\u9ed8\u8ba4\u7684\u8bdd\u5e94\u8be5\u662fRequest\u7684url\u53ea\u8981\u5339\u914d\uff0c\u540c\u65f6\u7f13\u5b58\u4e2d\u5c1a\u8fd8\u5b58\u5728\u672a\u88ab\u6d88\u8017\u7684\u8be5url\u7684Response\uff0c\u5219\u4f1a\u76f4\u63a5\u8fd4\u56de\u3002</p> <p>\u6700\u540e\u8fd8\u53ef\u4ee5\u68c0\u67e5\u8be5\u7f13\u5b58\u6587\u4ef6\u6240\u6709\u6570\u636e\u662f\u4e0d\u90fd\u88ab\u6d88\u8017\u4e86\uff0c\u4ece\u800c\u66f4\u52a0\u4e25\u683c\u8fdb\u884c\u68c0\u67e5\u3002</p> <p>\u518d\u603b\u7ed3\u4e00\u6b21\uff1a</p> <ul> <li>\u6dfb\u52a0FileLogger\u624b\u52a8\u64cd\u4f5c\u4e00\u6b21\u6b63\u5e38\u6d41\u7a0b\u3002</li> <li>\u628aFileLogger\u8bb0\u5f55\u7684\u8bf7\u6c42\u6570\u636e\u8f6c\u79fb\u5230\u9879\u76ee\u7684androidTest-&gt;asset\u4e2d\u3002</li> <li>\u5728\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u6dfb\u52a0MockResponse\u62e6\u622a\u5668\uff0c\u5728\u6d4b\u8bd5\u7528\u4f8b\u5f00\u59cb\u65f6\u52a0\u8f7d\u5bf9\u5e94\u7684\u7f13\u5b58\u6587\u4ef6\u3002</li> <li>\u53ef\u81ea\u5b9a\u7f13\u5b58\u4f7f\u7528\u903b\u8f91\u3002\u6216\u6309\u9ed8\u8ba4\u81ea\u52a8\u8fd4\u56de\u7f13\u5b58\u7f51\u7edc\u6570\u636e\uff0c\u539f\u6837\u6a21\u62df\u4e4b\u524d\u64cd\u4f5c\u573a\u666f\u3002</li> <li>\uff08\u53ef\u9009\uff09\u68c0\u67e5\u7f13\u5b58\u6570\u636e\u662f\u5426\u5168\u90e8\u88ab\u6d88\u8017\u5b8c\u6bd5\u3002</li> </ul>"},{"location":"Bito/Bito%20VSCode%20Extension/","title":"Bito VSCode Extension","text":"<p>\u53d7\u9650\u4e8e\u654f\u611f\u4fe1\u606f\uff0c\u6211\u5c06\u6587\u6863\u4f5c\u4e3a\u56fe\u7247\u5c55\u793a\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"Bito/Bito-TSX/","title":"Bito TSX","text":"<p>\u53d7\u9650\u4e8e\u654f\u611f\u4fe1\u606f\uff0c\u6211\u5c06\u6587\u6863\u4f5c\u4e3a\u56fe\u7247\u5c55\u793a\u5982\u4e0b\uff1a</p>"},{"location":"Bito/Bito-TSX/#1","title":"1\u5206\u949f\u7248","text":""},{"location":"Bito/Bito-TSX/#_1","title":"\u5b8c\u6574\u7248","text":""},{"location":"CI/Github%26Gitlab-CI%26CD%E7%90%86%E8%A7%A3/","title":"Github&Gitlab CI&CD\u7406\u89e3","text":"<p>\u6b64\u6587\u6863\u662f\u5f88\u4e45\u4ee5\u524d\u5199\u7684\uff0c\u4ec5\u4f5c\u4e3a\u9057\u7559\u4ea7\u7269</p>"},{"location":"CI/Github%26Gitlab-CI%26CD%E7%90%86%E8%A7%A3/#github-gitlab-cicd","title":"Github, Gitlab \u7684 CI/CD\u529f\u80fd","text":""},{"location":"CI/Github%26Gitlab-CI%26CD%E7%90%86%E8%A7%A3/#cicd","title":"CI/CD","text":"<p>CI\u6301\u7eed\u96c6\u6210\uff0cCD\u6301\u7eed\u90e8\u7f72\u3002\u5b9e\u9645\u4e0a\u90fd\u662f\u5728\u4ed3\u5e93\u53d1\u751f\u4e00\u4e9b\u4e8b\u4ef6\u6216\u8005\u5468\u671f\u6027\u7684\u8fd0\u884c\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u811a\u672c\u3002</p> <p>\u5bf9\u4e8eGithub\u4e0a\uff0c\u88ab\u5b9a\u4e49\u4e3a\u4e86Actions/Workflow\u529f\u80fd\u3002\u5bf9\u4e8eGitlab\u4e0a\uff0c\u88ab\u5b9a\u4e49\u4e3a\u4e86Pipeline\u548cSchedulers\u529f\u80fd\u3002\u4f46\u8fd9\u4e9b\u811a\u672c\u90fd\u662f\u901a\u8fc7yml\u683c\u5f0f\u5199\u7684\uff0c\u5177\u4f53\u7684\u8bed\u6cd5\u89c4\u8303\u76f8\u4f3c\u4f46\u4e0d\u76f8\u540c\u3002\u9700\u8981\u7528\u7684\u65f6\u5019\u591a\u53c2\u8003\u4e0b\u6587\u6863\u3002</p> <p>Github\u7684Actions\u7684\u8fd0\u884c\u73af\u5883\u662fGithub\u76f4\u63a5\u63d0\u4f9b\u7684Azure\u4e0a\u7684\u8d44\u6e90\uff08\u679c\u7136\u5f53\u65f6\u51b3\u5b9a\u5356\u7ed9\u5fae\u8f6f\u8fd8\u662f\u5f88\u6709\u773c\u5149\u7684\uff09\uff0c\u81ea\u5df1\u53ea\u9700\u8981\u5199\u811a\u672c\u5c31\u53ef\u4ee5\u4e86\uff0c\u6bd4Gitlab\u8981\u65b9\u4fbf\u3002Gitlab\u9700\u8981\u81ea\u5df1\u6216\u8005\u4f01\u4e1a\u81ea\u884c\u63d0\u4f9b\u3001\u6ce8\u518cGitlabRunner\uff08\u8fc7\u7a0b\u8fd8\u7b97\u7b80\u5355\uff09\uff0c\u7136\u540e\u8fd9\u4e9b\u8dd1GitlabRunner\u7684\u673a\u5668\u8fd8\u9700\u8981\u88c5docker\u6216virtualBox\u7b49\u865a\u62df\u5316\u7c7b\u7684\u8f6f\u4ef6\u3002\u56e0\u4e3aCI/CD\u8fd9\u4e9b\u811a\u672c\u5f80\u5f80\u662f\u9700\u8981\u5404\u79cd\u5404\u6837\u7684\u6784\u5efa\u3001\u90e8\u7f72\u73af\u5883\uff0c\u5f53\u7136\u5b9e\u5728\u4e0d\u60f3\u5f04\u5e94\u8be5\u4e5f\u6709\u529e\u6cd5\u76f4\u63a5\u5728\u672c\u5730\u4e0a\u8dd1\u3002</p>"},{"location":"CI/Github%26Gitlab-CI%26CD%E7%90%86%E8%A7%A3/#jenkins","title":"Jenkins","text":"<p>\u6211\u4eec\u53bb\u770b\u5176\u672c\u8d28\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u5982\u679c\u53ea\u662f\u9488\u5bf9\u4e00\u4e2a\u7279\u5b9a\u9879\u76ee\uff0c\u7528\u4e0d\u7528\u4e0a\u9762\u7684\u8fd9\u4e9b\u65b9\u6848\u90fd\u4e0d\u662f\u7279\u522b\u91cd\u8981\u3002\u5b9e\u9645\u4e0a\u4e0d\u8fc7\u662f\uff08\u4e00\u822c\u800c\u8a00\uff09\u90fd\u662f\u53bb\u5728\u4ee3\u7801\u66f4\u65b0\u7684\u65f6\u5019\u5b8c\u6210\u4e00\u4e9b\u56de\u5f52\u6d4b\u8bd5\u7b49\uff0c\u518d\u901a\u77e5\u6d4b\u8bd5\u7ed3\u679c\u3002\u8fd9\u4e9b\u672c\u8d28\u4e0a\u8fd8\u662f\u4f9d\u8d56git\u81ea\u8eab\u7684webHook\u5c31\u53ef\u4ee5\u505a\u5230\u3002\u53ea\u4e0d\u8fc7CI/CD\u4ee5\u53ca\u4e0a\u9762\u6240\u8bf4\u662f\u6700\u4e3b\u8981\u7684\u4e00\u4e2a\u4f7f\u7528\u573a\u666f\u3002</p> <p>WebHook\u5b9e\u9645\u4e0a\u5c31\u662f\u5f53\u4ed3\u5e93\u53d1\u751f\u4e00\u4e9b\u4e8b\u4ef6\u7684\u65f6\u5019\u4f1a\u7ed9\u81ea\u5b9a\u7684url\u53d1\u9001\u8bf7\u6c42\u544a\u77e5\u8fd9\u4e9b\u4e8b\u4ef6\uff0c\u5e76\u53ef\u4ee5\u4fee\u6539\u6700\u7ec8\u4ed3\u5e93\u7684\u4e00\u4e9b\u884c\u4e3a\u3002</p> <p>\u5f53\u6211\u4eec\u81ea\u5df1\u53bb\u914d\u7f6eWebHook\u65f6\uff0c\u751a\u81f3\u81ea\u5df1\u5199\u811a\u672c\u53bb\u8f6e\u8badGit\u4ed3\u5e93\u53d8\u66f4\u65f6\uff0c\u5176\u5b9e\u90fd\u53ef\u4ee5\u53bb\u5b8c\u6210\u5404\u79cd\u81ea\u5df1\u9700\u8981\u7684\u4efb\u52a1\uff0c\u5373\u4f7f\u662f\u7528Jenkins\u4e5f\u4e0d\u4f8b\u5916\u3002\u53ea\u662f\u4e0a\u9762\u7684CI/CD\u662f\u9488\u5bf9Github\u548cGitlab\u66f4\u4e3a\u7b80\u5355\u3001\u5c01\u88c5\u66f4\u597d\u7684\u65b9\u6848\u800c\u5df2\u3002</p>"},{"location":"CI/Github%26Gitlab-CI%26CD%E7%90%86%E8%A7%A3/#github-actions-secret","title":"Github Actions Secret","text":"<p>GithubActions\u4e2d\u81ea\u5b9a\u7684workflow\u811a\u672c\u96be\u514d\u4f1a\u7528\u5230\u654f\u611f\u7684\u5982\u8d26\u53f7\u3001\u5bc6\u7801\u7b49\u4e1c\u897f\uff0c\u8fd9\u4e9b\u53ef\u4ee5\u4f7f\u7528Github Secret\u6765\u4fdd\u5b58\uff0c\u5728\u811a\u672c\u4f7f\u7528\u7684\u65f6\u5019\u518d\u901a\u8fc7\u522b\u540d\u5f15\u5165secrets\u4f5c\u4e3a\u811a\u672c\u7684\u73af\u5883\u53d8\u91cf\u5373\u53ef\u3002\u8fd9\u4e2a\u529f\u80fd\u5728Gitlab\u4e0a\u4e5f\u6709\u7c7b\u4f3c\u4ea7\u7269\u3002</p>"},{"location":"CI/Github%26Gitlab-CI%26CD%E7%90%86%E8%A7%A3/#_1","title":"\u601d\u60f3","text":"<p>git\u53ca\u5176\u7c7b\u4f3cGithub\u53caGitlab\u5728\u540e\u671f\u9010\u6e10\u5b8c\u5584\u7684\u8fd9\u4e00\u6574\u5957\u6d41\u7a0b\u7ba1\u7406\uff0c\u5df2\u7ecf\u662f\u5bf9\u5927\u90e8\u5206\u7684\u9879\u76ee\uff08\u65e0\u8bba\u9879\u76ee\u7684\u7c7b\u578b\u3001\u9879\u76ee\u7684\u89c4\u6a21\uff09\u90fd\u80fd\u9ad8\u5ea6\u6982\u62ec\u3001\u63d0\u70bc\u3002\u5f88\u591a\u9879\u76ee\uff0c\u54ea\u6015\u662f\u7c7b\u4f3c\u4e2a\u4eba\u7684\u6587\u7ae0\u6574\u7406\u3001\u591a\u4eba\u65c5\u884c\u8ba1\u5212\u7b49\u7b49\u90fd\u5b8c\u5168\u53ef\u4ee5\u4f9d\u8d56\u8fd9\u79cd\u65b9\u5f0f\u3002</p> <p>\u6bd4\u5982\u5bf9\u4e8e\u4e2a\u4eba\u6587\u7ae0\u7ba1\u7406\uff0c\u53ef\u4ee5\u5728CI/CD\u4e0a\u6dfb\u52a0\u811a\u672c\u8ba9\u4ed3\u5e93\u91cc\u7684\u6587\u7ae0\u5168\u90e8\u81ea\u52a8\u540c\u6b65\u5230\u4e2a\u4eba\u7f51\u7ad9\u3001\u5176\u4ed6\u5404\u7c7b\u5e73\u53f0\u7684\u8d26\u53f7\u3001\u751a\u81f3\u81ea\u52a8\u63a8\u9001\u5fae\u535a\u3001\u5fae\u4fe1\u7b49\u7b49\u3002</p> <p>\u6bd4\u5982\u5bf9\u4e8e\u591a\u4eba\u65c5\u884c\u8ba1\u5212\uff0cGithub\u81ea\u884c\u53ef\u4ee5\u751f\u6210\u7f51\u9875\uff0c\u800cCI/CD\u8fd8\u53ef\u4ee5\u81ea\u52a8\u628a\u6700\u65b0\u7684\u8ba1\u5212\u901a\u77e5\u7ed9\u6240\u6709\u8ba2\u9605\u8ba1\u5212\u7684\u4eba\u3002</p> <p>\u5f53\u7136\uff0c\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u751a\u81f3\u8fd8\u53ef\u4ee5\u52a0\u5165\u4e00\u4e9b\u8bed\u6cd5\u5206\u6790\u3001\u8bed\u8a00\u7684\u9759\u6001\u68c0\u67e5\uff0c\u9632\u6b62\u51fa\u73b0\u9519\u522b\u5b57\u7b49\u8bed\u8a00\u9519\u8bef\u60c5\u51b5\u3002</p> <p>\u603b\u4e4b\u8fd9\u79cd\u9879\u76ee\u7684\u6d41\u7a0b\u548c\u7ba1\u7406\uff0c\u5982\u679c\u6df1\u5165\u601d\u8003\u548c\u63a2\u7a76\uff0c\u4f1a\u53d1\u73b0\u5176\u7075\u6d3b\u5ea6\u3001\u5f3a\u5927\u5ea6\u8fdc\u8fdc\u8d85\u8fc7\u60f3\u8c61\uff01\u4f60\u4f1a\u53d1\u73b0\uff0c\u5982\u679c\u771f\u6b63\u5145\u5206\u4f7f\u7528\u8d77\u6765\u8fd9\u4e9b\u4e1c\u897f\uff0c\u6211\u4eec\u7684\u5f88\u591a\u6d41\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\uff0c\u5e0c\u671b\u89c4\u907f\u7684\u95ee\u9898\u90fd\u80fd\u5f97\u5230\u53ef\u9760\u7684\u89e3\u51b3\u3002\u6211\u5f88\u4f69\u670d\u8fd9\u79cd\u771f\u6b63\u7684CS\u601d\u7ef4\u7684\u4ea7\u7269\u3002</p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/","title":"Makefile cmake gn ninja","text":""},{"location":"CXX/makefile%20cmake%20gn%20ninja/#_1","title":"\u6982\u8ff0","text":"<p>makefile\u662f\u4e00\u4e2a\u7c7b\u4f3cshell\u811a\u672c\u6587\u4ef6\uff0c\u7528\u4e8e\u501f\u52a9gnu make\u5de5\u5177\uff0c\u9760<code>make</code>\u6307\u4ee4\u6765\u6784\u5efa\u51fa\u76ee\u6807\u4ea7\u7269\u3002</p> <p>cmake\u5219\u662f\u6784\u5efa\u7cfb\u7edf\u7684\u751f\u6210\u5668\uff0c\u501f\u52a9gnu cmake\u5de5\u5177\uff0c\u5728\u63cf\u8ff0\u4e00\u4e9b\u89c4\u5219\u540e\u6765\u751f\u6210\u51famakefile\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7684\u6784\u5efa\u7cfb\u7edf\u6587\u4ef6\u3002</p> <p>ninja\u3001gn\u5219\u662fGoogle\u51fa\u4ea7\u7684cxx\u6784\u5efa\u5de5\u5177\u3002\u76f8\u6bd4make/cmake\uff0cninja/gn\u65e8\u5728\u66f4\u9ad8\u6548\u3001\u5e76\u4e14\u5c3d\u53ef\u80fd\u907f\u514dmake/cmake\u90a3\u4e9b\u9690\u6666\u7684\u9690\u5f0f\u5b8f\u3001\u53d8\u91cf\u7b49\u3002ninja\u53ef\u4ee5\u7c7b\u6bd4make\uff0c\u800cgn\u53ef\u4ee5\u7c7b\u6bd4cmake\u3002</p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#makefile","title":"makefile","text":"<p>\u6587\u4ef6\u540d\u4e3a<code>makefile</code>\u6216<code>xxx.mk</code>\u5c31\u4f1a\u88ab\u8ba4\u4e3a\u662fmakefile\u4e86\u3002\u6587\u4ef6\u7684\u57fa\u672c\u89c4\u5219\u662f\uff1a</p> <p><pre><code>target ... : prerequisites ...\n    command\n</code></pre> \u5f53target\u4e0d\u5b58\u5728\u3001\u6216\u8005prerequisties\u7684\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u6bd4target\u6587\u4ef6\u66f4\u65b0\uff0c\u5219\u4f1a\u6267\u884ccommand\u3002target\u9664\u4e86\u53ef\u4ee5\u662f\u6587\u4ef6\u540d\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u662flabel\uff0c\u53ef\u4ee5\u901a\u8fc7make label\u6765\u6267\u884c\u4e00\u4e9b\u7279\u5b9a\u7684\u884c\u4e3a\u3002</p> <p>\u6b64\u5916\u5e38\u89c1\u7684\u8fd8\u5305\u62ec\uff1a</p> <ul> <li>\u5f15\u5165\u53d8\u91cf\uff0c\u6765\u65b9\u4fbf\u7ef4\u62a4\u6587\u4ef6\u5217\u8868\u3002</li> <li>\u5f15\u5165\u5176\u4ed6makefile\uff0c\u6765\u6784\u9020\u66f4\u590d\u6742\u7684\u9879\u76ee</li> </ul> <p>makefile\u4e2d\u7684cc, ld\u7b49\u90fd\u53ef\u4ee5\u8fdb\u4e00\u6b65\u6307\u5b9a\u5177\u4f53\u7684\u5de5\u5177\uff0c$(make)\u5219\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5d4c\u5957\u5b50\u76ee\u5f55\u7f16\u8bd1\u3002</p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#_2","title":"\u793a\u4f8b\uff1a\u7b80\u5355\u7f16\u8bd1","text":"<pre><code>blah: blah.o\n    cc blah.o -o blah # Runs third\n\nblah.o: blah.c\n    cc -c blah.c -o blah.o # Runs second\n\nblah.c:\n    echo \"int main() { return 0; }\" &gt; blah.c # Runs first\n</code></pre>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#_3","title":"\u793a\u4f8b\uff1a\u5f15\u5165\u5b50\u76ee\u5f55","text":"<p>\u6839\u76ee\u5f55 <pre><code>new_contents = \"hello:\\n\\\\techo \\$$(cooly)\"\n\nall:\n    mkdir -p subdir\n    echo $(new_contents) | sed -e 's/^ //' &gt; subdir/makefile\n    @echo \"---MAKEFILE CONTENTS---\"\n    @cd subdir &amp;&amp; cat makefile\n    @echo \"---END MAKEFILE CONTENTS---\"\n    cd subdir &amp;&amp; $(MAKE)\n\n# Note that variables and exports. They are set/affected globally.\ncooly = \"The subdirectory can see me!\"\nexport cooly\n# This would nullify the line above: unexport cooly\n\nclean:\n    rm -rf subdir\n</code></pre> \u5b50\u76ee\u5f55subdir\uff1a <pre><code>hello:\n    echo $(cooly)\n</code></pre></p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#cmake","title":"cmake","text":"<p>\u6587\u4ef6\u540d\u4e3a<code>cmakelists.txt</code>\uff0c\u5c31\u4f1a\u88ab\u8ba4\u4e3a\u662fcmake\u6587\u4ef6\u4e86\u3002\u5b83\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u7684\u5b8f\u6765\u63cf\u8ff0\u4e00\u4e2acxx\u7684\u9879\u76ee\u6784\u5efa\uff1a</p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#_4","title":"\u793a\u4f8b\uff1a\u751f\u6210\u9009\u9879\u5b8f\uff0c\u589e\u52a0\u5b50\u76ee\u5f55","text":"<p><pre><code>cmake_minimum_required(VERSION 3.10)\nproject(Step2 VERSION 0.1)\n\noption(USE_ALIB \"use alib ?\" ON)\nconfigure_file(Step1Config.h.in Step1Config.h)\n\nif(USE_ALIB)\n    add_subdirectory(alib)\n    list(APPEND EXTRA_LIBS ALib)\n    add_definitions(-DUSE_ALIB)\nendif()\n\nadd_executable(Step2 step1.cpp)\ntarget_link_libraries(Step2 PUBLIC ${EXTRA_LIBS})\ntarget_include_directories(Step2 PUBLIC \n    \"${PROJECT_BINARY_DIR}\"\n)\n\ninstall(TARGETS Step2 DESTINATION bin)\n</code></pre> \u5b50\u76ee\u5f55alib: <pre><code>add_library(ALib alib.cpp)\ntarget_include_directories(ALib INTERFACE ${CMAKE_CURRENT_SOURCE_DIR})\n\ninstall(TARGETS ALib DESTINATION lib)\ninstall(FILES alib.h DESTINATION include)\n</code></pre></p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#_5","title":"\u793a\u4f8b\uff1a\u5f15\u5165\u5916\u90e8\u5934\u6587\u4ef6\u3001\u5e93","text":"<p>\u5728<code>brew install cjson</code>\u540e\uff0c\u5373\u53ef\u5728\u83b7\u5f97cjson\u7684\u5934\u6587\u4ef6\u548c\u5e93\u3002\u5982\u4e0b\u53ef\u4ee5\u5f15\u5165\u5230\u6784\u5efa\u4e2d\uff1a <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(CJsonPlay VERSION 0.1)\nadd_executable(CJsonPlay play.cpp)\ntarget_include_directories(CJsonPlay PUBLIC \"/usr/local/include/\")\nfind_library(CJson cjson)\ntarget_link_libraries(CJsonPlay PUBLIC \"${CJson}\")\n</code></pre></p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#macosskia","title":"\u793a\u4f8b\uff1amacOS\u5f15\u5165\u9884\u6784\u5efaSkia","text":"<p>macOS\u4e0a\u6709\u65f6\u5019\u9700\u8981\u5f15\u5165\u4e00\u4e9b\u7cfb\u7edf\u5e93\uff0c\u5982\u4e0b<code>-framework xxxx</code>\u90e8\u5206\u3002 <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(SkiaPlay VERSION 0.1)\nadd_executable(SkiaPlay play.cpp)\ntarget_compile_features(SkiaPlay PRIVATE cxx_std_17)\ntarget_include_directories(SkiaPlay PUBLIC \"${PROJECT_SOURCE_DIR}\")\nfind_library(Skia skia HINTS \"/Users/zhangruize/fav-libs/skia/out/Static\")\ntarget_link_libraries(SkiaPlay PUBLIC \"${Skia}\" \n\"-framework CoreFoundation\"\n\"-framework CoreGraphics\"\n\"-framework CoreText\"\n\"-framework ImageIO\"\n\"-framework ApplicationServices\"\n)\n</code></pre></p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#ndk","title":"\u793a\u4f8b\uff1a\u5b89\u5353\u4e0a\u5f15\u5165ndk\u5e93","text":"<p>\u5b89\u5353\u5f15\u5165ndk\uff0c\u4e00\u822c\u5728module\u7684build.gradle\u4e2d\uff1a <pre><code>android{\n    externalNativeBuild {\n        cmake {\n            path file('src/main/cpp/CMakeLists.txt')\n            version '3.22.1' // \u7248\u672c\u6309\u9700\u8bbe\u7f6e\u3002\u5982\u679cndk\u81ea\u5e26\u7684cmake\u7248\u672c\u4e0d\u7b26\u5408\u8981\u6c42\uff0c\u5219gradle plugin\u4f1a\u5728\u73af\u5883\u53d8\u91cf\u548clocal.properties: cmake.dir\u4e2d\u5bfb\u627e\u7b26\u5408\u8981\u6c42\u7684cmake\u3002\n        }\n    }\n    ndkVersion '22.1.7171670'\n}\n</code></pre> minSdkVersion\u4f1a\u51b3\u5b9a\u6240\u4f7f\u7528\u7684ndk\u5934\u6587\u4ef6\u3001\u94fe\u63a5\u7684\u5e93\u3002\u4e0d\u540c\u7684minSdkVersion\u4e0b\uff0c\u53ef\u80fd\u5e93\u6587\u4ef6\u540d\u6709\u5dee\u5f02\u3002\u5982<code>#include &lt;android/native_window.h&gt;</code>\u5728\u4e0d\u540c\u7684\u7248\u672c\u65f6\uff0c\u4f1a<code>-landroid</code>\u6216<code>-lnativewindow</code>\u5373\u4f4d\u4e8e<code>libandroid</code>\u6216<code>libnativewindow</code>\u3002</p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#ninja","title":"ninja","text":"<p>\u5b83\u53ef\u4ee5\u4e0e<code>makefile</code>\u7c7b\u6bd4\uff1a <pre><code>ninja_required_version = 1.7.2\n\nrule gn\n  command = ../../../../tools/gn --root=./.. -q --regeneration gen .\n  pool = console\n  description = Regenerating ninja files\n\nrule hh\n  command = echo \"hhh\"\n\nbuild hh2: hh\n\nbuild build.ninja: gn\n  generator = 1\n  depfile = build.ninja.d\n\nsubninja toolchain.ninja\n\nbuild $:hello: phony ./hello\n\nbuild all: phony $\n    ./hello\n\ndefault all\n</code></pre> \u7ed3\u6784\u5927\u81f4\u5982\u4e0b\uff1a <pre><code>config\n\nrule name\n    config...\n\nbuild name: ruleName\n    config...\n</code></pre></p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#gn","title":"gn","text":"<p>\u5728\u9879\u76ee\u7684\u6839\u76ee\u5f55\u4e2d\u5efa\u7acb<code>.gn</code>\u6587\u4ef6\uff0c\u4e00\u822c\u683c\u5f0f\u5982\u4e0b\uff1a <pre><code>buildconfig = \"//gn/BUILDCONFIG.gn\"\n\ndefault_args = {\n}\n</code></pre> \u5176\u4e2dgn\u76ee\u5f55\u4e0b\uff1a <pre><code>set_default_toolchain(\"//gn/toolchains:gcc_like\")\ncflags_cc = [\"-std=c++11\"]\n</code></pre> \u6ce8\u610f\uff0cgn\u4e0d\u4f1a\u9ed8\u8ba4\u91c7\u7528\u4efb\u4f55toolchain\uff0c\u6240\u6709toolchain\u90fd\u9700\u8981\u624b\u52a8\u6307\u5b9a\u3002\u5728toolchain\u76ee\u5f55\u4e0b\uff0cbuild.gn: <pre><code>template(\"gcc_like_toolchain\") {\n  toolchain(target_name) {\n    ar = invoker.ar\n    cc = invoker.cc\n    cxx = invoker.cxx\n    link = invoker.link\n    lib_switch = \"-l\"\n    lib_dir_switch = \"-L\"\n\n    tool(\"cc\") {\n      depfile = \"{{output}}.d\"\n      command = \"$cc -MD -MF $depfile {{defines}} {{include_dirs}} {{cflags}} {{cflags_c}} -c {{source}} -o {{output}}\"\n      depsformat = \"gcc\"\n      outputs =\n          [ \"{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o\" ]\n      description = \"compile {{source}}\"\n    }\n\n    tool(\"cxx\") {\n      depfile = \"{{output}}.d\"\n      command = \" $cxx -MD -MF $depfile {{defines}} {{include_dirs}} {{cflags}} {{cflags_cc}} -c {{source}} -o {{output}}\"\n      depsformat = \"gcc\"\n      outputs =\n          [ \"{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o\" ]\n      description = \"compile {{source}}\"\n    }\n\n    tool(\"objc\") {\n      depfile = \"{{output}}.d\"\n      command = \" $cc -MD -MF $depfile {{defines}} {{include_dirs}} {{framework_dirs}} {{cflags}} {{cflags_objc}} -c {{source}} -o {{output}}\"\n      depsformat = \"gcc\"\n      outputs =\n          [ \"{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o\" ]\n      description = \"compile {{source}}\"\n    }\n\n    tool(\"objcxx\") {\n      depfile = \"{{output}}.d\"\n      command = \" $cxx -MD -MF $depfile {{defines}} {{include_dirs}} {{framework_dirs}} {{cflags}} {{cflags_cc}} {{cflags_objcc}} -c {{source}} -o {{output}}\"\n      depsformat = \"gcc\"\n      outputs =\n          [ \"{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o\" ]\n      description = \"compile {{source}}\"\n    }\n\n    tool(\"asm\") {\n      depfile = \"{{output}}.d\"\n      command = \" $cc -MD -MF $depfile {{defines}} {{include_dirs}} {{asmflags}} -c {{source}} -o {{output}}\"\n      depsformat = \"gcc\"\n      outputs =\n          [ \"{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o\" ]\n      description = \"assemble {{source}}\"\n    }\n\n    is_mac = false\n    is_ios=false\n    if (is_mac || is_ios) {\n      not_needed([ \"ar\" ])  # We use libtool instead.\n    }\n\n    tool(\"alink\") {\n      if (is_mac || is_ios) {\n        command = \"libtool -static -o {{output}} -no_warning_for_no_symbols {{inputs}}\"\n      } else {\n        rspfile = \"{{output}}.rsp\"\n        rspfile_content = \"{{inputs}}\"\n        rm_py = rebase_path(\"../rm.py\")\n        command = \"python \\\"$rm_py\\\" \\\"{{output}}\\\" &amp;&amp; $ar rcs {{output}} @$rspfile\"\n      }\n\n      outputs =\n          [ \"{{root_out_dir}}/{{target_output_name}}{{output_extension}}\" ]\n      default_output_extension = \".a\"\n      output_prefix = \"lib\"\n      description = \"link {{output}}\"\n    }\n\n    tool(\"solink\") {\n      soname = \"{{target_output_name}}{{output_extension}}\"\n\n      rpath = \"-Wl,-soname,$soname\"\n      if (is_mac || is_ios) {\n        rpath = \"-Wl,-install_name,@rpath/$soname\"\n      }\n\n      rspfile = \"{{output}}.rsp\"\n      rspfile_content = \"{{inputs}}\"\n\n      # --start-group/--end-group let us link multiple .a {{inputs}}\n      # without worrying about their relative order on the link line.\n      #\n      # This is mostly important for traditional linkers like GNU ld and Gold.\n      # The Mac/iOS linker neither needs nor accepts these flags.\n      # LLD doesn't need these flags, but accepts and ignores them.\n      _start_group = \"-Wl,--start-group\"\n      _end_group = \"-Wl,--end-group\"\n      if (is_mac || is_ios) {\n        _start_group = \"\"\n        _end_group = \"\"\n      }\n\n      command = \"$link -shared {{ldflags}} $_start_group @$rspfile {{frameworks}} {{solibs}} $_end_group {{libs}} $rpath -o {{output}}\"\n      outputs = [ \"{{root_out_dir}}/$soname\" ]\n      output_prefix = \"lib\"\n      default_output_extension = \".so\"\n      description = \"link {{output}}\"\n    }\n\n    tool(\"link\") {\n      exe_name = \"{{root_out_dir}}/{{target_output_name}}{{output_extension}}\"\n      rspfile = \"$exe_name.rsp\"\n      rspfile_content = \"{{inputs}}\"\n\n\n\n      command = \"$link {{ldflags}} @$rspfile {{frameworks}} {{solibs}} {{libs}} -o $exe_name\"\n\n      outputs = [ \"$exe_name\" ]\n      description = \"link {{output}}\"\n    }\n\n    stamp = \"touch\"\n\n    tool(\"stamp\") {\n      command = \"$stamp {{output}}\"\n      description = \"stamp {{output}}\"\n    }\n\n    tool(\"copy\") {\n      cp_py = rebase_path(\"../cp.py\")\n      command = \"python \\\"$cp_py\\\" {{source}} {{output}}\"\n      description = \"copy {{source}} {{output}}\"\n    }\n\n    tool(\"copy_bundle_data\") {\n      cp_py = rebase_path(\"../cp.py\")\n      command = \"python \\\"$cp_py\\\" {{source}} {{output}}\"\n      description = \"copy_bundle_data {{source}} {{output}}\"\n    }\n\n    # We don't currently have any xcasset files so make this a NOP\n    tool(\"compile_xcassets\") {\n      command = \"true\"\n      description = \"compile_xcassets {{output}}\"\n    }\n\n    toolchain_args = {\n      current_cpu = invoker.cpu\n      current_os = invoker.os\n    }\n  }\n}\n\ngcc_like_toolchain(\"gcc_like\") {\n\n  ar = \"ar\"\n  cc = \"cc\"\n  cxx = \"c++\"\n  target_ar = ar\n  target_cc = cc\n  target_cxx = cxx\n  target_link = target_cxx\n  cpu = current_cpu\n  os = current_os\n  ar = target_ar\n  cc = target_cc\n  cxx = target_cxx\n  link = target_link\n}\n</code></pre> \u5373\u4e00\u822c\u91c7\u7528template\u6765\u590d\u7528toolchain\u7684\u914d\u7f6e\uff0c\u4ece\u800c\u53ef\u4ee5\u51cf\u5c11\u7ef4\u62a4\u4e0d\u540c\u5e73\u53f0\u3001\u914d\u7f6e\u4e0b\u7684\u6784\u5efa\u5de5\u5177\u94fe\u7684\u914d\u7f6e\u6210\u672c\u3002\u4e0a\u9762\u662f\u4e00\u4e2a\u5e76\u4e0d\u5b8c\u7f8e\u7684\u914d\u7f6e\u3002\u62f7\u8d1d\u65f6\u8bf7\u614e\u91cd\u3002\u51c6\u5907\u5c31\u7eea\u540e\uff0c\u53ea\u9700\u8981<code>gn gen</code>\uff0c\u5373\u53ef\u5f97\u5230<code>ninja</code>\u7684\u6784\u5efa\u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528<code>ninja</code>\u6765\u6784\u5efa\u76ee\u6807\u5373\u53ef\u3002</p>"},{"location":"CXX/makefile%20cmake%20gn%20ninja/#_6","title":"\u9605\u8bfb\u66f4\u591a","text":"<ul> <li>makefile tutorial</li> <li>cmake tutorial</li> <li>cmake index</li> </ul>"},{"location":"Gradle/gradle%20plugin/","title":"Gradle plugin","text":""},{"location":"Gradle/gradle%20plugin/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>\u4f7f\u7528\u4e86AGP TransformAPI\u7684gradle plugin\uff0c\u4ee3\u7801\u8d28\u91cf\u8f83\u597d\uff0c\u4f7f\u7528\u4e86JavaAssist\uff0ckotlin\u5199\u7684\uff0c\u5305\u542b\u4e86\u6d4b\u8bd5\u3002</li> <li>JavaAssist github</li> <li>JavaAssist Tutorial</li> </ul>"},{"location":"Java/JVM%20TI/","title":"JVM TI","text":"<p>Jvm Tooling interface\u53ef\u80fd\u662fJvm\u5e94\u7528\u6027\u80fd\u5173\u6ce8\u7684\u7a76\u6781\u3001\u7ec8\u6781\u89e3\u51b3\u65b9\u6848\u3002\u5229\u7528\u8d77\u5b83\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u5bf9Jvm\u7684\u6027\u80fd\u95ee\u9898\u4e0d\u518d\u72b9\u8c6b\u3002</p> <p>\u76f8\u89c1\u6068\u665a\uff0c\u53ef\u60dc\u67d0\u6b21\u9762\u8bd5\u65f6\u786c\u662f\u6ca1\u60f3\u8d77\u6765\u8fd9\u4e2a\u7a76\u6781\u6cd5\u5b9d\u3002\u8bf7\u628a\u5b83\u4f5c\u4e3aJvm\u6027\u80fd\u65b9\u9762\u7684\u7a76\u6781\u6cd5\u5b9d\u3002</p>"},{"location":"Java/JVM%20TI/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>\u4e00\u7bc7\u7b80\u4e66\u7684\u6587\u7ae0</li> <li>JVM TI oracle</li> </ul>"},{"location":"Java/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/","title":"JVM\u5185\u5b58\u6a21\u578b","text":"<p>\u4e00\u822c\u800c\u8a00\u4f1a\u5212\u5206\u5982\u4e0b\u51e0\u7c7b\uff1a</p> <ul> <li>\u5806</li> <li>\u65b9\u6cd5\u533a\uff08\u7b97\u5806\u7684\u4e00\u90e8\u5206\uff0c\u4f46\u662f\u5b58\u7684\u662f\u9759\u6001\u7684\u8d44\u6e90\uff0c\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\uff09</li> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08\u7ebf\u7a0b\u79c1\u6709\uff09</li> <li>\u6808\uff08\u7ebf\u7a0b\u79c1\u6709\uff09</li> <li>\u672c\u5730\u65b9\u6cd5\u6808\uff08\u7ebf\u7a0b\u79c1\u6709\uff09</li> </ul> <p>\u5982\u4e0b\u662f\u66f4\u8be6\u7ec6\u7684\u5bf9\u7167\u56fe\u793a</p> <p></p> <p>Jvm\u7684\u5404\u533a\u540d\u79f0\u548c\u5bf9\u5e94\u7684\u5185\u5b58</p> <p></p>"},{"location":"Java/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/#_1","title":"\u6808\u5e27\u3001\u65b9\u6cd5\u8c03\u7528","text":"<p>\u5728\u6808\u4e0a\uff0c\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u8c03\u7528\u90fd\u4f1a\u4f34\u968f\u7740\u6808\u5e27\u7684\u4ea7\u751f\u3002\u5173\u4e8eaload, astore, invokevirtual\u7b49\u6307\u4ee4\u5177\u4f53\u542b\u4e49\uff0c\u53ef\u4ee5\u53c2\u8003JVM specification\u4e0a\u5173\u4e8einstruction\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"Java/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/#_2","title":"\u5bf9\u8c61\u5934","text":""},{"location":"Java/Jar/","title":"Jar","text":"<p>JAR \u6587\u4ef6\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a zip \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u53ef\u9009\u7684 META-INF \u76ee\u5f55\u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cJAR \u6587\u4ef6\u662f Java \u7c7b\u6587\u4ef6\u548c/\u6216\u8d44\u6e90\u7684\u7b80\u5355\u5b58\u6863\uff0c\u5b83\u4eec\u7528\u4f5c\u5e94\u7528\u7a0b\u5e8f\u548c\u6269\u5c55\u7684\u6784\u5efa\u5757\uff0cMETA-INF \u76ee\u5f55\uff08\u5982\u679c\u5b58\u5728\uff09\u7528\u4e8e\u5b58\u50a8\u5305\u548c\u6269\u5c55\u914d\u7f6e\u6570\u636e\uff0c\u5305\u62ec\u5b89\u5168\u6027\u3001\u7248\u672c\u63a7\u5236\u3001\u6269\u5c55\u548c\u670d\u52a1\u3002</p>"},{"location":"Java/Jar/#_1","title":"\u6784\u5efa","text":"<p>JAR \u6587\u4ef6\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884cjar\u5de5\u5177\u521b\u5efa\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 Java \u5e73\u53f0\u4e2d\u7684  java.util.jar API \u521b\u5efa\u3002</p>"},{"location":"Java/Jar/#_2","title":"\u6e05\u5355\u6587\u4ef6","text":"<ul> <li>META-INF/MANIFEST.MF</li> </ul> <p>\u4e3b\u8981\u7531\u201c\u4e3b\u5c5e\u6027\u201d\u90e8\u5206\u548c\u201c\u6761\u76ee\u5c5e\u6027\u201d\u90e8\u5206\u3002\u5404\u90e8\u5206\u7531\u7a7a\u884c\u5206\u9694\u3002\u5173\u4e8e\u4e3b\u5c5e\u6027\u7684\u4ecb\u7ecd\u53c2\u89c1\u62d3\u5c55\u9605\u8bfb\u3002</p>"},{"location":"Java/Jar/#_3","title":"\u7b7e\u540d","text":"<ul> <li>META-INF/MANIFEST.MF</li> <li>META-INF/*.SF</li> <li>META-INF/*.DSA</li> <li>META-INF/*.RSA</li> <li>META-INF/SIG-*</li> </ul> <p>\u53ef\u4ee5\u4f7f\u7528jdk\u9644\u5e26\u7684jarsigner\u6765\u7ed3\u5408\u6307\u5b9akeystore\u7b7e\u540d\uff0c\u800ckeystore\u5219\u53ef\u4ee5\u4f7f\u7528jdk\u9644\u5e26\u7684keystore\u5de5\u5177\u6765\u751f\u6210jks\u683c\u5f0f\u7684keystore\u6587\u4ef6\u3002</p> <p>\u8fd9\u91cc\u4e3b\u8981\u4ecb\u7ecd.SF\u548c.RSA\u7684\u4f5c\u7528\u3002\u5148\u770b\u4e00\u4efd\u6837\u4f8b\uff1a</p> <pre><code># MANIFEST.MF\n\nManifest-Version: 1.0\nCreated-By: 1.8.0_302 (Temurin)\n\nName: pkg/Hello.class\nSHA-256-Digest: +XXeGO7G7/2tQpgeNLtkHTwRHK9zIZ03uQi5NDYw7Gw=\n</code></pre> <pre><code># ANDROID.SF\n\nSignature-Version: 1.0\nSHA-256-Digest-Manifest-Main-Attributes: SSbKFlknndiEVdAPV1pvgPnoo+P/I\n pmGp6WsJEAIiGY=\nSHA-256-Digest-Manifest: qKW1LZ+EenVhjLC7IjLc1gmaiTi7D1bSeqWkUdMJelc=\nCreated-By: 1.8.0_302 (Temurin)\n\nName: pkg/Hello.class\nSHA-256-Digest: dg9A2AXOkh4Ta3mEkylcsnFi+pCduFJbfN6bJbZBFIc=\n</code></pre> <p>\u8fd9\u91cc\u7b80\u8ff0\u4e00\u4e0b\u5c5e\u6027\u542b\u4e49\uff1a</p> <ul> <li>{x}-Digest-Manifest-Main-Attributes: \u5bf9\u6e05\u5355\u6587\u4ef6\u4e3b\u5c5e\u6027\u90e8\u5206\u6458\u8981</li> <li>{x}-Digest-Manifest: \u5bf9\u6e05\u5355\u6587\u4ef6\u6574\u4f53\u7684\u6458\u8981</li> <li>{x}-Digest: \u5bf9\u67d0\u5b9e\u4f53\u6587\u4ef6\u7684\u6458\u8981\uff08\u6b64\u6587\u4ef6\u5fc5\u987b\u5728\u6e05\u5355\u6587\u4ef6\u4e2d\u5305\u542b\uff09</li> <li>x: \u6458\u8981\u7b97\u6cd5\u6807\u51c6\u540d\u79f0</li> </ul> <p>\u518d\u7b80\u8ff0\u4e00\u4e0b\u9a8c\u8bc1\u8fc7\u7a0b\uff1a</p> <ul> <li>\u9996\u5148\u5bf9\u6e05\u5355\u6587\u4ef6\u7684\u6458\u8981\u8fdb\u884c\u9a8c\u8bc1\u3002\u5373\u4f7f\u7528\u6458\u8981\u7b97\u6cd5\u5bf9\u6e05\u5355\u6587\u4ef6\u8fdb\u884c\u6458\u8981\u3001\u4e3b\u5c5e\u6027\u8fdb\u884c\u6458\u8981\uff0c\u6bd4\u5bf9\u662f\u5426\u548c*.SF\u7684\u5bf9\u5e94\u5c5e\u6027\u5339\u914d\u3002</li> <li>\u5176\u6b21\u5bf9\u6e05\u5355\u6587\u4ef6\u91cc\u7684\u6587\u4ef6\u5b9e\u4f53\u8fdb\u884c\u6458\u8981\uff0c\u68c0\u67e5\u662f\u5426\u548c\u6e05\u5355\u6587\u4ef6\u7684\u5bf9\u5e94\u6458\u8981\u5339\u914d\uff0c\u800c*.SF\u7684\u8be5\u6587\u4ef6\u6761\u76ee\u6458\u8981\u662f\u6307\u6e05\u5355\u6587\u4ef6\u91cc\u8be5\u5b9e\u4f53\u6761\u76ee\u7684\u6458\u8981\u3002</li> </ul> <p>.RSA\u662f .SF\u6587\u4ef6\u7684\u6570\u5b57\u7b7e\u540d\u7248\u672c\uff0c\u5373\u9700\u8981\u4f7f\u7528\u516c\u94a5\u89e3\u5bc6\u540e\uff0c\u5bf9\u6bd4\u5176\u5185\u5bb9\u662f\u5426\u548c\u5b9e\u9645\u7684 *.SF\u4e00\u81f4\u3002</p>"},{"location":"Java/Jar/#_4","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>oracle docs</li> <li>others</li> </ul>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/","title":"Java\u5e76\u53d1","text":""},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#volatile","title":"volatile","text":"<p>\u5b83\u4f5c\u4e3a\u5173\u952e\u5b57\u7528\u4e8e\u4fee\u9970\u5b57\u6bb5\u3002</p> <ol> <li>\u7981\u6b62\u6307\u4ee4\u91cd\u6392</li> <li>\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u5373\u4f7f\u8be5\u53d8\u91cfcpu\u7f13\u5b58\u65e0\u6548\u3002</li> <li>\u540e\u6765\u53d1\u73b0\u5e94\u8be5\u518d\u589e\u52a0\u4e00\u70b9\uff0cvolatile\u8fd8\u4fdd\u8bc1\u4e86double, long\u5199\u5165\u65f6\u7684\u539f\u5b50\u6027\u3002\u5426\u5219double, long\u53ef\u80fd\u4f1a\u51fa\u73b0\u201c\u5b57\u65ad\u88c2\u201d\u7684\u60c5\u51b5\u3002\u56e0\u4e3a64\u4f4d\u9700\u8981\u5206\u4e24\u6b21\u5199\u5165\uff0c\u800c\u8fd9\u4e24\u6b21\u5199\u5165\u5bf9\u67d0\u4e9b\u5e73\u53f0\u4e0d\u662f\u539f\u5b50\u6027\u7684\u3002</li> </ol> <p>\u4ec5\u9002\u7528\u4e8e\u591a\u7ebf\u7a0b\u8bfb\uff0c\u56fa\u5b9a\u552f\u4e00\u7ebf\u7a0b\u5199\u7684\u573a\u666f\u3002</p> <p>\u5bf9CPU\u7981\u6b62\u7f13\u5b58\u3001\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u7684\u7b80\u5355\u56fe\u793a\u3002</p> <p></p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#synchronized","title":"synchronized","text":"<p>\u5b83\u4f5c\u4e3a\u5173\u952e\u5b57\u4fee\u9970\u9759\u6001\u65b9\u6cd5\u3001\u65b9\u6cd5\uff0c\u6216\u8005\u4fee\u9970\u5bf9\u8c61\u6765\u521b\u5efa\u540c\u6b65\u4ee3\u7801\u5757\u3002synchronized\u540c\u6b65\u4ee3\u7801\u5757\u662f\u901a\u8fc7\u52a0\u5165\u5b57\u8282\u7801<code>monitorenter</code>\u548c<code>monitorexit</code>\u6307\u4ee4\u6765\u5b9e\u73b0monitor\u7684\u83b7\u53d6\u548c\u91ca\u653e\uff0c\u4e5f\u5c31\u662f\u9700\u8981JVM\u901a\u8fc7\u5b57\u8282\u7801\u663e\u5f0f\u7684\u53bb\u83b7\u53d6\u548c\u91ca\u653emonitor\u5b9e\u73b0\u540c\u6b65\uff0c\u800csynchronized\u4fee\u9970\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u662f\u68c0\u67e5\u65b9\u6cd5\u7684<code>ACC_SYNCHRONIZED</code>\u6807\u5fd7\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86\u5219\u7ebf\u7a0b\u9700\u8981\u5148\u53bb\u83b7\u53d6monitor\uff0c\u6267\u884c\u5b8c\u6bd5\u4e86\u7ebf\u7a0b\u518d\u91ca\u653emonitor\u3002</p> <p>synchronized \u7684\u4f18\u5316\uff08\u65e0\u9501\u3001\u504f\u5411\u9501\u3001\u8f7b\u91cf\u9501\u3001\u91cd\u91cf\u9501\uff09\u4ee5\u53caJVM\u4e0a\u7684\u5b9e\u73b0\u539f\u7406\uff08\u5bf9\u8c61\u5934\uff09\uff0c\u8be6\u7ec6\u8bf4\u660e\u89c1OpenJDK wiki</p> <p></p> <p>\u66f4\u591a\u8bf4\u660e\u89c1link\uff0c\u4e2a\u4eba\u5bf9JVM\u5982\u4f55\u5b9e\u73b0\u6b64\u5173\u952e\u5b57\u5177\u4f53\u7ec6\u8282\u4e0d\u662f\u5f88\u5927\u3002\u53ea\u9700\u8981\u5927\u81f4\u4e86\u89e3\u8fd9\u51e0\u4e2a\u9501\u7b49\u7ea7\u542b\u4e49\u5206\u522b\u662f\uff1a</p> <ul> <li>\u504f\u5411\u9501\uff0c\u7c7b\u4f3c\u8bb0\u5f55\u4e00\u4e0b\uff0c\u5982\u679c\u6574\u4f53\u671f\u95f4\u5c31\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\uff0c\u5219\u4e0d\u9700\u8981\u4efb\u4f55\u9501\u5347\u7ea7\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5373\u9501\u503e\u5411\u4e8e\u5f53\u524d\u7ebf\u7a0b\u3002</li> <li>\u8f7b\u91cf\u7ea7\u9501\uff0c\u5373\u81ea\u65cb\u9501</li> <li>\u91cd\u91cf\u7ea7\u9501\uff0c\u9760mutex</li> </ul>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#wait-notify-notifyall","title":"wait notify notifyAll","text":"<p>\u4e00\u5b9a\u8981\u5148\u6301\u6709\u8fd9\u4e2a\u5bf9\u8c61\u7684\u9501\uff0c\u7136\u540e\u624d\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e9b\u65b9\u6cd5\u3002\u4e5f\u5c31\u662f\u4e00\u5b9a\u8981\u5728<code>synchronized</code>\u6b64\u5bf9\u8c61\u4e2d\u8c03\u7528\u3002\u5e76\u4e14\u9700\u8981\u7b49notify\u7684\u7ebf\u7a0b\u9000\u51fa\u81ea\u5df1\u7684<code>synchronized</code>\u5757\u3002</p> <p><code>wait</code>\u4f1a\u91ca\u653e\u6389<code>synchronized</code>\u6301\u6709\u7684\u9501\u3002<code>synchronized</code>\u662f\u53ef\u4ee5\u91cd\u5165\u7684\u3002</p> <p><code>notifyAll</code>\u548c<code>notify</code>\u533a\u522b\u5728\u4e8e\uff0c\u524d\u8005\u4f1a\u5524\u9192\u6240\u6709\u5bf9\u8be5\u5bf9\u8c61\u8c03\u7528<code>wait</code>\u7684\u7ebf\u7a0b\uff08\u5f53\u7136\u7ebf\u7a0b\u4eec\u8fd8\u662f\u9700\u8981\u4e00\u4e2a\u4e00\u4e2a\u6062\u590d\u6267\u884c\uff09\uff0c\u4f46\u662f\u6700\u7ec8\u90fd\u4f1a\u88ab\u6062\u590d\u3002\u800c\u540e\u8005\u4ec5\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b\u6062\u590d\u6267\u884c\u3002\u5bf9\u4e8e\u4e92\u65a5\u64cd\u4f5c\u60c5\u51b5\u4e0b\u4e00\u822c\u4f7f\u7528\u540e\u8005<code>notify</code>\uff0c\u5bf9\u4e8e\u53ef\u4ee5\u5171\u4eab\u64cd\u4f5c\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u524d\u8005<code>notifyAll</code>\uff08\u66f4\u591a\u8bf4\u660e\uff09\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#thread","title":"thread","text":""},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#join","title":"join","text":"<p>Thread\u5185\u90e8\u6709\u4e00\u4e2aobject\u4f5c\u4e3alock\uff0c\u5728\u7ebf\u7a0b\u7ed3\u675f\u65f6\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528<code>lock.notifyAll()</code>\uff0c\u6765\u5524\u9192\u6240\u6709<code>lock.wait</code>\u963b\u585e\u7684\u7ebf\u7a0b\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#threadlocal","title":"ThreadLocal","text":"<ul> <li>thead{threadLocalMap}</li> <li>ThreadLocalMap(ThreadLocal -&gt; Object)</li> <li>looper(sLooper(mainLooper), sThreadLocal = ThreadLocal()(\u7528\u4e8emyLooper\u7684\u8fd4\u56de\uff08\u5373\u5f53\u524d\u7ebf\u7a0b\u7684looper\uff09-&gt;sThreadLocal.get()-&gt; Thread.threadLocalMap.get(sThreadLocal)-&gt;object)</li> </ul>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#cas","title":"\u539f\u5b50\u5e93\u3001CAS","text":"<p>Atomic\u539f\u5b50\u5e93\u4e3b\u8981\u4f7f\u7528Unsafe\u5305\u7684cas\u64cd\u4f5c\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#reentrantlock-reentrantreadwritelock-countdownlatch","title":"ReentrantLock ReentrantReadWriteLock CountDownLatch","text":"<p>\u90fd\u662f\u57fa\u4e8eAQS\u3002AQS\u662f\u901a\u8fc7int\u6765\u7ef4\u62a4\u72b6\u6001\u7684\u540c\u6b65\u5668\u57fa\u7c7b\uff0c\u652f\u6301\u4e24\u79cd\u65b9\u5f0f\u5de5\u4f5c\uff08\u4f46\u4e00\u822c\u53ea\u9009\u62e9\u4e00\u79cd\uff0c\u72ec\u5360\u6a21\u5f0f\u3001\u5171\u4eab\u6a21\u5f0f\uff09\uff0c\u72ec\u5360\u6a21\u5f0f\u662fstate=0\u8868\u793a\u7a7a\u95f2\uff0c\u5360\u6709\u7684\u65f6\u5019\u4e00\u822c\u4f1a+1\uff0c\u5171\u4eab\u6a21\u5f0f\u662fstate&gt;0\u8868\u793a\u7a7a\u95f2\uff0c\u5360\u6709\u7684\u65f6\u5019\u901a\u8fc7-acquire\u3002AQS\u7684\u5b50\u7c7b\u9700\u8981\u9009\u62e9\u6027\u590d\u5199<code>tryAcquire</code>, <code>tryAcquireShared</code>, <code>tryRelease</code>, <code>tryReleaseShared</code>\u7b49\u65b9\u6cd5\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u7740\u4e0a\u8ff0\u4e24\u79cd\u6a21\u5f0f\u3002\u53ef\u4ee5\u6839\u636e\u9700\u8981\u9009\u62e9\u4e00\u79cd\u6a21\u5f0f\u7684\u76f8\u5173\u65b9\u6cd5\u590d\u5199\u3002</p> <p><code>ReentrantLock</code>, <code>ReentrantReadWriteLock</code>\u90fd\u5305\u542b\u4e86\u516c\u5e73\u3001\u975e\u516c\u5e73\u7684\u5b9e\u73b0\u3002\u540e\u8005\u548c\u524d\u8005\u76f8\u6bd4\uff0c\u7ec6\u5206\u4e86<code>read, write</code>\u4e24\u79cd\u60c5\u51b5\u3002\u8bfb-\u8bfb\u53ef\u5171\u5b58\uff0c\u5176\u4ed6\u60c5\u51b5\u5747\u9700\u8981\u7ade\u4e89\u3001\u7b49\u5f85\u3002</p> <p>\u516c\u5e73\u548c\u975e\u516c\u5e73\u662f\u6307\uff0c\u8be5\u6240\u7684\u7b49\u5f85\u8005\u662f\u6839\u636e\u7b49\u5f85\u7684\u987a\u5e8f\u4f9d\u6b21\u5524\u9192\uff0c\u8fd8\u662f\u76f4\u63a5\u7ade\u4e89\uff0c\u968f\u673a\u5524\u9192\u3002\u5b83\u4eec\u7684\u5b9e\u73b0\u5dee\u5f02\u4e3b\u8981\u5728\u4e8e\uff1a</p> <ul> <li>\u975e\u516c\u5e73\uff0c\u5728<code>tryAcquire</code>\u7684\u65f6\u5019\uff0c\u68c0\u67e5state\u7a7a\u95f2\uff0c\u5c31\u4f1aacquire(\u5373compareAndSetState)\u3002</li> <li>\u516c\u5e73\uff0c\u5728<code>tryAcquire</code>\u7684\u65f6\u5019\uff0c\u68c0\u67e5state\u7a7a\u95f2\uff0c\u5982\u679c\u81ea\u5df1\u7684\u7ebf\u7a0b\u4e0d\u662f\u5728\u7b49\u5f85\u961f\u5217\u7684head\u7684\u8bdd\uff0c\u4f1a\u8fd4\u56defalse\u3002\u5982\u679c\u7b49\u5f85\u961f\u5217\u4e3a\u7a7a\u7684\u8bdd\uff0c\u5219\u4e5f\u4f1a\u5c1d\u8bd5acquire\u3002\u6216\u8005\u81ea\u5df1\u5df2\u7ecf\u662f\u5360\u6709\u7ebf\u7a0b\u4e86\u76f4\u63a5acquire\u3002</li> </ul>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#_1","title":"\u7ebf\u7a0b\u6c60","text":"<p><code>ThreadPoolExecutor</code>\u4f7f\u7528\u4e86<code>ArrayBlockingQueue</code>\u4f5c\u4e3a\u4efb\u52a1\u961f\u5217\uff0c\u5b83\u652f\u6301\u963b\u585e\u3001\u8d85\u65f6\u3001\u7acb\u5373\u8fd4\u56de\u7b49\u5f62\u5f0f\u7684\u8bfb\u5199\uff0c\u5e76\u591a\u7ebf\u7a0b\u5b89\u5168\uff0c\u8be6\u89c1\u201cJava\u201dsection\u3002 <code>ScheduledThreadPoolExecutor</code>\u7ee7\u627f\u4e86<code>ThreadPoolExecutor</code>\uff0c\u4f46\u4f7f\u7528\u4e86<code>DelayedWorkQueue</code>\u4f5c\u4e3a\u4efb\u52a1\u961f\u5217\uff0c\u5b83\u662f\u4e13\u95e8\u7684\u4e00\u4e2a\u5b9e\u73b0\uff0c\u5e76\u4e0d\u901a\u7528\uff0c\u5982\u4f60\u6240\u60f3\uff0c\u5b83\u5728\u5165\u5217\u65f6\u4f1a\u63d0\u4f9b\u6839\u636e<code>delay</code>\u5927\u5c0f\u6392\u5e8f\uff0c\u4f3c\u4e4e\u662f\u5806\u6392\u5e8f\u3002\u6b64\u5916\u5728\u51fa\u5217\u65f6\uff0c\u83b7\u53d6\u5934\u5143\u7d20\u540e\uff0c\u82e5\u53d1\u73b0\u4f9d\u7136\u6709<code>delay</code>\u5219\u4e0d\u8fd4\u56de\u5143\u7d20\u3002\u5373\u5b83\u51fa\u5217\u7684\u524d\u63d0\u662f\u8be5\u5143\u7d20\u5df2\u7ecf\u6ca1\u6709<code>delay</code>\u4e86\u3002\u5176<code>delay</code>\u8ba1\u7b97\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>        public long getDelay(TimeUnit unit) {\n            return unit.convert(this.time - System.nanoTime(), TimeUnit.NANOSECONDS);\n        }\n</code></pre> <code>DelayedWorkQueue</code>\u51fa\u5217\u903b\u8f91\u5982\u4e0b\uff1a <pre><code>  public RunnableScheduledFuture&lt;?&gt; take() throws InterruptedException {\n      final ReentrantLock lock = this.lock;\n      lock.lockInterruptibly();\n      try {\n          for (;;) {\n              RunnableScheduledFuture&lt;?&gt; first = queue[0];\n              if (first == null)\n                  available.await(); \n              else {\n                  long delay = first.getDelay(NANOSECONDS);\n                  if (delay &lt;= 0L)  // \u5373\u82e5delay\u8fc7\u671f\uff0c\u5219\u53d6\u51fa\u3002\n                      return finishPoll(first);\n                  first = null; // don't retain ref while waiting\n                  if (leader != null)\n                      available.await();\n                  else {\n                      Thread thisThread = Thread.currentThread();\n                      leader = thisThread;\n                          available.awaitNanos(delay);\n                  }\n              }\n          }\n      }\n  }\n</code></pre></p> <p>\u7ebf\u7a0b\u6c60\u76d1\u63a7\u95ee\u9898</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#_2","title":"\u7ebf\u7a0b\u5b89\u5168\u96c6\u5408","text":"<p>\u53c2\u89c1\u201cJava\u201dsection\u96c6\u5408\u76f8\u5173\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#aqs-lock-condition","title":"AQS Lock Condition","text":""},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#condition","title":"Condition","text":"<p>\u6ce8\u91ca\u7ed9\u7684\u8bb2\u89e3\u5f88\u8be6\u7ec6\uff0c\u5148\u9605\u8bfb\u4e00\u4e0b\uff1a</p> <p>Condition\u5c06Object\u76d1\u89c6\u5668\u65b9\u6cd5\uff08 wait \u3001 notify\u548cnotifyAll \uff09\u5206\u89e3\u4e3a\u4e0d\u540c\u7684\u5bf9\u8c61\uff0c\u901a\u8fc7\u5c06\u5b83\u4eec\u4e0e\u4efb\u610fLock\u5b9e\u73b0\u7684\u4f7f\u7528\u76f8\u7ed3\u5408\uff0c\u4ea7\u751f\u6bcf\u4e2a\u5bf9\u8c61\u5177\u6709\u591a\u4e2a\u7b49\u5f85\u96c6\u7684\u6548\u679c\u3002 Lock\u4ee3\u66ff\u4e86synchronized\u65b9\u6cd5\u548c\u8bed\u53e5\u7684\u4f7f\u7528\uff0c\u800cCondition\u4ee3\u66ff\u4e86\u5bf9\u8c61\u76d1\u89c6\u5668\u65b9\u6cd5\u7684\u4f7f\u7528\u3002 \u6761\u4ef6\uff08\u4e5f\u79f0\u4e3a\u6761\u4ef6\u961f\u5217\u6216\u6761\u4ef6\u53d8\u91cf\uff09\u4e3a\u4e00\u4e2a\u7ebf\u7a0b\u63d0\u4f9b\u4e86\u4e00\u79cd\u6302\u8d77\u6267\u884c\uff08\u201c\u7b49\u5f85\u201d\uff09\u7684\u65b9\u6cd5\uff0c\u76f4\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u901a\u77e5\u67d0\u4e2a\u72b6\u6001\u6761\u4ef6\u73b0\u5728\u53ef\u80fd\u4e3a\u771f\u3002 \u56e0\u4e3a\u5bf9\u8fd9\u4e2a\u5171\u4eab\u72b6\u6001\u4fe1\u606f\u7684\u8bbf\u95ee\u53d1\u751f\u5728\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e2d\uff0c\u5b83\u5fc5\u987b\u53d7\u5230\u4fdd\u62a4\uff0c\u6240\u4ee5\u67d0\u79cd\u5f62\u5f0f\u7684\u9501\u4e0e\u6761\u4ef6\u76f8\u5173\u8054\u3002 \u7b49\u5f85\u6761\u4ef6\u63d0\u4f9b\u7684\u5173\u952e\u5c5e\u6027\u662f\u5b83\u4ee5\u539f\u5b50\u65b9\u5f0f\u91ca\u653e\u5173\u8054\u7684\u9501\u5e76\u6302\u8d77\u5f53\u524d\u7ebf\u7a0b\uff0c\u5c31\u50cfObject.wait\u4e00\u6837\u3002 Condition\u5b9e\u4f8b\u672c\u8d28\u4e0a\u7ed1\u5b9a\u5230\u9501\u3002 \u8981\u83b7\u53d6\u7279\u5b9aLock\u5b9e\u4f8b\u7684Condition\u5b9e\u4f8b\uff0c\u8bf7\u4f7f\u7528\u5176newCondition()\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u652f\u6301put\u548ctake\u65b9\u6cd5\u7684\u6709\u754c\u7f13\u51b2\u533a\u3002 \u5982\u679ctake\u5c1d\u8bd5\u5bf9\u4e00\u4e2a\u7a7a\u7684\u7f13\u51b2\u5668\uff0c\u5219\u8be5\u7ebf\u7a0b\u5c06\u963b\u585e\uff0c\u76f4\u5230\u4e00\u4e2a\u9879\u76ee\u53d8\u4e3a\u53ef\u7528; \u5982\u679cput\u8bd5\u56fe\u5728\u4e00\u4e2a\u5b8c\u6574\u7684\u7f13\u51b2\u533a\uff0c\u90a3\u4e48\u7ebf\u7a0b\u5c06\u963b\u585e\uff0c\u76f4\u5230\u7a7a\u95f4\u53d8\u5f97\u53ef\u7528\u3002 \u6211\u4eec\u613f\u7ee7\u7eed\u7b49\u5f85put\u7ebf\uff0c\u5e76take\u7ebf\u7a0b\u72ec\u7acb\u7684\u7b49\u5f85\u96c6\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u7684\u53ea\u6709\u5728\u5f53\u9879\u76ee\u6216\u7a7a\u95f4\u7684\u7f13\u51b2\u533a\u53d8\u5f97\u53ef\u7528\u65f6\u901a\u77e5\u5355\u4e2a\u7ebf\u7a0b\u7684\u4f18\u5316\u3002 \u8fd9\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2aCondition\u5b9e\u4f8b\u6765\u5b9e\u73b0\u3002    class BoundedBuffer {      final Lock lock = new ReentrantLock();      final Condition notFull  = lock.newCondition();       final Condition notEmpty = lock.newCondition(); </p> <pre><code> final Object[] items = new Object[100];\n int putptr, takeptr, count;\n\n public void put(Object x) throws InterruptedException {\n   lock.lock();\n   try {\n     while (count == items.length)\n       notFull.await();\n     items[putptr] = x;\n     if (++putptr == items.length) putptr = 0;\n     ++count;\n     notEmpty.signal();\n   } finally {\n     lock.unlock();\n   }\n }\n\n public Object take() throws InterruptedException {\n   lock.lock();\n   try {\n     while (count == 0)\n       notEmpty.await();\n     Object x = items[takeptr];\n     if (++takeptr == items.length) takeptr = 0;\n     --count;\n     notFull.signal();\n     return x;\n   } finally {\n     lock.unlock();\n   }\n }\n</code></pre> <p>}</p> <p>\uff08 java.util.concurrent.ArrayBlockingQueue\u7c7b\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u529f\u80fd\uff0c\u6240\u4ee5\u6ca1\u6709\u7406\u7531\u5b9e\u73b0\u8fd9\u4e2a\u793a\u4f8b\u4f7f\u7528\u7c7b\u3002\uff09 Condition\u5b9e\u73b0\u53ef\u4ee5\u63d0\u4f9b\u4e0eObject\u76d1\u89c6\u5668\u65b9\u6cd5\u4e0d\u540c\u7684\u884c\u4e3a\u548c\u8bed\u4e49\uff0c\u4f8b\u5982\u4fdd\u8bc1\u901a\u77e5\u7684\u987a\u5e8f\uff0c\u6216\u8005\u5728\u6267\u884c\u901a\u77e5\u65f6\u4e0d\u9700\u8981\u6301\u6709\u9501\u3002 \u5982\u679c\u5b9e\u73b0\u63d0\u4f9b\u4e86\u8fd9\u6837\u7684\u4e13\u95e8\u8bed\u4e49\uff0c\u90a3\u4e48\u5b9e\u73b0\u5fc5\u987b\u8bb0\u5f55\u8fd9\u4e9b\u8bed\u4e49\u3002 \u8bf7\u6ce8\u610f\uff0c Condition\u5b9e\u4f8b\u53ea\u662f\u666e\u901a\u5bf9\u8c61\uff0c\u5b83\u4eec\u672c\u8eab\u53ef\u4ee5\u7528\u4f5csynchronized\u8bed\u53e5\u4e2d\u7684\u76ee\u6807\uff0c\u5e76\u4e14\u53ef\u4ee5\u8c03\u7528\u5b83\u4eec\u81ea\u5df1\u7684\u76d1\u89c6\u5668wait\u548cnotify\u65b9\u6cd5\u3002 \u83b7\u53d6Condition\u5b9e\u4f8b\u7684\u76d1\u89c6\u5668\u9501\uff0c\u6216\u4f7f\u7528\u5176\u76d1\u89c6\u5668\u65b9\u6cd5\uff0c\u4e0e\u83b7\u53d6\u4e0e\u8be5Condition\u5173\u8054\u7684Lock\u6216\u5176\u7b49\u5f85\u548c\u4fe1\u53f7\u65b9\u6cd5\u7684\u4f7f\u7528\u6ca1\u6709\u7279\u5b9a\u7684\u5173\u7cfb\u3002 \u5efa\u8bae\u60a8\u4e0d\u8981\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528Condition\u5b9e\u4f8b\u4ee5\u907f\u514d\u6df7\u6dc6\uff0c\u9664\u975e\u5728\u5b83\u4eec\u81ea\u5df1\u7684\u5b9e\u73b0\u4e2d\u3002</p> <p>\u5982\u4e0a\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u7ec4<code>await</code>, <code>await(timeout)</code>, <code>signal</code>, <code>signalAll</code>\u7b49\u63a5\u53e3\u6765\u63d0\u4f9b\u7c7b\u4f3c<code>Object.java</code>\u7684<code>wait</code>, <code>wait(timeout)</code>, <code>notify</code>, <code>notifyAll</code>\u3002\u8fd9\u4e24\u8005\u5dee\u5f02\u5728\u4e8e\uff0ccondition\u9700\u8981\u7ed3\u5408<code>lock</code>\u7c7b\u6765\u7528\uff0c\u800clock\u7c7b\u5f80\u5f80\u76f8\u6bd4<code>synchronized</code>\u5173\u952e\u5b57\u6709\u66f4\u7075\u6d3b\u7684api\uff0c\u6bd4\u5982<code>tryLock</code>\u7b49\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#aqs","title":"AQS","text":"<p>\u5373<code>AbstractQueuedSynchronizer</code>\uff0c\u5b83\u901a\u8fc7\u94fe\u8868\u7ed3\u6784\u7ef4\u62a4\u4e86\u7b49\u5f85\u961f\u5217\uff0c\u5b83\u7684\u5185\u90e8\u7c7b<code>ConditionObject</code>\u662f<code>Condition</code>\u7684\u5b9e\u73b0\uff0c\u800c<code>Condition</code>\u4e5f\u5c31\u53ea\u6709\u8fd9\u4e2a\u5b9e\u73b0\u3002\u6765\u770b\u4e0b\u5b83\u7684<code>await</code>\u5b9e\u73b0\uff1a <pre><code>public final long awaitNanos(long nanosTimeout)\n        throws InterruptedException {\n    Node node = addConditionWaiter();\n    int savedState = fullyRelease(node);\n        if (nanosTimeout &gt; SPIN_FOR_TIMEOUT_THRESHOLD)\n            LockSupport.parkNanos(this, nanosTimeout);\n    }\n}\n</code></pre> \u5728\u6211\u6765\u770b\u4e3b\u8981\u7684\u4ee3\u7801\u7cbe\u7b80\u5982\u4e0a\uff0c\u5373\u6dfb\u52a0\u4e00\u4e2a\u7b49\u5f85\u8282\u70b9\uff08\u4ee5\u4fbf\u5524\u8d77\uff09\uff0c\u4f7f\u7528<code>LockSupport</code>\u6765<code>park</code>\u4e00\u4e2a\u8d85\u65f6\u65f6\u957f\uff0c\u8fd9\u91cc\u4f1a\u8c03\u7528\u5230<code>Unsafe</code>\u5305\u7684<code>park</code>\u6765\u6302\u8d77\u7ebf\u7a0b\u4e00\u6bb5\u65f6\u95f4\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#unsafe","title":"Unsafe","text":"<p>\u8fd9\u4e2a\u7c7b\u5f88\u795e\u79d8\uff0c\u4f46\u53c8\u7ecf\u5e38\u5728\u5e95\u5c42\u7684\u4ee3\u7801\u4e2d\u9047\u5230\u3002\u867d\u7136\u53ebUnsafe\uff0c\u4f46\u662fJdk\u4e0d\u5c11\u90e8\u5206\u529f\u80fd\u4f9d\u7136\u4f9d\u8d56\u4e8e\u6b64\uff0c\u5c24\u5176\u662f\u548c\u5e76\u53d1\u76f8\u5173\u7684\u529f\u80fd\u3002\u8fd9\u4e2a\u7c7b\u7684\u76ee\u7684\u662f\u7531jdk\u6765\u5b9e\u73b0\u5e73\u53f0\u76f8\u5173\u7684\u4e00\u7ec4api\uff0c\u8fd9\u7ec4api\u5f80\u5f80\u5728\u4e0d\u540c\u5e73\u53f0\u4e0a\u6709\u4e0d\u540c\u7684cpu\u6307\u4ee4\u96c6\u7684\u652f\u6301\uff0c\u7531\u6b64\u53ef\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u5e76\u53d1\u539f\u8bed\u652f\u6301\u3002\u6bd4\u5982CAS\u64cd\u4f5c\uff0cpark, unpark\u7b49\u3002\u82e5\u5e73\u53f0\u6ca1\u6709\u7279\u5b9a\u7684\u652f\u6301\u65b9\u5f0f\uff0c\u5219\u53ef\u4ee5\u7528\u666e\u901a\u4ee3\u7801\u515c\u5e95\u5b9e\u73b0\u3002</p>"},{"location":"Java/Java%E5%B9%B6%E5%8F%91/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Java\u5e76\u53d1\u6982\u8ff0</li> </ul>"},{"location":"Java/Jni/","title":"Jni","text":""},{"location":"Java/Jni/#_1","title":"\u65b9\u6cd5\u6ce8\u5165","text":"<p>\u6709\u4e24\u79cd\u6ce8\u5165jni\u7684\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u6b63\u5e38\u58f0\u660e\u8c03\u7528\uff0c\u9700\u8981\u5148<code>System.loadLibrary/load</code>\u3002\u53e6\u4e00\u79cd\u662f\u7528<code>JNIEnv\u7684registerNatives</code>\u65b9\u6cd5\uff0c\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>static JNINativeMethod methods[] = {\n    {\"hashCode\",    \"()I\",                    (void *)&amp;JVM_IHashCode},\n    {\"wait\",        \"(J)V\",                   (void *)&amp;JVM_MonitorWait},\n    {\"notify\",      \"()V\",                    (void *)&amp;JVM_MonitorNotify},\n    {\"notifyAll\",   \"()V\",                    (void *)&amp;JVM_MonitorNotifyAll},\n    {\"clone\",       \"()Ljava/lang/Object;\",   (void *)&amp;JVM_Clone},\n};\n\nJNIEXPORT void JNICALL\nJava_java_lang_Object_registerNatives(JNIEnv *env, jclass cls)\n{\n    (*env)-&gt;RegisterNatives(env, cls,\n                            methods, sizeof(methods)/sizeof(methods[0]));\n}\n</code></pre>"},{"location":"Java/Jni/#_2","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Stackoverflow</li> </ul>"},{"location":"Java/List%20Queue/","title":"List Queue","text":""},{"location":"Java/List%20Queue/#blockingqueue","title":"BlockingQueue","text":"<p>BlockingQueue\u57fa\u4e8eQueue\u63a5\u53e3\uff0c\u4f46\u63d0\u4f9b\u4e86\u7b49\u5f85\u961f\u5217\u64cd\u4f5c\u7684\u529f\u80fd\u3002\u5b83\u7684\u64cd\u4f5c\u65b9\u6cd5\u5bb9\u6613\u6df7\u6dc6\uff0c\u603b\u7ed3\u5982\u4e0b\uff1a</p> <p>\u83b7\u53d6\u961f\u5217\u5934\u90e8</p> <ul> <li>E take() \u4f1a\u51fa\u5217\uff0c\u4f1a\u963b\u585e</li> <li>E poll(long timeout, TimeUnit unit) \u4f1a\u51fa\u5217\uff0c\u8bbe\u7f6e\u7b49\u5f85\u8d85\u65f6</li> <li>E element() \u4e0d\u51fa\u5217\uff0c\u82e5\u65e0\u5143\u7d20\u5219\u5f02\u5e38</li> <li>E peek() \u4e0d\u51fa\u5217\uff0c\u65e0\u5143\u7d20\u8fd4\u56de\u7a7a</li> </ul> <p>\u6dfb\u52a0</p> <ul> <li>boolean add(E)\uff0c\u6210\u529f\u8fd4\u56detrue\uff0c\u5931\u8d25\u629b\u5f02\u5e38</li> <li>boolean offer(E)\uff0c\u6210\u529f\u8fd4\u56detrue\uff0c\u7a7a\u95f4\u4e0d\u591f\u8fd4\u56defalse</li> <li>void put(E) \u963b\u585e\u76f4\u5230\u63d2\u5165</li> <li>void offer(E, long timeout, TimeUnit unit) \u8bbe\u7f6e\u7b49\u5f85\u8d85\u65f6</li> </ul> <p>\u5b83\u6709\u591a\u79cd\u5b9e\u73b0\uff0c\u4e5f\u4f34\u968f\u4e0d\u540c\u7279\u6027\u3002\u5206\u522b\u7b80\u5355\u770b\u4e0b\u3002</p>"},{"location":"Java/List%20Queue/#arrayblockingqueue","title":"ArrayBlockingQueue","text":"<p>\u8fd9\u662f\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u5b9e\u73b0\u3002\u5185\u90e8\u4f7f\u7528<code>ReentrantLock</code>\u4f5c\u4e3a\u9501\uff0c\u4ee5\u53ca\u4e24\u4e2a<code>Condition</code>\u5206\u522b\u662f<code>notEmpty</code>, <code>notFull</code>\u3002\u6765\u770b\u4e00\u4e2a\u963b\u585e\u7684\u5b9e\u73b0\uff1a</p> <p><pre><code>    public E poll(long timeout, TimeUnit unit) throws InterruptedException {\n        lock.lockInterruptibly();\n        try {\n            while (count == 0) {\n                if (nanos &lt;= 0L)\n                    return null;\n                nanos = notEmpty.awaitNanos(nanos);\n            }\n            return dequeue();\n        } finally {\n            lock.unlock();\n        }\n    }\n    public boolean offer(E e, long timeout, TimeUnit unit)\n        lock.lockInterruptibly();\n        try {\n            while (count == items.length) {\n                if (nanos &lt;= 0L)\n                    return false;\n                nanos = notFull.awaitNanos(nanos);\n            }\n            enqueue(e);\n            return true;\n        } finally {\n            lock.unlock();\n        }\n    }\n</code></pre> \u5373\u5982\u679c\u6ca1\u6709\u5143\u7d20\u4e14\u8bbe\u7f6e\u4e86\u7b49\u5f85\u8d85\u65f6\uff0c\u5219\u7531<code>notEmpty</code>Condition\u6765\u963b\u585e\u7b49\u5f85\u3002Condition\u7684\u5de5\u4f5c\u539f\u7406\u89c1\u201cJava\u201dsection.</p>"},{"location":"Java/List%20Queue/#copyonwritearraylist","title":"CopyOnWriteArrayList","text":"<p>\u662f\u4e00\u4e2a\u5199\u5165\u65f6\u62f7\u8d1d\u7684\u5217\u8868\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5b83\u7684\u5b9e\u4f8b\u91cc\u7684\u6570\u7ec4\u503c\u662f\u4e0d\u53ef\u53d8\u7684\u3002\u6bcf\u6b21\u5199\u5165\u7684\u5217\u8868\u64cd\u4f5c\u90fd\u4f1a\u5728\u4e34\u754c\u533a\u91cc\uff0c\u5148\u5f97\u51fa\u65b0\u7684\u6570\u7ec4\uff0c\u5e76\u4ee5\u6b64\u4f5c\u4e3a\u5185\u90e8\u6301\u6709\u7684\u6570\u7ec4\uff0c\u4ee5\u786e\u4fdd\u6570\u7ec4\u5185\u5bb9\u7684\u4e0d\u53d8\u6027\u3002\u6bd4\u5982\u5982\u4e0b\u7684\u5199\u5165\u64cd\u4f5c\uff1a</p> <pre><code>    public boolean addAll(int index, Collection&lt;? extends E&gt; c) {\n        Object[] cs = c.toArray();\n        synchronized (lock) {\n            Object[] elements = getArray();\n            int len = elements.length;\n            if (index &gt; len || index &lt; 0)\n                throw new IndexOutOfBoundsException(outOfBounds(index, len));\n            if (cs.length == 0)\n                return false;\n            int numMoved = len - index;\n            Object[] newElements;\n            if (numMoved == 0)\n                newElements = Arrays.copyOf(elements, len + cs.length);\n            else {\n                newElements = new Object[len + cs.length];\n                System.arraycopy(elements, 0, newElements, 0, index);\n                System.arraycopy(elements, index,\n                                 newElements, index + cs.length,\n                                 numMoved);\n            }\n            System.arraycopy(cs, 0, newElements, index, cs.length);\n            setArray(newElements);\n            return true;\n        }\n    }\n</code></pre>"},{"location":"Java/Map/","title":"Map","text":""},{"location":"Java/Map/#hashmap","title":"HashMap","text":""},{"location":"Java/Map/#slot-bucket","title":"slot, bucket","text":"<p>HashMap\u4e2d\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u5b58\u50a8\u4e86slot\uff08\u69fd\uff09\u3002\u5f53\u54c8\u5e0c\u78b0\u649e\u65f6\uff0c\u4f1a\u5728slot\u4e2d\u904d\u5386\u91cc\u9762\u7684\u6570\u636e\uff0c\u5f53\u5c0f\u4e8e\u201c\u6811\u201d\u5316\u7684\u9608\u503c\u65f6\uff0c\u4ee5\u94fe\u8868\u5b58\u50a8\uff0c\u5927\u4e8e\u65f6\u4f1a\u201c\u6811\u201d\u5316\uff0c\u91c7\u7528\u7684\u662f\u201c\u7ea2\u9ed1\u6811\u201d\u3002\u5f53\u5c0f\u4e8e\u201c\u53bb\u6811\u201d\u5316\u7684\u9608\u503c\u65f6\u53c8\u9000\u56de\u5230\u94fe\u8868\u3002</p>"},{"location":"Java/Map/#_1","title":"\u54c8\u5e0c\u503c\u8ba1\u7b97","text":"<p>\u4e3a\u4e86\u66f4\u597d\u7684\u6027\u80fd\uff0cHashMap\u6ca1\u6709\u4f7f\u7528\u6c42\u4f59%\u6216\u8005\u9664\u6cd5\uff0c\u56e0\u4e3a\u8fd9\u662f\u8f83\u8017\u65f6\u7684\u6307\u4ee4\u3002\u800c\u662f\u91c7\u7528\u4e86\u548cslot\u7684\u5c3a\u5bf8\u8fdb\u884c\u6309\u4f4d\u4e0e&amp;\u64cd\u4f5c\u786e\u5b9a\u7684slot\u4e0b\u6807\uff08\u53c2\u8003Thinking in java\uff09\u3002\u6b64\u5916\u5728\u5bf9key\u8c03\u7528hashCode()\u540e\u8fd8\u8fdb\u884c\u4e86\u4e00\u6b65\u5904\u7406\uff0c\u628ahashCode()\u8fd4\u56de\u7ed3\u679c\u4e0e\u6b64\u7ed3\u679c\u65e0\u7b26\u53f7\u53f3\u79fb16\u4f4d\u8fdb\u884c\u4ea6\u6216\uff08^\uff09\u8fd0\u7b97\u3002\u6b64\u539f\u56e0\u662f\u56e0\u4e3a\u5f53map\u5bb9\u91cf\u8f83\u5c0f\u65f6\uff0c\u56e0\u4e3a\u4e0a\u9762&amp;\u7684\u539f\u56e0\uff0c\u5bfc\u81f4\u5bf9\u4e8e\u9ad8bit\u4f4d\u5dee\u5f02\u5927\uff0c\u4f4ebit\u4f4d\u5dee\u5f02\u5c0f\u7684hashCode\u60c5\u51b5\u4f1a\u5f88\u5bb9\u6613\u53d1\u751f\u78b0\u649e\uff08float\u4e3akey\u7684\u6848\u4f8b\uff09\u3002</p>"},{"location":"Java/Map/#_2","title":"\u5bb9\u91cf &amp; \u8d1f\u8f7d\u56e0\u5b50","text":"<p>\u5bb9\u91cf\u5fc5\u987b\u662f2\u7684\u6307\u6570\uff0c\u539f\u56e0\u4e0a\u9762\u4e5f\u5df2\u7ecf\u6d89\u53ca\uff0c\u6b64\u5916\u8fd8\u53ef\u4ee5\u5728\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u7a0b\u5ea6\u907f\u514d\u4e86\u6570\u636e\u79fb\u52a8\uff0c\u8d1f\u8f7d\u56e0\u5b50\u9ed8\u8ba40.75\uff0c\u4e5f\u662f\u5e73\u5747\u6027\u80fd\u6700\u4f18\u7684\u7ed3\u679c\u3002\u5bb9\u91cf\u4e0e\u8d1f\u8f7d\u56e0\u5b50\u7684\u4e58\u79ef\uff0c\u5c06\u51b3\u5b9amap\u5b9e\u9645\u5b58\u50a8\u91cf\u8fbe\u5230\u591a\u5c11\u65f6\u6269\u5bb9\u3002\u4e4b\u6240\u4ee5\u4e0d\u5728\u8fbe\u5230\u5bb9\u91cf\u4e0a\u9650\u624d\u6269\u5bb9\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u6027\u80fd\u3002</p>"},{"location":"Java/Map/#_3","title":"\u65f6\u95f4\u590d\u6742\u5ea6","text":"<p>slot\u67e5\u8be2O(1)\uff0c\u5f53\u7136\u524d\u63d0\u662fkey\u7684hashCode()\u662fO(1)\u3002Bucket\u67e5\u8be2\u6700\u5dee\u60c5\u51b5\uff08\u54c8\u5e0c\u5168\u78b0\u649e\uff09O(n)\u6216O(log n)\u8fd9\u53d6\u51b3\u4e8e\u662f\u94fe\u8868\u8fd8\u662f\u6811\uff0c\u6700\u597d\u60c5\u51b5O(1)\uff0c\u56e0\u4e3a\u5b8c\u5168\u5747\u5300\u4e14\u5c31\u4ec5\u4e00\u4e2a\u5143\u7d20\u3002</p>"},{"location":"Java/Map/#node","title":"Node","text":"<p>Node\u662f\u5b58\u50a8HashMap\u5b58\u50a8\u5143\u7d20\u7684\u8282\u70b9\u3002\u4f46HashMap\u4e3a\u4e86LinkedHashMap\u4fdd\u7559\u4e86newNode\u65b9\u6cd5\uff0c\u4ee5\u4fbfLinkedHashMap\u521b\u5efa\u7279\u6b8a\u7684\u4e00\u79cdNode\u3002\u8be6\u89c1\u201cLinkedHashMap\u7406\u89e3\u201d\u3002</p> <p>\u800c\u5bf9\u4e8e\u201c\u6811\u201d\u5316\u540e\uff0c\u5b58\u50a8\u7684\u8282\u70b9\u4f1a\u53d8\u4e3aTreeNode\uff0c\u4e3a\u4e86\u652f\u6301\u6811\u7684\u7ed3\u6784\uff0c\u589e\u52a0\u4e86\u66f4\u591a\u7684\u5b57\u6bb5\u3002</p>"},{"location":"Java/Map/#null","title":"Null\u517c\u5bb9\u6027","text":"<p>\u652f\u6301Null\u7684Key\u6216Value\u3002null\u7684key\u7684HashCode\u8ba4\u4e3a\u662f0</p>"},{"location":"Java/Map/#_4","title":"\u7ebf\u7a0b\u5b89\u5168\u6027","text":"<p>\u7ebf\u7a0b\u4e0d\u5b89\u5168</p>"},{"location":"Java/Map/#_5","title":"\u6709\u5e8f\u6027","text":"<p>\u4e0d\u4fdd\u8bc1\u6709\u5e8f</p>"},{"location":"Java/Map/#_6","title":"\u6269\u5bb9","text":"<p>\u5bb9\u91cf\u7ffb\u500d\uff0c\u5bf9\u4e8e\u94fe\u8868\u7ed3\u6784\uff0c\u539f\u6765\u94fe\u8868\u4e0b\u7684\u8282\u70b9\u4f1a\u88ab\u91cd\u6392\u4e3a\u4e24\u4e2a\u94fe\u8868\uff0c\u53ea\u9700\u8981\u53d6\u6269\u5bb9\u65f6\u65b0\u589e\u7684\u90a3\u4f4dbit\u5373\u8001\u7684\u5bb9\u91cf\uff08oldCap\uff09\u4e0e\u8282\u70b9\u7684hash \u8fdb\u884c\u4e0e\u8fd0\u7b97\u5373\u53ef\uff0c\u5206\u6210\u7684\u4e24\u4e2a\u65b0\u94fe\u8868\u5bf9\u5e94\u4e86\u65b0\u7684\u90a3\u4e00\u4f4d\u662f\u5426\u4e3a0.</p>"},{"location":"Java/Map/#jdk-7-jdk-8","title":"jdk 7 -&gt; jdk 8","text":"<p>\u7531\u6570\u7ec4+\u94fe\u8868\u7684\u7ed3\u6784\u6539\u4e3a\u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811\u3002 \u4f18\u5316\u4e86\u9ad8\u4f4d\u8fd0\u7b97\u7684hash\u7b97\u6cd5\uff1ah^(h&gt;&gt;&gt;16) \u6269\u5bb9\u540e\uff0c\u5143\u7d20\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\uff0c\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\u518d\u79fb\u52a82\u6b21\u5e42\u7684\u4f4d\u7f6e\uff0c\u4e14\u94fe\u8868\u987a\u5e8f\u4e0d\u53d8\u3002 \u6700\u540e\u4e00\u6761\u662f\u91cd\u70b9\uff0c\u56e0\u4e3a\u6700\u540e\u4e00\u6761\u7684\u53d8\u52a8\uff0chashmap\u57281.8\u4e2d\uff0c\u4e0d\u4f1a\u5728\u51fa\u73b0\u6b7b\u5faa\u73af\u95ee\u9898\u3002</p>"},{"location":"Java/Map/#linkedhashmap","title":"LinkedHashMap","text":"<p>LinkedHashMap\u6700\u5e38\u7528\u4e8eLRU\u7b97\u6cd5\u7684\u7f13\u5b58\u5b9e\u73b0\uff08\u4f7f\u7528accessOrder\u6a21\u5f0f\uff09\uff0c\u53e6\u4e00\u4e2a\u6a21\u5f0f\u662f\u6309\u63d2\u5165\u987a\u5e8f\u3002\u6b64\u5916\u5b83\u8fd8\u4fdd\u8bc1\u4e86\u987a\u5e8f\u3002</p>"},{"location":"Java/Map/#hashmap_1","title":"\u4e0eHashMap\u7684\u5173\u7cfb","text":"<p>\u7ee7\u627f\u4e8eHashMap\uff0c\u5e76\u91cd\u5199\u4e86newNode\u65b9\u6cd5\uff0c\u5b83\u7684Node\u7c7b\u578b\u4e5f\u7ee7\u627f\u4e86HashMap\u7684Node\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u652f\u6301\u53cc\u5411\u94fe\u8868\u589e\u52a0\u4e86before\u548cafter\u8282\u70b9\u3002\u6574\u4f53\u5b58\u50a8\u65b9\u5f0f\u8fd8\u662f\u4f9d\u8d56\u4e86HashMap\uff0c\u5373put\u548cget\u4f9d\u8d56\u4e86HashMap\u7684\u5b9e\u73b0\uff0c\u4f46\u5bf9\u4e8eaccessOrder\u6a21\u5f0f\u65f6\uff0c\u5bf9get\u4f1a\u8c03\u6574\u94fe\u8868\u7684\u987a\u5e8f\u3002</p>"},{"location":"Java/Map/#lru","title":"LRU\u8fc7\u7a0b\u5b9e\u73b0","text":"<p>\u5f53accessOrder=true\u7684\u65f6\u5019\uff0cLinkedHashMap\u901a\u8fc7\u91cd\u5199onNodeAccess\uff0c\u4f1a\u628a\u8bbf\u95ee\u7684\u5143\u7d20\u4ece\u94fe\u8868\u53d6\u51fa\uff0c\u5e76\u91cd\u65b0\u653e\u5728\u94fe\u8868\u5c3e\u7aef\uff08head, tail\u90fd\u5b58\u5728\u6210\u5458\u53d8\u91cf\uff09\u3002\u5217\u8868\u5934\u662f\u6700\u5c11\u88ab\u8bbf\u95ee\u7684\uff0c\u56e0\u6b64\u662f\u6700\u5c11\u88ab\u4f7f\u7528\u7684\uff08\u4f46\u5982\u679c\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u4ee5\u5176\u4ed6\u65b9\u5f0f\u5728\u4e0d\u65ad\u88ab\u4f7f\u7528\uff0c\u90a3\u4e48\u53e6\u5f53\u522b\u8bba\uff09\u3002\u4f46\u6574\u4e2a\u8fc7\u7a0bLinkedHashMap\u90fd\u4e0d\u4f1a\u81ea\u52a8\u8fdb\u884c\u5220\u9664\u64cd\u4f5c\u3002\u5982\u679c\u4f7f\u7528\u8005\u9700\u8981\u589e\u52a0\u5220\u9664\u903b\u8f91\uff0c\u53ef\u4ee5\u590d\u5199removeEldestEntry(Node node)\uff0c\u8fd9\u662f\u5728put\u65f6\uff0c\u4f1a\u89e6\u53d1\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u8fd4\u56de\u5e03\u5c14\u503c\uff0c\u65b9\u4fbf\u51b3\u5b9a\u662f\u5426\u76f4\u63a5\u5220\u9664\u6700\u8001\u7684\u8282\u70b9\uff08\u5934\u8282\u70b9\uff09\u3002</p>"},{"location":"Java/Map/#concurrenthashmap","title":"ConcurrentHashMap","text":"<ul> <li>\u5728jdk1.7\u4f7f\u7528\u7684\u662f\u5206\u6bb5\u9501\u3002</li> <li>\u540e\u9762\u4e3b\u8981\u4ee5jdk1.8\u4e3a\u51c6\u3002\u540c\u6b65\u4e3b\u8981\u4f7f\u7528\u4e86cas\uff08\u5f53\u76ee\u6807\u4e0b\u6807\u7684tab\u4e0a\u8fd8\u6ca1\u5143\u7d20\u65f6\uff0c\u4f7f\u7528cas\u6dfb\u52a0\u65b0\u5143\u7d20\uff0c\u5931\u8d25\u5219\u8fdb\u5165\u4e0b\u4e00\u6b21\u5904\u7406\uff09\u548c\u5c40\u90e8\u7684synchronize\uff08\u5f53\u76ee\u6807\u4e0b\u6807tab\u5df2\u7ecf\u6709\u5143\u7d20\u65f6\uff0c\u83b7\u53d6\u6839\u5143\u7d20\u7684\u9501\uff09\u5173\u952e\u5b57\u3002\u5728put\u7684\u65f6\u5019\u4f1a\u52a0\u4e0a\u5faa\u73af\uff0c\u76f4\u5230\u6210\u529f\u4e3a\u6b62\u3002</li> <li>\u6838\u5fc3\u7684\u7406\u5ff5\u548chashmap\u76f8\u540c\u3002</li> </ul>"},{"location":"Java/Map/#treemap","title":"TreeMap","text":""},{"location":"Java/Map/#_7","title":"\u7b97\u6cd5","text":"<p>\u7ea2\u9ed1\u6811</p>"},{"location":"Java/Map/#_8","title":"\u65f6\u95f4\u590d\u6742\u5ea6","text":"<p>\u4fdd\u8bc1O(log n)</p>"},{"location":"Java/Map/#_9","title":"\u6709\u5e8f\u6027","text":"<p>\u4f1a\u6839\u636e\u6784\u9020\u5668\u7684comparator, \u6216\u8005\u5b58\u50a8\u7684key\u5b9e\u73b0\u7684comparable\u63a5\u53e3\u6765\u6392\u5e8f\u3002\u6709\u5e8f\u7684\u3002</p>"},{"location":"Java/Map/#_10","title":"\u7279\u70b9","text":"<p>\u9700\u8981\u4f7f\u7528comparator\u6216\u8005key\u5b9e\u73b0comparable\u3002\u5426\u5219\u4f1a\u51fa\u9519\u3002</p>"},{"location":"Java/Map/#vs-hashmap","title":"vs HashMap","text":"<p>\u540c\u4e0a\u9762\u6240\u8ff0\uff0c\u5982\u679c\u9700\u8981\u6309key\u6392\u5e8f\uff0c\u5219\u6b64map\u8f83\u4e3a\u5408\u9002\uff0c\u5982\u679c\u4e0d\u9700\u8981\uff0c\u800c\u4e14key\u4e5f\u6ca1\u6709\u5b9e\u73b0\u8fd9\u4e9b\u65b9\u6cd5\uff0c\u4e0d\u63d0\u4f9b\u6bd4\u8f83\u5668\uff0c\u5219\u6ca1\u5fc5\u8981\u4f7f\u7528treeMap\u3002</p>"},{"location":"Java/Map/#vs-linkedhasmap","title":"vs LinkedHasMap","text":"<p>\u540c\u4e0a\u3002\u867d\u7136\u4e24\u8005\u90fd\u6709\u5e8f\u3002\u4f46\u6392\u5e8f\u65b9\u5f0f\u4e0d\u540c\u3002</p>"},{"location":"Java/RxJava/","title":"RxJava","text":"<p>\u6b64\u6587\u7ae0\u8f83\u8001</p>"},{"location":"Java/RxJava/#pull-vs-push","title":"pull vs push","text":"<p>\u6709\u8fd9\u4e48\u4e00\u79cd\u6bd4\u8f83\u5c0f\u4f17\u7684\u8bf4\u6cd5\uff0c\u4f46\u6216\u8bb8\u6709\u4e00\u5b9a\u9053\u7406\uff0c\u201cRxJava\u4f53\u73b0\u51fa\u6765\u7684Pull\u548cPush\u201d\u7684\u533a\u522b\uff1f\u8fd9\u4e2a\u521d\u542c\u8d77\u6765\u65e0\u6cd5\u7406\u89e3\uff0c\u4f46\u53ef\u4ee5\u53c2\u8003\u4e00\u4e2a\u6587\u7ae0\u3002\u5728\u8fd9\u4e2a\u6587\u7ae0\u91cc\uff0c\u9996\u5148pull\u672c\u8eab\u662f\u6307\u81ea\u5df1\uff08\u89c2\u6d4b\u8005\uff09\u53bb\u4e3b\u52a8\u8bf7\u6c42\u6570\u636e\uff0cpush\u5219\u662f\u6307\uff08\u88ab\u89c2\u6d4b\u8005\uff09\u6570\u636e\u53d8\u66f4\u65f6\u4e3b\u52a8\u53bb\u901a\u77e5\u89c2\u6d4b\u8005\u3002pull\u5982\u679c\u60f3\u5f97\u5230\u65b0\u7684\u6570\u636e\uff0c\u5f80\u5f80\u9700\u8981poll\uff0c\u5373\u4e0d\u65ad\u53bb\u8f6e\u8be2\uff0c\u800cpush\u5982\u679c\u60f3\u5f97\u5230\u65b0\u7684\u6570\u636e\uff0c\u5f80\u5f80\u9700\u8981callback\u5373\u53ef\u3002\u800cRxJava\u4fbf\u662f\u8fd9\u6837\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5927\u91cf\u51cf\u5c11Callback\u8fd9\u6837\u7684\u6837\u677f\u4ee3\u7801\u3002\u800c\u5bf9\u5e94Android\u65b9\u9762\uff0c\u8fd9\u91cc\u66f4\u591a\u7684\u573a\u666f\u4fbf\u662f\u6307\u7f51\u7edc\u8bf7\u6c42\u6216\u8005\u9875\u9762\u4e8b\u4ef6\u7b49\u3002</p>"},{"location":"Java/RxJava/#subscribeon-vs-observeon","title":"subscribeOn vs observeOn","text":"<p>\u5173\u4e8eRxJava\uff0c\u60f3\u5230\u7684\u4e00\u4e9b\u7279\u70b9\u662f\uff0c\u94fe\u5f0f\u8c03\u7528\uff0c\u4ee5\u53ca\u5f88\u591a\u6e05\u6670\u3001\u6613\u7528\u7684\u57fa\u672c\u539f\u8bed\u3001\u672f\u8bed\u3001\u64cd\u4f5c\u7b26\u3002onNext, onError, onComplete, Schedulers, Single, Flowable, map, flatMap\u7b49\u7b49\u3002\u597d\u7528\u7684\u540c\u65f6\uff0c\u6709\u65f6\u5019\u4f1a\u5f15\u5165\u4ee4\u4eba\u6df7\u6dc6\u7684\u4e1c\u897f\uff0c\u6bd4\u5982observeOn\u4ee5\u53casubscribeOn\uff0c\u4ee5\u53ca\u4e24\u8005\u591a\u6b21\u7a7f\u63d2\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002</p> <p>subscribeOn\uff0c\u5373\u5728\u54ea\u91cc\u8ba2\u9605\uff0c\u8ba2\u9605\u5b8c\u5c31\u8be5\u4ea7\u751f\u6570\u636e\u4e86\uff0c\u6307\u7684\u662f\u88ab\u89c2\u6d4b\u8005\u5728onSubscribe\u65f6\u5019\u89e6\u53d1\u7684\u7ebf\u7a0b\u73af\u5883\u3002\u5b83\u7684\u672c\u8d28\u662f\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u88ab\u89c2\u6d4b\u8005\uff0c\u65b0\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005\u5728onSubscribe\u5373\u88ab\u8ba2\u9605\u7684\u65f6\u5019\uff0c\u4f7f\u7528Schedulers\u91cc\u5b89\u6392\u7684\u7ebf\u7a0b\u4e0a\uff0c\u89e6\u53d1\u81ea\u5df1\u672c\u8eab\u7684\u539f\u59cbonSubscribe\u5185\u5bb9\u3002</p> <p>observeOn\uff0c\u5373\u5728\u54ea\u91cc\u89c2\u6d4b\uff0c\u6307\u7684\u662f\u89c2\u6d4b\u8005\u88ab\u56de\u8c03\u65f6\u671f\u671b\u7684\u7ebf\u7a0b\u73af\u5883\u3002\u5b83\u7684\u672c\u8d28\u662f\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u88ab\u89c2\u6d4b\u8005\uff0c\u65b0\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005\u5728onSubscribe\u5373\u88ab\u8ba2\u9605\u7684\u65f6\u5019\uff0c\u4f1a\u8ba2\u9605\u539f\u88ab\u89c2\u6d4b\u8005\uff0c\u6b64\u65f6\u7684\u89c2\u6d4b\u8005\u662f\u81ea\u8eab\uff08\u5373\u65b0\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005\uff09\uff0c\u5728\u65b0\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005onNext,onError, onComplete\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528Schedulers\u63d0\u4f9b\u7684\u7ebf\u7a0b\uff0c\u5207\u6362\u73af\u5883\u540e\u8c03\u7528\u540e\u9762\u89c2\u6d4b\u8005\u7684onNext, onError, onComplete\u7b49\u3002</p> <p>\u601d\u8003\u4e0b\u590d\u6742\u573a\u666f\uff0cX.subscribeOn(A).observeOn(B).subscribe(O)\u3002\u6ce8\u610f\u6700\u540e.subscribe(O)\u628a\u89c2\u6d4b\u8005O\u4f20\u9012\u7ed9\u4e86\u4e0a\u9762\u5012\u6570\u7b2c\u4e8c\u6b65\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005\u3002\u800c\u8fd9\u4e2a\u89c2\u6d4b\u8005\u6839\u636e\u4e0a\u9762\u6240\u8ff0\uff0c\u4f1a\u8fdb\u800c\u7ee7\u7eed\u8c03\u7528\u524d\u9762\u7684\u88ab\u89c2\u6d4b\u8005\uff0c\u5373observeOn\u6240\u751f\u6210\u7684\u3002\u800cobserveOn\u6240\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005\u4f1a\u51c6\u5907\u5728A\u7ebf\u7a0b\u73af\u5883\u4e2d\u8fdb\u800c\u8c03\u7528X\u4ece\u800c\u4ea7\u751f\u6570\u636e\u3002\u5728\u4ea7\u751f\u5b8c\u6570\u636e\u540e\uff0c\u4f1a\u56de\u5230subscribeOn\u6240\u751f\u6210\u7684\u88ab\u89c2\u6d4b\u8005\uff0c\u6b64\u65f6\u5b83\u7684\u89c2\u6d4b\u8005\u662f\u81ea\u5df1\uff0c\u5728onNext\u53c8\u5207\u6362\u4e86\u7ebf\u7a0b\u6700\u540e\u5728\u7ebf\u7a0bB\u4e2d\u628a\u6570\u636e\u4ea4\u4ed8\u7ed9\u4e86O\u3002</p> <p>X.subscribeOn(A).observeOn(B).subscribeOn(C).subscribe(O) \u53ef\u4ee5\u8bd5\u7740\u5206\u6790\u4e00\u4e0b\uff0cX\u5e94\u8be5\u4f1a\u5728A\u7ebf\u7a0b\u88ab\u8c03\u7528\uff0cO\u5e94\u8be5\u4f1a\u5728B\u4e2d\u8c03\u7528</p> <p>\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u89e3\u91ca\u6b64\u65b9\u9762\u7684\u6587\u7ae0</p>"},{"location":"Java/RxJava/#_1","title":"\u94fe\u5f0f\u8c03\u7528","text":"<p>\u5173\u4e8eRxJava\u7684\u94fe\u5f0f\u8c03\u7528\uff0c\u4e5f\u8fdc\u6bd4\u770b\u4e0a\u53bb\u7684\u66f4\u6709\u610f\u601d\u3002\u8fd9\u91cc\u7684\u94fe\u5f0f\u8c03\u7528\u867d\u7136\u65b9\u6cd5\u6309\u987a\u5e8f\u4e0d\u65ad\u4ece\u4e0a\u5230\u4e0b\u8fdb\u884c\u8c03\u7528\uff0c\u4f46\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u53ea\u662f\u5728\u8fdb\u884c\u5305\u88c5\uff0c\u800c\u6700\u7ec8\u53ea\u6709subscribeXxx\u624d\u4f1a\u89e6\u53d1\u5b8c\u6574\u7684\u5c01\u88c5\u94fe\u6761\u8c03\u7528\u3002\u800c\u4e14\u6839\u636e\u5c01\u88c5\u5185\u5bb9\uff0c\u6700\u7ec8\u5c01\u88c5\u540e\u7684\u4ea7\u7269\u5728\u8c03\u7528\u65f6\u662f\u6709\u4e00\u79cd\u4ece\u4e0b\u5230\u4e0a\u7684\u611f\u89c9\u3002</p>"},{"location":"Java/SPI/","title":"SPI","text":"<p>\u5b83\u662f\u7531Java 6 \u5f15\u5165\u7684\u7528\u4e8e\u53d1\u73b0\u670d\u52a1\u5b9e\u73b0\u7684\u529f\u80fd\u3002\u6211\u8ba4\u4e3a\u5b83\u5b9e\u73b0\u4e86<code>Service Locator</code>\u8bbe\u8ba1\u6a21\u5f0f\u3002</p> <p>\u5b83\u901a\u8fc7\u5982\u4e0b\u51e0\u4e2a\u90e8\u5206\u6765\u5de5\u4f5c\uff1a</p> <ul> <li>\u58f0\u660eAPI\u5c42\uff0cAPI\u5c42\u4e00\u822c\u5305\u542b\u670d\u52a1\u63a5\u53e3\u5b9a\u4e49\uff0c\u4ee5\u53ca\u6d89\u53ca\u7684\u6570\u636e\u7c7b\u578b\u3002\u5b83\u5c06\u88ab\u5e94\u7528\u548c\u5b9e\u73b0\u8005\u4f9d\u8d56\u3002</li> <li>\u5b9e\u73b0API\u5c42\uff0c\u5b9e\u73b0\u8005\u4f9d\u8d56API\u6a21\u5757\uff0c\u63d0\u4f9b\u670d\u52a1\u63a5\u53e3\u7684\u5b9e\u73b0\u3002\u6700\u540e\u5728<code>resources/META-INF/services</code>\u76ee\u5f55\u4e2d\u521b\u5efa\u6240\u5b9e\u73b0\u7684\u670d\u52a1\u63a5\u53e3\u5168\u91cf\u9650\u5b9a\u540d\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u5185\u5bb9\u662f\u5b9e\u73b0\u7c7b\u7684\u5168\u91cf\u9650\u5b9a\u540d\u3002</li> <li>\u5e94\u7528\u5c42\uff0c\u4f9d\u8d56API\u6a21\u5757\uff0c\u4f7f\u7528<code>ServiceLoader.load</code>\u7b49\u65b9\u6cd5\u6765\u67e5\u8be2\u5b9e\u73b0\uff0c\u4ece\u800c\u4f7f\u7528\u8be5\u670d\u52a1\u3002</li> </ul> <p>\u53e6\u5916\u670d\u52a1\u63d0\u4f9b\u8005\u4ee5\u6269\u5c55\u7684\u5f62\u5f0f\u5b89\u88c5\uff0c\u9700\u8981\u628a\u5176jar\u6587\u4ef6\u6211\u4eec\u5f15\u5165\u5230\u5e94\u7528\u7a0b\u5e8f\u7c7b\u8def\u5f84\u3001Java \u6269\u5c55\u7c7b\u8def\u5f84\u6216\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u8def\u5f84\u4e2d\u3002\u82e5\u7c7b\u8def\u5f84\u91cc\u6ca1\u6709\u6b64\u9879\uff0c\u5c06\u4f9d\u7136\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\u3002</p>"},{"location":"Java/SPI/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>ServiceLoader</li> <li>Java-spi example</li> <li>Java-spi example github</li> <li>\u201c\u8bbe\u8ba1\u6a21\u5f0f\u201dsection</li> </ul>"},{"location":"Java/%E5%9B%9B%E7%A7%8D%E5%BC%95%E7%94%A8/","title":"\u56db\u79cd\u5f15\u7528","text":"<ul> <li>\u5f3a\u5f15\u7528 </li> <li>\u8f6f\u5f15\u7528\uff08\u5185\u5b58\u4e0d\u8db3\u65f6\u56de\u6536\uff09 </li> <li>\u5f31\u5f15\u7528\uff08gc\u56de\u6536\uff09 </li> <li>\u865a\u5f15\u7528\uff08\u5f62\u540c\u865a\u8bbe\uff0c\u968f\u65f6\u53ef\u80fd\u56de\u6536\uff09</li> </ul> <p>\u540e\u4e09\u79cd\u90fd\u53ef\u4ee5\u7ed3\u5408referenceQueue\u8ddf\u8e2a\u56de\u6536\u72b6\u6001\u3002\u5e26<code>ReferenceQueue</code>\u7684\u6784\u9020\u65b9\u6cd5\u7b7e\u540d\u5982\u4e0b\uff1a <pre><code>    public WeakReference(T referent, ReferenceQueue&lt;? super T&gt; q) {\n        super(referent, q);\n    }\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>q.poll()</code>\u6765\u83b7\u53d6\u961f\u5217\u91cc\u7684\u5143\u7d20\uff0c\u82e5\u80fd\u83b7\u53d6\u975e\u7a7a\u5143\u7d20\uff0c\u5219\u4ee3\u8868\u8be5\u76ee\u6807\u5df2\u7ecf\u65e0\u5f3a\u5f15\u7528\uff0c\u76ee\u524d\u5b83\u662f\u5f31\u8bbf\u95ee\u7684\uff0c\u5982\u679c\u6b64\u65f6\u53d1\u751fGC\u56de\u6536\uff0c\u90a3\u4e48\u5c06\u4f1a\u88ab\u56de\u6536\u3002\u800c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u5185\u5b58\u9003\u9038\u7684\u65f6\u673a\u3002\u4ea6\u6216\u8005\u662f\u68c0\u67e5\u5176\u88ab\u5408\u7406\u91ca\u653e\u7684\u65f6\u673a\u3002\u5bf9\u4e8e<code>leakCanary</code>\u6765\u8bf4\uff0c\u4fbf\u662f\u5728\u8fd9\u91cc\u8ba4\u4e3a\u76ee\u6807\u662f\u5f31\u8bbf\u95ee\u7684\uff0c\u4fbf\u4ece\u89c2\u5bdf\u5217\u8868\u91cc\u5220\u9664\u8be5\u5143\u7d20\u3002</p>"},{"location":"Java/%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95/","title":"\u6784\u9020\u65b9\u6cd5","text":""},{"location":"Java/%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95/#_1","title":"\u6784\u9020\u8fc7\u7a0b","text":"<p>\u6ce8\u610f\u521d\u59cb\u5316\u4ee3\u7801\u5757\u4f1a\u6309\u524d\u540e\u987a\u5e8f\u63d2\u5165\u5728\u6784\u9020\u51fd\u6570super\u540e\u7684\u7b2c\u4e00\u53e5\u8bdd\u3002\u800c\u4e0d\u662f\u6784\u9020\u7ed3\u675f\u540e\u3002</p>"},{"location":"Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD/","title":"\u7c7b\u52a0\u8f7d","text":""},{"location":"Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD/#_1","title":"\u7c7b\u52a0\u8f7d","text":"<p>\u52a0\u8f7d\uff08classLoader) \u94fe\u63a5{\u9a8c\u8bc1\uff0c\u51c6\u5907\uff0c\u89e3\u6790\uff08jvm\u4e2d\u7b26\u53f7\u5f15\u7528\u6539\u4e3a\u5185\u5b58\u5f15\u7528)} \u521d\u59cb\u5316</p> <p>class loader \u5e76\u4e0d\u80fd\u76f4\u63a5\u66ff\u6362java\u6838\u5fc3\u7c7b\u3002\u6838\u5fc3\u7c7b\u7684classpath\u662f\u901a\u8fc7bootclasspath\u4f20\u5165\uff0c\u4f46\u662f\u5728\u5b89\u5353\u4e0a\uff0c\u5e94\u7528\u8fdb\u7a0b\u90fd\u662ffork\u51fa\u6765\u7684\uff0c\u65e0\u6cd5\u66f4\u6539\u8fd9\u4e9bdvm\u7684\u521d\u59cb\u53c2\u6570\u3002link</p> <p></p>"},{"location":"Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD/#_2","title":"\u62d3\u5c55\u9605\u8bfb","text":"<p>zhihu</p>"},{"location":"Javascript/Javascript%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/","title":"Javascript\u5f00\u53d1\u73af\u5883\u90e8\u7f72","text":"<p>\u672c\u6587\u6863\u65e8\u5728\u5e2e\u52a9\u4f60\u5feb\u901f\u4e0a\u624b\u3001\u642d\u5efa\u4e00\u4e2a\u73b0\u4ee3\u7684Javascript\u73af\u5883\u3002\u9ad8\u624b\u53ef\u4ee5\u76f4\u63a5\u5ffd\u7565\u3002</p> <p>\u672c\u6587Js\u73af\u5883\u4e3b\u8981\u6307\u57fa\u4e8eNode\u7684\u73af\u5883\u3002\u6587\u672c\u7f16\u8f91\u5668\u4f7f\u7528VSCode\u3002</p> <p>\u4e00\u5f00\u59cb\u9762\u4e34\u5404\u79cd\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982package.json, tsconfig.json, webpack.js xxx.json/js\u8fd9\u79cd\u5404\u5f0f\u5404\u6837\u7684dsl\u6587\u4ef6\u8ba9\u6211\u89c9\u5f97\u529b\u4e0d\u4ece\u5fc3\uff0c\u4f46\u540e\u6765\u53d1\u73b0\u5927\u90e8\u5206\u7684\u5de5\u5177\u90fd\u63d0\u4f9b\u4e86init\u6307\u4ee4\u7528\u4e8e\u53cb\u597d\u3001\u4ea4\u4e92\u5730\u521d\u59cb\u5316\u4e00\u4efd\u672c\u5730\u5de5\u4f5c\u73af\u5883\u3002\u56e0\u4e3a\u6709\u65f6\u5019\u8bc9\u6c42\u5f88\u7b80\u5355\uff0c\u53ea\u60f3\u8981\u4e00\u4efd\u7b80\u5355\u7684\u914d\u7f6e\u80fdRun\u8d77\u6765\uff0c\u6b64\u65f6\u4e00\u5b9a\u8bb0\u5f97npx ... init/--init\uff0c\u8fd9\u6837\u5c31\u4e0d\u5fc5\u5230\u5904\u53bb\u627e\u4e00\u4e2a\u914d\u7f6e\u6837\u672c\u518d\u81ea\u5b9a\u4e49\u4e86\u3002</p> <p>\u4e00\u822c\u6211\u9700\u8981\u7684\u73af\u5883\u914d\u7f6e\u5982\u4e0b\uff1a</p> <p>\u6700\u57fa\u672c\u7684\u5305\u62ec\uff1a</p> <ul> <li>node.js:<ul> <li>cd working_space</li> <li>npm init</li> </ul> </li> <li>typescript:<ul> <li>npm install -D typescript </li> <li>npx tsc --init</li> </ul> </li> </ul> <p>\u5982\u679c\u9700\u8981watch\u3001\u9700\u8981\u51fa\u6346\u7ed1\u5305\u3001\u9700\u8981\u9762\u5411web\u7684\u8bdd\uff1a</p> <p>\u5982\u679c\u53ea\u662f\u7b80\u5355watch\uff0c\u53ef\u4ee5\u7528node\u624b\u5199</p> <ul> <li>webpack:<ul> <li>npm install -D webpack</li> <li>npx webpack init</li> </ul> </li> <li>webpack-shell-plugin-next</li> </ul> <p>\u4e4b\u540e\u6839\u636e\u9700\u8981\uff0c\u518d\u5173\u6ce8\u7f16\u8f91\u76ee\u5f55\u4e0b\u7684tsconfig.json, package.json, webpack.js\u5373\u53ef\u3002\u82e5\u9700\u8981\u9ad8\u7ea7\u7528\u6cd5\uff0c\u518d\u67e5\u5b98\u7f51\u5b9a\u4e49\u3002</p>"},{"location":"Javascript/JsApi%20proto/","title":"JsApi Proto","text":"<p>\u7528<code>proto</code>\u8bed\u6cd5\u63cf\u8ff0\u5bb9\u5668\u6ce8\u5165\u7684JsApi\uff0c\u5e76\u751f\u6210\u51fa\u5404\u8bed\u8a00\u7684client/service\u5b9e\u73b0\u3002</p> <p>\u672c\u6587\u5047\u8bbe\u60a8\u5df2\u7ecf\u5bf9<code>proto2</code>/<code>proto3</code>\u6709\u6240\u4e86\u89e3\u3002</p> <p>\u7279\u70b9\uff1a</p> <ul> <li><code>proto</code>\u8bed\u8a00\u4e2d\u7acb\uff0c\u5bf9\u6b64\u7c7b\u6865\u63a5\u6027\u8d28\u7684JsApi\uff0c\u53ef\u4ee5\u751f\u6210\u51fa\u5404\u79cd\u8bed\u8a00\u7248\u672c\u7684 Api\u4f7f\u7528\u7aef/\u5b9e\u73b0\u7aef\u3002</li> <li>\u4e2d\u95f4\u8fc7\u7a0b\u7684\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u81ea\u52a8\u5904\u7406\uff0c\u652f\u6301Json\u548cprotobuf\u7b49\u591a\u79cd\u65b9\u5f0f\u3002</li> <li>\u9762\u5411\u5bf9\u8c61\u53cb\u597d\uff0c\u5173\u6ce8\u5177\u4f53\u7684\u6570\u636e\u7ed3\u6784\u5b9a\u4e49\uff0c\u800c\u4e0d\u5fc5\u5bf9\u96f6\u6563\u5b57\u6bb5\u624b\u52a8\u5904\u7406\u3002</li> <li>\u6587\u6863\u53cb\u597d\uff0c\u7ed3\u5408<code>proto</code>\u7684\u6ce8\u91ca\uff0c\u53ef\u4ee5\u8f93\u51faJsApi\u6587\u6863\uff0c\u4ee5\u4fbf\u540e\u7eed\u7684\u52a0\u5de5\u5904\u7406\u3002\u6bd4\u5982\u5bf9\u5185\u3001\u5bf9\u5916\u6587\u6863\u751f\u6210\u7b49\u3002\u89c1\u201c\u6587\u6863\u751f\u6210\u201d\u7ae0\u8282\u3002</li> </ul> <p>\u6837\u4f8b\uff1a</p> <p>\u6b64\u4ed3\u5e93\u7684<code>example</code>\u76ee\u5f55\u5305\u542b\u4e86JsApi proto\u6837\u4f8b\u4ee5\u53ca\u751f\u6210\u7684ts, java\u4ee3\u7801\u6837\u4f8b\u3002</p>"},{"location":"Javascript/JsApi%20proto/#jsapi","title":"JsApi \u63cf\u8ff0","text":"<p>\u6211\u4eec\u4f7f\u7528proto\u4e2d\u7684<code>service</code>\u76f8\u5173\u8bed\u6cd5\u6765\u63cf\u8ff0JsApi\uff0c\u548c\u63cf\u8ff0\u4e00\u4e2a<code>rpc</code>\u65b9\u6cd5\u5341\u5206\u76f8\u4f3c\uff0c\u5c3d\u7ba1\u5b83\u672c\u8d28\u4e0a\u5e76\u4e0d\u662frpc\u3002</p> <p>\u4e0b\u9762\u7684\u4ee3\u7801\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5f02\u6b65JsApi\u3002 <pre><code>syntax = \"proto3\";\n\nmessage Request {\n  string action = 1;\n  int32 id = 2;\n}\n\nmessage Response {\n  string message = 1;\n  bool isSuccess = 2;\n}\n\nservice DemoApiInterface {\n  rpc asyncApi(Request) returns (Response) {}\n}\n</code></pre> \u5982\u4f60\u6240\u89c1\uff0c\u8fd9\u6bb5proto\u63cf\u8ff0\u4e86\u4e00\u4e2aJsApi\uff0c\u5b83\u662f\u5f02\u6b65\u7684\uff0c\u5ba2\u6237\u7aef\u9700\u8981\u4f20\u5165<code>Request</code>\u5bf9\u8c61\uff0c\u670d\u52a1\u7aef\u9700\u8981\u8fd4\u56de<code>Response</code>\u3002\u5728\u6211\u4eec\u7684\u573a\u666f\u4e2d\uff0c\u5ba2\u6237\u7aef\u662f\u6307\u5c0f\u7a0b\u5e8f\u4fa7\uff0c\u670d\u52a1\u7aef\u5219\u662f\u5c0f\u7a0b\u5e8f\u5bb9\u5668\u4fa7\u3002\u6211\u4eec\u6839\u636e\u573a\u666f\u8865\u5145\u4e86\u5982\u4e0b\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u548c\u7c7b\u578b\uff1a</p> \u62d3\u5c55 \u542b\u4e49 \u9ed8\u8ba4\u503c isAsync \u8868\u793aJsApi\u662f\u5426\u662f\u5f02\u6b65 true isEvent \u8868\u793a\u662f\u5426\u662f\u4ece\u5c0f\u7a0b\u5e8f\u5bb9\u5668\u4fa7\u8c03\u7528\u81f3\u5c0f\u7a0b\u5e8f\u4fa7\uff0c\u4e00\u822c\u662f\u4e8b\u4ef6\u573a\u666f\uff0c\u5728\u65b9\u6cd5\u8fd4\u56de\u7c7b\u578b\u4e2d\u5b9a\u4e49\u4e8b\u4ef6\u6570\u636e\u7ed3\u6784\u3002 false Void \u5f53\u4e0d\u9700\u8981\u8bf7\u6c42\u53c2\u6570\uff0c\u6216\u8005\u4e0d\u9700\u8981\u8fd4\u56de\u7ed3\u679c\uff0c\u7528\u6b64\u5360\u4f4d\u3002 androidOnly \u8868\u793a\u4ec5\u9650\u5b89\u5353 windowsOnly \u8868\u793a\u4ec5\u9650Windows <p>\u6ce8\u610f\uff0c\u5f53\u4f7f\u7528\u5230<code>isAsync</code>, <code>isEvent</code>, <code>Void</code>\u65f6\uff0c\u6211\u4eec\u63a8\u8350\u4f7f\u7528<code>import \"rocket.proto\";</code>\u7684\u65b9\u5f0f\u6765\u5bfc\u5165\u8fd9\u4e9b\u9009\u9879\u3001\u7c7b\u578b\u7684\u5b9a\u4e49\u3002<code>rocket.proto</code>\u53ef\u4ee5\u5728<code>example</code>\u76ee\u5f55\u4e0b\u627e\u5230\u3002</p> <p>\u4e0b\u9762\u901a\u8fc7\u7ed9\u65b9\u6cd5\u914d\u7f6e<code>isAsync</code>\u5b57\u6bb5\u4e3a<code>false</code>\u6765\u6539\u53d8JsApi\u4e3a\u540c\u6b65\u5f62\u5f0f\u3002 <pre><code>rpc syncApi(Request) returns (Response) { option (isAsync) = false; }\n</code></pre> \u800c\u5bf9\u4e8e\u4ece\u5c0f\u7a0b\u5e8f\u5bb9\u5668\u4fa7\u4e3b\u52a8\u8c03\u7528\u5230\u5c0f\u7a0b\u5e8f\u4fa7\u7684JsApi\uff0c\u9700\u8981<code>isEvent</code>\u5b57\u6bb5\u8bbe\u4e3atrue\u3002\u5728\u8fd4\u56de\u7ed3\u679c\u4e2d\u4f20\u5165\u6570\u636e\u4f53\u5b9a\u4e49\u3002 <pre><code>rpc onSomeEvent(Void) returns (Response) { option (isEvent) = true; }\n</code></pre> \u6b64\u5916\uff0c\u5982\u679c\u4e0d\u9700\u8981\u4efb\u4f55\u8bf7\u6c42\u53c2\u6570\uff0c\u6216\u8005\u4e0d\u9700\u8981\u4efb\u4f55\u8fd4\u56de\u7ed3\u679c\uff0c\u5219\u5c06\u5bf9\u5e94\u7c7b\u578b\u7528<code>Void</code>\u4ee3\u66ff\u3002 <pre><code>rpc asyncApiNoParamNoResponse(Void) returns (Void) {}\n</code></pre></p> <p>\u9664\u4e86\u4e0a\u8ff0\u7684\u81ea\u5b9a\u4e49\u62d3\u5c55\uff0c\u6211\u4eec\u8fd8\u652f\u6301\u5982\u4e0b\u7684<code>proto</code>\u7279\u6027\uff1a - optional\u5b57\u6bb5 - \u679a\u4e3e\u7c7b\u578b - \u5d4c\u5957\u7c7b\u578b - repeated\u5b57\u6bb5</p> <p>\u4f7f\u7528\u8fd9\u4e9b\u7279\u6027\u53ef\u4ee5\u6709\u6548\u5e2e\u52a9\u5b9a\u4e49JsApi\u7684\u6570\u636e\u7ed3\u6784\u3002\u6bd4\u5982\uff1a</p> <pre><code>message SomeActionRequest {\n  Action action = 1;\n\n  enum Action {\n    Play = 0;\n    Pause = 1;\n    Stop = 2;\n  }\n}\n\nmessage SomeActionResponse {\n  optional PlayActionResult playActionResult = 1;\n  optional PauseActionResult pauseActionResult = 2;\n}\n</code></pre>"},{"location":"Javascript/JsApi%20proto/#_1","title":"\u4ee3\u7801\u751f\u6210","text":""},{"location":"Javascript/JsApi%20proto/#protoc-rocket","title":"protoc-rocket\u5de5\u5177","text":"<p><code>protoc-rocket</code>\u5de5\u5177\u662f\u4e00\u4e2a\u65b9\u4fbf\u4e3aJsApi proto\u751f\u6210<code>.ts</code>, <code>.java</code>\u6587\u4ef6\u7684\u5de5\u5177\u3002\u5b83\u5185\u7f6e\u4e86<code>protoc</code>\uff0c\u5e76\u4f1a\u81ea\u884c\u4e0b\u8f7d\u6700\u65b0\u7684ts/java\u63d2\u4ef6\uff0c\u53ea\u9700\u8981\u4e00\u53e5\u547d\u4ee4\u5373\u53ef\u751f\u6210\u6240\u9700\u7684\u6587\u4ef6\u3002</p> <p>\u5728\u5b89\u88c5nodejs\u73af\u5883\u540e\uff0c\u5b89\u88c5tnpm\uff08\u82e5\u5df2\u6709tnpm\u5219\u8df3\u8fc7\uff09\uff1a <pre><code>npm install tnpm -g --registry=https://registry.npm.alibaba-inc.comssssss\n</code></pre> \u5b89\u88c5<code>protoc-rocket</code>: <pre><code>tnpm install -g @aasflipay/protoc-rocket\n</code></pre> \u4e4b\u540e\u5373\u53ef\u5f00\u59cb\u4f7f\u7528<code>protoc-rocket</code>\u4e86\u3002\u4e86\u89e3\u66f4\u591a\u80cc\u540e\u7ec6\u8282\uff0c\u8bf7\u67e5\u9605\u4ed3\u5e93\u3002</p>"},{"location":"Javascript/JsApi%20proto/#_2","title":"\u5728\u5de5\u7a0b\u4e2d\u4f7f\u7528","text":""},{"location":"Javascript/JsApi%20proto/#rocket","title":"Rocket\u5c0f\u7a0b\u5e8f","text":"<p>\u9996\u5148\u8981\u4e3aRocket\u5c0f\u7a0b\u5e8f\u914d\u7f6etypescript\u73af\u5883\uff0c\u5efa\u8bae\u5b89\u88c5\u5168\u5c40\u7684typescript\uff08\u5982\u679c\u5df2\u6709\u8bf7\u8df3\u8fc7\uff09\uff1a <pre><code>npm install -g typescript\n</code></pre></p> <p>\u521b\u5efa\u9875\u9762\u7684ts\u6587\u4ef6<code>your-page.ts</code>\u5e76\u5c06<code>your-page.vue</code>\u4e2dscript\u90e8\u5206\u7531\u524d\u8005\u5bfc\u5165\uff0c\u6bd4\u5982\uff1a <pre><code>&lt;template&gt;\n  &lt;div class=\"page home-page\"&gt;\n    &lt;text&gt;{{ content }}&lt;/text&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nexport default your-page.default; //\u5b8c\u5168\u4ea4\u7ed9.ts\u8f93\u51fa\u7684\u72ec\u7acb.js\u6587\u4ef6\u5bfc\u5165\n&lt;/script&gt;\n</code></pre> \u540c\u65f6\u5728<code>manifest.json</code>\u4e2d\u5bf9\u8be5\u9875\u9762\u589e\u52a0<code>import</code>\u914d\u7f6e\uff0c\u7531\u6b64\u5728typescript\u7f16\u8bd1\u540e\u5f97\u5230\u9875\u9762\u7684\u72ec\u7acb<code>.js</code>\u6587\u4ef6\u5e76\u88ab<code>.vue</code>\u6587\u4ef6\u5bfc\u5165\u3002 <pre><code>  \"pages\": [\n    {\n      \"key\": \"...\",\n      \"index\": \"./pages/home/your-page\",\n      \"imports\": [\n        {\n          \"alias\": \"your-page\",\n          \"path\": \"./pages/home/your-page.js\"\n        }\n      ]\n    }\n  ]\n</code></pre> \u6b64\u65f6\u5c0f\u7a0b\u5e8f\u5de5\u7a0b\u5177\u5907\u4e86typescript\u73af\u5883\u3002\u63a5\u7740\u76f4\u63a5\u4f7f\u7528<code>protoc-rocket</code>\u5de5\u5177\u5373\u53ef\u751f\u6210<code>.ts</code>\u6587\u4ef6\u5230\u76ee\u6807\u5de5\u7a0b\uff1a <pre><code>protoc-rocket path/to/proto -I=path/to/proto_folder --ts_out=project/src/jsapi\n</code></pre> \u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd8\u53ef\u4ee5\u628a\u8fd9\u4e2a\u547d\u4ee4\u6dfb\u52a0\u5230<code>package.json</code>\u4e2d\u65b9\u4fbf\u4f7f\u7528\uff1a <pre><code>{\n   \"scripts\": {\n    ...\n    \"protoc:ts\": \"protoc-rocket jsapi/proto/local/path -I=jsapi/proto/local/folder --ts_out=src/api\"\n  } \n}\n</code></pre></p> <p>\u5982\u679c\u4ecd\u7136\u6709\u56f0\u60d1\uff0c\u53ef\u4ee5\u53c2\u8003\u6837\u677f\u5de5\u7a0b\uff1aexample-proto2ts-rocket-miniapp</p>"},{"location":"Javascript/JsApi%20proto/#java","title":"Java\u5de5\u7a0b","text":"<p>\u5728Gradle\u5de5\u7a0b\u4e2d\uff0c\u63a8\u8350\u4f7f\u7528<code>protobuf-gradle-plugin</code>\u63d2\u4ef6\u3002\u518d\u914d\u7f6e\u4e0bJava\u63d2\u4ef6\u8def\u5f84\uff0c\u6dfb\u52a0JsApi proto\u8def\u5f84\u5230proto sourceSet\u5373\u53ef\u3002\u6a21\u5757build.gradle\u914d\u7f6e\u53c2\u8003\u5982\u4e0b\uff1a <pre><code>Properties properties = new Properties()\nproperties.load(project.rootProject.file('local.properties').newDataInputStream())\n\nandroid {\n    sourceSets {\n        main {\n            proto {\n                // In addition to the default 'src/main/proto'\n                def jsapiProtoPath = properties.getProperty(\"jsapi.proto.dir\")\n                if (jsapiProtoPath != null &amp;&amp; !jsapiProtoPath.isEmpty()) {\n                    srcDir jsapiProtoPath\n                }\n            }\n        }\n    }\n}\n\nprotobuf {\n    protoc {\n        artifact = 'com.google.protobuf:protoc:3.18.0'\n    }\n    plugins {\n        rocket {\n            // use remote artifact in future. Or use your any local path.\n            path = rootDir.absolutePath + '/protoc-rocket-plugin-java/lib/bin/lib'\n        }\n    }\n    generateProtoTasks {\n        all().each { task -&gt;\n            task.builtins {\n                remove java\n            }\n\n            task.plugins {\n                rocket {\n                    option \"container=tiny\"\n                }\n            }\n        }\n    }\n}\n</code></pre></p> <p>\u9664\u4e86<code>protobuf-gradle-plugin</code>\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>protoc-rocket</code>\u5de5\u5177\u4eceJsApi proto\u751f\u6210<code>.java</code>\u6587\u4ef6\u5230\u76ee\u6807\u5de5\u7a0b\uff1a <pre><code>protoc-rocket path/to/proto -I=path/to/proto_folder java_out=project/src/main/java\n</code></pre> \u5177\u4f53\u8def\u5f84\u8bf7\u6839\u636e\u672c\u5730\u73af\u5883\u66f4\u6539\u3002</p>"},{"location":"Javascript/JsApi%20proto/#_3","title":"\u6587\u6863\u751f\u6210","text":"<p>JsApi proto\u53ef\u4ee5\u8f7b\u677e\u83b7\u53d6JsApi\u7684\u5404\u7c7b\u4fe1\u606f\uff0c\u4e5f\u5305\u62ec\u6ce8\u91ca\u4fe1\u606f\u3002\u4ece\u800c\u53ef\u4ee5\u8f7b\u677e\u8f93\u51faJsApi\u6587\u6863\uff0c\u53ef\u4ee5\u5927\u5e45\u65b9\u4fbf\u5bf9\u5185\u3001\u5bf9\u5916\u7684\u67e5\u9605\u3002\u5982\u4e0b\uff1a</p> <p> </p>"},{"location":"Javascript/JsApi%20proto/#qa","title":"Q&amp;A","text":"Question Anwser \u4e3a\u4f55\u4e0d\u4f7f\u7528protoc\u5185\u7f6e\u7684\u4ee3\u7801\u751f\u6210\u5668\u800c\u8981\u81ea\u5199\uff1f \u4e3b\u8981\u56e0\u4e3aprotoc\u5185\u7f6e\u7684js/java\u4ee3\u7801\u751f\u6210\u5668\u751f\u6210\u7684\u4ee3\u7801\u91cf\u8f83\u5927\uff0c\u4e14\u4e0d\u9002\u7528\u4e8e\u5f53\u524d\u573a\u666f\u3002\u8be6\u89c1<code>protoc-rocket-plugin-java</code>\u4ed3\u5e93\u6587\u6863\u3002 \u6709\u54ea\u4e9b\u7f3a\u70b9\uff1f \u7a0d\u589e\u52a0\u4e86\u5de5\u7a0b\u590d\u6742\u5ea6\u3001\u7a0d\u589e\u52a0\u4e86\u5305\u4f53\u79ef\uff0c\u4e0d\u652f\u6301\u90e8\u5206proto\u8bed\u6cd5\u3002\u6682\u4e0d\u652f\u6301\u5b57\u6bb5\u9ed8\u8ba4\u503c\u3002 \u652f\u6301C/C++\u5417\uff1f \u9700\u8981\u81ea\u5199\u4e00\u4e2aC/C++\u7684\u63d2\u4ef6\u6765\u652f\u6301\u3002 \u548cprotobuf\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u76ee\u524d\u53ea\u4f7f\u7528\u4e86Json\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u3002\u4f46\u751f\u6210\u4ee3\u7801\u98ce\u683c\u548cprotobuf\u4fdd\u6301\u4e00\u81f4\uff0c\u672a\u6765\u82e5\u6709\u9700\u8981\uff0c\u53ef\u4ee5\u65e0\u7f1d\u66ff\u6362\u5230protobuf\u7684\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u65b9\u5f0f\u3002 \u8c03\u7528\u7684\u5bb9\u5668\u4fa7JsApi\u662f\u6cdb\u5316\u7684\u8fd8\u662f\u5404\u81ea\u5355\u72ec\u7684\uff1f \u6211\u4eec\u63d0\u4f9b\u4e86<code>useGenericBridge</code>\u9009\u9879\u4ee5\u5141\u8bb8\u5728\u65b9\u6cd5\u7ef4\u5ea6\u5207\u6362\u4f7f\u7528\u6cdb\u5316\u5bb9\u5668\u4fa7\u63a5\u53e3\u3002"},{"location":"Javascript/JsApi%20proto/#_4","title":"\u76f8\u5173\u4ed3\u5e93","text":"<ul> <li>protoc-rocket protoc-rocket \u5de5\u5177\u3002</li> <li>protoc-rocket-plugin-java protoc java\u63d2\u4ef6\uff0c\u7528\u4e8e\u8f93\u51fajava\u6587\u4ef6\u3002</li> <li>protoc-rocket-plugin-ts protoc ts\u63d2\u4ef6\uff0c\u7528\u4e8e\u8f93\u51fats\u6587\u4ef6\u3002</li> <li>example-proto2ts-rocket-miniapp \u5305\u542b\u4e86typescript\u548cJsApi proto\u751f\u6210\u7684\u5c0f\u7a0b\u5e8f\u6837\u677f\u5de5\u7a0b\u3002</li> </ul>"},{"location":"Javascript/js%20this%2C%20prototype/","title":"Js this, prototype","text":""},{"location":"Javascript/js%20this%2C%20prototype/#this","title":"this","text":"<ul> <li>\u5728\u5168\u5c40\u6267\u884c\u73af\u5883\u4e2d\uff08\u6d4f\u89c8\u5668\u73af\u5883\uff09\uff0c<code>this</code>\u5373<code>window</code>\u3002</li> <li>\u5728\u51fd\u6570\u5185\uff0c<code>this</code>\u53d6\u503c\u53d6\u51b3\u4e8e\u51fd\u6570\u8c03\u7528\u65b9\u5f0f\uff1a<ul> <li>\u82e5\u5728\u975e\u4e25\u683c\u6a21\u5f0f\u4e0b\uff0c\u6ca1\u6709\u8bbe\u7f6e<code>this</code>\uff0c\u5219\u4e00\u822c\u4f9d\u7136\u6307\u5411\u5168\u5c40\u3002\u5bf9\u6d4f\u89c8\u5668\u662f<code>window</code></li> <li>\u82e5\u5728\u4e25\u683c\u6a21\u5f0f\u4e0b\uff0c\u5219\u4f1a\u662f<code>undefined</code></li> <li>\u53ef\u4ee5\u4f7f\u7528<code>call</code>, <code>apply</code>\u6765\u8bbe\u7f6e\u51fd\u6570\u5185\u7684<code>this</code>\u53d6\u503c\u3002\u6b64\u5916\u8fd8\u6709ES5\u5f15\u5165\u7684<code>bind</code> <pre><code>// \u5bf9\u8c61\u53ef\u4ee5\u4f5c\u4e3a bind \u6216 apply \u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\uff0c\u5e76\u4e14\u8be5\u53c2\u6570\u5c06\u7ed1\u5b9a\u5230\u8be5\u5bf9\u8c61\u3002\nvar obj = {a: 'Custom'};\n\n// \u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\uff0c\u5e76\u5c06\u8be5\u53d8\u91cf\u4f5c\u4e3a\u5168\u5c40\u5bf9\u8c61 window \u7684\u5c5e\u6027\u3002\nvar a = 'Global';\n\nfunction whatsThis() {\n  return this.a;  // this \u7684\u503c\u53d6\u51b3\u4e8e\u51fd\u6570\u88ab\u8c03\u7528\u7684\u65b9\u5f0f\n}\n\nwhatsThis();          // 'Global' \u56e0\u4e3a\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d this \u6ca1\u6709\u88ab\u8bbe\u5b9a\uff0c\u6240\u4ee5\u5b83\u9ed8\u8ba4\u4e3a \u5168\u5c40/ window \u5bf9\u8c61\nwhatsThis.call(obj);  // 'Custom' \u56e0\u4e3a\u51fd\u6570\u4e2d\u7684 this \u88ab\u8bbe\u7f6e\u4e3aobj\nwhatsThis.apply(obj); // 'Custom' \u56e0\u4e3a\u51fd\u6570\u4e2d\u7684 this \u88ab\u8bbe\u7f6e\u4e3aobj\n\n//\u53e6\u4e00\u4e2a\u4f8b\u5b50\nfunction add(c, d) {\n  return this.a + this.b + c + d;\n}\n\nvar o = {a: 1, b: 3};\n\n// \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7528\u4f5c\u201cthis\u201d\u7684\u5bf9\u8c61\n// \u5176\u4f59\u53c2\u6570\u7528\u4f5c\u51fd\u6570\u7684\u53c2\u6570\nadd.call(o, 5, 7); // 16\n\n//bind\u4f8b\u5b50\u3002\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u76f8\u540c\u51fd\u6570\u4f53\uff0c\u4f46this\u6c38\u4e45\u88ab\u7ed1\u5b9a\u4e3a\u4e86bind\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002\nfunction f(){\n  return this.a;\n}\n\nvar g = f.bind({a:\"azerty\"});\nconsole.log(g()); // azerty\n\nvar h = g.bind({a:'yoo'}); // bind\u53ea\u751f\u6548\u4e00\u6b21\uff01\nconsole.log(h()); // azerty\n\nvar o = {a:37, f:f, g:g, h:h};\nconsole.log(o.a, o.f(), o.g(), o.h()); // 37, 37, azerty, azerty\n</code></pre></li> </ul> </li> <li>\u5728\u7c7b\u6784\u9020\u51fd\u6570\u4e2d\uff0c<code>this</code>\u539f\u578b\u4f1a\u7ed1\u5b9a\u8be5\u7c7b\u6240\u6709\u7684\u975e\u9759\u6001\u65b9\u6cd5\uff08\u4ec5\u57fa\u7c7b\uff09\uff0c\u82e5\u662f\u6d3e\u751f\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u5219\u6ca1\u6709\u521d\u59cb\u7684this\u7ed1\u5b9a\uff0c\u56e0\u4e3a\u9700\u8981\u8c03\u7528<code>super(..)</code>\u7531\u6b64<code>this</code>\u4f9d\u7136\u662f\u57fa\u7c7b\u7684\u60c5\u51b5\u3002 <pre><code>class Example {\n  constructor() {\n    const proto = Object.getPrototypeOf(this);\n    console.log(Object.getOwnPropertyNames(proto));\n  }\n  first(){}\n  second(){}\n  static third(){}\n}\n\nnew Example(); // ['constructor', 'first', 'second']\n</code></pre></li> <li> <p>\u5bf9\u8c61\u7684\u65b9\u6cd5\u4e2d\u7684<code>this</code>\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u8be5\u5bf9\u8c61\u3002\u5b83\u4e0d\u53d7\u5b9a\u4e49\u65b9\u6cd5\u7684\u65b9\u5f0f\u5f71\u54cd\uff0c\u5982\u4e0b\uff1a <pre><code>var o = {\n  prop: 37,\n  f: function() {\n    return this.prop;\n  }\n};\n\nconsole.log(o.f()); // 37\n\n//\u5373\u4f7f\u5982\u4e0b\u8fd9\u6837\u5b9a\u4e49\u4e5f\u53ef\u4ee5\nvar o = {prop: 37};\n\nfunction independent() {\n  return this.prop;\n}\n\no.f = independent;\n\nconsole.log(o.f()); // 37\n</code></pre></p> </li> <li> <p>\u7bad\u5934\u51fd\u6570\u7684this\u548c\u5c01\u95ed\u8bcd\u6cd5\u73af\u5883\u7684this\u4fdd\u6301\u4e00\u81f4\u3002\u5e76\u4e14\u5b83\u4e0d\u4f1a\u88ab<code>call</code>, <code>apply</code>, <code>bind</code>\u6539\u53d8\u3002 <pre><code>var globalObject = this;\nvar foo = (() =&gt; this);\nconsole.log(foo() === globalObject); // true\n// \u4f5c\u4e3a\u5bf9\u8c61\u7684\u4e00\u4e2a\u65b9\u6cd5\u8c03\u7528\nvar obj = {foo: foo};\nconsole.log(obj.foo() === globalObject); // true\n\n// \u5c1d\u8bd5\u4f7f\u7528call\u6765\u8bbe\u5b9athis\nconsole.log(foo.call(obj) === globalObject); // true\n\n// \u5c1d\u8bd5\u4f7f\u7528bind\u6765\u8bbe\u5b9athis\nfoo = foo.bind(obj);\nconsole.log(foo() === globalObject); // true\n</code></pre></p> </li> </ul>"},{"location":"Javascript/js%20this%2C%20prototype/#prototype","title":"prototype","text":""},{"location":"Javascript/js%20this%2C%20prototype/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>mdn this</li> </ul>"},{"location":"Kotlin/Kotlin%20Basics/","title":"Kotlin Basics","text":"<p>\u6b64\u6587\u6863\u8f83\u65e9\uff0c\u4ec5\u505a\u9057\u7559\u4ea7\u7269</p> <p>\u8fd9\u91cc\u4e3b\u8981\u8bb2\u89e3Kotlin\u8f6c\u4e3a\u5b57\u8282\u7801\u7684\u65f6\u5019\uff0c\u5c24\u5176\u548cJava\u76f8\u6bd4\uff0c\u662f\u5982\u4f55\u5b9e\u73b0\u5b83\u7684\u4e00\u4e9b\u8bed\u6cd5\u7279\u6027\u7684\u3002</p>"},{"location":"Kotlin/Kotlin%20Basics/#_1","title":"\u4e0d\u9700\u8981\u7c7b\uff0c\u53ef\u4ee5\u50cf\u51fd\u6570\u5f0f\u3001\u811a\u672c\u4e00\u6837\u8fd0\u884c","text":"<p>\u7f16\u8bd1\u5668\u81ea\u52a8\u6309\u6587\u4ef6\u540d\u751f\u6210\u4e86\u5bf9\u5e94\u7684class\u540d\u7684\u5916\u5c42\u5305\u88c5\uff08final\u4fee\u9970\uff09\u3002\u5b9a\u4e49\u7684\u51fd\u6570\u90fd\u4f1a\u8f6c\u4e3astatic\u7684\u8c03\u7528\u3002\u7531\u4e8e\u6709main\u4f5c\u4e3a\u4e3b\u51fd\u6570\u5165\u53e3\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u4f1a\u7c7b\u4f3cJava\u7684static void main\u5165\u53e3\u3002</p>"},{"location":"Kotlin/Kotlin%20Basics/#_2","title":"\u53c2\u6570\u9ed8\u8ba4\u503c\uff0c\u53ef\u9009\u5165\u53c2\uff0c\u547d\u540d\u5165\u53c2","text":"<p>\u8fd9\u4e9b\u7279\u6027\u7b97\u662f\u5728\u4e00\u4e2a\u65b9\u6848\u91cc\u5b9e\u73b0\u7684\u3002\u65e0\u8bba\u4e00\u4e2a\u65b9\u6cd5\u6709\u591a\u5c11\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\uff08\u6b64\u65f6\u5df2\u7ecf\u6210\u4e3a\u53ef\u9009\u5165\u53c2\uff0c\u4ee5\u53ca\u652f\u6301\u547d\u540d\u5165\u53c2\uff09\uff0c\u90fd\u4f1a\u5728\u6211\u4eec\u5b9a\u4e49\u4e4b\u5916\u518d\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u76f8\u6bd4\u4e8e\u666e\u901a\u7684\u5b9a\u4e49\uff0c\u591a\u4e86\u4e00\u4e2aint\u548cobject\u7684\u5165\u53c2\u3002object\u7684\u5165\u53c2\u542b\u4e49\u6682\u4e14\u6ca1\u53d1\u73b0\u3002\u4f46int\u662f\u501f\u52a9\u4f4d\u6765\u6807\u8bc6\u6709\u54ea\u4e9b\u6709\u6548\u5165\u53c2\uff0c\u56e0\u6b64\u82e5\u53d1\u73b0\u65e0\u6548\u5165\u53c2\uff0c\u5219\u53ef\u4ee5\u5bf9\u5176\u8d4b\u503c\u4e3a\u9ed8\u8ba4\u503c\u3002\u89c1\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a</p> <pre><code>//\u65b9\u6cd5\u539f\u578b\ntest(p1:String = \"def1\", p2:String = \"def2\", p3:String = \"def3\")\n//\u81ea\u52a8\u751f\u6210\ntest(p1, p2, p3, int, object)\n//int\u4ece\u53f3\u5230\u5de6\uff0c\u6bcf\u4e00\u4f4d\u90fd\u6807\u8bc6\u4e86\u7b2c\u51e0\u4e2a\u53c2\u6570\u662f\u5426\u6709\u6548\uff0c1\u6807\u8bc6\u662f\u6709\u6548\u5165\u53c2\uff0c0\u6807\u8bc6\u65e0\u6548\u5165\u53c2\uff0c\u8981\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002\n//\u6700\u540e\u4e3ap1,p2,p3\u5b8c\u6210\u521d\u59cb\u8d4b\u503c\u540e\uff0c\u8c03\u7528\u771f\u6b63\u7684\u51fd\u6570\u539f\u578btest(p1,p2,p3)\n</code></pre>"},{"location":"Kotlin/Kotlin%20Basics/#vs","title":"== vs ===","text":"<p><code>==</code>\u53ef\u4ee5\u7c7b\u6bd4Object.equals()\uff0c\u800c<code>===</code>\u53ef\u4ee5\u7c7b\u6bd4\u6307\u9488\u5f15\u7528\u662f\u5426\u76f8\u7b49\u3002</p>"},{"location":"Kotlin/Kotlin%20Basics/#lambda","title":"lambda","text":"<p>kotlin\u4e2d\u7684lambda\u5b9e\u73b0\u548cjava\u5b8c\u5168\u4e0d\u540c\u3002\u6709\u591a\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u5982\u679c\u662f\u5185\u8054\u65b9\u6cd5\uff0c\u5219lambda\u4ee3\u7801\u5757\u4f1a\u88ab\u5185\u8054\u8fdb\u5165\u8c03\u7528\u8005\uff0c\u6b64\u65f6\u6ca1\u6709\u4ec0\u4e48\u5305\u88c5\u3002</li> <li>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4ee3\u7801\u5757\u4f1a\u88ab\u5305\u88c5\u4e3a<code>kotlin.jvm.internal.Lambda</code>\u7684\u5b50\u7c7b\uff0c\u5e76\u6839\u636e\u6240\u5305\u542b\u7684\u53c2\u6570\u60c5\u51b5\u5b9e\u73b0<code>FunctionX</code>\u63a5\u53e3\u518d\u8fdb\u884c\u4f20\u9012\u3002</li> </ul>"},{"location":"Kotlin/Kotlin%20Flow%20Channel/","title":"Kotlin Flow Channel","text":""},{"location":"Kotlin/Kotlin%20Flow%20Channel/#flow","title":"Flow","text":"<p>Flow\u4e00\u822c\u610f\u4e49\u4e0a\u4ee3\u8868\u4e00\u7ec4\u72ec\u7acb\u7684\u5f02\u6b65\u6570\u636e\u3002\u201c\u72ec\u7acb\u201d\u610f\u5473\u7740\uff0c\u5bf9\u540c\u4e00\u4e2aFlow\u7c7b\u578b\u7684\u4e0d\u540c\u5b9e\u4f8b\u8fdb\u884ccollect\uff0c\u90fd\u5e94\u8be5\u5404\u81ea\u5f97\u5230\u9884\u671f\u7684\u5f02\u6b65\u6570\u636e\u3002Flow\u5728Collect\u7684\u65f6\u5019\u5f00\u59cb\u4ea7\u751f\u5f02\u6b65\u6570\u636e\u3002\u8fd9\u4e5f\u88ab\u79f0\u4e3a\u201c\u51b7\u6d41\u201d\u3002\u4f46\u8fd8\u6709\u4e00\u7c7b<code>SharedFlow</code>\u5219\u662f\u975e\u5e38\u89c4\u7684\u6d41\uff0c\u88ab\u79f0\u4e3a\u201c\u70ed\u6d41\u201d\uff0c\u56e0\u4e3a\u5b83\u4eec\u6c38\u4e0d\u5b8c\u6210\uff0c\u800c\u4e14\u7528\u4e8e\u4ee5\u5e7f\u64ad\u5f62\u5f0f\u5171\u4eab\u6240\u6709\u53d1\u9001\u7684\u503c\u3002</p>"},{"location":"Kotlin/Kotlin%20Flow%20Channel/#channel","title":"Channel","text":"<p>Channel\u5219\u4ee3\u8868\u4e86\u66f4\u4e00\u822c\u7684\uff0c\u534f\u7a0b\u4e0a\u7684\u5f02\u6b65\u6570\u636e\uff0c\u5b83\u7684\u4ea7\u751f\u548c\u63a5\u6536\u90fd\u662f\u66f4\u52a0\u5f39\u6027\u7684\uff0c\u4e14\u5bf9\u540c\u4e00\u4e2aChannel\u5b9e\u4f8b\u63a5\u6536\uff0c\u4f1a\u516c\u5e73\u5730\u63a5\u6536\u4e0b\u4e00\u4e2a\u6570\u636e\u3002</p> <p>Channel\u5219\u5305\u542b\u4e86SendChannel\u548cReceiveChannel\uff0c\u4ee3\u8868\u4e86\u6570\u636e\u53d1\u9001\u548c\u6570\u636e\u63a5\u53d7\u7684\u5177\u4f53\u884c\u4e3a\u3002Channel\u4e2d\u7684\u6570\u636e\uff0c\u9ed8\u8ba4\u4f1a\u91c7\u7528\u201c\u76f8\u9047\u201d\u7b56\u7565\uff0c\u53d1\u9001\u8005\u53d1\u9001\u540e\u7b49\u5f85\u63a5\u53d7\u8005\u63a5\u6536\uff0c\u63a5\u53d7\u8005\u63a5\u6536\u65f6\u4f1a\u7b49\u5f85\u53d1\u9001\u8005\u53d1\u9001\uff0c\u5426\u5219\u5747\u4f1a\u963b\u585e\u3002\u4e5f\u53ef\u4ee5\u66f4\u6539\u4e3a\u5176\u4ed6\u7b56\u7565\uff0c\u7c7b\u4f3c\u53ef\u4ee5\u7f13\u5b58\u6307\u5b9a\u6570\u91cf\u7684\u5143\u7d20\uff0c\u6216\u8005\u4e00\u76f4\u4fdd\u7559\u6700\u65b0\u7684\u3002\u53e6\u5916\uff0c\u4e00\u822c\u7684Channel\u7684\u63a5\u53d7\u8005\uff0c\u90fd\u662f\u6309\u8c03\u7528\u63a5\u6536\u7684\u987a\u5e8f\uff0c\u516c\u5e73\u5730\u4e00\u4e2a\u4e00\u4e2a\u63a5\u6536\u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u82e5\u9700\u8981\u5e7f\u64ad\u5f62\u5f0f\u7684\u63a5\u6536\uff0c\u5219\u9700\u8981<code>BroadcastChannel</code>\uff0c\u5b83\u5b9e\u9645\u662f\u4e00\u4e2a<code>SendChannel</code>\u3002</p>"},{"location":"Kotlin/Kotlin%20Flow%20Channel/#stateflow","title":"StateFlow","text":"<p><code>StateFlow: SharedFlow</code>, <code>MutableStateFlow:MutableSharedFlow</code></p> <p>\u5b83\u662f\u4e00\u4e2a\u7279\u6b8a\u7684flow\u3002\u5728android\u5f00\u53d1\u66f4\u4e3a\u5e38\u7528\uff0c\u5176\u7279\u70b9\u5728\u4e8e\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u72b6\u6001\u3002\u968f\u65f6\u53ef\u4ee5\u8bfb\u53d6\u6765\u83b7\u53d6\u76ee\u524d\u7684\u72b6\u6001\uff0c\u4e5f\u53ef\u4ee5\u4ee5<code>collect</code>\u65b9\u5f0f\u8ba2\u9605\u72b6\u6001\u53d8\u5316\u3002\u5b83\u7c7b\u4f3c<code>LiveData</code>\uff0c\u5c24\u5176\u5f53\u914d\u5408<code>lifecycleScope</code>\u4e00\u8d77\u4f7f\u7528\u7684\u65f6\u5019\u3002\u6bd4\u5982<code>lifecycleScope.launchWhenStart{ someState.collect{} }</code>\u3002\u5728collect\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5148\u6536\u5230\u5f53\u524d\u72b6\u6001\u3002\u6b64\u5916\u591a\u4e2a\u6536\u96c6\u5668\u6536\u96c6\u65f6\uff0c\u90fd\u4f1a\u5f97\u5230\u5206\u53d1\uff0c\u56e0\u4e3a\u5b83\u4e5f\u662f<code>SharedFlow</code>\uff0c\u56e0\u6b64\u5b83\u7684\u8ba2\u9605\u662f\u65e0\u6b62\u5883\u7684\uff0c\u4e14\u662f\u5e7f\u64ad\u5f62\u5f0f\u5171\u4eab\u7684\u3002</p>"},{"location":"Kotlin/Kotlin%20Flow%20Channel/#sharedflow","title":"SharedFlow","text":"<p>\u8ba2\u9605\u8005\u4ee5<code>slot</code>\u65b9\u5f0f\u7ef4\u62a4\uff0c<code>slot</code>\u4f1a\u5728<code>collect</code>\u65b9\u6cd5\u4e2d\u8fdb\u5165\u5faa\u73af\uff0c\u5e76\u4e00\u822c\u5f00\u542f\u4e00\u4e2a\u534f\u7a0b\u6765\u7b49\u5f85\u5524\u8d77\u3002\u5524\u8d77\u540e\u5373\u53ef\u8bfb\u53d6\u65b0\u7684emit\u503c\u3002</p>"},{"location":"Kotlin/Kotlin%20Flow%20Channel/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<p>Kotlin\u8d1f\u8d23\u4eba\u7684Cold flow, Hot channel\u6587\u7ae0 Flow &amp; Channel\u7406\u89e3\u3001\u5bf9\u6bd4</p>"},{"location":"Kotlin/Kotlin%20in%20out%20%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98/","title":"Kotlin in out \u534f\u53d8\u3001\u9006\u53d8","text":"<p>in, out\u7684\u4f7f\u7528\u5bf9\u6211\u4e00\u76f4\u6709\u4e00\u4e9b\u56f0\u60d1\uff0c\u603b\u89c9\u5f97\u4e0d\u5982Java\u7684<code>T extends xxx</code>, <code>T super Xxx</code>\u597d\u7528\u3001\u597d\u7406\u89e3\uff0c\u4f46\u540e\u6765\u53d1\u73b0\uff0c<code>in, out</code>\u51fa\u73b0\u662f\u4e3a\u4e86\u5f25\u8865\u4e00\u4e9bJava\u6cdb\u578b\u5e26\u6765\u7684\u7f3a\u5931\u4e4b\u5904\u7684\u3002</p>"},{"location":"Kotlin/Kotlin%20in%20out%20%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98/#in-out-position","title":"in, out position","text":"<p>in\u548cout\u662f\u5bf9\u5e94\u4e86\u4e0d\u540c\u7684position\u7684\u3002\u5bf9\u4e8ein position\uff0c\u662f\u6307\u5728\u65b9\u6cd5\u53c2\u6570\u4e4b\u4e2d\u51fa\u73b0\u7684\u7c7b\u578b\u53c2\u6570\u3002\u5bf9\u4e8eout position\uff0c\u662f\u6307\u65b9\u6cd5\u8fd4\u56de\u7ed3\u679c\u7c7b\u578b\u3002\u4e5f\u5c31\u662f\u8bf4\uff1a - in/out\u7528\u4e8e\u4fee\u9970\u7c7b\u578b\u53c2\u6570 - in/out\u4fee\u9970\u7c7b\u578b\u53c2\u6570\u7684\u4f4d\u7f6e\u4e0d\u4e00\u6837\uff0cin\u53ef\u4ee5\u4fee\u9970\u65b9\u6cd5\u5165\u53c2\uff0cout\u53ef\u4ee5\u4fee\u9970\u65b9\u6cd5\u8fd4\u56de\u7ed3\u679c\u3002\u6b64\u5916\uff0c\u5bf9\u4e8e\u5728interface, class\u58f0\u660e\u7684\u7c7b\u578b\u53c2\u6570\uff0cin/out\u5747\u53ef\u4ee5\u4f7f\u7528\u3002\u8fd9\u4e5f\u4ee3\u8868\u4e86\u540e\u7eed\u5bf9\u8be5\u7c7b\u578b\u53c2\u6570\u6240\u80fd\u4f7f\u7528\u7684\u573a\u666f\u2014\u2014\u65b9\u6cd5\u5165\u53c2\u6216\u8005\u8fd4\u56de\u7ed3\u679c\u3002</p>"},{"location":"Kotlin/Kotlin%20in%20out%20%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98/#_1","title":"\u89e3\u51b3\u4e86\u4ec0\u4e48\u95ee\u9898\uff1f","text":"<p>\u5bf9\u4e8eout\uff0c\u89e3\u51b3\u4e86\u5982\u4e0b\u7684\u95ee\u9898\uff1a <pre><code>\u5047\u5b9a\u7ee7\u627f\u5173\u7cfb\uff1aChild:Parent:Any\n\ninterface OutExample&lt;out T&gt;{\n    fun getSome():T\n}\n\nvar a:OutExample&lt;Child&gt; = ...\nvar b:OutExample&lt;Parent&gt; = ...\nb = a\n</code></pre> \u800c\u4e0a\u8ff0\u7684\u60c5\u51b5\u5728\u6ca1\u6709in/out\u7684Java\u4e2d\u5219\u4e0d\u5141\u8bb8\u3002\u56e0\u4e3aout\u8868\u8fbe\u4e86\u53ea\u662f\u5bf9\u5916\u63d0\u4f9b\u67d0\u7c7b\u578b\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5f15\u7528\u5176\u7236\u7c7b\u578b\u7684\u5b9e\u4f8b\uff0c\u5219\u662f\u53ef\u4ee5\u5b89\u5168\u88ab\u5b50\u7c7b\u578b\u8d4b\u503c\u7684\u3002\u5982\u4e0a\u9762\u4ee3\u7801\uff0c\u5bf9\u4e8e<code>b.getSome()</code>\u9884\u671f\u5f97\u5230\u7684\u662f<code>Parent</code>\u7c7b\u578b\uff0c\u8d4b\u503c<code>a</code>\u540e\uff0c\u5f97\u5230\u7684\u7c7b\u578b\u53d8\u4e3a\u4e86<code>Child</code>\uff0c\u800c<code>Child</code>\u662f<code>Parent</code>\u5b50\u7c7b\uff0c\u6839\u636e<code>\u591a\u6001</code>\uff0c\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee<code>Parent</code>\u7684\u6240\u6709\u7279\u6027\u3002\u800c\u8fd9\u4e5f\u88ab\u79f0\u4f5c\u201c\u534f\u53d8\u201d\uff0c\u5b83\u5141\u8bb8T\u7684\u7236\u7c7b\u578b\u53c2\u6570\u4f5c\u4e3a\u6cdb\u578b\u7684\u7c7b\uff0c\u88ab\u5b50\u7c7b\u578b\u7684\u7c7b\u6240\u8d4b\u503c\u3002</p> <p>\u5bf9\u4e8ein\uff0c\u89e3\u51b3\u4e86\u5982\u4e0b\u7684\u95ee\u9898\uff08\u4e0e\u6b64\u4e92\u8865\uff09\uff1a <pre><code>interface InExample&lt;in T&gt;{\n    fun readSome(t:T)\n}\nvar a:InExample&lt;Parent&gt;=...\nvar b:InExample&lt;Child&gt;=...\na=b\n</code></pre> \u4e0a\u8ff0\u7684\u89c4\u5219\u5bf9\u4e8eJava\u4f9d\u7136\u4e0d\u5141\u8bb8\u3002\u4e4b\u6240\u4ee5\u8fd9\u6837\u7684\u8d4b\u503c\u662f\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5b83\u4f9d\u7136\u6ee1\u8db3\u9762\u5411\u5bf9\u8c61\u7684\u201c\u591a\u6001\u201d\u3002\u8fd9\u88ab\u79f0\u4f5c\u201c\u9006\u53d8\u201d\uff0c\u5b83\u5141\u8bb8T\u7684\u7236\u7c7b\u578b\u53c2\u6570\u7684\u7c7b\u8d4b\u503c\u5230\u5b50\u7c7b\u578b\u4f5c\u4e3a\u53c2\u6570\u7684\u7c7b\u3002\u56e0\u4e3a\u5b50\u7c7b\u578b\u4f5c\u4e3a\u5165\u53c2T\uff0c\u4f9d\u65e7\u6ee1\u8db3\u201c\u591a\u6001\u201d\uff0c\u53ef\u4ee5\u5b89\u5168\u7684\u8bbf\u95ee\u7236\u7c7b\u7279\u6027\u3002</p>"},{"location":"Kotlin/Kotlin%20in%20out%20%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98/#_2","title":"\u591a\u6001","text":"<p>\u5f53\u5355\u7eaf\u5b9a\u4e49\u4e86\u6cdb\u578b<code>T</code>\u65f6\uff0c\u82e5\u8868\u793a\u5165\u53c2\u7c7b\u578b\uff0c\u5219\u5141\u8bb8\u5176\u5b50\u7c7b\u4f5c\u4e3a\u7c7b\u578b\u3002\u82e5\u8868\u793a\u51fa\u53c2\uff0c\u4f9d\u7136\u5982\u6b64\u3002</p>"},{"location":"Kotlin/Kotlin%20in%20out%20%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98/#_3","title":"\u8fb9\u754c","text":"<p>\u7c7b\u4f3cJava\uff0c\u6211\u4eec\u53ef\u4ee5\u7528<code>T extends superClass</code>\u5b9a\u4e49\u4e00\u4e2a\u5e26\u4e0a\u8fb9\u754c\u7684\u7c7b\u578b\u53c2\u6570\uff0c[parent, childClass...]\u3002</p>"},{"location":"Kotlin/Kotlin%20in%20out%20%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98/#_4","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>wikipedia</li> </ul>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/","title":"Kotlin \u534f\u7a0b \u6302\u8d77\u51fd\u6570","text":"<p>\u672c\u6587\u5c06\u4ecb\u7ecdKotlin\u4e2d\u534f\u7a0b\u6709\u5173\u7684\u57fa\u672c\u6982\u5ff5\u3001\u4ee5\u53ca\u6302\u8d77\u51fd\u6570\u7684\u5de5\u4f5c\u539f\u7406\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_1","title":"\u80cc\u666f","text":"<p>\u534f\u7a0b\u5728kotlin\u4e2d\u4ee5\u5b98\u65b9\u7684\u5e93\u51fa\u73b0\uff0c\u9700\u8981\u914d\u5408suspend\u5173\u952e\u8bcd\u3002\u800csuspend\u56e0\u4e3a\u53ea\u662f\u8bed\u6cd5\u7684\u4e00\u90e8\u5206\uff0c\u610f\u5473\u7740\u81f3\u4e8esuspend\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u8fd8\u6709\u66f4\u5927\u7684\u5f39\u6027\uff0c\u4e0d\u4e00\u5b9a\u5c31\u8981\u548c\u534f\u7a0b\u4e00\u76f4\u7ed1\u5b9a\u3002suspend\u5173\u952e\u8bcd\u7c7b\u6bd4Javascript\u7684async/await\uff0cContinuation(\u7a0d\u540e\u4f1a\u8bf4)\u7c7b\u6bd4Javascript\u7684Promise\uff0c\u5b83\u4eec\u7684\u51fa\u73b0\uff0c\u4e3b\u8981\u90fd\u662f\u4e3a\u4e86\u89e3\u51b3\u4ee5\u524d\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u5bf9\u201c\u5f02\u6b65\u201d\u201c\u540c\u6b65\u201d\u63cf\u8ff0\u80fd\u529b\u7684\u532e\u4e4f\u3002\u5728\u8fd9\u4e9b\u6982\u5ff5\u51fa\u73b0\u524d\uff0c\u201c\u8001\u201d\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4e00\u822c\u4f1a\u4ee5\u56de\u8c03\u63a5\u53e3\u63d0\u4f9b\u201c\u5f02\u6b65\u201d\u7684\u7f16\u7a0b\uff0c\u4e0d\u65ad\u7684\u5f02\u6b65\u56de\u8c03\u63a5\u53e3\u5b9e\u73b0\uff0c\u4f1a\u5f15\u5165\u5d4c\u5957\uff0c\u4f7f\u5f97\u4ee3\u7801\u96be\u770b\u4e14\u4e0d\u6613\u4e8e\u7ef4\u62a4\u3002</p> <pre><code>aAsyncAction(callback1{\n    bAsyncAction(callback2{\n        cAsyncAction(callback3{\n\n        })\n    })\n})\n</code></pre> <p>\u4f18\u5316\u7684\u601d\u8def\u90fd\u662f\u628a\u5176\u8f6c\u4e3a\u987a\u5e8f\u8c03\u7528\u3002\u4ece\u4e00\u5f00\u59cb\u7684\u54cd\u5e94\u5f0f\u94fe\u5f0f\u8c03\u7528RxJava\uff0c\u7c7b\u6bd4Promise\u624b\u52a8\u8c03\u7528\u3002\u5c06\u5d4c\u5957\u7ed3\u6784\u5148\u62b9\u5e73\u3002</p> <p><pre><code>aAsyncAction()\n.map({result1-&gt;\n    return bAsyncAction(result)\n})\n.map({result2-&gt;\n    return cAsyncAction(result)\n}).observe()\n\naAsyncAction()\n.then(result1 =&gt;{\n    return bAsyncAction(result1)\n})\n.then(result2=&gt;{\n    return cAsyncAction(result2)\n}).\n</code></pre> \u4f46\u56e0\u4e3a\u6837\u677f\u4ee3\u7801\u4e5f\u5f88\u591a\u3002\u6240\u4ee5\u4f18\u79c0\u7684\u5c01\u88c5\u8fdb\u4e00\u6b65\u51fa\u73b0\u3002 <pre><code>async function jsAsyncFunction(){\n    let result = aAsyncFunction()\n    result = bAsyncFuntion(result)\n    cAsyncFunction(result)\n}\n\nsuspend fun kotlinSuspendFunction(){\n    val result1 = aAsyncFunction()\n    val result2 = bAsyncFunction(result1)\n    cAsyncFunction(result2)\n}\n</code></pre> \u8fdb\u4e00\u6b65\u5c06\u5176\u8f6c\u5316\u4e3a\u770b\u8d77\u6765\u548c\u201c\u540c\u6b65\u201d\u4e00\u6837\u7684\u4ee3\u7801\u3002\u800c\u628a\u6837\u677f\u4ee3\u7801\u7684\u5de5\u4f5c\u5168\u4ea4\u7ed9\u7f16\u8bd1\u5668\u6765\u5904\u7406\u3002\u8fd9\u4fbf\u662fsuspend\u6240\u5e26\u6765\u7684\u91cd\u8981\u6539\u53d8\u3002</p> <p>\u5982\u679c\u53ea\u6709suspend\uff0c\u4f46\u6ca1\u6709\u534f\u7a0b\u5e93\uff0c\u5e76\u975e\u6ca1\u6709\u53ef\u80fd\u8ba9\u5b83\u6210\u529f\u8fd0\u884c\u3002\u56e0\u4e3a\u8fd9\u5957\u8bed\u6cd5\u5bf9\u4e8e\u63cf\u8ff0\u5f02\u6b65\u903b\u8f91\u5df2\u7ecf\u5177\u5907\u5b8c\u6574\u7684\u4fe1\u606f\u3002\u5373\u4f7f\u6ca1\u6709coroutine\u5305\u4e0b\u7684\u6240\u6709\u5de5\u5177\uff0c\u7406\u8bba\u4e0a\u8bb2\uff0c\u7167\u6837\u53ef\u4ee5\u7ed9\u5b83\u6267\u884c\u5f02\u6b65\u7684\u73af\u5883\uff0c\u5e76\u6ce8\u5165\u666e\u901a\u7684\u56de\u8c03\u673a\u5236\uff0c\u6765\u8ba9\u5176\u5de5\u4f5c\u3002\u4f46\u8fd9\u597d\u6bd4\u628aKotlin\u7684\u8fd9\u90e8\u5206\u7f16\u8bd1\u80fd\u529b\u91cd\u505a\u4e86\u3002</p> <p>\u5c3d\u7ba1\u5982\u6b64\uff0ckotlin\u66f4\u8fdb\u4e00\u6b65\uff0c\u5728\u534f\u7a0b\u4e2d\u589e\u52a0\u4e86\u4e0a\u4e0b\u6587\uff0c\u63d0\u4f9b\u4e86\u66f4\u5b8c\u5584\u7684\u201c\u7ed3\u6784\u5316\u5e76\u53d1\u201d\u7684\u652f\u6301\uff0c\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7ba1\u7406\u4f5c\u4e1a\u5173\u7cfb\u3002\u76f8\u6bd4Javascript\u4e25\u683c\u5355\u7ebf\u7a0b\u53ef\u5f02\u6b65\uff0cKotlin\u7684\u534f\u7a0b\u5728\u591a\u7ebf\u7a0b\u7684\u73af\u5883\u4e0b\u9762\u4e34\u7684\u6311\u6218\u66f4\u5927\uff0c\u6700\u7ec8\u5e26\u7ed9\u5f00\u53d1\u8005\u7684\u6536\u76ca\u4e5f\u66f4\u9ad8\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_2","title":"\u534f\u7a0b\u662f\u4ec0\u4e48","text":"<p>\u629b\u5f00\u4e00\u4e9b\u5e38\u89c1\u7684\u8bf4\u6cd5\uff0cCoroutine\u662f\u201c\u8f7b\u91cf\u7ea7\u7ebf\u7a0b\u201d\u3002\u8fd9\u79cd\u8bf4\u6cd5\u6709\u4e9b\u5bb9\u6613\u4ee4\u4eba\u56f0\u60d1\u3002\u4ee5\u4e2a\u4eba\u89d2\u5ea6\uff0cCoroutine\u4e0e\u8fc7\u53bb\u8ba4\u77e5\u7684Job\u3001Task\u7684\u89d2\u8272\u4f1a\u66f4\u8d34\u5207\u3002</p> <p>\u7c7b\uff1aStandaloneCoroutine: AbstractCoroutine: JobSupport(active), Job, Continuation, CoroutineScope <p>\u5b83\u5305\u542b\u4e86\u5173\u4e8e\u4f5c\u4e1a\u7684\u4e00\u4e9b\u5468\u671f\u56de\u8c03\u3001\u72b6\u6001\u3001\u4f5c\u4e1a\u5173\u7cfb\u3001\u4ee5\u53ca\u534f\u7a0b\u4e0a\u4e0b\u6587\u4fe1\u606f\u3002\u5f53\u7528\u534f\u7a0b\u6784\u9020\u5668\u6784\u9020\u534f\u7a0b\u540e\uff0c\u542f\u52a8\u65f6\uff0c\u672c\u8d28\u5c31\u662f\u4e00\u4e2aJob\u5f00\u59cb\u542f\u52a8\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_3","title":"\u56de\u8c03\u662f\u4ec0\u4e48","text":"<p><code>Continuation</code>\u626e\u6f14\u8005\u7c7b\u4f3cJavascript\u7684Promise\u7684\u89d2\u8272\uff0c\u4e5f\u5c31\u662f\u7c7b\u4f3c\u56de\u8c03\u7684\u89d2\u8272\u3002\u5b83\u5305\u542b\u4e86\u4e00\u4e2a\u534f\u7a0b\u4e0a\u4e0b\u6587\uff0c\u4ee5\u53ca<code>resumeWith(Result)</code>\u3002\u8fd9\u4e2a<code>resumeWith</code>\u7ecf\u5e38\u4ee4\u6211\u56f0\u60d1\u3002\u5c24\u5176\u5f53\u9700\u8981\u5b9e\u73b0\u4e00\u4e2aContinuatino\u7684\u65f6\u5019\uff0c\u5b9e\u73b0\u6b64\u65b9\u6cd5\u65f6\uff0c\u7ecf\u5e38\u4f1a\u6709\u9519\u89c9\u662f\u8981\u4f20\u9012\u4e00\u4e2a\u7ed3\u679c\u51fa\u53bb\uff0c\u800c\u5b9e\u9645\u4e0a\u5b9e\u73b0\u6b64\u65b9\u6cd5\u662f\u6536\u5230\u7ed3\u679c\uff0c\u5373\u7c7b\u4f3c<code>onCallback(result)</code>,<code>onResult(result)</code>\u8fd9\u79cd\u3002\u53ea\u662f\u8fd9\u79cd\u540d\u5b57\u5bf9\u4f20\u5165\u6570\u636e\u7684\u8c03\u7528\u65b9\u5f88\u597d\u7406\u89e3\uff0c\u6bd4\u5982Continuation\u4f5c\u4e3a\u5165\u53c2\u65f6\uff0c\u8bf4\u660e\u6211\u4eec\u9700\u8981\u5b8c\u6210\u4e00\u4e9b\u4efb\u52a1\uff0c\u7136\u540e\u8c03\u7528\u5b83\u7684<code>resumeWith()</code>\u6765\u4f20\u9012\u8ba1\u7b97\u7ed3\u679c\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_4","title":"\u4e0a\u4e0b\u6587\u3001\u8303\u56f4","text":"<p><code>CoroutineContext</code>\u662f\u534f\u7a0b\u7684\u4e0a\u4e0b\u6587\u73af\u5883\uff0c\u534f\u7a0b\u7684\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4ece\u4e2d\u627e\u5230\u5f88\u591a\u7ea6\u5b9a\u7684\u91cd\u8981\u5143\u7d20\u3002\u800c\u5b83\u4e5f\u590d\u5199\u4e86\u64cd\u4f5c\u7b26<code>+</code>\uff0c\u4f7f\u5f97\u4e0a\u4e0b\u6587\u7684\u5143\u7d20\u6dfb\u52a0\u5f88\u65b9\u4fbf\u3002</p> <p><code>Element : CoroutineContext</code>\u4e0a\u4e0b\u6587\u73af\u5883\u4e2d\u7684\u5143\u7d20\uff0c\u53e6\u5916\u6709\u4e00\u4e2a\u7a7a\u63a5\u53e3<code>Key</code>\u4f5c\u4e3a\u952e</p> <p><code>CoroutineScope</code>\u7528\u4e8e\u65b9\u4fbf\u7ba1\u7406\u4e00\u4e2a\u903b\u8f91\u4e0a\u4e0b\u6587\u91cc\u7684\u4efb\u52a1\u3002Android\u7684Lifecycle\u5e93\u4e2d\uff0c\u4fbf\u63d0\u4f9b\u4e86\u5185\u7f6e\u7684lifecycleScope\uff0c\u8fd8\u6709ViewModelScope\uff0c\u90fd\u7528\u4e8e\u8fd9\u4e9b\u5bf9\u5e94\u7c7b\uff08\u5982Activity, Fragment, ViewModel, View)\u7684\u751f\u547d\u5468\u671f\u5185\u6240\u8fd0\u884c\u7684\u534f\u7a0b\u4efb\u52a1\u3002\u5728\u6b64\u8303\u56f4\u5185\u7684\u4efb\u52a1\uff0c\u5f80\u5f80\u4f1a\u88ab\u8d1f\u8d23\u7ba1\u7406\u6b64\u8303\u56f4\u7684\u72b6\u6001\u8005\u6240\u95f4\u63a5\u63a7\u5236\u3002\u9664\u4e86\u4e3b\u8981\u7684\u542f\u52a8\u534f\u7a0b\u65b9\u6cd5<code>launch{}</code> <code>async</code>\u4e00\u822c\u8fd8\u4f1a\u63d0\u4f9b\u62d3\u5c55\u65b9\u6cd5\u7c7b\u4f3c <code>launchWhenCreated</code>, <code>launchWhenStart</code>\u7b49\u4e0d\u540c\u58f0\u660e\u5468\u671f\u65f6\u518d\u542f\u52a8\u7684\u534f\u7a0b\u3002</p> <p><code>EmptyCoroutineContext</code>\u7a7a\u7684\u4e0a\u4e0b\u6587</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_5","title":"\u53d1\u8d77\u3001\u8fc1\u79fb","text":"<p><code>runBlocking</code>\u4ece\u975e\u6302\u8d77\u65b9\u6cd5\u73af\u5883\u5230\u6302\u8d77lambda\u73af\u5883\u3002\u963b\u585e\u7ebf\u7a0b\u76f4\u5230lambda\u5b8c\u6210\u3002\u5373\u4f7f\u4f7f\u7528Dispatchers\uff0c\u4e5f\u53ea\u662f\u4ee3\u8868Lambda\u7684\u6267\u884c\u7ebf\u7a0b\uff0c\u4f46\u8c03\u7528\u53d1\u8d77\u7ebf\u7a0b\u4f9d\u7136\u4f1a\u963b\u585e\u3002</p> <p><code>launch:Job</code>\u5728\u6302\u8d77\u73af\u5883\u4e2d\u53d1\u8d77\u4e00\u4e2a\u534f\u7a0b\uff0c\u4f1a\u8fd4\u56deJob\u3002\u53ef\u6307\u5b9a\u534f\u7a0b\u542f\u52a8\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u76f4\u63a5\u542f\u52a8\u3002\u662f\u5426\u963b\u585e\u53d6\u51b3\u4e8e\u534f\u7a0b\u542f\u52a8\u65b9\u5f0f\uff0c\u5982\u679c\u662f\u76f4\u63a5\u8fd0\u884c\u5c31\u4f1a\u963b\u585e\u3002\u4f46\u672c\u610f\u4e0d\u963b\u585e\u3002</p> <p><code>async:Deffered&lt;T&gt;</code>\u5728\u6302\u8d77\u73af\u5883\u4e2d\u53d1\u8d77\u4e00\u4e2a\u534f\u7a0b\uff0c\u672c\u610f\u4e0d\u963b\u585e\uff0c\u53ef<code>await</code>\u7b49\u5f85\u7ed3\u679c\u3002</p> <p><code>withContext</code>\u5728\u6302\u8d77\u73af\u5883\u4e2d\u53d1\u8d77\u4e00\u4e2a\u534f\u7a0b\uff0c\u963b\u585e\u5e76\u7b49\u5f85\u7ed3\u679c\u3002\u4f46\u66f4\u5e7f\u4e49\u4e0a\u8bf4\uff0c\u5207\u6362\u4e00\u4e2acontext\u73af\u5883\uff0c\u8fd0\u884c\u5e76\u7b49\u5f85\u7ed3\u679c\u3002</p> <p><code>suspendCancellableCoroutine</code>\u662f\u4e00\u4e2a\u5e38\u7528\u7684\u628a\u4f20\u7edf\u7684\u56de\u8c03\u3001\u5f02\u6b65\u884c\u4e3a\u8fc1\u79fb\u5230\u534f\u7a0b\u65b9\u5f0f\u3001\u4e5f\u6216\u8005\u5c01\u88c5\u6210\u534f\u7a0b\u65b9\u5f0f\u3002\u4e00\u4e2a\u5408\u683c\u7684\u5c01\u88c5\u4e0d\u4ec5\u8981\u8003\u8651<code>resume</code>\u8fd8\u8981\u8003\u8651<code>invokeOnCancel</code>\u7b49\u3002\u5982\u4e0b\u662f<code>compose</code>\u5bf9choreographer\u7684callback\u7684\u5c01\u88c5\uff1a <pre><code>suspend fun &lt;R&gt; withFrameNanos(\n        onFrame: (Long) -&gt; R\n    ): R {\n        val uiDispatcher = coroutineContext[ContinuationInterceptor] as? AndroidUiDispatcher\n        return suspendCancellableCoroutine { co -&gt;\n            val callback = Choreographer.FrameCallback { frameTimeNanos -&gt;\n                co.resumeWith(runCatching { onFrame(frameTimeNanos) })\n            }\n            if (uiDispatcher != null &amp;&amp; uiDispatcher.choreographer == choreographer) {\n                uiDispatcher.postFrameCallback(callback)\n                co.invokeOnCancellation { uiDispatcher.removeFrameCallback(callback) }\n            } else {\n                choreographer.postFrameCallback(callback)\n                co.invokeOnCancellation { choreographer.removeFrameCallback(callback) }\n            }\n        }\n    }\n</code></pre></p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_6","title":"\u7ebf\u7a0b\u5207\u6362","text":"<p><code>DispatchedContinuation(CoroutineDispatcher, Continuation):Continuation, DispatchedTask</code></p> <p>\u590d\u5199\u4e86<code>resumeWith</code>\uff0c\u8be2\u95eedispatcher\u662f\u5426\u9700\u8981\u5206\u53d1\uff0c\u82e5\u9700\u8981\uff0c\u5219\u5206\u53d1\u3002</p> <p><code>ExecutorCoroutineDispatcher: CoroutineDispatcher</code></p> <p><code>ExecutorCoroutineDispatcherImpl: ExecutorCoroutineDispatcher(), Delay</code> \u4e00\u822c\u8fd8\u662f\u7528ExecuterService\u5206\u53d1\u3002\u82e5\u662fScheduledExecuterService\uff0c\u5219delay\u4f1a\u7528\u5176\u5bf9\u5e94\u7684<code>schedule</code>\u7b49\u65b9\u6cd5\uff0c\u5426\u5219\u5c06\u5f00\u542f\u5176\u4ed6\u7ebf\u7a0b\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_7","title":"\u8fc7\u7a0b\u63cf\u8ff0","text":"<p>\u56e0\u4e3a\u8fd9\u4e2a\u8fc7\u7a0b\u8fd8\u662f\u5f88\u5bb9\u6613\u4f7f\u4eba\u56f0\u60d1\uff0c\u65e0\u6cd5\u5f04\u6e05\u695a\u534f\u7a0b\u548c\u7ebf\u7a0b\u7684\u5206\u53d1\u8fc7\u7a0b\uff0c\u8fd9\u91cc\u6211\u518d\u91cd\u65b0\u8865\u5145\u4e00\u4e9b\u7ec6\u8282\u3002</p> <p><code>CoroutineDispatcher</code>\uff0c\u5b83\u662f<code>ContinuationInterceptor</code>\u7684\u5b50\u7c7b\uff0c\u7531\u6b64\u53ef\u4ee5\u5728\u534f\u7a0b\u4e0a\u4e0b\u6587\u4e2d\u4ee5\u8fd9\u4e2a\u7c7b\u4f5c\u4e3akey\u68c0\u7d22\u5230\u3002\u800c\u4f5c\u4e3a\u62e6\u622a\u5668\uff0c\u5b83\u7684\u76ee\u7684\u662f\u521b\u5efa<code>DispatchedContinuation</code>\uff0c\u5373\u628a\u539f\u6765\u7684<code>continuation</code>\u5305\u88f9\u4e3a\u5177\u6709\u5206\u53d1\u6027\u8d28\u7684<code>continuation</code>\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>public final override fun &lt;T&gt; interceptContinuation(continuation: Continuation&lt;T&gt;): Continuation&lt;T&gt; =\n        DispatchedContinuation(this, continuation)\n</code></pre> \u5982\u4e0a\u6240\u8bf4\uff0c<code>DispatchedContinuation</code>\u4e3b\u8981\u5bf9\u539f<code>continuation</code>\u5305\u88c5\u4e86\u4e00\u5c42\uff0c\u8fd9\u4e00\u5c42\u76ee\u7684\u5728\u4e8e\u51b3\u5b9a\u662f\u5426\u5206\u53d1\uff0c\u5373\u662f\u5426\u9700\u8981\u5207\u6362\u7ebf\u7a0b\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>// DispatchedContinuation: \n    override fun resumeWith(result: Result&lt;T&gt;) {\n        val context = continuation.context\n        val state = result.toState()\n        if (dispatcher.isDispatchNeeded(context)) {\n            _state = state\n            resumeMode = MODE_ATOMIC\n            dispatcher.dispatch(context, this)\n        } else {\n            executeUnconfined(state, MODE_ATOMIC) {\n                withCoroutineContext(this.context, countOrElement) {\n                    continuation.resumeWith(result)\n                }\n            }\n        }\n    }\n</code></pre> \u5373\u5b83\u9700\u8981<code>dispatcher</code>\u6210\u5458\u53bb\u5224\u65ad\u662f\u5426\u9700\u8981\u5206\u53d1\uff0c\u82e5\u9700\u8981\u5219\u4ea4\u7531\u5176\u5206\u53d1\uff0c\u65b9\u6cd5\u662f<code>Dispatcher.dispatch(CoroutineContext, Runnable)</code>\uff0c\u5176\u4e2d<code>Runnable</code>\u662f<code>DispatchedContinuation</code>\u81ea\u5df1\uff0c\u5373\u5b83\u5b9e\u73b0\u4e86<code>runnable</code>\uff0c\u6765\u5305\u88f9\u4e86<code>resume</code>\u7684\u8fc7\u7a0b\uff0c\u4ece\u800c\u5728\u5206\u53d1\u5668\u5206\u53d1\u540e\u7ee7\u7eed\u5b8c\u6210<code>resume</code>\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>// DispatchedContinuation -: DispatchedTask # run. \u5df2\u7cbe\u7b80\u3002\u7528\u4e8e\u5728\u5206\u53d1\u5668\u5b8c\u6210\u5206\u53d1\u540e\u7ee7\u7eed\u5b8c\u6210resume\u8fc7\u7a0b\u3002\n    public final override fun run() {\n        val taskContext = this.taskContext\n        var fatalException: Throwable? = null\n        try {\n            val delegate = delegate as DispatchedContinuation&lt;T&gt;\n            val continuation = delegate.continuation\n            withContinuationContext(continuation, delegate.countOrElement) {\n                val context = continuation.context\n                val state = takeState() // NOTE: Must take state in any case, even if cancelled\n                val exception = getExceptionalResult(state)\n                val job = if (exception == null &amp;&amp; resumeMode.isCancellableMode) context[Job] else null\n                if (job != null &amp;&amp; !job.isActive) {\n                    val cause = job.getCancellationException()\n                    cancelCompletedResult(state, cause)\n                    continuation.resumeWithStackTrace(cause)\n                } else {\n                    if (exception != null) {\n                        continuation.resumeWithException(exception)\n                    } else {\n                        continuation.resume(getSuccessfulResult(state))\n                    }\n                }\n            }\n        }\n    }\n</code></pre> \u7531\u6b64\uff0c\u6211\u4eec\u518d\u770b<code>CoroutineDispathcer.dispatch</code>\u7684\u5b9e\u73b0\uff0c\u8fd9\u91cc\u6709\u5e38\u89c1\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ol> <li>\u57fa\u4e8e\u73b0\u6709Java\u7684<code>Executor</code>\u5b9e\u73b0\u6765\u6784\u9020\u7684<code>ExecutorCoroutineDispatcher</code>\uff0c\u53ef\u4ee5\u4f7f\u7528<code>ExecutorService.asCoroutineDispatcher()</code>\u62d3\u5c55\u65b9\u6cd5\u8f6c\u5316\u3002</li> <li>\u57fa\u4e8eKotlin\u81ea\u5df1\u5b9e\u73b0\u7684Java\u7684<code>Executor</code>\u63a5\u53e3<code>CoroutineScheduler</code>\uff0c\u5e76\u4ee5\u5176\u4e3a\u627f\u8f7d\u6765\u6784\u9020\u51fa\u7684<code>ExperimentalCoroutineDispatcher</code>\u3002</li> </ol> <p>\u76ee\u524d\u6211\u8fd9\u91cc\u770b\u5230\u7684<code>Dispatchers.IO</code>\u4f7f\u7528\u7684\u662f\u540e\u8005\u3002</p> <p>\u8fd9\u4e24\u79cddispatcher\u65b9\u6848\u7684<code>dispatch</code>\u4ee3\u7801\u5bf9\u6bd4\u5982\u4e0b\uff1a <pre><code>    override fun dispatch(context: CoroutineContext, block: Runnable) {\n        try {\n            executor.execute(wrapTask(block))\n        } catch (e: RejectedExecutionException) {\n            cancelJobOnRejection(context, e)\n            Dispatchers.IO.dispatch(context, block)\n        }\n    }\n\n    override fun dispatch(context: CoroutineContext, block: Runnable): Unit =\n        try {\n            coroutineScheduler.dispatch(block)\n        } catch (e: RejectedExecutionException) {\n            DefaultExecutor.dispatch(context, block)\n        }\n</code></pre> \u81f3\u4e8e\u6700\u540e<code>Executor</code>\u8fd9\u4e2ajava\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u5b9e\u73b0\u5747\u4f9d\u8d56\u4e8e\u591a\u751f\u4ea7\u8005\u3001\u591a\u6d88\u8d39\u8005\u7684\u961f\u5217\u6570\u636e\u7ed3\u6784\uff0c\u5bf9\u4e8eExecutorService\u6765\u8bf4\uff0c\u5f80\u5f80\u91c7\u7528<code>ArrayBlockingQueue</code>\uff0c\u5b83\u652f\u6301\u963b\u585e\u83b7\u53d6\u4e5f\u652f\u6301\u8d85\u65f6\u83b7\u53d6\u7b49\uff0c\u800c\u5bf9\u4e8e<code>ScheduledThreadPoolExecutor</code>\uff0c\u5219\u4f7f\u7528<code>DelayedWorkQueue</code>\uff0c\u8be6\u89c1\u201cJava\u201dsection.\u5bf9\u4e8ekotlin\u7684<code>CoroutineScheduler</code>\u6765\u8bf4\uff0c\u5219\u662f\u91c7\u7528<code>LockFreeTaskQueue</code>\uff0c\u4e5f\u662f\u81ea\u5df1\u521b\u9020\u7684\u4e00\u4e2a\u7c7b\u578b\u3002</p> <p>\u90a3\u4e48\u601d\u8def\u603b\u7ed3\u5c31\u662f\uff0c\u7ebf\u7a0b\u7684\u5206\u53d1\u5efa\u7acb\u5728<code>continuation</code>\u7684<code>CoroutineContext</code>\u4e0a\u4e0b\u6587\u4e2d\u7684<code>CoroutineInterceptor</code>\u5143\u7d20\u4e2d\uff0c\u5b83\u662f<code>CoroutineDispatcher</code>\u7c7b\u578b\u3002<code>CoroutineInterceptor</code>\u63d0\u4f9b\u4e86\u673a\u5236\u6765\u5bf9<code>Continuation</code>\u62e6\u622a\u3001\u8fdb\u884c\u5305\u88c5\u7b49\u3002\u5bf9\u4e8e\u7ebf\u7a0b\u5206\u53d1\uff0c\u5219\u662f\u5bf9<code>Continuation</code>\u8fdb\u884c\u5305\u88c5\uff0c\u5305\u88c5\u540e\u7684<code>DispatchedContinuation</code>\u5728<code>resume</code>\u7684\u5904\u7406\u4e2d\u6709\u6240\u4e0d\u540c\uff0c\u4f1a\u67e5\u8be2\u662f\u5426\u9700\u8981\u5206\u53d1\uff0c\u82e5\u9700\u8981\u5219\u4f1a\u5728\u5206\u53d1\u540e\u518d<code>resume</code>\u3002</p> <p>\u57fa\u4e8e\u6b64\u601d\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u5982\u4e0b\u7684\u4ee3\u7801\u573a\u666f\uff1a <pre><code>//ui thread\nval r = async(IO){api()}\nprintln(r)\n\n\u7b49\u6548\u4e8e\nfunA(Callback{r-&gt; println(r) })\n\nfun funA(callback){\n    dispatchCallback1(Callback{\n        api(Callback{it-&gt;\n            dispatchCallback2(callback, it)\n        })\n    })\n}\nfun dispatchCallback1(callback){\n    IO.executor.execute(callback)\n}\nfun dispatchCallback2(callback){\n    UI.executor.execute(callback)\n}\n</code></pre></p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_8","title":"\u6302\u8d77\u51fd\u6570","text":"<p><code>suspend fun xxx(){}</code></p> <p>\u6302\u8d77\u51fd\u6570\u4f1a\u88ab\u7f16\u8bd1\u5668\u5904\u7406\uff0c\u8865\u5145\u4e00\u4e2aContinuation\u53c2\u6570\uff0c\u7c7b\u6bd4\u6b64\u65b9\u6cd5\u540c\u6b65\u6267\u884c\u7684\u7ed3\u679c\u5f02\u6b65\u56de\u8c03\u3002\u5728\u51fd\u6570\u5185\u90e8\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6302\u8d77\u65b9\u6cd5\u8c03\u7528\u5904\uff0c\u90fd\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u4e2a\u6302\u8d77\u70b9\uff0c\u76f8\u6bd4\u4e8e\u6bcf\u4e00\u4e2a\u6302\u8d77\u70b9\u90fd\u65b0\u751f\u6210\u4e00\u4e2a\u56de\u8c03\uff0cKotlin\u9009\u62e9\u5efa\u7acb\u4e00\u4e2a\u5185\u90e8\u7684\u7c7b(\u7ee7\u627f\u4e8e <code>ContinuationImpl</code>\uff0c\u91cd\u5199<code>invokeSuspend</code>)\uff0c\u7c7b\u4f3c\u6709\u9650\u72b6\u6001\u673a\uff0c\u4f5c\u4e3a\u8fd9\u4e9b\u6302\u8d77\u70b9\u5171\u7528\u7684\u56de\u8c03\u3002\u5e76\u4e14\u4e3a\u5176\u5b57\u6bb5\u8d4b\u503c\u4e0d\u540c\u9636\u6bb5\u5f97\u5230\u7684\u7ed3\u679c\u3002\u56e0\u6b64\u907f\u514d\u4ea7\u751f\u66f4\u591a\u65e0\u610f\u4e49\u7684\u56de\u8c03\u533f\u540d\u7c7b\u548c\u5b9e\u4f8b\u3002\u5728\u6210\u529f\u5b8c\u6210\u540e\uff0c\u4f1a\u8c03\u7528\u53c2\u6570\u4e2d\u81ea\u52a8\u8865\u5145\u7684continuation\uff0c\u4f5c\u4e3a\u5bf9\u6700\u7ec8\u7ed3\u679c\u7684\u56de\u8c03\u3002</p> <p>\u6240\u4ee5\u7b80\u5355\u6765\u8bf4\uff0c\u6302\u8d77\u51fd\u6570\u3001\u6302\u8d77\u65b9\u6cd5\uff0c\u539f\u7406\u5c31\u662f\uff0c\u5176\u5185\u90e8\u5171\u7528\u751f\u6210\u7684\u4e00\u4e2a\u56de\u8c03\uff0c\u5e76\u7ed9\u65b9\u6cd5\u5165\u53c2\u81ea\u52a8\u6dfb\u52a0\u4e00\u4e2a\u56de\u8c03\uff0c\u5728\u65b9\u6cd5\u5b8c\u6210\u540e\u8c03\u7528\u3002</p> <p></p> <p><code>suspend ()-&gt;Unit</code>\u6216\u66f4\u4e00\u822c\u7684<code>suspend T.()-&gt;R</code></p> <p>\u6bd4\u5982<code>runBlocking{...}</code>\uff0c\u6216\u8005<code>someF: suspend ()-&gt;R,    someF.createCoroutine</code>\u7b49\u60c5\u51b5\uff0c\u7f16\u8bd1\u5668\u7684\u5904\u7406\u4f1a\u7565\u6709\u4e0d\u540c\u3002\u4f1a\u751f\u6210\u7ee7\u627f\u4e8e<code>SuspendLambda :ContinuationImpl</code>\u7684\u5b50\u7c7b\uff0c\u91cd\u5199\u4e86<code>invokeSuspend</code>\uff0c<code>create:Continuation</code>\uff0c\u4ee5\u53caFunction2\u7684\u63a5\u53e3<code>invoke</code>, \u5176\u4e2d<code>invoke</code>\u903b\u8f91\u5c31\u662f<code>create(.., ..).invokeSuspend</code>\u3002\u800c\u5b83\u548c\u4e0a\u9762<code>suspend fun</code>\u533a\u522b\u5728\u4e8e\uff0c\u4e0a\u9762\u662f\u9700\u8981\u4e3a\u6302\u8d77\u65b9\u6cd5\u751f\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684\u7c7b\uff0c\u518d\u5728\u539f\u65b9\u6cd5\u4e2d\u4f7f\u7528\u3002\u800c\u8fd9\u91cc\u56e0\u4e3akotlin\u7684suspend lambda\u672c\u6765\u5c31\u4f1a\u8f6c\u4e3a\u533f\u540d\u7c7b(\u7ee7\u627f\u4e8eSuspendLambda)\uff0c\u6b64\u65f6lambda\u6240\u6709\u4ee3\u7801\u76f4\u63a5\u88ab\u8f6c\u79fb\u5230\u4e86<code>invokeSuspend</code>\u65b9\u6cd5\u91cc\u3002</p> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u63a8\u65ad\u3002\u5728Kotlin\u4e2d\uff0c\u6302\u8d77\u5757\u8f6c\u4e3a\u534f\u7a0b\u7684\u6700\u7ec8\u90e8\u5206\uff0c\u5176\u5b9e\u90fd\u662f\u7531\u7f16\u8bd1\u5668\u6765\u8d1f\u8d23\u751f\u6210\u4e86<code>ContinuationImpl</code>\u7684\u5b50\u7c7b\uff0c\u5176\u4e2d\u5173\u952e\u65b9\u6cd5<code>invokeSuspend</code>\u5bf9\u4e8e\u6302\u8d77\u65b9\u6cd5\u548c\u6302\u8d77Lambda\u8868\u8fbe\u5f0f\u6709\u6240\u5dee\u5f02\uff0c\u524d\u8005\u662f\u8bb0\u5f55\u7ed3\u679c\uff0c\u5e76\u91cd\u590d\u8c03\u7528\u539f\u6302\u8d77\u65b9\u6cd5\uff0c\u4ece\u800c\u8fdb\u5165\u4e0b\u4e00\u4e2alabel\u3002\u800c\u540e\u8005\u662f\u5185\u8054\u4e86lambda\u8868\u8fbe\u5f0f\u7684\u6240\u6709\u5185\u5bb9\u3002 \u800c\u4e24\u8005\u4ee3\u7801\u5757\u5185\u5bb9\u4e2d\uff0c\u6240\u6709\u7684\u6302\u8d77\u70b9\u90fd\u4f1a\u88ab\u4e00\u81f4\u7684\u65b9\u5f0f\u5904\u7406\uff0c\u5373\u88ablabel\u6807\u8bb0\uff0c\u5e76\u5171\u7528\u4e00\u4e2a\uff0c\u5373\u751f\u6210\u7684\u8fd9\u4e2aContinuation\u4f5c\u4e3a\u56de\u8c03\u3002\u76f4\u5230\u6700\u540e\u7684\u7ed3\u679c\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_9","title":"\u4f18\u52a3","text":"<ul> <li> <p>\u5bf9\u4e8e\u6539\u7528\u534f\u7a0b\u7684\u5e93\u4ef6\u6765\u8bf4\uff0c\u4f1a\u8ba9app\u603b\u7ebf\u7a0b\u6570\u91cf\u7684\u7ef4\u62a4\u5f97\u5230\u4f18\u5316\uff0c\u6bcf\u4e2a\u5e93\u4e0d\u5fc5\u518d\u7ef4\u62a4\u81ea\u5df1\u7684\u7ebf\u7a0b\u6c60\u3002</p> </li> <li> <p>\u66f4\u7cbe\u70bc\u7684\u5f02\u6b65\u4ee3\u7801\u3001\u66f4\u597d\u7684\u751f\u547d\u5468\u671f\u8303\u56f4\u7ba1\u7406\u3002</p> </li> </ul>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_10","title":"\u7279\u6b8a\u95ee\u9898","text":"<p>launch{     runblocking{         println()     } }</p> <p>\u8bf4\u662f\u4f1a\u6709\u5076\u73b0\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4launch\u65e0\u6cd5\u7ed3\u675f\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_11","title":"\u778e\u63b0\u4e00\u53e5","text":"<p>\u5f88\u591aKotlin\u7684\u7279\u6027\uff0c\u81f3\u5c11\u5728Jvm\u5e73\u53f0\u4e0a\uff0c\u80fd\u770b\u5230\u7f16\u8bd1\u5668\u505a\u4e86\u5927\u91cf\u7684\u5de5\u4f5c\u3002\u4e00\u6bb5\u7b80\u77ed\u7684kotlin\u4ee3\u7801\uff0c\u80cc\u540e\u7684Jvm class\u5374\u5e76\u4e0d\u7b80\u77ed\u3002\u751a\u81f3\u7f16\u8bd1\u5668\u5bf9\u5176\u7f16\u8bd1\u5185\u5bb9\u91cc\uff0c\u8fdb\u4e00\u6b65\u5f15\u5165\u4e86Kotlin\u7684\u534f\u7a0b\u5e93\uff0c\u5373\u8bf4\u660e\uff0c\u5373\u4f7f\u5b8c\u6210\u4e86\u7f16\u8bd1\uff0c\u5728\u8fd0\u884c\u65f6\u5fc5\u987b\u8981\u9644\u5e26Kotlin\u7684\u534f\u7a0b\u5e93\u8fd0\u884c\u65f6\uff0c\u4e0d\u7136\u4f9d\u7136\u65e0\u6cd5\u6267\u884c\u3002</p> <p>\u8fd9\u4e9b\u7279\u70b9\u5176\u5b9e\u542f\u53d1\u8fd8\u662f\u5f88\u591a\u7684\uff0c\u4e5f\u548c\u4e4b\u524d\u9047\u5230\u7684\u5f88\u591a\u4e8b\u60c5\u90fd\u5f88\u76f8\u4f3c\uff0c\u5177\u4f53\u6765\u8bf4\uff1a - \u8bed\u6cd5\u88ab\u7f16\u8bd1\u5668\u7f16\u8bd1\u5230\u7279\u5b9a\u5e73\u53f0\uff0c\u8fd9\u5de5\u4f5c\u7c7b\u4f3c\u6211\u4eec\u5728Apt\u6216\u8005android gradle transform class\u8fc7\u7a0b\uff0c\u9700\u8981\u81ea\u52a8\u751f\u6210\u4e00\u4e9b\u4ee3\u7801\u3002\u4e5f\u7c7b\u4f3c\u4e4b\u524d\u505a<code>lx</code>\u9879\u76ee\u3002 - \u7f16\u8bd1\u5668\u5f15\u5165\u4e86\u4f9d\u8d56\uff0c\u8fd9\u4e2a\u7c7b\u4f3c\u5728<code>lx</code>\u9879\u76ee\u4e2d\uff0c\u7528\u4e86<code>external</code>\u5173\u952e\u5b57\u6765\u5f15\u5165\u5916\u90e8\u80fd\u529b\uff0c\u4ea4\u7ed9\u7f16\u8bd1\u5668\u53bb\u89e3\u6790<code>id</code>\uff0c\u4ee5\u6b64\u5f15\u5165\u4f9d\u8d56\uff0c\u4e3b\u8981\u662f\u7279\u5b9a\u5e73\u53f0\u7684\u4e00\u4e9b\u4f9d\u8d56\u3002\u800c\u5dee\u5f02\u5728\u4e8e\uff0c\u5b83\u5f15\u5165\u4e86\u81ea\u5df1\u5728\u6b64\u5e73\u53f0\u63d0\u4f9b\u7684\u4e00\u5957\u8fd0\u884c\u65f6\u4f9d\u8d56\u3002\u5c31\u597d\u6bd4\u5bf9\u4e8e<code>lx</code>\u9879\u76ee\uff0c<code>external println=System.out.println</code>\u53d8\u6210\u4e86<code>external println=Lx.jvm.println</code>\u3002\u540c\u65f6\u6700\u7ec8\u6253\u5305\u9700\u8981\u5f15\u5165<code>Lx.jvm</code>\u5305\u3002</p> <p>\u4e0d\u59a8\u8ba9\u81ea\u5df1\u4e5f\u6709\u7a7a\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u81ea\u5df1\u8981\u8ba9<code>lx</code>\u4e5f\u6765\u8bd5\u7740\u89e3\u51b3\u4e0b\u5f02\u6b65\u8bed\u6cd5\u652f\u6301\u95ee\u9898\uff0c\u8be5\u7ed9\u51fa\u600e\u6837\u7684\u65b9\u6848\u5462\u3002</p>"},{"location":"Kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%20%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0/#_12","title":"\u62d3\u5c55\u9605\u8bfb","text":"<p>\u4ecb\u7ecd\u6302\u8d77\u51fd\u6570\u7684\u5b57\u8282\u7801\u751f\u6210</p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/","title":"\u65e0\u5916\u90e8\u4f9d\u8d56\u521b\u9020\u4e00\u4e2a\u8bed\u8a00\u8dd1\u8d77\u6765","text":"<p>\u6700\u8fd1\u82b1\u4e86\u4e00\u5468\u65f6\u95f4\uff0c\u7528typescript\u5199\u4e86\u4e00\u4e2a\u73a9\u5177\u8bed\u8a00\uff0c\u5305\u62ec\u5b83\u7684\u8bed\u6cd5\u89e3\u6790\u5668\u3001\u4ee5\u53ca\u4e00\u4e2a\u7b80\u5355\u7684\u7f16\u8bd1\u5668\uff0c\u80fd\u628a\u5b83\u7f16\u8bd1\u4e3ajvm\u5e73\u53f0\u7684class\u6587\u4ef6\u5e76\u8fd0\u884c\u3002\u6574\u4e2a\u9879\u76ee\u6ca1\u6709\u4efb\u4f55\u5916\u90e8\u4f9d\u8d56\u3002\u521d\u8877\u662f\u60f3\u4eb2\u81ea\u4f53\u9a8c\u4e00\u4e0b\u8fd9\u79cd\u521b\u9020\u4e00\u4e9b\u6700\u57fa\u672c\u7684\u4e1c\u897f\u7684\u4e50\u8da3\u3002\u5b9e\u9645\u8bc1\u660e\uff0c\u6bd4\u8d77\u5355\u7eaf\u9605\u8bfb\u4e86\u89e3\uff0c\u8fd8\u662f\u6709\u6761\u4ef6\u4e0a\u624b\u5c1d\u8bd5\u5199\u4e00\u4e0b\u5e26\u6765\u7684\u611f\u89c9\u624d\u66f4\u68d2~</p> <p></p> <p>\u4e0a\u56fe\u62c6\u5f00\u6765\u770b\uff0clx\u8bed\u8a00\u7684\u6d4b\u8bd5\u811a\u672c\uff1a</p> <p></p> <p>\u6240\u5f97\u5230\u7684\u5bf9\u5e94AST\uff1a</p> <p></p> <p>\u7f16\u8bd1\u5668\u751f\u6210Class\u65f6\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u8fd0\u884c\u7f16\u8bd1\u5668\u8f93\u51fa\u7684class\u6587\u4ef6\uff1a</p> <p></p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#_1","title":"\u5177\u4f53\u505a\u4e86\u4ec0\u4e48","text":"<ul> <li>\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u8bed\u8a00\u7684\u8bed\u6cd5</li> <li>\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u7528\u4e8e\u751f\u6210\u8bed\u6cd5\u89e3\u6790\u5668\u7684\u8868\u8fbe\u5f0f\u3002\uff08\u4e3a\u4e86\u66f4\u9ad8\u6548\u7684\u63cf\u8ff0\u8bed\u6cd5\u3001\u89e3\u6790\u8bed\u6cd5\uff09</li> <li>\u4e00\u4e2aclass\u6587\u4ef6\u751f\u6210\u5668</li> <li>\u4e00\u4e2a\u628a\u8bed\u6cd5\u89e3\u6790\u6811\u7f16\u8bd1\u8f93\u51fa\u4e3aclass\u6587\u4ef6\u7684\u7f16\u8bd1\u5668</li> <li>\u4e00\u4e2aplayground\uff0c\u6587\u4ef6\u53d8\u66f4\u65f6\u81ea\u52a8\u89e3\u6790\u3001\u7f16\u8bd1\u3002</li> <li>\u65e0\u5916\u90e8\u4f9d\u8d56</li> </ul>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#_2","title":"\u5177\u4f53\u7ec6\u8282","text":""},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#_3","title":"\u4e00\u5f00\u59cb","text":"<p>\u4e00\u5f00\u59cb\u672c\u6765\u60f3\u7814\u7a76\u4e0bllvm\uff0c\u4f46\u56e0\u4e3a\u624b\u4e0a\u7535\u8111\u662fwindows\uff0c\u5bf9\u7f16\u8bd1\u8fd9\u79cdcpp\u9879\u76ee\u611f\u89c9\u4f1a\u6709\u5751\uff0c\u5c31\u6ca1\u76f4\u63a5\u5c1d\u8bd5\u3002\u4f46\u611f\u89c9\u8fd9\u4e9b\u5e95\u5c42\u7684\u4e1c\u897f\uff0c\u5982\u679c\u53ea\u662f\u4e3a\u4e86\u521d\u6b65\u8dd1\u8d77\u6765\uff0c\u81ea\u5df1\u5199\u4e00\u904d\u4e5f\u4f1a\u662f\u4e2a\u6709\u8da3\u7684\u8fc7\u7a0b\u3002\u5c31\u51b3\u5b9a\u81ea\u5df1\u5f00\u59cb\u5199\u4e86\u3002</p> <p>\u4e00\u5f00\u59cb\u662f\u6309\u7167lexer\u901a\u8fc7nextChar\u7c7b\u4f3c\u65b9\u5f0f\uff0c\u628achar\u8f6c\u4e3atoken\uff0c\u8fdb\u800c\u4ea4\u7ed9parser\u518d\u505a\u5904\u7406\u3002\u6574\u4e2a\u8fc7\u7a0b\u7684lexer\u3001parser\u5168\u90e8\u662f\u9488\u5bf9\u8fd9\u4e2a\u8bed\u8a00\u624b\u52a8\u7f16\u5199\u7684\u3002\u6bd4\u5982\uff0c\u5e0c\u671b\u589e\u52a0\u67d0\u4e2a\u5173\u952e\u5b57\u65f6\uff0c\u5c31\u8981\u5728lexer\u91cc\u8865\u5145\u7279\u5b9a\u7684\u5224\u65ad\uff0c\u8f93\u51fa\u65b0\u7684token\u7c7b\u578b\uff0c\u4ece\u800c\u5728\u540e\u9762\u7684parser\u91cc\u53ef\u4ee5\u5224\u65ad\u3002</p> <p>\u8865\u5145\u8bf4\u660e\u4e00\u4e0b\uff0c\u8fd9\u91cc\u7684\u5927\u81f4\u5de5\u4f5c\u6a21\u578b\u662f\uff0cparser-&gt;lexer.nextToken()-&gt;input.nextChar()...\u3002lexer\u5728\u751f\u6210token\u7684\u6d41\u7a0b\u4e00\u822c\u662f\uff0c\u5403\u6389\u4e00\u6ce2\u8fde\u7eed\u7a7a\u683c\uff0c\u7136\u540e\u8bfb\u53d6\u4e0b\u4e00\u6ce2\u8fde\u7eed\u7684\u6570\u5b57/\u5b57\u6bcd\u6216\u7279\u5b9a\u7684\u7b26\u53f7\u7b49\u7b49\uff0c\u6765\u8fd4\u56de\u4e00\u4e2a\u9700\u8981\u88ab\u89e3\u6790\u5668\u5904\u7406\u7684\u57fa\u672c\u5143\u7d20\u3002</p> <p>\u5982\u679c\u4e00\u95e8\u8bed\u8a00\u7684\u8bed\u6cd5\uff0c\u5df2\u7ecf\u5b9a\u6b7b\u4e86\u3001\u4e0d\u518d\u8f7b\u6613\u6539\u52a8\u4e86\uff0c\u90a3\u4e48\u8fd9\u6837\u5b50\u4e5f\u65e0\u53ef\u539a\u975e\u3002\u4f46\u5bf9\u4e8e\u6211\u6765\u8bf4\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u4ee3\u7801\u6240\u60f3\u8868\u8fbe\u7684\u4e1c\u897f\u5176\u5b9e\u4f1a\u6709\u66f4\u597d\u7684\u62bd\u8c61\u5f62\u5f0f\uff0c\u5c31\u50cf\u6b63\u5219\u8868\u8fbe\u5f0f\u90a3\u6837\uff0c\u6bd4\u5982\u5bf9\u4e8e\u8fde\u7eed\u52a0\u6cd5\uff0ca(+ b)*\uff0c\u5c31\u80fd\u8868\u8fbe\u51fa\u5f88\u591a\u79cd\u5408\u7406\u7684\u53ef\u80fd\u6027\u3002\u6211\u89c9\u5f97\u6bd4\u8d77\u5199\u6b7b\u67d0\u79cd\u7279\u5b9a\u89e3\u6790\uff0c\u8fd8\u662f\u540e\u8005\u8fd9\u79cd\u80fd\u6839\u636e\u8868\u8fbe\u5f0f\u81ea\u52a8\u751f\u6210\u89e3\u6790\u5668\u89e3\u6790\u8bed\u8a00\u811a\u672c\u6765\u7684\u66f4\u723d\u3002</p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#_4","title":"\u8bed\u6cd5\u8868\u8fbe\u5f0f\u3001\u81ea\u52a8\u751f\u6210\u89e3\u6790\u5668","text":"<p>\u4e8e\u662f\uff0c\u5728\u624b\u5199\u4e86\u4e24\u5929\u540e\uff0c\u610f\u8bc6\u5230\u60f3\u7ed9\u5b83\u8865\u5145\u65b0\u7684\u8bed\u6cd5\u89c4\u5219\u65f6\uff0c\u662f\u4f4e\u6548\u7e41\u7410\u7684\uff0c\u8f6c\u800c\u5f00\u59cb\u91cd\u6784\u7528\u201c\u8bed\u6cd5\u8868\u8fbe\u5f0f\u201d\u6765\u81ea\u52a8\u751f\u6210\u89e3\u6790\u5668\uff0c\u5e76\u4e5f\u5141\u8bb8\u6ce8\u5165\u4e00\u4e9b\u624b\u5199\u7684\u89e3\u6790\u5668\u7684\u65b9\u6848\u3002\u5728\u4e24\u5e74\u524d\u6709\u4e86\u89e3\u8fc7ALTAR4/5\uff0c\u4f3c\u4e4e\u662f\u8fd9\u4e2a\u540d\u5b57\uff0c\u5f53\u65f6\u770b\u5230\u90a3\u79cd\u76f4\u63a5\u63cf\u8ff0\u8bed\u6cd5\u89c4\u5219\uff0c\u5c31\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u8bed\u6cd5\u89e3\u6790\u5668\u7684\u611f\u89c9\u4ee4\u4eba\u5370\u8c61\u6df1\u523b\u3002\u6211\u4e5f\u7b97\u5728\u624b\u52a8\u505a\u4e00\u4e2a\u7b80\u5355\u7248\u672c\u7684\u3002</p> <p>\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u601d\u8003\uff0c\u6211\u8bbe\u8ba1\u7684\u63cf\u8ff0\u8bed\u6cd5\u89c4\u5219\u7684\u8868\u8fbe\u5f0f\u5982\u4e0b\uff1a <pre><code>(tag1 tag2 tag3) //tag1, tag2, tag3\u6309\u987a\u5e8f\u5c1d\u8bd5\uff0c\u524d\u4e00\u4e2a\u89e3\u6790\u6210\u529f\u624d\u4f1a\u5c1d\u8bd5\u4e0b\u4e00\u4e2a\u89e3\u6790\u5668\uff0c\u6700\u540e\u4e00\u4e2a\u89e3\u6790\u5668\u6210\u529f\u540e\u5219\u8868\u8fbe\u5f0f\u89e3\u6790\u6210\u529f\n                 //\u4e5f\u5c31\u662f\uff0c\u8fd9\u662f\u4e00\u4e2a\u903b\u8f91 \u4e0e \u7684\u8868\u8fbe\u5f0f\uff0c\u5728\u5185\u90e8\u4f1a\u628a\u51e0\u4e2a\u89e3\u6790\u5668\u5408\u5e76\u4e3a\u4e00\u4e2aand\u89e3\u6790\u5668\u3002\n[tag1 tag2 tag3] //tag1, tag2, tag3\u6309\u987a\u5e8f\u5c1d\u8bd5\uff0c\u6709\u4e00\u4e2a\u89e3\u6790\u6210\u529f\u5219\u8868\u8fbe\u5f0f\u6210\u529f\u3002\n                 //\u4e5f\u5c31\u662f\uff0c\u8fd9\u662f\u4e00\u4e2a\u903b\u8f91 \u6216 \u7684\u8868\u8fbe\u5f0f\uff0c\u5185\u90e8\u4f1a\u628a\u5b83\u4eec\u5408\u5e76\u4e3a\u4e00\u4e2aor\u89e3\u6790\u5668\ntag*            //\u5339\u914d\u6210\u529f\u6b21\u6570\u4e0b\u96500\uff0c\u65e0\u4e0a\u9650\u3002\u6b64\u8868\u8fbe\u5f0f\u603b\u662f\u6210\u529f\u3002\ntag+            //\u5339\u914d\u6210\u529f\u6b21\u6570\u4e0b\u96501\uff0c\u65e0\u4e0a\u9650\u3002\ntag?            //\u5339\u914d\u6210\u529f\u6b21\u6570\u4e0b\u96500\uff0c\u4e0a\u96501\n!tag            //\u82e5tag\u89e3\u6790\u6210\u529f\uff0c\u5219\u6b64\u8868\u8fbe\u5f0f\u89e3\u6790\u5931\u8d25\uff0c\u82e5tag\u89e3\u6790\u5931\u8d25\uff0c\u5219\u6b64\u8868\u8fbe\u5f0f\u89e3\u6790\u6210\u529f\u3002\n\"str\"           //\u4e3a\u56fa\u5b9a\u5b57\u7b26\u4e32\u751f\u6210\u5185\u5bb9\u5339\u914d\u89e3\u6790\u5668\uff0c\u5b8c\u5168\u548cstr\u76f8\u540c\u65f6\u89e3\u6790\u6210\u529f\u3002\n                //\u6ce8\u610f\uff0c\u5b83\u4e5f\u53ef\u4ee5\u4f5c\u4e3atag\u66ff\u6362\u5230\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\u4e2d\ntag1 tag2 tag3  //\u65e0\u62ec\u53f7\u65f6\uff0c\u7b49\u4e8e(tag1 tag2 tag3)\n</code></pre> \u5728\u8bbe\u8ba1\u8fd9\u5957\u8868\u8fbe\u5f0f\u7684\u65f6\u5019\uff0c\u6240\u9700\u7684\u7279\u6027\u4e5f\u662f\u53d6\u81ea\u4e4b\u524d\u624b\u5199\u89e3\u6790\u5668\u7684\u7ecf\u9a8c\u3002\u7279\u6027\u53ef\u4ee5\u7b80\u5355\u5f52\u7eb3\u5982\u4e0b\uff1a</p> <ul> <li>\u903b\u8f91and\u548cor\u3001\u903b\u8f91\u5426\u5b9a</li> <li>\u5339\u914d\u6b21\u6570\u9650\u5236</li> <li>\u53ef\u5d4c\u5957\u4f7f\u7528</li> <li>\u7eaf\u5b57\u7b26\u4e32\u5339\u914d</li> </ul> <p>\u5728\u6ee1\u8db3\u8fd9\u4e9b\u80fd\u529b\u7684\u8868\u8fbe\u8bc9\u6c42\u540e\uff0c\u6211\u89c9\u5f97\u5df2\u7ecf\u80fd\u6ee1\u8db3\u5f88\u591a\u60c5\u51b5\u4f7f\u7528\u4e86\u3002\u81ea\u5df1\u8bbe\u8ba1\u5b8c\u4e4b\u540e\u5c1d\u8bd5\u5199\u4e86\u51e0\u4e2a\u89c4\u5219\uff0c\u611f\u5230\u6ee1\u610f\u3001\u8f7b\u677e\u3001\u6ca1\u6709\u6b67\u4e49\u5c31\u8db3\u591f\u4e86\u3002\u63a5\u4e0b\u6765\u5c31\u662f\u5199\u7a0b\u5e8f\u6765\u5904\u7406\u5b83\u4e86\u3002</p> <p>\u5904\u7406\u8fd9\u5957\u8868\u8fbe\u5f0f\u7684\u601d\u8def\u4e5f\u5f88\u6709\u8da3\u4e14\u7b80\u5355\uff0c\u5c31\u662f\u628a\u4e0a\u9762\u5b9a\u4e49\uff0c\u90fd\u7406\u89e3\u4e3a\u5bf9\u89e3\u6790\u5668\u7684\u4e00\u6b21\u5305\u88c5\uff0c\u4ece\u800c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u89e3\u6790\u5668\u3002\u56e0\u6b64\u6574\u4e2a\u8868\u8fbe\u5f0f\u6700\u7ec8\u8fd4\u56de\u7684\u4e5f\u662f\u4e00\u4e2a\u89e3\u6790\u5668\u3002\u5176\u5b9e\u8fd9\u4e2a\u601d\u8def\u662f\u5f97\u76ca\u4e8e\u4e00\u4e2a\u524d\u63d0\uff1a\u5bf9\u89e3\u6790\u5668\u7684\u7edf\u4e00\u62bd\u8c61\uff0c\u5bf9\u89e3\u6790\u7ed3\u679c\u7684\u7edf\u4e00\u62bd\u8c61\u3002</p> <p>\u8fd9\u91cc\u5305\u62ec\u7684\u62bd\u8c61\u6a21\u578b\u662f\uff1a</p> <ul> <li>Node:{name:string, nodes:Node[]}</li> <li>Parser(LexerContext):Node|undefined</li> <li>LexerContext{ nextChar(); pos():number; seek(number); }</li> </ul> <p>\u5bf9\u89e3\u6790\u5668\u7684\u5305\u88c5\u80fd\u529b\u5305\u62ec\uff1a</p> <ul> <li>and(Parser[]):Parser =&gt; Node result, while((node=parseri &amp;&amp; result.nodes.push(n)))...</li> <li>or(Parser[]):Parser =&gt; while(n = parseri) return n....</li> <li>mc(Parser, minMatchCount, maxMatchCount):Parser</li> <li>neg(Parser):Parser</li> <li>contentParser(str):Parser</li> </ul> <p>\u5230\u6b64\uff0c\u5df2\u7ecf\u53ef\u4ee5\u7f16\u5199\u51fa\u89e3\u6790\u8fd9\u5957\u8bed\u6cd5\u8868\u8fbe\u5f0f\u7684\u89e3\u6790\u5668\u4e86\u3002\u5e76\u8ba9\u5b83\u80fd\u751f\u6210\u65b0\u7684\u89e3\u6790\u5668\uff0c\u548c\u67d0\u4e2atag\u7ed1\u5b9a\u6ce8\u518c\u8d77\u6765\u3002\u5f53\u7136\uff0c\u5728\u771f\u6b63\u5f00\u59cb\u4f7f\u7528\u5b83\u8868\u8fbe\u4e00\u4e9b\u4e0a\u5c42\u8bed\u6cd5\u524d\uff0c\u8fd8\u9700\u8981\u66f4\u57fa\u672c\u7684\u89e3\u6790\u5668\uff0c\u5b83\u4eec\u5145\u5f53\u7740lexer\u628achar\u8f6c\u4e3atoken\u7684\u89d2\u8272\u3002\u6bd4\u5982\uff1a</p> <ul> <li>registerParser('0-9', myDigitParser)</li> <li>registerParser('A-z', myAlphaParser)</li> <li>registerParser('wsc', myWhiteSpaceConsumer)</li> <li>registerParser('br', myLineBreakParser)</li> <li>registerParser('eof', myEofParser)</li> </ul> <p>\u501f\u52a9\u6211\u4eec\u7684tag\u6ce8\u518c\u673a\u5236\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u6ce8\u518c\u751f\u6210\u7684\u89e3\u6790\u5668\uff0c\u4e5f\u53ef\u4ee5\u6ce8\u518c\u81ea\u5df1\u624b\u5199\u7684\u89e3\u6790\u5668\u3002\u5b83\u4eec\u5171\u4eab\u7740\u4e00\u4e2aContext\u3002\u4e5f\u5c31\u662f\uff0c\u5f53\u6709\u4e00\u4e2a\u89e3\u6790\u5668\u89e3\u6790\u6210\u529f\u540e\uff0ccontext\u7684\u4f4d\u7f6e\u4fe1\u606f\u4f1a\u66f4\u65b0\uff0c\u6240\u6709\u7684\u89e3\u6790\u5668\u90fd\u80fd\u6309\u987a\u5e8f\u5728\u4e00\u4e2a\u4e0a\u4e0b\u6587\u5de5\u4f5c\u3002</p> <p>\u6700\u540e\u8fd8\u9700\u8981\u63d0\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u65b9\u5f0f\u4f1a\u9047\u5230\u201c\u7a7a\u683c\u201d\u3001\u201c\u6362\u884c\u201d\u6d88\u8d39\u7684\u95ee\u9898\u3002\u548c\u6587\u7ae0\u4e00\u5f00\u59cb\u7684\u5de5\u4f5c\u6a21\u578b\u4e0d\u540c\uff0c\u5982\u679c\u6211\u7528\u8868\u8fbe\u5f0f(varName \".\" functionName \"()\")\u6765\u8bd5\u56fe\u8868\u8fbe\u7a7a\u53c2\u6570\u51fd\u6570\u8c03\u7528\u7684\u60c5\u51b5\u65f6\uff0c\"   someVar  .  afun  ()  \"\u5c06\u65e0\u6cd5\u88ab\u89e3\u6790\u6210\u529f\u3002\u8fd9\u91cc\u6709\u8bf8\u591a\u539f\u56e0\u3002\u4f46\u4e3a\u4e86\u548c\u4e4b\u524d\u7684\u5de5\u4f5c\u65b9\u5f0f\u63a5\u8fd1\uff0c\u6211\u6dfb\u52a0\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u539f\u5219\uff0c\u81ea\u52a8\u751f\u6210\u7684\u89e3\u6790\u5668\u4f1a\u201c\u5403\u6389\u8fde\u7eed\u7a7a\u767d\u201d\u540e\u518d\u5f00\u59cb\u771f\u6b63\u5de5\u4f5c\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u610f\u5473\u7740\u5982\u4e0b\u7684\u60c5\u51b5\uff1a <pre><code>\u8bed\u6cd5\u8868\u8fbe\u5f0f\uff1a (varName \".\" functionName \"()\")\u3002varName\u548cfunctionName\u90fd\u662f\u81ea\u52a8\u751f\u6210\u7684\u89e3\u6790\u5668\u3002\n\u65e0\u6cd5\u5339\u914d\uff1a\"   someVar  .  afun  ()  \"\u3002\u56e0\u4e3asomeVar\u540e\u9762\u7684\u7a7a\u767d\u65e0\u6cd5\u88ab\u8868\u8fbe\u5f0f\u91cc\u7684\".\"\u5904\u7406\n\nregisterParser(\"dot\",'\".\"')\n\u8bed\u6cd5\u8868\u8fbe\u5f0f\uff1a (varName dot functionName \"()\")\n\u65e0\u6cd5\u5339\u914d\uff1a\"   someVar  .  afun  ()  \"\u3002\u56e0\u4e3aafun\u540e\u9762\u7684\u7a7a\u767d\u65e0\u6cd5\u88ab\u8868\u8fbe\u5f0f\u91cc\u7684\"()\"\u5904\u7406\n\nregisterParser(\"lb\",'\"(\"')\nregisterParser(\"rb\",'\")\"')\n\u8bed\u6cd5\u8868\u8fbe\u5f0f\uff1a (varName dot functionName lb rb)\n\u53ef\u4ee5\u5339\u914d\uff1a\"   someVar  .  afun  ()  \"\u3002\u4f46\u5e76\u975e\u5b8c\u5168\u5339\u914d\uff0c\u5339\u914d\u540econtext\u5904\u4e8e)\u4e4b\u540e\u3002\u4e0b\u4e2a\u89e3\u6790\u5668\u4f9d\u7136\u8981\u6ce8\u610f\u7a7a\u767d\u5904\u7406\u3002\n</code></pre></p> <p>\u5bf9\u4e8e\u6362\u884c\u548ceof\u7684\u5904\u7406\uff0c\u6211\u662f\u90fd\u5728script\u7684\u89e3\u6790\u5668\u4e2d\u5904\u7406\u3002\u800c\u5e76\u6ca1\u6709\u5199\u5728\u7c7b\u4f3c\u8868\u8fbe\u5f0f\u7684\u8bed\u6cd5\u89c4\u5219\u91cc\u3002</p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#_5","title":"\u5b9a\u4e49\u8bed\u6cd5\uff0c\u4f18\u5316\u89e3\u6790\u5668\u7ed3\u679c\uff0c\u751f\u6210\u89e3\u6790\u6811","text":"<p>\u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u73b0\u5728\u7ec8\u4e8e\u53ef\u4ee5\u6bd4\u8f83\u9ad8\u6548\u5730\u5b9a\u4e49\u8bed\u6cd5\u89c4\u5219\u4e86\u3002\u73a9\u4e86\u4e00\u4f1a\uff0c\u5f88\u5feb\u5c31\u4f1a\u610f\u8bc6\u5230\u63a5\u4e0b\u6765\u7684\u95ee\u9898\uff1a\u8fd9\u89e3\u6790\u7ed3\u679c\u6709\u70b9\u590d\u6742\u554a\u3002</p> <p>\u56e0\u4e3a\u4e0a\u9762\u7684\u8bbe\u8ba1\uff0c\u6211\u4eec\u5bf9\u8868\u8fbe\u5f0f\u91cc\u7684\u6700\u57fa\u672c\u5143\u7d20\u8fdb\u884c\u4e86\u5c42\u5c42\u5c01\u88c5\uff0c\u6bcf\u4e00\u6b21\u5c01\u88c5\uff0c\u90fd\u53ef\u80fd\u4f1a\u5e26\u6765\u4e00\u4e2a\u65b0\u7684\u8282\u70b9\u5c42\u7ea7\uff0c\u6700\u540e\u5bfc\u81f4\u8bed\u6cd5\u867d\u7136\u5339\u914d\u987a\u5229\uff0c\u4f46\u5f97\u5230\u7684\u89e3\u6790\u7ed3\u679c\u5f88\u7e41\u7410\u3002\u5bf9\u6b64\uff0c\u6211\u6240\u91c7\u53d6\u7684\u4f18\u5316\u65b9\u5f0f\u662f\uff0c\u589e\u52a0\u4e00\u4e2a\u4f18\u5316\u8fd4\u56de\u7ed3\u679c\u7684\u89e3\u6790\u5668\u5c01\u88c5\u3002\u6216\u8005\u81ea\u5b9a\u4e49\u4e00\u4e2a\u89e3\u6790\u5668\u5c01\u88c5\uff0c\u7528\u4e8e\u5728\u62ff\u5230\u7ed3\u679c\u540e\u628a\u91cc\u9762\u7684\u7ed3\u6784\u68b3\u7406\u597d\u3002 \u76ee\u524d\u8fd9\u4e2a\u65b9\u5f0f\u8fd8\u6bd4\u8f83\u201c\u624b\u52a8\u201d\uff0c\u6211\u5176\u5b9e\u4e00\u76f4\u5728\u60f3\u53e6\u4e00\u79cd\u628a\u89e3\u6790\u7ed3\u679c\u7684\u5c42\u7ea7\u7ed3\u6784\u4e5f\u878d\u5165\u5230\u8bed\u6cd5\u8868\u8fbe\u5f0f\u5b9a\u4e49\u4e2d\u3002\u4f46\u56e0\u4e3a\u53ef\u80fd\u7684\u8bc9\u6c42\u592a\u591a\uff0c\u8fd8\u6ca1\u7cbe\u529b\u53bb\u771f\u6b63\u601d\u8003\u5176\u53ef\u884c\u6027\u3002\u521d\u6b65\u60f3\u6cd5\u7c7b\u4f3c(lb paramList rb){paramList}{\"args\"}\uff0c\u8868\u8fbe\u7684\u542b\u4e49\u662f\u628a\u53ea\u4fdd\u7559\u89e3\u6790\u7ed3\u679c\u91cc\u7684paramList\u7ed3\u6784\uff0c\u5e76\u91cd\u547d\u540d\u4e3aargs\u3002\u4f46\u770b\u8d77\u6765\u8fd8\u662f\u6709\u8bf8\u591a\u95ee\u9898\u3002\u56e0\u6b64\u8fd8\u662f\u5148\u624b\u52a8\u6765\u4f18\u5316\u4e86\u3002</p> <p>\u624b\u52a8\u4f18\u5316\u89e3\u6790\u7ed3\u679c\u65f6\uff0c\u5176\u5b9e\u5c31\u662f\u5173\u4e8e\u8282\u70b9\u6811\u7684\u5404\u79cd\u64cd\u4f5c\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u62bd\u8c61\u51fa\u4e86\u8282\u70b9\u64cd\u4f5c\u5305\u62ec\uff1a</p> <ul> <li>merge\uff0c\u628a\u6240\u6709\u7684\u8282\u70b9\u9012\u5f52\u904d\u5386\u540e\uff0c\u628a\u5185\u90e8\u7684token\u5408\u5e76\u3002\u6700\u540e\u5f97\u5230\u4e00\u4e2aToken\u4f5c\u4e3a\u7ed3\u679c\uff0c\u9002\u5408\u4e00\u4e9b\u4e0d\u9700\u8981\u4fdd\u7559\u89e3\u6790\u7ec6\u8282\u7684\u89c4\u5219\u3002</li> <li>\u5220\u9664</li> <li>\u6253\u5e73\uff08\u5c42\u7ea7\u63d0\u5347\uff09</li> <li>\u91cd\u547d\u540d</li> <li>Visit\uff0c\u5b83\u7684\u4e3b\u8981\u76ee\u7684\u5176\u5b9e\u5c31\u662f\u63d0\u4f9b\u4e00\u4e2a\u901a\u7528\u9012\u5f52\u8bbf\u95ee\u5668\u3002\u6b64\u5916\u6709\u65f6\u5019\u4e5f\u4f1a\u4e3a\u4e86\u64cd\u4f5c\u65b9\u4fbf\uff0c\u4f1a\u9760visit\u6536\u96c6\u51fa\u8282\u70b9\u5217\u8868\uff0c\u7136\u540e\u91cd\u65b0\u521b\u5efa\u81ea\u5df1\u9700\u8981\u7684\u8282\u70b9\u7ed3\u6784\u6765\u5b8c\u5168\u66ff\u6362\u89e3\u6790\u7ed3\u679c\u3002</li> </ul> <p>\u5f53\u7f16\u5199\u201c\u4e8c\u76ee\u8fd0\u7b97\u8868\u8fbe\u5f0f\u201d\u7684\u65f6\u5019\uff0c\u4f1a\u9047\u5230\u4e00\u4e9b\u6311\u6218\uff0c\u5f53\u7136\u4e5f\u662f\u5728\u4e4b\u524d\u4e00\u5f00\u59cb\u624b\u5199Parser\u7684\u65f6\u5019\u5c31\u9047\u5230\u8fc7\u3002\u56e0\u4e3a\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u7684\u95ee\u9898\uff0c\u9700\u8981\u66f4\u590d\u6742\u7684\u903b\u8f91\u6765\u8c03\u6574\u89e3\u6790\u7ed3\u679c\u3002\u4e00\u822c\u4f1a\u628a\u66f4\u9ad8\u4f18\u7684\u6784\u5efa\u6210\u4e00\u4e2a\u5b50\u6811\uff0c\u6dfb\u52a0\u5230\u4e0a\u5c42\u7684\u5de6\u8fd0\u7b97\u6570\u6216\u53f3\u8fd0\u7b97\u6570\u91cc\u3002\u5ea6\u8fc7\u8fd9\u4e2a\u6311\u6218\u3001\u5145\u5206\u6d4b\u8bd5\u3001\u5f97\u5230\u6ee1\u610f\u7684\u7ed3\u679c\u3001\u53ef\u80fd\u4f1a\u82b1\u8d392-6\u4e2a\u5c0f\u65f6\u4e0d\u7b49\u3002</p> <p>\u4e00\u5f00\u59cb\u6211\u8003\u8651\u7684\u6bd4\u8f83\u7b80\u5355\uff0c\u5199\u8033\u76ee\u8fd0\u7b97\u7b26\u8868\u8fbe\u5f0f\u53ea\u662f\u4e3a\u4e86\u6c42+-/*\uff0c\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u4e5f\u662f\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u51e0\u4e2a\u7b26\u53f7\u7684\u4f18\u5148\u7ea7\u3002\u540e\u6765\u53d1\u89c9\uff0c\u5b83\u7684\u7528\u5904\u8fd8\u6709\u5f88\u591a\u3002\u5305\u62ec\u5f88\u591a\u4e8c\u76ee\u903b\u8f91\u8fd0\u7b97\u7b26\uff0c== != &amp;&amp; || &gt;= &lt;= &gt; &lt; \u7b49\u7b49\u3002\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u7684\u652f\u6301\u90fd\u4f9d\u7136\u4f1a\u53d7\u76ca\u4e8e\u8fd9\u4e2a\u903b\u8f91\u3002</p> <p>\u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u6b64\u65f6\uff0c\u6211\u4eec\u5e94\u8be5\u53ef\u4ee5\u5f97\u5230\u5f88\u591a\u4e0d\u9519\u7684\u3001\u6d4b\u8bd5\u826f\u597d\u7684\u201c\u8868\u8fbe\u5f0f\u201d\u8bed\u6cd5\u4e86\u3002\u73b0\u5728\u53ea\u9700\u8981\u518d\u5199\u4e00\u4e2a\u7c7b\u4f3c\u201cscript\u201d\u89e3\u6790\u5668\uff0c\u7c7b\u4f3c\u4ee3\u7801\u5757\u89e3\u6790\u5668\uff0c\u7c7b\u6bd4\u4e00\u4e2a\u8bed\u6cd5\u96c6\u5408\uff0c\u6765\u7528\u5b83\u4f5c\u4e3a\u6700\u5916\u5c42\u7684\u89e3\u6790\u5668\uff0c\u6765\u89e3\u6790\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\u91cc\u7684\u6240\u6709\u5185\u5bb9\u4e86\u3002\u8fd9\u91cc\u552f\u4e00\u53ef\u80fd\u5934\u75bc\u7684\u5c31\u662f\u6362\u884c\u548c\u6587\u4ef6\u7ed3\u5c3e\u7684\u95ee\u9898\u3002\u6211\u82b1\u4e86\u67092-3\u4e2a\u5c0f\u65f6\u5c1d\u8bd5\u4e86\u4e00\u4e9b\u65b9\u5f0f\u89e3\u51b3\u3002\u8fd9\u4e9b\u89e3\u51b3\u65b9\u5f0f\u90fd\u5e76\u6ca1\u6709\u6253\u7834\u4e0a\u9762\u7684\u57fa\u672c\u539f\u5219\u3002\u800c\u662f\u5728\u8fd9\u4e9b\u89c4\u5219\u5185\u7684\u5de7\u5999\u624b\u6bb5\u6765\u89e3\u51b3\uff0c\u4f9d\u7136\u6ee1\u8db3\u539f\u5219\u7684\u7b80\u5355\u6027\u3002</p> <p>\u6b64\u65f6\uff0c\u5728\u5b8c\u6210\u8fd9\u4e9b\u4e4b\u540e\uff0c\u5c31\u80fd\u89e3\u6790\u4e00\u6bb5\u81ea\u5df1\u8bed\u8a00\u7684\u811a\u672c\u4e86\u3002\u68c0\u67e5\u4e0b\u5b83\u7684\u89e3\u6790\u7ed3\u679c\uff0c\u601d\u8003\u4e0b\u662f\u5426\u9700\u8981\u4f18\u5316\u3002\u5982\u679c\u8fd8\u6709\u5174\u8da3\uff0c\u628a\u89e3\u6790\u7ed3\u679c\u4ee5\u66f4\u6709\u8da3\u7684\u65b9\u5f0f\u6253\u5370\u51fa\u6765\u4ee5\u4fbf\u89c2\u5bdf\u5427\u3002</p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#playground","title":"\u4f18\u5316\u62a5\u9519\uff0c\u5199\u4e00\u4e2aplayground","text":"<p>\u65e0\u6cd5\u88ab\u89e3\u6790\u662f\u5f88\u5e38\u89c1\u7684\u4e8b\uff0c\u8fd9\u4e2a\u65f6\u5019context\u4e2d\u4f1a\u6709\u4e0d\u5c11\u5173\u952e\u4fe1\u606f\u53ef\u4ee5\u63d0\u4f9b\u3002\u53ef\u4ee5\u628a\u51fa\u9519\u7684\u5185\u5bb9\u4f4d\u7f6e\u548c\u4e0a\u4e0b\u6587\u7f57\u5217\u6e05\u695a\uff0c\u4ee5\u4fbf\u6211\u4eec\u77e5\u9053\u662f\u54ea\u91cc\u6ca1\u80fd\u89e3\u6790\u3002</p> <p>\u4e4b\u540e\u6211\u6253\u5f00\u4e86\u4e00\u4e2a\u4e4b\u524d\u4e00\u76f4\u672c\u7528\u4f5c\u6d4b\u8bd5\u81ea\u5b9a\u4e49\u811a\u672c\u8f93\u5165\u6e90\u7684\u6587\u4ef6\uff0c\u7528Node fs\u7684watch\u5bf9\u5b83\u6301\u7eed\u89c2\u5bdf\uff0c\u7136\u540e\u89e3\u6790\uff0c\u8f93\u51fa\u89e3\u6790\u7ed3\u679c\uff0c\u4ea6\u6216\u7ed9\u51fa\u62a5\u9519\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u6837\u5b50\uff0c\u5728VS Code\u91cc\uff0c\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u6709\u8da3\u7684Playground\u4e86\u3002\u6211\u5f55\u4e86\u4e00\u4e2a\u52a8\u56fe\uff1a</p> <p></p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#classfilebuilder","title":"\u8ba9\u5b83\u8dd1\u8d77\u6765\uff0cclassFileBuilder","text":"<p>\u5230\u4e86\u8fd9\u4e00\u6b65\uff0c\u6211\u4eec\u62ff\u5230\u4e86\u81ea\u5df1\u8bed\u8a00\u7684\u8bed\u6cd5\u6811\u3002\u8fd8\u5dee\u4e00\u6b65\u624d\u80fd\u8ba9\u5b83\u771f\u6b63\u88ab\u8ba1\u7b97\u673a\u8fd0\u884c\u3002\u8fd9\u91cc\u6211\u8003\u8651\u4e86\u591a\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u7ffb\u8bd1\u6210\u67d0\u4e9b\u8bed\u8a00\uff0c\u5982JavaScript\u3001Java</li> <li>\u8fc1\u79fb\u81f3\u67d0\u4e9b\u66f4\u901a\u7528\u7684AST\uff0c\u4ee5\u501f\u52a9\u76f8\u5e94AST\u7684\u5de5\u5177\u751f\u6001\u3002</li> <li>\u89e3\u91ca\u6267\u884c\uff0c\u5199\u4e00\u4e2a\u89e3\u91ca\u5668\uff0c\u7528\u81ea\u5df1\u7684\u89e3\u91ca\u5668\u8fd0\u884c\u81ea\u5df1\u7684\u811a\u672c\u3002</li> <li>\u7f16\u8bd1\u5230\u5e73\u53f0\uff0c\u7f16\u8bd1\u5230\u67d0\u4e2a\u7279\u5b9a\u5e73\u53f0\uff0c\u6bd4\u5982jvm\u3002native\u7684\u5e73\u53f0\u5c31\u4e0d\u592a\u6562\u60f3\u4e86\uff0c\u9664\u975e\u7528llvm\u3002\u4e0d\u7136\u5de5\u4f5c\u91cf\u5e94\u8be5\u662f\u60ca\u4eba\u7684\uff0c\u6216\u8005\u4e5f\u662f\u6211\u76ee\u524d\u4e0d\u64c5\u957f\u7684\u3002</li> </ul> <p>\u5176\u5b9e\u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\uff0c\u5199\u4e00\u4e2a\u865a\u62df\u673a\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u8fd8\u662f\u7559\u7ed9\u672a\u6765\u5427\uff08\u4e3a\u4ec0\u4e48\u8981\u5199\u4e00\u4e2a\u865a\u62df\u673a\uff1f\u56e0\u4e3a\u611f\u89c9\u6bd4\u8d77\u4e00\u5473\u53bb\u7406\u89e3jvm\u7684\u79cd\u79cd\u4e1c\u897f\uff0c\u4e0d\u5982\u81ea\u5df1\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u53bb\u610f\u8bc6\u5230\u8981\u9762\u4e34\u54ea\u4e9b\u95ee\u9898\uff0c\u4ee5\u53ca\u5927\u6982\u600e\u4e48\u89e3\u51b3\uff09\u3002</p> <p>\u662f\u7684\uff0c\u80fd\u60f3\u5230\u8fd9\u4e9b\u6709\u8da3\u7684\u65b9\u5f0f\uff0c\u4e5f\u662f\u505a\u8fd9\u4ef6\u4e8b\u7ed9\u6211\u7684\u5de8\u5927\u4e50\u8da3\u54c8\u54c8\u3002</p> <p>\u90a3\u4e48\u8be5\u600e\u4e48\u9009\u62e9\u5462\u3002</p> <ul> <li>\u65b9\u5f0f1\uff0c\u6211\u89c9\u5f97\u6709\u70b9\u65e0\u804a\u3002\u6216\u8bb8\u6709\u673a\u4f1a\u53ef\u4ee5\u7814\u7a76\u4e0bbabel.js\uff0c\u4f46\u603b\u4e4b\u8fd8\u662f\u504f\u65e0\u804a\u3002\u628a\u81ea\u5df1\u7684\u4e1c\u897f\u7ffb\u8bd1\u5230\u4e00\u4e2a\u81ea\u5df1\u719f\u6089\u7684\u8bed\u8a00\uff0c\u542c\u4e0a\u53bb\u6536\u83b7\u5f88\u5c11\u3001\u6311\u6218\u4e00\u822c\u3002</li> <li>\u65b9\u5f0f2\uff1aAST\u8f6c\u6362\u3002\u662f\u6211\u4e86\u89e3\u4e0d\u591a\u7684\u9886\u57df\uff0c\u4f1a\u6709\u6536\u83b7\u3002\u4f46\u8f6cAST\u5e94\u8be5\u4ee4\u6211\u5934\u75bc\u3002\u6bd5\u7adf\uff0cAST\u548c\u81ea\u5df1\u7684\u8bed\u6cd5\u8bbe\u8ba1\u8fd8\u662f\u633a\u7d27\u5bc6\u7684\u3002</li> <li>\u65b9\u5f0f3\uff1a\u4e0d\u9519\uff0c\u65e9\u5c31\u77e5\u9053JIT\u4e86\uff0c\u4f46\u4e86\u89e3\u4e00\u76f4\u4e0d\u591f\u6df1\u523b\uff0c\u503c\u5f97\u81ea\u5df1\u5199\u4e00\u4e0b\u8bd5\u8bd5\u3002\uff08\u672a\u6765\u641e\uff09</li> <li>\u65b9\u5f0f4\uff1a\u6211\u9009\u4e86\u7f16\u8bd1\u5230jvm\u3002\u4e3b\u8981\u662f\u60f3\u52a0\u6df1\u4e0b\u5bf9class\u6587\u4ef6\u7684\u5370\u8c61\u3002\u6bd5\u7adf\u81ea\u5df1\u4e4b\u524d\u505a\u5b89\u5353\u6bd4\u8f83\u4e45\u3002\u5bf9class\u6587\u4ef6\u5370\u8c61\u518d\u6df1\u4e00\u4e9b\u8fd8\u662f\u6709\u610f\u4e49\u7684\u3002</li> </ul> <p>\u8fc7\u7a0b\u4e5f\u662f\u6bd4\u8f83\u987a\u5229\u3002\u5176\u5b9e\u5c31\u662f\u628ajvm specification\u6253\u5f00\uff0c\u7b2c\u56db\u7ae0\uff0cclass\u6587\u4ef6\u7ed3\u6784\u3002\u7b2c\u4e8c\u7ae0\uff0c\u67e5\u6307\u4ee4\u3002\u628a\u91cc\u9762\u7684\u4e00\u90e8\u5206\u4e1c\u897f\u7ffb\u8bd1\u51fa\u6765\u5c31\u884c\u4e86\u3002\u7cbe\u529b\u6709\u9650\uff0c\u53ea\u7ffb\u8bd1\u4e86\u81ea\u5df1\u5173\u5fc3\u7684\u3002</p> <p>\u6211\u5148javac -g:none Hello.java\u7f16\u8bd1\u4e86\u4e00\u4e2a\u4e0d\u5e26\u8c03\u8bd5\u4fe1\u606f\u7684Hello world\uff08\u4e00\u5f00\u59cb\u6ca1\u6ce8\u610f\uff0c\u8c03\u8bd5\u4fe1\u606f\u6709\u70b9\u62d6\u5f00\u53d1\u8282\u594f\uff0c\u7740\u6025\u7684\u8bdd\uff0c\u5c31\u53bb\u6389\u5427\uff09\u3002 \u62ff\u5230Hello.class\u540e\u53ef\u4ee5\u5bf9\u7167javap\u7684\u7ed3\u679c\uff0c\u5e76\u7528\u4e8c\u8fdb\u5236\u67e5\u770b\u5668\u3001\u8f85\u4ee5Jvm Specification\u7b2c\u56db\u7ae0\uff0c\u8fb9\u8bfb\u8fb9\u7406\u89e3\u3002\u7136\u540e\u7f16\u7801\u7ffb\u8bd1\u3002</p> <p>\u6211\u5148\u9760\u6b64\u8fc7\u7a0b\u8f93\u51fa\u4e86\u4e00\u4e2aclass_file\u7684\u7ed3\u6784\u5b9a\u4e49\uff0c\u5305\u62ec\u91cc\u9762\u4e3b\u8981\u7684\u7ed3\u6784\u5b9a\u4e49\u3002\u7136\u540e\u9760\u8fd9\u4e9b\u7ed3\u6784\u5b9a\u4e49\uff0c\u7167\u7740javap Hello.class\u7684\u5185\u5bb9\u624b\u52a8\u786c\u751f\u751f\u7ec4\u88c5\u51fa\u4e00\u4e2aclass\u6587\u4ef6\u3002\u7136\u540e\u7528\u4e8c\u8fdb\u5236diff\u5de5\u5177\u4e00\u70b9\u70b9\u5bf9\u6bd4\uff0c\u4fee\u590d\u6240\u6709\u95ee\u9898\u540e\u3002\u518d\u8fdb\u4e00\u6b65\u63d0\u70bc\u4e00\u4e9b\u65b9\u6cd5\uff0c\u6765\u7b80\u5316class_file\u7684\u7ed3\u6784\u751f\u6210\u3001\u4ee5\u53cacode\u5c5e\u6027\u7684\u751f\u6210\u8fc7\u7a0b\u3002</p> <p>\u7ecf\u8fc7\u4e00\u4e9b\u52aa\u529b\uff0c\u5f97\u5230\u4e86ClassFileBuilder\uff0c\u548cCodeBuilder\u3002\u901a\u8fc7\u8fd9\u4e24\u4e2a\u7c7b\u7684api\u3002\u5c31\u53ef\u4ee5\u5728\u6bd4\u8f83\u77ed\u7684\u63cf\u8ff0\u4e0b\uff0c\u6784\u5efa\u51faHello World\u7684class\u6587\u4ef6\u4e86\u3002\u5f53\u7136\u9664\u4e86Hello World\uff0c\u8fd8\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u9700\u8981\uff0c\u9010\u6e10\u4f7f\u7528\u66f4\u590d\u6742\u7684java\u6587\u4ef6\uff0c\u589e\u52a0\u66f4\u590d\u6742\u7684class\u6587\u4ef6\u652f\u6301\u3002</p> <p>\u5982\u4e0b\u56fe\u662f\u5bf9\u6bd4\u9760\u624b\u52a8\u7ec4\u88c5class_file\u7ed3\u6784\uff0c\u548c\u4f7f\u7528\u5c01\u88c5\u540e\u7684classFileBuilder\u7684\u5dee\u5f02\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4e3b\u8981\u5c31\u662f\u5728\u66f4\u6539\u4e00\u4e9b\u540e\uff0c\u65f6\u4e0d\u65f6\u6d4b\u8bd5\u4e00\u4e0b\u4fdd\u8bc1\u5f97\u5230\u7684class\u6587\u4ef6\u80fd\u88abjavap\u89e3\u6790\uff0c\u80fdjava\u8dd1\u901a\uff0c\u8f93\u51fa\u7b26\u5408\u9884\u671f\u7684\u7ed3\u679c\u3002</p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#compiler","title":"\u5199Compiler","text":"<p>\u73b0\u5728\u53ea\u9700\u8981\u5173\u6ce8\u5982\u4f55\u628a\u89e3\u6790\u51fa\u6765\u7684\u8bed\u6cd5\u6811\uff0c\u8f6c\u4e3a\u5408\u9002\u7684classFileBuilder\u7684\u4f7f\u7528\u4e86\u3002\u4ea6\u6216\u8005\u8bf4\uff0c\u6838\u5fc3\u662f\uff0c\u904d\u5386Node\u8282\u70b9\u5e76\u8f6c\u4e3a\u5408\u9002\u7684Builder\u8c03\u7528\u3002\u6216\u8bb8\u8fd9\u4e0d\u7b97\u4e25\u683c\u7684compiler\u5b9a\u4e49\uff0c\u4f46\u5904\u4e8e\u7b80\u5355\u573a\u666f\uff0c\u6b64\u65f6\u9700\u8981\u5b83\u6765\u626e\u6f14\u8fd9\u4e2a\u89d2\u8272</p> <p>\u6211\u7684\u8bbe\u8ba1\u662f\uff0c\u5bf9\u6bcf\u4e2a\u8282\u70b9\u90fd\u5e94\u8be5\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u8282\u70b9\u5904\u7406\u5668\u3002\u8282\u70b9\u5904\u7406\u5668\u4e4b\u95f4\u57fa\u672c\u5171\u4eab\u4e00\u4e2a\u4e0a\u4e0b\u6587\uff0c\u4ece\u4e0a\u4e0b\u6587\u4e2d\u83b7\u5f97codeBuilder\u7684api\u3001\u4ee5\u53ca\u5176\u4ed6\u4fe1\u606f\uff0c\u6bd4\u5982\u53d8\u91cf\u8868\u7b49\u3002\u8fd9\u4e9b\u5904\u7406\u5668\uff0c\u6709\u7684\u5de5\u4f5c\u4f1a\u590d\u6742\u4e00\u4e9b\uff0c\u6709\u7684\u5219\u7b80\u5355\u4e00\u4e9b\uff0c\u751a\u81f3\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u6bd4\u5982\u5bf9\u4e8e\u201c\u6ce8\u91ca\u201d\u7c7b\u578b\u7684\u8282\u70b9\uff0c\u5c31\u4ec0\u4e48\u90fd\u4e0d\u505a\uff08\u54e6\uff0c\u5f53\u7136\u6211\u4eec\u4e0d\u4f1a\u8003\u8651\u7c7b\u4f3c\u8f93\u51fadoc\u8fd9\u79cd\u590d\u6742\u7684\u529f\u80fd\uff0c\u5bf9\u4e8eclass\u751f\u6210\u6765\u8bf4\u5b83\u786e\u5b9e\u4e0d\u9700\u8981\u5173\u6ce8\uff09\u3002</p> <p>\u56e0\u4e3a\u6211\u7684\u6700\u5916\u5c42\u8282\u70b9\u662fscript\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6d41\u7a0b\u5165\u53e3\u57fa\u672c\u5c31\u662f\uff0c\u627e\u5230script\u7684\u8282\u70b9\u5904\u7406\u5668\uff0c\u5f00\u59cb\u5904\u7406script\u8282\u70b9\u3002script\u8282\u70b9\u5904\u7406\u5668\u4f1a\u8d1f\u8d23\u57fa\u4e8e\u8f93\u5165\u7684context\uff0c\u521b\u5efa\u65b0\u7684context\uff0c\u5b9a\u4e49className, packageName,\u505a\u4e00\u4e9bclassFile\u7684\u8bbe\u5b9a\uff0c\u6dfb\u52a0\u7a7a\u6784\u9020\u3001\u4e3b\u65b9\u6cd5\uff0c\u7136\u540e\u904d\u5386\u5b50\u8282\u70b9\uff0c\u6ce8\u5165\u65b0\u521b\u5efa\u7684context\uff0c\u5b50\u8282\u70b9\u7684\u5904\u7406\u5668\u4eec\u4ececontext\u91cc\u62ff\u5230\u7684codeBuilder\u5c31\u662fscript\u5bf9\u5e94\u6784\u9020\u7684classFile\u7684\u4e86\u3002</p> <p>\u8282\u70b9\u5904\u7406\u5668\u505a\u7684\u4e8b\u60c5\u5927\u6982\u662f\uff1a</p> <ul> <li>\u201c\u58f0\u660e\u201d\u8282\u70b9\u5904\u7406\u5668\uff1a\u8bb0\u5f55\u53d8\u91cf\u540d\uff0c\u53d8\u91cf\u7c7b\u578b</li> <li>\u201c\u5916\u90e8\u58f0\u660e\u201d\u8282\u70b9\u5904\u7406\u5668\uff1a\u8bb0\u5f55\u53d8\u91cf\u540d\uff0c\u89e3\u6790\u5916\u90e8Id\u3002</li> <li>\u201c\u8d4b\u503c\u201d\u8282\u70b9\u5904\u7406\u5668\uff1a\u5148\u8ba9\u53f3\u4fa7\u8868\u8fbe\u5f0f\u81ea\u884c\u5904\u7406\uff08\u503c\u8868\u8fbe\u5f0f\u5904\u7406\uff09\uff0c\u7136\u540e\u5904\u7406\u5de6\u8868\u8fbe\u5f0f\uff08\u53d8\u91cf\u540d\uff09\uff0c\u83b7\u53d6\u53d8\u91cf\u7d22\u5f15\u3001\u7c7b\u578b\uff0cxstore</li> <li>\u201c\u503c\u8868\u8fbe\u5f0f\u201d\u8282\u70b9\u5904\u7406\u5668\uff1a\u5b50\u8282\u70b9\u81ea\u884c\u89e3\u6790</li> <li>\u201c\u53d8\u91cf\u540d\u201d\u8282\u70b9\u5904\u7406\u5668\uff1a\u67e5\u8be2\u4e0a\u4e0b\u6587\u53d8\u91cf\u8868\u6709\u65e0\u6b64\u53d8\u91cf\uff0c\u83b7\u53d6\u7c7b\u578b\u4fe1\u606f\uff0c\u6216\u8bb8\u53d8\u91cf\u7d22\u5f15\uff0cxload</li> <li>\u201c\u6570\u5b57\u201d\u8282\u70b9\u5904\u7406\u5668\uff1aldc</li> <li>\u201c\u5b57\u9762\u91cf\u201d\u8282\u70b9\u5904\u7406\u5668\uff1aldc</li> <li>\u201c\u4e8c\u76ee\u8fd0\u7b97\u201d\uff1a\u5de6\u4fa7\u8282\u70b9\u81ea\u884c\u5904\u7406\u3001\u53f3\u4fa7\u8282\u70b9\u81ea\u884c\u5904\u7406\uff0c\u65e0\u8111 iadd/isub....etc\u3002\u76ee\u524d\u6ca1\u8003\u8651\u66f4\u590d\u6742\u60c5\u51b5\u3001\u4e5f\u6ca1\u8003\u8651\u7c7b\u578b\u95ee\u9898</li> <li>\u201c\u65b9\u6cd5\u8c03\u7528\u201d\uff1a\u6709\u4e9b\u590d\u6742\uff0c\u6709callee\u5219\u5148\u89e3\u6790callee\uff0c\u7136\u540e\u51c6\u5907\u53c2\u6570\u5217\u8868\uff08\u5b50\u8282\u70b9\u81ea\u884c\u5904\u7406\uff09\uff0c\u7136\u540e\u89e3\u6790\u65b9\u6cd5\u540d\uff0c\u56e0\u4e3a\u57fa\u672c\u90fd\u662f\u8d70external\u65b9\u6cd5\uff0c\u5373java\u7684\u65b9\u6cd5\uff0c\u4f1a\u6d89\u53ca\u65b9\u6cd5\u91cd\u8f7d\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e0d\u5f97\u4e0d\u68c0\u67e5\u53c2\u6570\u7c7b\u578b\u548c\u65b9\u6cd5\u7b7e\u540d\u4e2d\u7684\u7c7b\u578b\u5339\u914d\u4e86\u3002</li> </ul> <p>\u7efc\u4e0a\uff0c\u5176\u5b9e\u4f1a\u610f\u8bc6\u5230\uff0ccompiler\u662f\u4e00\u4e2a\u975e\u5e38\u590d\u6742\u7684\u90e8\u5206\u3002\u5bf9\u6211\u800c\u8a00\uff0c\u611f\u5230\u56f0\u96be\u7684\u5730\u65b9\u5728\u4e8e\uff1a</p> <ul> <li>\u7c7b\u578b\u89e3\u6790\u3001\u6bd4\u5bf9\u3002\u56e0\u4e3a\u8f6c\u4e3a\u5177\u4f53\u7684jvm instruction\u7684\u65f6\u5019\uff0c\u5f88\u591a\u6307\u4ee4\u662f\u9700\u8981\u533a\u5206i/a/f/d/s\u7b49\u7684\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u7c7b\u578b\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6ca1\u6709\u9b54\u6cd5\uff0c\u53ea\u80fd\u53bb\u9009\u62e9\u51c6\u786e\u7684\u7c7b\u578b\u6765\u8c03\u7528\u3002</li> <li>\u65b9\u6cd5\u5339\u914d\u3002\u8981\u8f6c\u4e3aJava\u7684\u5177\u4f53\u65b9\u6cd5\u65f6\uff0c\u6d89\u53ca\u5230\u65b9\u6cd5\u91cd\u8f7d\uff0c\u9700\u8981\u5bf9\u65b9\u6cd5\u7b7e\u540d\u7684\u53c2\u6570\u548cCompiler\u4e2d\u89e3\u6790\u7684\u7c7b\u578b\u505a\u5bf9\u6bd4\u3002\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u65b9\u6cd5\u7b7e\u540d\u6765\u8c03\u7528\u3002</li> </ul> <p>\u5f53\u89e3\u51b3\u4e4b\u540e\uff0c\u8fd9\u4e2a\u7f16\u8bd1\u5668\u81f3\u5c11\u4f1a\u62a5\u51fa\u4e24\u7c7b\u5e38\u89c1\u7684\u4e3b\u8981\u9519\u8bef\uff1a</p> <ul> <li>\u4f7f\u7528\u4e86\u672a\u58f0\u660e\u7684\u53d8\u91cf\u540d</li> <li>\u65e0\u6cd5\u627e\u5230\u5408\u9002\u7684\u65b9\u6cd5</li> </ul> <p>\u8fd9\u4e00\u5207\u8fd8\u662f\u6ca1\u6709\u6d89\u53ca\u5230\u201c\u6761\u4ef6\u201d\u201c\u5faa\u73af\u201d\u201c\u65b9\u6cd5\u58f0\u660e\u201d\u7684\u3002\u66f4\u6ca1\u6709\u9ad8\u7ea7\u7684\u201c\u63a5\u53e3\u201d\u201c\u7c7b\u201d\u201c\u7c7b\u578b\u53c2\u6570\u201d\u7b49\u7b49\u3002</p> <p>\u56e0\u4e3a\u6211\u505a\u7684\u6bd4\u8f83\u7c97\u7cd9\uff0c\u4ee5\u81f3\u4e8e\u6709\u5f88\u591a\u9519\u8bef\u5728\u7f16\u8bd1\u5668\u90fd\u6ca1\u68c0\u67e5\uff0c\u9700\u8981\u81ea\u884c\u4fdd\u8bc1\uff0c\u4e0d\u7136\u4f1a\u8fd0\u884c\u65f6\u9047\u5230\u4e00\u4e9b\u201c\u9177\u70ab\u201d\u7684\u9519\u8bef\u3002\u4e4b\u6240\u4ee5\u8bf4\u5b83\u201c\u9177\u70ab\u201d\u662f\u56e0\u4e3a\uff0c\u8fd9\u4e9b\u9519\u8bef\uff0c\u5e73\u65f6\u76f4\u63a5\u5199Java/kotlin\u65f6\u4f3c\u4e4e\u662f\u6ca1\u770b\u5230\u8fc7\u7684\u3002\u524d\u8005\u4e3b\u8981\u662fjvm instruction\u8c03\u7528\u5931\u8d25\u3001\u51fa\u73b0\u9519\u8bef\u4e86\u3002\u800c\u540e\u8005\u5f80\u5f80\u662f\u4e3b\u52a8\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u5728jvm instruction\u6267\u884c\u5c42\u9762\u4e0a\u5e76\u6ca1\u6709\u95ee\u9898\u3002</p> <p>\u4e00\u5f00\u59cb\u8bbe\u8ba1\u8bed\u6cd5\u7684\u65f6\u5019\uff0c\u5e76\u6ca1\u6709\u8003\u8651\u7c7b\u578b\u58f0\u660e\uff0c\u662f\u5199\u7f16\u8bd1\u5668\u8fd9\u4e2a\u73af\u8282\u53d1\u73b0\u6ca1\u6709\u7c7b\u578b\u4fe1\u606f\u5b9e\u5728\u592a\u96be\u63a8\u65ad\u51fa\u7c7b\u578b\u3001\u4ece\u800c\u65e0\u6cd5\u786e\u5b9a\u5408\u9002\u7684jvm instruction\u3002\u6240\u4ee5\u8d76\u7d27\u8865\u4e0a\u4e86\u53ea\u8ba4\u4e00\u79cd\u7c7b\u578b\uff1aint\u3002</p>"},{"location":"Lx/%E6%97%A0%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%AF%AD%E8%A8%80%E8%B7%91%E8%B5%B7%E6%9D%A5/#playground_1","title":"\u7ed3\u5408Playground\uff0c\u5927\u529f\u544a\u6210","text":"<p>\u52a0\u4e0a\u6211\u4eec\u7684playground\uff0c\u6211\u4eec\u5728\u6587\u4ef6\u53d8\u66f4\u65f6\uff0c\u8bed\u6cd5\u89e3\u6790\u6210\u529f\u540e\uff0c\u4ea4\u7ed9compiler\uff0c\u5982\u679ccompiler\u4e5f\u6210\u529f\u7f16\u8bd1\uff0c\u8fb9\u7ed9\u51fa\u4e00\u53e5cmd\u6307\u4ee4\u4ee5\u4fbf\u6211\u4eec\u8fd0\u884c\u8f93\u51fa\u7684class\u7a0b\u5e8f\u3002\u5982\u679ccompiler\u7f16\u8bd1\u5931\u8d25\uff0c\u90a3\u4e48\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u975e\u5e38\u7b80\u5355\u7684\u9519\u8bef\u3002\u5f53\u7136\u8fd8\u6709\u66f4\u591a\u9519\u8bef\u5728\u8fd0\u884c\u8f93\u51fa\u7684class\u6587\u4ef6\u91cc\u3002\u8fd9\u79cd\u65f6\u5019\uff0c\u9700\u8981\u6211\u4eec\u770b\u770b\u8f93\u51faclass\u6587\u4ef6\u65f6\uff0c\u7a76\u7adf\u5199\u4e86\u54ea\u4e9b\u6307\u4ee4\u3002\u5f97\u76ca\u4e8eJavascript\u7684Object.prototype\uff0c\u6211\u4eec\u7ed9builder\u5199\u5165\u6307\u4ee4\u7684\u65f6\u5019\u5305\u88c5\u4e86log\u3002\u4ece\u800c\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u8bca\u65ad\u95ee\u9898\u3002</p> <p>\u7efc\u4e0a\uff0c\u5c31\u662f\u8fd9\u4e00\u5468\u65f6\u95f4\u7684\u6709\u8da3\u65c5\u7a0b\uff0c\u4eb2\u624b\u5199\u8fd9\u4e9b\u57fa\u7840\u7684\u4e1c\u897f\u6536\u83b7\u5f88\u591a\uff0c\u4f46\u611f\u89c9\u5982\u679c\u5728\u66f4\u65e9\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u5927\u5b66\u672c\u79d1\u53bb\u5b8c\u6210\u4f3c\u4e4e\u5c31\u66f4\u597d\u4e86\u3002</p> <p>\u9644\u4e0a\u4e00\u5f20\u56fe\u7247\u7ed3\u675f\u8fd9\u4e2a\u77ed\u6682\u7684\u65c5\u7a0b\u5427\u3002</p> <p></p>"},{"location":"Rust/rust/","title":"Rust","text":"<p>\u6b64\u6587\u6863\u5f85\u5b8c\u5584</p> <p>\u4e4b\u6240\u4ee5\u60f3\u4e86\u89e3Rust\uff0c\u662f\u60f3\u5173\u6ce8\u4e0b\u5b83\u63d0\u51fa\u7684\u89e3\u51b3\u5e76\u53d1\u5b89\u5168\u548c\u5185\u5b58\u51e0\u4e4e\u4e0d\u9700\u8981\u56de\u6536\u7684\u65b9\u6cd5\u3002</p> <p>\u56e0\u4e3a\u8fd9\u4e00\u7279\u6027\uff0c\u4f7f\u5b83\u7279\u522b\u9002\u5408\u7f16\u5199\u57fa\u7840\u5c42\u7684\u4ee3\u7801\uff0c\u5185\u5b58\u5b89\u5168\u9ad8\u6548\uff0c\u5e76\u53d1\u5b89\u5168\u9ad8\u6548\u3002</p>"},{"location":"Rust/rust/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Rust\u5b98\u7f51</li> <li>boa rust js engine.</li> <li>starlight rust js engine.</li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/%E5%90%89%E4%BB%96%E6%8C%87%E5%9E%8B%E6%8E%A8%E5%AF%BC/","title":"\u5409\u4ed6\u6307\u578b\u63a8\u5bfc","text":"<p>0\ufe0f\u20e31\ufe0f\u20e32\ufe0f\u20e33\ufe0f\u20e34\ufe0f\u20e3\ud83d\udd34\ud83d\udfe0\ud83d\udfe1\ud83d\udfe2\ud83d\udd35\ud83d\udfe3\u2b55</p> 0 1 2 3 4 C/a #C/#a 0 1 2 3 4 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 0 1 2 3 4 D/b 0 1 2 3 4 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 0 1 2 3 4 #D/c 0 1 2 3 4 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 0 1 2 3 4 E/#c 0 1 2 3 4 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 0 1 2 3 4 F/d #F/#d 0 1 2 3 4 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 0 1 2 3 4 G/e 0 1 2 3 4 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 0 1 2 3 4 #G/f 0 1 2 3 4 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 0 1 2 3 4 A/#f 0 1 2 3 4 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 0 1 2 3 4 #A/g 0 1 2 3 4 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 0 1 2 3 4 B/#g 0 1 2 3 4 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udfe1 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 C/a \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 <p>Blues</p> 0 1 2 3 4 5 6 7 8 9 10 11 12 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udfe1 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 <p>Blues</p> 0 1 2 3 4 5 6 7 8 9 10 11 12 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 <p>Major</p> 0 1 2 3 4 5 6 7 8 9 10 11 12 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 <p>Major+</p> 0 1 2 3 4 5 6 7 8 9 10 11 12 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd35 \ud83d\udd34 \ud83d\udd35 \ud83d\udd35"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/Linux%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E3%80%81%E6%A0%87%E5%87%86%E5%BA%93/","title":"Linux\u7cfb\u7edf\u8c03\u7528\u3001\u6807\u51c6\u5e93","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/Linux%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E3%80%81%E6%A0%87%E5%87%86%E5%BA%93/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Linux programming interface part1</li> <li>Linux programming interface part2</li> <li>Linux driver development</li> </ul>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/cpu-mcu-isc/","title":"Cpu mcu isc","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/cpu-mcu-isc/#cpumpumcusocdsp","title":"CPU/MPU/MCU/SOC/DSP","text":"<p>CPU\uff08Central Processing Unit\uff0c\u4e2d\u592e\u5904\u7406\u5668\uff09\u53d1\u5c55\u51fa\u6765\u4e09\u4e2a\u5206\u679d\uff0c\u4e00\u4e2a\u662fDSP\uff08Digital Signal Processing/Processor\uff0c\u6570\u5b57\u4fe1\u53f7\u5904\u7406\uff09\uff0c\u53e6\u5916\u4e24\u4e2a\u662fMCU\uff08Micro Control Unit\uff0c\u5fae\u63a7\u5236\u5668\u5355\u5143\uff09\u548cMPU\uff08Micro Processor Unit\uff0c\u5fae\u5904\u7406\u5668\u5355\u5143\uff09\u3002</p> <p>1\u3001CPU(Central Processing Unit)\uff0c\u662f\u4e00\u53f0\u8ba1\u7b97\u673a\u7684\u8fd0\u7b97\u6838\u5fc3\u548c\u63a7\u5236\u6838\u5fc3\u3002CPU\u7531\u8fd0\u7b97\u5668\u3001\u63a7\u5236\u5668\u548c\u5bc4\u5b58\u5668\u53ca\u5b9e\u73b0\u5b83\u4eec\u4e4b\u95f4\u8054\u7cfb\u7684\u6570\u636e\u3001\u63a7\u5236\u53ca\u72b6\u6001\u7684\u603b\u7ebf\u6784\u6210\u3002\u5dee\u4e0d\u591a\u6240\u6709\u7684CPU\u7684\u8fd0\u4f5c\u539f\u7406\u53ef\u5206\u4e3a\u56db\u4e2a\u9636\u6bb5\uff1a\u63d0\u53d6(Fetch)\u3001\u89e3\u7801(Decode)\u3001\u6267\u884c(Execute)\u548c\u5199\u56de(Writeback)\u3002 CPU\u4ece\u5b58\u50a8\u5668\u6216\u9ad8\u901f\u7f13\u51b2\u5b58\u50a8\u5668\u4e2d\u53d6\u51fa\u6307\u4ee4\uff0c\u653e\u5165\u6307\u4ee4\u5bc4\u5b58\u5668\uff0c\u5e76\u5bf9\u6307\u4ee4\u8bd1\u7801\uff0c\u5e76\u6267\u884c\u6307\u4ee4\u3002\u6240\u8c13\u7684\u8ba1\u7b97\u673a\u7684\u53ef\u7f16\u7a0b\u6027\u4e3b\u8981\u662f\u6307\u5bf9CPU\u7684\u7f16\u7a0b\u3002</p> <p>2\u3001MPU (Micro Processor Unit)\uff0c\u53eb\u5fae\u5904\u7406\u5668(\u4e0d\u662f\u5fae\u63a7\u5236\u5668)\uff0c\u901a\u5e38\u4ee3\u8868\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684CPU(\u6682\u4e14\u7406\u89e3\u4e3a\u589e\u5f3a\u7248\u7684CPU\u5427),\u4f46\u4e0d\u662f\u4e3a\u4efb\u4f55\u5df2\u6709\u7684\u7279\u5b9a\u8ba1\u7b97\u76ee\u7684\u800c\u8bbe\u8ba1\u7684\u82af\u7247\u3002\u8fd9\u79cd\u82af\u7247\u5f80\u5f80\u662f\u4e2a\u4eba\u8ba1\u7b97\u673a\u548c\u9ad8\u7aef\u5de5\u4f5c\u7ad9\u7684\u6838\u5fc3CPU\u3002Intel X86\uff0cARM\u7684\u4e00\u4e9bCortex-A\u82af\u7247\u5982\u98de\u601d\u5361\u5c14i.MX6\u3001\u5168\u5fd7A20\u3001TI AM335X\u7b49\u90fd\u5c5e\u4e8eMPU\u3002</p> <p>3\u3001MCU(Micro Control Unit)\uff0c\u53eb\u5fae\u63a7\u5236\u5668\uff0c\u662f\u6307\u968f\u7740\u5927\u89c4\u6a21\u96c6\u6210\u7535\u8def\u7684\u51fa\u73b0\u53ca\u5176\u53d1\u5c55\uff0c\u5c06\u8ba1\u7b97\u673a\u7684CPU\u3001RAM\u3001ROM\u3001\u5b9a\u65f6\u8ba1\u6570\u5668\u548c\u591a\u79cdI/O\u63a5\u53e3\u96c6\u6210\u5728\u4e00\u7247\u82af\u7247\u4e0a\uff0c\u5f62\u6210\u82af\u7247\u7ea7\u7684\u82af\u7247\uff0c\u6bd4\u598251\uff0cAVR\u3001Cortex-M\u8fd9\u4e9b\u82af\u7247\uff0c\u5185\u90e8\u9664\u4e86CPU\u5916\u8fd8\u6709RAM\u3001ROM\uff0c\u53ef\u4ee5\u76f4\u63a5\u52a0\u7b80\u5355\u7684\u5916\u56f4\u5668\u4ef6(\u7535\u963b\uff0c\u7535\u5bb9)\u5c31\u53ef\u4ee5\u8fd0\u884c\u4ee3\u7801\u4e86\u3002\u800c\u5982x86\u3001ARM\u8fd9\u4e9bMPU\u5c31\u4e0d\u80fd\u76f4\u63a5\u653e\u4ee3\u7801\u4e86\uff0c\u5b83\u53ea\u4e0d\u8fc7\u662f\u589e\u5f3a\u7248\u7684CPU\uff0c\u6240\u4ee5\u5f97\u6dfb\u52a0RAM\uff0cROM\u3002</p> <p>4\u3001SOC(System on Chip)\uff0c\u6307\u7684\u662f\u7247\u4e0a\u7cfb\u7edf\uff0cMCU\u53ea\u662f\u82af\u7247\u7ea7\u7684\u82af\u7247\uff0c\u800cSOC\u662f\u7cfb\u7edf\u7ea7\u7684\u82af\u7247\uff0c\u5b83\u65e2MCU(51\uff0cavr)\u90a3\u6837\u6709\u5185\u7f6eRAM\u3001ROM\u540c\u65f6\u53c8\u50cfMPU\u90a3\u6837\u5f3a\u5927\uff0c\u4e0d\u5355\u5355\u662f\u653e\u7b80\u5355\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u653e\u7cfb\u7edf\u7ea7\u7684\u4ee3\u7801\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u8fd0\u884c\u64cd\u4f5c\u7cfb\u7edf(\u5c06\u5c31\u8ba4\u4e3a\u662fMCU\u96c6\u6210\u5316\u4e0eMPU\u5f3a\u5904\u7406\u529b\u5404\u4f18\u70b9\u4e8c\u5408\u4e00)\u3002</p> <p>5\u3001DSP\u8fd0\u7b97\u80fd\u529b\u5f3a\uff0c\u64c5\u957f\u5f88\u591a\u7684\u91cd\u590d\u6570\u636e\u8fd0\u7b97</p> <p>\u5fae\u63a7\u5236\u5668\u5728\u7ecf\u8fc7\u8fd9\u51e0\u5e74\u4e0d\u65ad\u5730\u7814\u7a76,\u53d1\u5c55,\u5386\u7ecf4\u4f4d,8\u4f4d,\u5230\u73b0\u5728\u768416\u4f4d\u53ca32\u4f4d,\u751a\u81f364\u4f4d\u3002\u4ea7\u54c1\u7684\u6210\u719f\u5ea6,\u4ee5\u53ca\u6295\u5165\u5382\u5546\u4e4b\u591a,\u5e94\u7528\u8303\u56f4\u4e4b\u5e7f,\u771f\u53ef\u8c13\u4e4b\u7a7a\u524d\u3002\u76ee\u524d\u5728\u56fd\u5916\u5927\u5382\u56e0\u5f00\u53d1\u8f83\u65e9,\u4ea7\u54c1\u7ebf\u5e7f,\u6240\u4ee5\u6280\u672f\u9886\u5148,\u800c\u672c\u571f\u5382\u5546\u5219\u4ee5\u591a\u529f\u80fd\u4e3a\u4ea7\u54c1\u5bfc\u5411\u53d6\u80dc\u3002\u4f46\u4e0d\u53ef\u8bb3\u8a00\u7684,\u672c\u571f\u5382\u5546\u7684\u4ef7\u683c\u6218\u662f\u5bf9\u5916\u5546\u9020\u6210\u5a01\u80c1\u7684\u5173\u952e\u56e0\u7d20\u3002 \u7531\u4e8e\u5236\u7a0b\u7684\u6539\u8fdb\uff0c8\u4f4dMCU\u4e0e4\u4f4dMCU\u4ef7\u5dee\u76f8\u53bb\u65e0\u51e0\uff0c8\u4f4d\u5df2\u6e10\u6210\u4e3a\u5e02\u573a\u4e3b\u6d41\uff1b</p> <p>\u76ee\u524d4\u4f4dMCU\u5927\u90e8\u4efd\u5e94\u7528\u5728\u8ba1\u7b97\u5668\u3001\u8f66\u7528\u4eea\u8868\u3001\u8f66\u7528\u9632\u76d7\u88c5\u7f6e\u3001\u547c\u53eb\u5668\u3001\u65e0\u7ebf\u7535\u8bdd\u3001CD\u64ad\u653e\u5668\u3001LCD\u9a71\u52a8\u63a7\u5236\u5668\u3001LCD\u6e38\u620f\u673a\u3001\u513f\u7ae5\u73a9\u5177\u3001\u78c5\u79e4\u3001\u5145\u7535\u5668\u3001\u80ce\u538b\u8ba1\u3001\u6e29\u6e7f\u5ea6\u8ba1\u3001\u9065\u63a7\u5668\u53ca\u50bb\u74dc\u76f8\u673a\u7b49\uff1b</p> <p>8\u4f4dMCU\u5927\u90e8\u4efd\u5e94\u7528\u5728\u7535\u8868\u3001\u9a6c\u8fbe\u63a7\u5236\u5668\u3001\u7535\u52a8\u73a9\u5177\u673a\u3001\u53d8\u9891\u5f0f\u51b7\u6c14\u673a\u3001\u547c\u53eb\u5668\u3001\u4f20\u771f\u673a\u3001\u6765\u7535\u8fa8\u8bc6\u5668\uff08CallerID\uff09\u3001\u7535\u8bdd\u5f55\u97f3\u673a\u3001CRT\u663e\u793a\u5668\u3001\u952e\u76d8\u53caUSB\u7b49\uff1b</p> <p>16\u4f4dMCU\u5927\u90e8\u4efd\u5e94\u7528\u5728\u884c\u52a8\u7535\u8bdd\u3001\u6570\u5b57\u76f8\u673a\u53ca\u6444\u5f55\u653e\u5f71\u673a\u7b49\uff1b</p> <p>32\u4f4dMCU\u5927\u90e8\u4efd\u5e94\u7528\u5728Modem\u3001GPS\u3001PDA\u3001HPC\u3001STB\u3001Hub\u3001Bridge\u3001Router\u3001\u5de5\u4f5c\u7ad9\u3001ISDN\u7535\u8bdd\u3001\u6fc0\u5149\u6253\u5370\u673a\u4e0e\u5f69\u8272\u4f20\u771f\u673a\uff1b</p> <p>64\u4f4dMCU\u5927\u90e8\u4efd\u5e94\u7528\u5728\u9ad8\u9636\u5de5\u4f5c\u7ad9\u3001\u591a\u5a92\u4f53\u4e92\u52a8\u7cfb\u7edf\u3001\u9ad8\u7ea7\u7535\u89c6\u6e38\u4e50\u5668\uff08\u5982SEGA\u7684Dreamcast\u53caNintendo\u7684GameBoy\uff09\u53ca\u9ad8\u7ea7\u7ec8\u7aef\u673a\u7b49\u3002</p> <p>\u539f\u6587 https://blog.csdn.net/mao834099514/article/details/106720704</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/cpu-mcu-isc/#x86arm","title":"x86/ARM","text":"<p>\u82f9\u679c\u5ba3\u5e03\u51b3\u5b9a\u4ece\u82f1\u7279\u5c14 CPU \u8f6c\u5411\u81ea\u5df1\u7684 ARM \u82af\u7247\u3002\u6709\u4ec0\u4e48\u533a\u522b\uff1f\u65b0\u7684 Apple Silicon \u82af\u7247\u57fa\u4e8e ARM CPU\uff0c\u5c31\u50cf\u76ee\u524d\u7528\u4e8e iPhone \u548c iPad \u7684 CPU\u3002\u82f1\u7279\u5c14\u82af\u7247\u4f7f\u7528\u82f1\u7279\u5c14\u4e13\u6709\u7684 x86 \u67b6\u6784\u3002</p> <p>ARM \u662fRISC \u67b6\u6784\u3002RISC \u4ee3\u8868\u7cbe\u7b80\u6307\u4ee4\u96c6\u8ba1\u7b97\u3002\u8fd9\u610f\u5473\u7740 CPU \u53ef\u4ee5\u4f7f\u7528\u7684\u6307\u4ee4\u6570\u91cf\u6709\u9650\u3002\u7ed3\u679c\uff0c\u6bcf\u6761\u6307\u4ee4\u5728\u4e00\u4e2a\u5468\u671f\u5185\u8fd0\u884c\uff0c\u6307\u4ee4\u66f4\u7b80\u5355\u3002\u540c\u65f6\uff0cx86 \u662f\u4e00\u79cd CISC \u67b6\u6784\uff0c\u4ee3\u8868\u590d\u6742\u6307\u4ee4\u96c6\u8ba1\u7b97\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u5b83\u6709\u66f4\u591a\u7684\u6307\u4ee4\u3002\u786e\u5207\u7684\u6570\u5b57\u53d6\u51b3\u4e8e\u60a8\u5982\u4f55\u8ba1\u7b97\u5b83\u4eec\uff0c\u4f46 x86-64\u81f3\u5c11\u6709 981 \u6761\u6307\u4ee4\u3002\u53e6\u4e00\u65b9\u9762\uff0cARM\u63a5\u8fd1 50 \u4e2a\uff08ARM \u7684\u5b9e\u9645\u6587\u6863\u5f88\u96be\u627e\u5230\uff0c\u56e0\u4e3a\u5b83\u53ea\u662f\u534a\u5f00\u653e\u7684\uff09\u3002\u5176\u4e2d\u4e00\u4e9b\u6307\u4ee4\u5c06\u9700\u8981\u4e00\u4e2a\u4ee5\u4e0a\u7684\u5468\u671f\u624d\u80fd\u6267\u884c\u3002\u4f46\u662f\uff0c\u6709\u4e9b\u6307\u4ee4\u53ef\u4ee5\u5b8c\u6210\u8bb8\u591a RISC \u6307\u4ee4\u7684\u5de5\u4f5c\u3002</p> <p>ARM \u7684\u53e6\u4e00\u4e2a\u597d\u5904\u662f\u5b83\u662f\u4e00\u4e2a\u534a\u5f00\u653e\u5f0f\u67b6\u6784\u3002\u5f88\u5c11\u6709\u516c\u53f8\u751f\u4ea7 x86 \u5904\u7406\u5668\uff0c\u56e0\u4e3a\u82f1\u7279\u5c14\u5df2\u5c06\u5176\u8bbe\u4e3a\u95ed\u6e90\u3002\u53e6\u4e00\u65b9\u9762\uff0cARM \u5b9e\u9645\u4e0a\u5e76\u4e0d\u5236\u9020\u81ea\u5df1\u7684 CPU\u3002\u4ed6\u4eec\u5c06\u8bbe\u8ba1\u6388\u6743\u7ed9\u5176\u4ed6\u60f3\u8981\u5236\u9020\u81ea\u5df1\u7684 CPU \u7684\u516c\u53f8\u3002\u82f9\u679c\u5c31\u662f\u5176\u4e2d\u4e4b\u4e00\u3002\u82f9\u679c\u80fd\u591f\u5b9a\u5236\u4ed6\u4eec\u7684\u82af\u7247\u4ee5\u5728\u4ed6\u4eec\u7684\u5e73\u53f0\u4e0a\u66f4\u597d\u5730\u5de5\u4f5c\u3002\u8fd9\u5927\u6982\u5c31\u662fiPhone \u5728\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u8868\u73b0\u51fa\u8272\u7684\u539f\u56e0\u3002</p> <p>ARM \u8bbe\u8ba1\u5f97\u66f4\u5c0f\u3001\u66f4\u8282\u80fd\uff0c\u5e76\u4e14\u4ea7\u751f\u7684\u70ed\u91cf\u66f4\u5c11\u3002\u8fd9\u4f7f\u5176\u975e\u5e38\u9002\u5408\u79fb\u52a8\u8bbe\u5907\uff0c\u5982\u667a\u80fd\u624b\u673a\u3002\u5c0f\u5c3a\u5bf8\u4f7f\u5176\u975e\u5e38\u9002\u5408\u5c0f\u578b\u8bbe\u5907\u3002\u80fd\u6e90\u6548\u7387\u4f7f\u8bbe\u5907\u7684\u7535\u6c60\u5bff\u547d\u66f4\u957f\u3002\u8f83\u4f4e\u7684\u70ed\u91cf\u5bf9\u4e8e\u4e0d\u65ad\u88ab\u6301\u6709\u7684\u8bbe\u5907\u662f\u6709\u76ca\u7684\u3002</p> <p>\u7b14\u8bb0\u672c\u7535\u8111\u4e5f\u6709\u540c\u6837\u7684\u597d\u5904\u3002\u82f9\u679c\u57282020 \u5e74\u30012018 \u5e74\u30012015\u5e74\u53ca\u66f4\u65e9\u7684\u5e74\u4efd\u4e00\u76f4\u5b58\u5728\u8fc7\u70ed\u95ee\u9898\u3002ARM \u5c06\u5141\u8bb8 Apple \u8ba9\u4ed6\u4eec\u7684 MacBook \u66f4\u9177\uff0c\u6240\u4ee5\u4ed6\u4eec\u4e0d\u4f1a\u9047\u5230\u8282\u6d41\u95ee\u9898\u3002\u8fd9\u5c06\u4f7f\u4ed6\u4eec\u80fd\u591f\u5236\u9020\u5177\u6709\u66f4\u957f\u7535\u6c60\u5bff\u547d\u7684\u8bbe\u5907\u3002\u82f9\u679c\u7684\u7b14\u8bb0\u672c\u7535\u8111\u4e5f\u6709\u53ef\u80fd\u53d8\u5f97\u66f4\u5c0f\u3002</p> <p>ARM\u7684\u7f3a\u70b9 \u4e00\u4e2a\u95ee\u9898\u662f x86 \u7a0b\u5e8f\u65e0\u6cd5\u5728 ARM \u4e0a\u8fd0\u884c\u3002\u7a0b\u5e8f\u9700\u8981\u5b8c\u5168\u91cd\u5199\u624d\u80fd\u5728 Apple \u7684\u65b0\u673a\u5668\u4e0a\u8fd0\u884c\u3002\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u90fd\u53ef\u4ee5\u5f88\u597d\u5730\u9488\u5bf9 ARM\u3002\u4efb\u4f55\u5f53\u524d\u7ef4\u62a4\u7684\u7a0b\u5e8f\u90fd\u5e94\u8be5\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u4e0d\u8fc7\uff0c\u4efb\u4f55\u7528Assembly\u7f16\u5199\u7684\u4e1c\u897f\u90fd\u9700\u8981\u91cd\u5199\u624d\u80fd\u5728 ARM \u4e0a\u8fd0\u884c\u3002</p> <p>\u4e3b\u8981\u95ee\u9898\u662f\u4e0d\u518d\u66f4\u65b0\u7684\u7a0b\u5e8f\u3002Apple \u6709Rosetta 2\uff0c\u5b83\u53ef\u4ee5\u8fd0\u884c x86 \u5e94\u7528\u7a0b\u5e8f\u3002\u7136\u800c\uff0c\u4f17\u6240\u5468\u77e5\uff0cRosetta 1 \u7684\u8fd0\u884c\u901f\u5ea6\u6bd4\u5728\u539f\u59cb\u786c\u4ef6\u4e0a\u6162\u5f97\u591a\u3002\u8fd9\u662f\u5fc5\u7136\u7684\u3002Rosetta \u9700\u8981\u5c06 x86 \u6307\u4ee4\u5b9e\u65f6\u7ffb\u8bd1\u6210 ARM \u6307\u4ee4\u3002\u516c\u5e73\u5730\u8bf4\uff0cJava \u53ef\u4ee5\u4ece\u5b57\u8282\u7801\u8f6c\u6362\u4e3a\u5176\u4ed6\u6240\u6709\u5185\u5bb9\uff0c\u800c\u4e14\u5b83\u4f3c\u4e4e\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002\u5c3d\u7ba1\u5982\u6b64\uff0c\u5982\u679c\u5fae\u8f6f\u4e5f\u51b3\u5b9a\u8f6c\u5411 ARM\uff0c\u4f3c\u4e4e\u5f88\u96be\u60f3\u8c61\u80fd\u591f\u73a9 2010 \u5e74\u4ee3\u7684\u6e38\u620f\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a\u901f\u5ea6\u95ee\u9898\u3002\u7531\u4e8e ARM \u7684\u6307\u4ee4\u8f83\u5c11\uff0c\u56e0\u6b64\u5f00\u53d1\u4eba\u5458\u9700\u8981\u4f7f\u7528\u66f4\u591a\u7684\u6307\u4ee4\u3002\u4f8b\u5982\uff0cARM \u901a\u5e38\u6ca1\u6709\u9664\u6cd5\u6307\u4ee4\u3002\u5373\u4f7f\u662f\u6700\u9ad8\u6548\u7684\u9664\u6cd5\u7b97\u6cd5\u4e5f\u5f88\u590d\u6742\uff0c\u5f88\u591a ARM CPU \u90fd\u6ca1\u6709\u5b9e\u73b0\u3002\u5728\u8fd9\u4e9b CPU \u4e0a\uff0c\u60a8\u5fc5\u987b\u4f7f\u7528\u5176\u4ed6\u6307\u4ee4\u8fdb\u884c\u5212\u5206\u3002\u7531\u4e8e\u60a8\u4f7f\u7528\u5176\u4ed6\u6307\u4ee4\u6765\u4f2a\u9020\u9664\u6cd5\uff0c\u56e0\u6b64\u6700\u7ec8\u9700\u8981\u66f4\u591a\u5468\u671f\u3002\u8fd9\u751a\u81f3\u53ef\u80fd\u6bd4 CISC \u6307\u4ee4\u96c6\u6162\u3002</p> <p>\u539f\u6587 https://www.section.io/engineering-education/arm-x86/#:~:text=ARM%20is%20a%20RISC%20architecture,of%20instructions%20it%20can%20use.&amp;text=Meanwhile%2C%20x86%20is%20a%20CISC,for%20Complex%20Instruction%20Set%20Computing.</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/cpu-mcu-isc/#ciscriscmisc","title":"CISC/RISC/MISC","text":"<p>CISC: \u590d\u6742\u6307\u4ee4\u96c6, RISC: \u7b80\u5355\u6307\u4ee4\u96c6\uff0c MISC: \u6700\u5c0f\u6307\u4ee4\u96c6</p> <p>wiki: https://en.wikipedia.org/wiki/Reduced_instruction_set_computer</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/cpu-mcu-isc/#esp32stm32","title":"esp32/stm32","text":"<p>\u5982\u4e0a\u6240\u8bf4\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e24\u8005\u7684\u82af\u7247\u4ea7\u54c1\u90fd\u662fmcu\uff0c\u5373\u5305\u542b\u4e86\u9664\u4e86cpu\u4ee5\u5916\u7684\u66f4\u591a\u6a21\u5757\uff0c\u5982wifi\uff0c\u84dd\u7259\u7b49\uff0c\u7b97\u662fCoC\uff0cchips on chips\u3002\u800c\u5dee\u5f02\u5728\u4e8e\uff0cesp32\u7684cpu\u5e76\u4e0d\u662farm\u67b6\u6784\u7684cpu\uff0c\u7531\u6b64ISC\u4e5f\u548cARM\u7684\u6709\u6240\u5dee\u5f02\u3002\u8fd9\u4e5f\u662f\u8bf4\uff0c\u5982\u679c\u67d0\u4e9b\u5e93\u53ea\u6709arm\u7684\u7f16\u8bd1\u7248\u672c\uff0c\u90a3\u4e48\u5e76\u4e0d\u80fd\u5728esp\u4e0a\u4f7f\u7528\u3002\u9664\u6b64\u4ee5\u5916\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u4f9d\u8d56\u4e86\u6c47\u7f16\u7684\u4ee3\u7801\uff0c\u4e5f\u9700\u8981\u66f4\u591a\u7684ISC\u517c\u5bb9\u6027\u3002</p> <p>esp \u6240\u7528\u7684Tensilica mcu\u7684ISC\uff1a https://en.wikipedia.org/wiki/Tensilica#Xtensa_instruction_set</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","title":"\u591a\u4efb\u52a1\u64cd\u4f5c\u7cfb\u7edf","text":""},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#_1","title":"\u5982\u4f55\u5b9e\u73b0\u591a\u4efb\u52a1\uff1f","text":"<p>\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u4e2d\u65ad\u53eb\u65f6\u949f\u4e2d\u65ad\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u501f\u52a9\u6b64\u4e2d\u65ad\u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u62a2\u593a\u56deCPU\u8d44\u6e90\uff0c\u7136\u540e\u4f9d\u636e\u81ea\u5df1\u7684\u7b97\u6cd5\uff0c\u8c03\u5ea6\u7cfb\u7edf\u8d44\u6e90\uff0c\u4ece\u800c\u5b9e\u73b0\u591a\u4efb\u52a1\u5904\u7406\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#cpu","title":"\u591a\u6838CPU","text":"<p>\u4efb\u52a1\u8c03\u5ea6\u3001\u4e2d\u65ad\u5904\u7406\u3001\u540c\u6b65\u4e92\u65a5</p> <p>\u5bf9\u4e8e\u591a\u6838CPU\uff0c\u4f18\u5316\u64cd\u4f5c\u7cfb\u7edf\u4efb\u52a1\u8c03\u5ea6\u7b97\u6cd5\u662f\u4fdd\u8bc1\u6548\u7387\u7684\u5173\u952e\u3002\u4e00\u822c\u4efb\u52a1\u8c03\u5ea6\u7b97\u6cd5\u6709\u5168\u5c40\u961f\u5217\u8c03\u5ea6\u548c\u5c40\u90e8\u961f\u5217\u8c03\u5ea6\u3002\u524d\u8005\u662f\u6307\u64cd\u4f5c\u7cfb\u7edf\u7ef4\u62a4\u4e00\u4e2a\u5168\u5c40\u7684\u4efb\u52a1\u7b49\u5f85\u961f\u5217\uff0c\u5f53\u7cfb\u7edf\u4e2d\u6709\u4e00\u4e2aCPU\u6838\u5fc3\u7a7a\u95f2\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u4ece\u5168\u5c40\u4efb\u52a1\u7b49\u5f85\u961f\u5217\u4e2d\u9009\u53d6\u5c31\u7eea\u4efb\u52a1\u5f00\u59cb\u5728\u6b64\u6838\u5fc3\u4e0a\u6267\u884c\u3002</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u70b9\u662fCPU\u6838\u5fc3\u5229\u7528\u7387\u8f83\u9ad8\u3002\u540e\u8005\u662f\u6307\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u6bcf\u4e2aCPU\u5185\u6838\u7ef4\u62a4\u4e00\u4e2a\u5c40\u90e8\u7684\u4efb\u52a1\u7b49\u5f85\u961f\u5217\uff0c\u5f53\u7cfb\u7edf\u4e2d\u6709\u4e00\u4e2aCPU\u5185\u6838\u7a7a\u95f2\u65f6\uff0c\u4fbf\u4ece\u8be5\u6838\u5fc3\u7684\u4efb\u52a1\u7b49\u5f85\u961f\u5217\u4e2d\u9009\u53d6\u6070\u5f53\u7684\u4efb\u52a1\u6267\u884c\uff0c\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u70b9\u662f\u4efb\u52a1\u57fa\u672c\u4e0a\u65e0\u9700\u5728\u591a\u4e2aCPU\u6838\u5fc3\u95f4\u5207\u6362\uff0c\u6709\u5229\u4e8e\u63d0\u9ad8CPU\u6838\u5fc3\u5c40\u90e8Cache\u547d\u4e2d\u7387\u3002\u76ee\u524d\u591a\u6570\u591a\u6838CPU\u64cd\u4f5c\u7cfb\u7edf\u91c7\u7528\u7684\u662f\u57fa\u4e8e\u5168\u5c40\u961f\u5217\u7684\u4efb\u52a1\u8c03\u5ea6\u7b97\u6cd5\u3002</p> <p>\u591a\u6838\u7684\u4e2d\u65ad\u5904\u7406\u548c\u5355\u6838\u6709\u5f88\u5927\u4e0d\u540c\u3002\u591a\u6838\u7684\u5404\u5904\u7406\u5668\u4e4b\u95f4\u9700\u8981\u901a\u8fc7\u4e2d\u65ad\u65b9\u5f0f\u8fdb\u884c\u901a\u4fe1\uff0c\u6240\u4ee5\u591a\u4e2a\u5904\u7406\u5668\u4e4b\u95f4\u7684\u672c\u5730\u4e2d\u65ad\u63a7\u5236\u5668\u548c\u8d1f\u8d23\u4ef2\u88c1\u5404\u6838\u4e4b\u95f4\u4e2d\u65ad\u5206\u914d\u7684\u5168\u5c40\u4e2d\u65ad\u63a7\u5236\u5668\u4e5f\u9700\u8981\u5c01\u88c5\u5728\u82af\u7247\u5185\u90e8\u3002</p> <p>\u53e6\u5916,\u591a\u6838CPU\u662f\u4e00\u4e2a\u591a\u4efb\u52a1\u7cfb\u7edf\u3002\u7531\u4e8e\u4e0d\u540c\u4efb\u52a1\u4f1a\u7ade\u4e89\u5171\u4eab\u8d44\u6e90\uff0c\u56e0\u6b64\u9700\u8981\u7cfb\u7edf\u63d0\u4f9b\u540c\u6b65\u4e0e\u4e92\u65a5\u673a\u5236\u3002\u800c\u4f20\u7edf\u7684\u7528\u4e8e\u5355\u6838\u7684\u89e3\u51b3\u673a\u5236\u5e76\u4e0d\u80fd\u6ee1\u8db3\u591a\u6838\uff0c\u9700\u8981\u5229\u7528\u786c\u4ef6\u63d0\u4f9b\u7684\u201c\u8bfb\uff0d\u4fee\u6539\uff0d\u5199\u201d\u7684\u539f\u5b50\u64cd\u4f5c\u6216\u5176\u4ed6\u540c\u6b65\u4e92\u65a5\u673a\u5236\u6765\u4fdd\u8bc1\u3002</p>"},{"location":"%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%81Linux/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#java","title":"Java\u7ebf\u7a0b\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b/\u8fdb\u7a0b\u5173\u7cfb","text":"<p>\u4e00\u5bf9\u4e00\uff0c\u591a\u5bf9\u4e00\uff0c\u591a\u5bf9\u591a.\u4f46\u6ce8\u610f\u8fd9\u91cc\u662f\u64cd\u4f5c\u7cfb\u7edf\u5c01\u88c5\u7684\u7ebf\u7a0b/\u8fdb\u7a0b\u529f\u80fd\u3002</p>"},{"location":"%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%8F%89%E6%A0%91/","title":"\u4e8c\u53c9\u6811","text":"<pre><code>class ANode {\n    constructor(public value: number, public left?: ANode, public right?: ANode) { }\n}\n\nlet root = new ANode(1, new ANode(2, new ANode(4, new ANode(8))), new ANode(3, new ANode(6), new ANode(7, new ANode(9))))\nprintNodesLayerZOrder([root], [], true)\n\nfunction printNodesDeepFirst(n: ANode) {\n    console.log(n.value)\n    if (n.left) printNodesDeepFirst(n.left)\n    if (n.right) printNodesDeepFirst(n.right)\n}\n\nfunction printNodesLayerFirst(ns: ANode[]) {\n    if (ns.length &gt; 0) {\n        console.log(ns[0].value)\n        if (ns[0].left) ns.push(ns[0].left)\n        if (ns[0].right) ns.push(ns[0].right)\n        ns.splice(0, 1)\n        printNodesLayerFirst(ns)\n    }\n}\n\nfunction printNodesLayerReverse(ns: ANode[]) {\n    if (ns.length &gt; 0) {\n        console.log(ns[0].value)\n        if (ns[0].right) ns.push(ns[0].right)\n        if (ns[0].left) ns.push(ns[0].left)\n        ns.splice(0, 1)\n        printNodesLayerReverse(ns)\n    }\n}\n\nfunction printNodesLayerZOrder(ns: ANode[], ns2: ANode[], printLeftToRight: boolean) {\n    if (printLeftToRight &amp;&amp; ns.length &gt; 0) {\n        console.log(ns[0].value)\n        if (ns[0].left) ns2.splice(0, 0, ns[0].left)\n        if (ns[0].right) ns2.splice(0, 0, ns[0].right)\n        ns.splice(0, 1)\n        if (ns.length == 0) printLeftToRight = !printLeftToRight;\n    } else if (!printLeftToRight &amp;&amp; ns2.length &gt; 0) {\n        console.log(ns2[0].value)\n        if (ns2[0].right) ns.splice(0, 0, ns2[0].right)\n        if (ns2[0].left) ns.splice(0, 0, ns2[0].left)\n        ns2.splice(0, 1)\n        if (ns2.length == 0) printLeftToRight = !printLeftToRight;\n    }\n    if (ns.length != 0 || ns2.length != 0) {\n        printNodesLayerZOrder(ns, ns2, printLeftToRight)\n    }\n}\n</code></pre>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/","title":"\u7b97\u6cd5\u6574\u7406","text":""},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_1","title":"\u9762\u8bd5\u5e38\u89c1","text":""},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_2","title":"\u9006\u5e8f\u94fe\u8868\u6c42\u548c","text":"<ul> <li>\u6ce8\u610f\u5224\u7a7a</li> <li>\u6ce8\u610f\u6700\u540e\u7684\u8fdb\u4f4d\uff0c\u53ef\u80fd\u9700\u8981\u521b\u5efa\u65b0\u7684\u8282\u70b9</li> <li>\u6ce8\u610f\u8fd4\u56de.next</li> <li>\u6ce8\u610f\u8fd4\u56de\u7ed3\u679c\u7684\u987a\u5e8f</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_3","title":"\u6bcf\u4e00\u4e2a\u6570\u5b57\u53f3\u4fa7\u7b2c\u4e00\u4e2a\u5927\u4e8e\u81ea\u5df1\u7684\u6570\u5b57","text":"<ul> <li>\u6808\u8bb0\u5f55\u7d22\u5f15</li> <li>\u904d\u5386\u7684\u65f6\u5019\u82e5\u5c0f\u4e8e\u6808\u9876\u7d22\u5f15\u7684\u5143\u7d20\uff0c\u5219\u5165\u6808\uff0c\u82e5\u5927\u4e8e\uff0c\u5219\u51fa\u6808\u5e76\u5bf9\u7ed3\u679c\u6570\u7ec4\u4e2d\u8fd9\u4e2a\u4f4d\u7f6e\u8d4b\u503c\u3002</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_4","title":"\u987a\u65f6\u9488\u904d\u5386\u4e8c\u7ef4\u6570\u7ec4","text":"<ul> <li>\u6ce8\u610f\u5224\u7a7a</li> <li>\u6ce8\u610f\u9000\u51fa\u6761\u4ef6</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#k","title":"\u94fe\u8868\u6bcfk\u4e2a\u8282\u70b9\u5012\u5e8f\u3002","text":"<ul> <li>\u94fe\u8868reverse\u4f5c\u4e3a\u65b9\u6cd5</li> <li>\u8ba1\u6570\uff0c&gt;=k\u7684\u65f6\u5019end.next =null\u6458\u53d6\u4e00\u5757\u94fe\u8868\uff0c\u7136\u540ereverse\uff0c\u518d\u62fc\u63a5\u56de\u53bb\u3002</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_5","title":"\u6392\u5e8f","text":"<ul> <li>\u5feb\u901f\u6392\u5e8f</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_6","title":"\u52a8\u6001\u89c4\u5212","text":"<ul> <li>LCS(\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217)</li> <li>\u6700\u957f\u8fde\u7eed\u516c\u5171\u5b50\u5e8f\u5217</li> <li>\u6700\u957f\u9012\u589e\u516c\u5171\u5b50\u5e8f\u5217</li> <li>\u4e00\u7ec4\u6570\u5b57\uff0c\u6c42\u7279\u5b9a\u548c\u6709\u591a\u5c11\u65b9\u6848</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_7","title":"\u84c4\u6c34\u95ee\u9898","text":"<p>https://blog.csdn.net/mw_nice/article/details/82663857</p>"},{"location":"%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/#_8","title":"\u601d\u7ef4\u89c4\u5f8b","text":"<ul> <li>\u590d\u6742\u95ee\u9898\u5206\u89e3\u4e3a\u76f8\u540c\u7684\u82e5\u5e72\u7b80\u5355\u5b50\u95ee\u9898\u3002</li> <li>\u4ece\u4e24\u7aef\u540c\u65f6\u5f00\u59cb\u904d\u5386\uff0c\u4e24\u4e2a\u6307\u9488\u79fb\u52a8\u9700\u8981\u4e00\u5b9a\u5224\u5b9a\u6761\u4ef6\uff0c\u5982\u54ea\u8fb9\u66f4\u5c0f\uff0c\u79fb\u52a8\u54ea\u8fb9\u3002</li> <li>\u6b63\u5411\u8003\u8651\u3001\u9006\u5411\u8003\u8651\u3002</li> </ul>"},{"location":"%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/","title":"\u94fe\u8868","text":"<pre><code>class ANode {\n    constructor(public value: number, public next?: ANode) { }\n}\n\n// printNodes(revNodes(makeNodes([1, 2, 3, 4], 0)!))\n// printNodes(revNodes(makeNodes([1], 0)!))\n// printNodes(revNodes(revNodes(makeNodes([1, 2, 3, 4], 0)!)))\n\nlet loopH = new ANode(2, undefined)\nlet loopN = new ANode(3, loopH);\nloopH.next = loopN;\n\nhasCircleNode(new ANode(1, loopH));\nconsole.log('circle node:', findCircleNode(new ANode(1, loopH)));\n\nfunction makeNodes(values: number[], index: number): ANode | undefined {\n    if (index &gt;= values.length) {\n        return undefined;\n    } else {\n        return new ANode(values[index], makeNodes(values, index + 1))\n    }\n}\n\nfunction printNodes(n: ANode) {\n    let cur: ANode | undefined = n;\n    let max = 5;\n    while (cur != undefined &amp;&amp; (max--) &gt; 0) {\n        console.log(cur.value)\n        cur = cur.next;\n    }\n}\n\nfunction revNodes(n: ANode): ANode {\n    let cur = n;\n    let prev: ANode | undefined = undefined;\n    let next: ANode | undefined = cur.next;\n    while (next != undefined) {\n        cur.next = prev;\n        prev = cur;\n        cur = next;\n        next = cur.next;\n    }\n    cur.next = prev;\n    return cur;\n}\n\nfunction hasCircleNode(n: ANode): boolean {\n    let revN = revNodes(n);\n    let c: ANode | undefined = n;\n    let c2: ANode | undefined = revN;\n    if (c != c2) {\n        console.log(\"no loop node.\")\n        return false;\n    }\n    console.log(\"has circle node.\")\n    return true;\n}\n\nfunction findCircleNode(n: ANode): ANode | undefined {\n    let c = n;\n    let markNode = new ANode(-1)\n    while (c.next != undefined) {\n\n        if (c.next == markNode) return c;\n        let next = c.next;\n        c.next = markNode;\n        c= next;\n    }\n    return undefined;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Json/","title":"Json","text":"<p>Json\u662f\u5e38\u89c1\u7684\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u65b9\u5f0f\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Json/#jsonfield","title":"JsonField","text":"<p>JsonField\u662f\u4e00\u4e2a\u6211\u5728\u5de5\u4f5c\u4e2d\u81ea\u521b\u7684\u5e93\uff0c\u7528\u4e8e\u6620\u5c04JSON\u5b57\u6bb5\uff0c\u4ee5\u53ca\u4f7f\u7528\u6ce8\u89e3\u58f0\u660e\u5b57\u6bb5\u7684\u7ea6\u675f\u68c0\u67e5\uff0c\u4f1a\u751f\u6210\u4ee3\u7801\u5728\u6784\u9020\u65f6\u68c0\u67e5\u8fd9\u4e9b\u7ea6\u675f\u662f\u5426\u6ee1\u8db3\u3002\u82e5\u4e0d\u6ee1\u8db3\u5219\u4f1a\u629b\u51fa\u5f02\u5e38\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Json/#_1","title":"\u4f7f\u7528\u6982\u8ff0","text":"<p>\u9996\u5148\u4ecb\u7ecd\u4e0b\u57fa\u672c\u7528\u6cd5\uff1a <pre><code>class SomeData{\n    @JsonField\n    public String stringValue;\n\n    @JsonField\n    public int intValueWithDefault = 1;\n\n    @JsonField(\"jsonkey\")\n    public float valueWithMappedName;\n\n    @JsonField(\"key1.key2.key3\")\n    public boolean jsonPathField;\n\n    @HasJsonField(\"key1.key2.key3\")\n    public boolean hasKey3;\n\n    @JsonField\n    public AnotherDataType obj;\n\n    class AnotherDataType{\n        @JsonField\n        public String hh;\n    }\n}\n</code></pre> \u5b83\u5305\u542b\u5982\u4e0b\u57fa\u672c\u7279\u6027\uff1a</p> <ul> <li>\u9ed8\u8ba4\u4ee5\u8be5\u5b57\u6bb5\u540d\u4f5c\u4e3aJson\u7684key\u3002\u6b64\u5916\u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6key\u7684\u540d\u79f0\uff0c\u8fd8\u53ef\u4ee5\u6307\u5b9a\u7b80\u5355\u7684JsonPath\u5b57\u7b26\u4e32\u6765\u83b7\u53d6\u5d4c\u5957\u5185\u90e8\u7684\u5b57\u6bb5\u3002</li> <li>HasJsonField\u7684\u7528\u6cd5\u7565\u6709\u4e0d\u540c\uff0c\u5b83\u4ec5\u7528\u6765\u4fee\u9970\u5e03\u5c14\u503c\uff0c\u8868\u793aJson\u7ed3\u6784\u4e2d\u662f\u5426\u5305\u542b\u6b64key\u3002</li> <li>\u652f\u6301\u5d4c\u5957\u6570\u636e\u7ed3\u6784\u5904\u7406\u3002</li> <li>\u5b57\u6bb5\u521d\u59cb\u503c\u4f5c\u4e3a\u9ed8\u8ba4\u503c\u3002</li> </ul> <p>\u9664\u4e86\u4ee5\u4e0a\u7528\u4e8e\u5e38\u89c4\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u7684\u58f0\u660e\u4ee5\u5916\uff0c\u8fd8\u8865\u5145\u4e86\u7528\u4e8e\u58f0\u660e\u5b57\u6bb5\u7ea6\u675f\u68c0\u67e5\u7684\u6ce8\u89e3\uff0c\u4ecb\u7ecd\u5982\u4e0b\uff1a <pre><code>class SomeData{\n    @JsonField\n    @Required\n    public String requiredField;\n\n    @JsonField\n    @ValidString([\"valid value1\", \"valid value2\"])\n    public String oneOfValidValue;\n\n    @JsonField\n    @ValidInt([1,2])\n    public int oneOfValidIntValue;\n\n    @JsonField\n    @ValidIntRange(min=0,max=Integer.MAX_VALUE)\n    public int oneOfValidIntValue2;\n\n    @JsonField\n    @NoCast\n    public int rejectNumberString;\n}\n</code></pre> \u5b83\u5305\u542b\u5982\u4e0b\u7684\u5b57\u6bb5\u7ea6\u675f\u68c0\u67e5\u80fd\u529b\uff1a</p> <ul> <li>\u5fc5\u9009\u5b57\u6bb5\u3002</li> <li>\u5404\u57fa\u672c\u6570\u636e\u7c7b\u578b\u6709\u6548\u53d6\u503c\u58f0\u660e\u3002</li> <li>\u7981\u6b62\u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\u3002</li> </ul> <p>\u5728\u5b8c\u6210\u4e0a\u8ff0\u58f0\u660e\u540e\uff0cBuild Project\u540e\uff0c\u4f1a\u5f97\u5230\u6240\u6709\u5305\u542b<code>@JsonField</code>, <code>@HasJsonField</code>\u8fd9\u4e9b\u6570\u636e\u7c7b\u7684\u5bf9\u5e94\u751f\u6210\u7684Builder\u7c7b\u3002\u5b83\u5177\u6709\u5982\u4e0b\u65b9\u6cd5\uff1a <pre><code>class SomeDataBuilder{\n    public static SomeDataBuilder from(JSONObject jsonObject){...}\n    public static SomeDataBuilder from(SomeData source){...}\n    public JSONObject json(){...}\n    public SomeData data(){}\n}\n</code></pre> \u4ece\u800c\u53ef\u4ee5\u8fdb\u884c\u8be5\u7c7b\u578b\u7684\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u4f7f\u7528\u3002<code>obj = SomeDataBuilder.from(json).data()</code>\u3002\u5982\u679c\u58f0\u660e\u4e86\u7ea6\u675f\uff0c\u5e76\u4e14\u7ea6\u675f\u68c0\u67e5\u5931\u8d25\uff0c\u5219\u53cd\u5e8f\u5217\u5316\u4f1a\u629b\u51fa\u5f02\u5e38\u9700\u8981\u81ea\u884c\u6355\u83b7\u3002\u5373\uff1a <pre><code>try {\n    obj = SomeDataBuilder.from(json).data()\n}catch(JsonFieldConstraintException e){\n    e.constraint // \u5373\u68c0\u67e5\u5931\u8d25\u7684\u5177\u4f53\u7ea6\u675f\u3002\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Json/#_2","title":"\u4f18\u52a3","text":"<p>\u5b83\u57fa\u4e8eAPT\uff0c\u5e76\u4e14\u4e3a\u4e86\u589e\u5f3a\u7075\u6d3b\u6027\u3001\u51cf\u5c11\u751f\u6210\u7684\u89e3\u6790\u903b\u8f91\u4e0a\u7684\u5197\u4f59\uff0c\u628a\u7ea6\u675f\u68c0\u67e5\u3001\u5b57\u6bb5\u89e3\u6790\u7684\u5177\u4f53\u903b\u8f91\u5747\u4ea4\u7531\u5de5\u5177\u5c42\u5b8c\u6210\u3002\u800c\u751f\u6210\u7684Builder\u4ee3\u7801\u53ea\u662f\u5305\u542b\u5bf9\u8fd9\u4e9b\u5de5\u5177\u5c42\u7684\u8c03\u7528\uff0c\u5de5\u5177\u5c42\u5fc5\u987b\u5728\u8fd0\u884c\u65f6\u9644\u5e26\u3002\u800c\u540e\u7eed\u7684\u7ef4\u62a4\u4e5f\u53ef\u4ee5\u66f4\u591a\u5728\u5de5\u5177\u5c42\u4e0a\u5b8c\u6210\uff0c\u800c\u4e0d\u5fc5\u9891\u7e41\u66f4\u6539\u751f\u6210\u7684\u4ee3\u7801\u3002</p> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u76f8\u6bd4\u4e8e\u65e0\u4ee3\u7801\u751f\u6210\u7684\u65b9\u6848\uff0c\u5982Gson\uff0c\u5b83\u4ece\u7406\u8bba\u4e0a\u63d0\u4f9b\u4e86\u66f4\u4f73\u7684\u8fd0\u884c\u65f6\u6027\u80fd\uff08\u7f3a\u4e4f\u6570\u636e\u7ed3\u8bba\uff09\u3002</li> <li>\u58f0\u660e\u5b57\u6bb5\u7ea6\u675f\u53ef\u5728\u53cd\u5e8f\u5217\u5316\u65f6\u81ea\u52a8\u6267\u884c\u68c0\u67e5\uff0c\u4ece\u4e1a\u52a1\u4e0a\u5e26\u6765\u4f18\u52bf\uff08\u5c3d\u7ba1\u5927\u90e8\u5206Json\u5e93\u4e5f\u6709\u62d3\u5c55\u53ef\u4ee5\u652f\u6301\u6b64\u7c7b\u4e1a\u52a1\uff09\u3002</li> <li>\u6e90\u7801\u968f\u610f\u62d3\u5c55\uff0c\u65e0\u5916\u90e8\u4f9d\u8d56\uff08\u751a\u81f3\u8fd9\u4e2a\u624d\u662f\u51fa\u53d1\u70b9\uff09\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>apt\u5e26\u6765\u6784\u5efa\u65f6\u95f4\u589e\u52a0\u3001\u4ee5\u53ca\u65b0\u589e\u7c7b\u7684\u4f53\u79ef\u53d8\u5316\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Json/#gson","title":"Gson","text":"<p>Gson\u662fJava\u4e0a\u5e38\u7528\u7684JSON\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u3002\u501f\u52a9\u8fd0\u884c\u65f6\u53cd\u5c04\u6765\u83b7\u53d6\u7c7b\u4e0eJSON\u7684\u5b57\u6bb5\u6620\u5c04\u5173\u7cfb\u3002</p> <p>\u5b83\u7684\u7279\u6027\u5305\u62ec\uff1a</p> <ul> <li>\u53cd\u5c04\u8fd0\u884c\u65f6\u67e5\u8be2\u6620\u5c04\u3001\u652f\u6301\u5d4c\u5957\u3001\u591a\u6620\u5c04\u540d\u3001\u5b57\u6bb5\u6392\u9664</li> <li>\u652f\u6301\u62d3\u5c55</li> </ul> <p>\u56e0\u4e3a\u5b83\u5177\u6709\u62d3\u5c55\u80fd\u529b\uff0c\u53ef\u4ee5\u5728\u53cd\u5e8f\u5217\u5316\u7684\u5de5\u4f5c\u6d41\u4e0a\u589e\u52a0\u81ea\u5b9a\u4e49\u7684\u5904\u7406\u8282\u70b9\uff0c\u4ece\u800c\u53ef\u4ee5\u5b9e\u73b0\u4e1a\u52a1\u4e0a\u7684\u4e00\u4e9b\u8bc9\u6c42\u7684\u5b9a\u5236\u5316\u3002\u6bd4\u5982\u6570\u636e\u9884\u5904\u7406\u3001\u5b57\u6bb5\u68c0\u67e5\u7b49\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/ProtoBuffer/","title":"ProtoBuffer","text":""},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/ProtoBuffer/#proto-buffer","title":"Proto Buffer","text":"<p>\u5b83\u662f\u4e00\u4e2aGoogle\u63a8\u51fa\u7684\u4ee5\u4e8c\u8fdb\u5236\u5f62\u5f0f\u5e8f\u5217\u5316\u6570\u636e\u7684\u5e93\u3002\u5b83\u5305\u542b\u4e86\u6570\u636e\u4f53\u7684\u58f0\u660e\u548c\u76ee\u6807\u8bed\u8a00\u5bf9\u5e94\u6570\u636e\u4f53\u7684\u6570\u636e\u7c7b\u4ee3\u7801\u3001\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u4ee3\u7801\u751f\u6210\u3002\u6570\u636e\u683c\u5f0f\u7684\u58f0\u660e\u9700\u8981\u4f7f\u7528<code>*.proto</code>\u6587\u4ef6\uff0c\u5e76\u7ed9\u51fa\u4e86\u4e00\u4efd\u5bf9\u5e94\u7684\u683c\u5f0f\u58f0\u660e\u89c4\u8303\u3002</p> <p>\u548c\u4f17\u591a\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u624b\u6bb5\u76f8\u4f3c\uff0c\u8981\u4e48\u727a\u7272\u53ef\u8bfb\u6027\u63d0\u9ad8\u5b58\u50a8\u6548\u7387\uff0c\u8981\u4e48\u63d0\u9ad8\u53ef\u8bfb\u6027\u964d\u4f4e\u5b58\u50a8\u6548\u7387\u3002\u4e0eJSON/XML\u76f8\u6bd4\uff0c\u5b83\u5c5e\u4e8e\u524d\u8005\u3002\u5728\u5b58\u50a8\u6548\u7387\u4e0a\u8fdc\u9ad8\u4e8eJSON\u3002\u5c3d\u7ba1\uff0c\u636e\u6211\u6240\u77e5\uff0c\u6709\u7684\u683c\u5f0f\u66f4\u8fdb\u4e00\u6b65\uff0c\u5728\u4e8c\u8fdb\u5236\u5e8f\u5217\u5316\u6570\u7ec4\u4e0a\u518d\u6b21\u538b\u7f29\uff0c\u53ef\u4ee5\u5f97\u5230\u66f4\u5c0f\u7684\u4f53\u79ef\u3002</p> <p>\u9664\u4e86\u5b58\u50a8\u6548\u7387\u5916\uff0c\u5b83\u7684\u53e6\u4e00\u4e2a\u4f18\u70b9\u5728\u4e8e\uff0c\u5e73\u53f0\u65e0\u5173\u7684<code>proto</code>\u6570\u636e\u4f53\u5b9a\u4e49\u3002\u8fd9\u5bf9\u4e8e\u4e00\u4efd\u6570\u636e\u4f53\u9700\u8981\u5728\u591a\u7aef\u6d88\u8d39\u7684\u573a\u666f\u4e0b\u6709\u6240\u6536\u76ca\u3002\u5c24\u5176\u548c\u4f20\u7edf\u7684\u5728\u7279\u5b9a\u5e73\u53f0\u5bf9JSON\u53cd\u5e8f\u5217\u5316\u5f97\u5230\u6570\u636e\u7c7b\u76f8\u6bd4\uff0c\u6b64\u65b9\u5f0f\u53ef\u4ee5\u7edf\u4e00\u5404\u5e73\u53f0\u7684\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\uff0c\u53bb\u9664\u6837\u5316\u7684\u5b57\u6bb5\u89e3\u6790\u8fc7\u7a0b\uff0c\u800c\u8ba9\u7cbe\u529b\u5173\u6ce8\u4e8e\u6570\u636e\u4f53\u7684\u63cf\u8ff0\u4e0a\u3002</p> <p>\u800c\u76ee\u524d\u6765\u770b\uff0cProto Buffer\u91c7\u53d6\u7684\u7279\u5b9a\u5e73\u53f0\u81ea\u52a8\u7f16\u8bd1\uff0c\u662f\u5bf9\u7279\u5b9a\u5e73\u53f0\u5f00\u53d1\u6240\u4f7f\u7528\u7684\u7279\u5b9a\u8bed\u8a00\u60c5\u666f\u4e0b\u7684\u59a5\u534f\u3002\u5373\uff0c\u5982\u679c\u5404\u7aef\u82e5\u6709\u7edf\u4e00\u7684\u8bed\u8a00\uff0c\u5219\u53ef\u4ee5\u4e0d\u5fc5\u51fa\u73b0\u9488\u5bf9\u591a\u8bed\u8a00\u7684\u6570\u636e\u4f53\u7f16\u8bd1\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u89d2\u5ea6\u4e0a\u8bb2\uff0cKotlin\u548cJavascript\u662f\u6f5c\u5728\u7684\u66ff\u4ee3\u8005\u3002\u5728\u90e8\u5206\u573a\u666f\u4e0b\uff0c\u53ea\u9700\u8981\u7528\u5b83\u4eec\u4e4b\u4e00\u7684\u8bed\u8a00\u6765\u5b8c\u6210\u6570\u636e\u4f53\u58f0\u660e\u548c\u89e3\u6790\uff0c\u4fbf\u53ef\u5728\u591a\u5e73\u53f0\u4e0a\u6d88\u8d39\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/ProtoBuffer/#_1","title":"\u6570\u636e\u4f53\u5b9a\u4e49","text":"<p>Protobuf\u4e0d\u4ec5\u5f15\u5165\u4e86\u63cf\u8ff0\u6570\u636e\u7684\u4e00\u5957\u7edf\u4e00\u7684\u5b57\u6bb5\u7c7b\u578b\uff08\u4e3b\u8981\u5305\u542b\u6570\u5b57\u7c7b\u578b\u3001\u5b57\u7b26\u4e32\u3001\u5e03\u5c14\u3001\u5217\u8868\u3001map\u7b49\uff09\uff0c\u6b64\u5916\u8fd8\u63d0\u4f9b\u4e86import\uff0cpackage\uff0coption\u4f5c\u4e3a\u6570\u636e\u4f53\u6a21\u5757\u95f4\u7684\u590d\u7528\u3001\u89e3\u8026\uff0c\u4ee5\u53ca\u5bf9\u5e73\u53f0\u7279\u6027\u7684\u62d3\u5c55\u3002</p> <p>\u4f46\u5bf9\u4e8e\u624b\u52a8\u6307\u5b9a\u7f16\u53f7\uff0c\u4e2a\u4eba\u89c9\u5f97\u8f83\u4e3a\u9ebb\u70e6\u3002\u5e94\u5f53\u5c06\u6b64\u4f5c\u4e3a\u5efa\u8bae\u7684\u65b9\u5f0f\u4f46\u975e\u5fc5\u987b\u7684\uff0c\u81ea\u52a8\u6839\u636e\u5b57\u6bb5\u540d\u53bb\u751f\u6210\u7f16\u53f7\u3001\u5e76\u8003\u8651\u5bf9\u5e94\u7684\u4fdd\u7559\u5b57\u6bb5\u63aa\u65bd\u5e94\u8be5\u4e5f\u4f1a\u53ef\u884c\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/ProtoBuffer/#_2","title":"\u5e8f\u5217\u5316\u4e0e\u53cd\u5e8f\u5217\u5316","text":"<p>ProtoBuffer\u7684\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u76f8\u5bf9\u7b80\u5355\u3002\u5199\u5165\u6570\u636e\u65f6\uff0c\u5bf9\u6bcf\u4e2a\u57fa\u672c\u7c7b\u578b\u90fd\u5148\u5199\u5165tag\uff0c\u518d\u5199\u5165\u5177\u4f53\u4fe1\u606f\u3002\u5bf9\u4e8e\u53d8\u957f\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u5728\u5199\u5165tag\u540e\uff0c\u4f1a\u5148\u5199\u5165\u957f\u5ea6\u3002\u5bf9\u4e8e\u5b9a\u957f\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u8bfb\u53d6tag\u540e\u5373\u53ef\u786e\u8ba4\u540e\u7eed\u6570\u636e\u7684\u5b57\u8282\u8303\u56f4\u3002\u5bf9\u4e8e\u5bf9\u8c61\u7c7b\u578b\uff0c\u5219\u9012\u5f52\u8fdb\u884c\u6b64\u8fc7\u7a0b\u3002</p> <p>\u8fd9\u4e2a\u548c\u5e38\u89c1\u7684\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u624b\u6bb5\u6ca1\u6709\u592a\u591a\u533a\u522b\u3002\u7c7b\u4f3cParcel\uff0c\u5747\u6709\u5de5\u5177\u751f\u6210writeXxx, readXxx\u7684\u4ee3\u7801\u3002\u5c3d\u7ba1Protobuf\u7684\u5dee\u5f02\u5728\u4e8e\uff0c\u5b83\u4e0d\u4f9d\u8d56\u5b57\u8282\u7684\u987a\u5e8f\uff0c\u4ece\u800c\u53ef\u4ee5\u5728\u65b0\u65e7\u7248\u672c\u4e2d\u5747\u80fd\u88ab\u5408\u7406\u89e3\u6790\uff0c\u89e3\u6790\u65f6\u53ea\u5173\u6ce8tag\u6765\u786e\u8ba4\u6240\u8bfb\u53d6\u7684\u5b57\u6bb5\u3002\u800cparcel\u4e25\u683c\u4f9d\u8d56\u4e8e\u987a\u5e8f\uff0c\u81ea\u8eab\u5e76\u4e0d\u5177\u5907\u7248\u672c\u517c\u5bb9\u7684\u80fd\u529b\u3002</p> <p>\u800c\u4e8c\u8fdb\u5236\u7684\u8fd9\u79cd\u5148\u7c7b\u578b\u3001\u518d\u957f\u5ea6\u3001\u518d\u6570\u636e\u7684\u683c\u5f0f\uff0c\u4e5f\u6bd4\u8f83\u5e38\u89c4\uff0c\u6ca1\u4ec0\u4e48\u5176\u4ed6\u6240\u8bf4\u7684\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/ProtoBuffer/#_3","title":"\u9002\u7528\u573a\u666f","text":"<p>\u9664\u4e86\u524d\u9762\u6240\u8bf4\u7684\u7edf\u4e00\u6570\u636e\u4f53\u63cf\u8ff0\u4ee5\u5916\uff0c\u5b83\u5bf9\u5d4c\u5165\u5f0f\u573a\u666f\u3001\u84dd\u7259\u4f20\u8f93\u6570\u636e\u7b49\u504f\u5e95\u5c42\u65b9\u5411\u65f6\uff0c\u6709\u6bd4\u8f83\u597d\u7684\u4f7f\u7528\u8bc9\u6c42\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/ProtoBuffer/#_4","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>protobuf</li> <li>protobuf-gradle-plugin</li> </ul>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Unicode%20Utf8%20Base64/","title":"Unicode Utf8 Base64","text":""},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Unicode%20Utf8%20Base64/#unicode","title":"Unicode","text":"<p>Unicode\u5185\u7684\u5b57\u7b26\u88ab\u6570\u5b57\u552f\u4e00\u6807\u8bc6\uff0c\u79f0\u4e3aCode Point\u3002\u68c0\u7d22Code Point\u53ef\u4ee5\u8bbf\u95eehttp://www.unicode.org/charts/\u3002</p> <p>Code Point\u4e00\u822c\u6309\u5927\u7684\u7c7b\u522b\u4f1a\u89c4\u5212\u51fa\u82e5\u5e72\u533a\uff0c\u5b9e\u9645\u5f00\u53d1\u65f6\uff0c\u53ef\u4ee5\u501f\u52a9Code Point\u8303\u56f4\u6765\u786e\u5b9a\u5b57\u7b26\u6240\u5904\u7684\u533a\uff0c\u6765\u786e\u5b9a\u7c7b\u578b\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Unicode%20Utf8%20Base64/#utf8-utf16","title":"Utf8 Utf16","text":"<p>Utf8\u548cUtf16\u7b49\u90fd\u662fUnicode\u7684\u7f16\u7801\u683c\u5f0f\uff0c\u5373\u5bf9Unicode Code point\u7f16\u7801\u3002\u76ee\u524dUtf8\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\uff0c\u5b83\u662f\u53d8\u957f\u5ea6\u7684\u7f16\u7801\u3002</p> <p></p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Unicode%20Utf8%20Base64/#base64","title":"Base64","text":"<p>Base64\u662f\u4e00\u79cd\u4e8c\u8fdb\u5236\u8f6c\u6587\u672c\u7684\u7f16\u7801\u65b9\u5f0f\u3002\u6bcf6\u4e2abit\u6784\u6210\u4e00\u4e2a\u53ef\u73b0\u5b9e\u7684\u5b57\u7b26\uff0c\u7531\u6b64\u5f97\u51fa\u53ef\u663e\u793a\u5b57\u7b26\u4e00\u5171\u662f2^6=64\u79cd\uff0c\u800c\u6bcf3\u4e2a\u5b57\u8282\u9700\u89814\u4e2a\u5b57\u7b26\uff0824\u4e2abit\uff09\u8868\u793a\u3002\u6548\u7387\u662f67%\u3002</p> <p>\u53e6\u5916\u5bf9\u4e8e\u975e3\u7684\u500d\u6570\u4e2a\u5b57\u8282\uff0c\u9700\u89810\u586b\u5145\uff0c\u800c\u586b\u5145\u5b57\u7b26\u662f\"=\"\uff0c\u53736\u4e2a0bit\u3002\u6bd4\u5982\"X=\"\u8868\u793a\u4e8612\u4e2abit\uff0c\u4f46\u56e0\u4e3a\u6700\u540e\u662f\u586b\u5145\uff0c\u6240\u4ee5\u7531\u6b64\u63a8\u65ad\u6709\u6548\u5b57\u8282\u662f\u524d8\u4e2abit\u3002\"XX=\"\u8868\u793a\u4e8618\u4e2abit\uff0c\u7c7b\u4f3c\u7684\uff0c\u6709\u6548\u5b57\u8282\u662f\u524d16\u4e2abit\u3002\u5373\u82e5\u8bc6\u522b\u5230\u4e86\u586b\u5145\u5b57\u7b26\uff0c\u53ea\u9700\u8981\u8865\u51450bit\u5230\u4e00\u4e2a\u5b8c\u6574\u5b57\u8282\u7ed3\u675f\u5373\u53ef\u3002</p> <p></p> <p></p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/Unicode%20Utf8%20Base64/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>wikipedia base 64</li> <li>Javascript\u4e2d\u4f7f\u7528CodePoint</li> </ul>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/","title":"\u6570\u5b57\u7b7e\u540d","text":""},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_1","title":"\u516c\u94a5\u79c1\u94a5","text":"<p>\u4ece\u516c\u94a5\u79c1\u94a5\u8bf4\u8d77\u3002\u5b83\u4eec\u53ef\u4ee5\u4e92\u76f8\u52a0\u89e3\u5bc6\u5f7c\u6b64\u7684\u4fe1\u606f\u3002\u5373\uff0c\u516c\u94a5\u52a0\u5bc6\u7684\u4fe1\u606f\u53ef\u4ee5\u88ab\u79c1\u94a5\u89e3\u5bc6\u3002\u79c1\u94a5\u52a0\u5bc6\u7684\u4fe1\u606f\u53ef\u4ee5\u88ab\u516c\u94a5\u89e3\u5bc6\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_2","title":"\u975e\u5bf9\u79f0\u6027","text":"<p>\u5373\u4e00\u4efd\u88ab\u516c\u94a5\u52a0\u5bc6\u7684\u4fe1\u606f\uff0c\u5c06\u65e0\u6cd5\u88ab\u516c\u94a5\u89e3\u5bc6\uff0c\u9664\u975e\u4f60\u6b63\u662f\u90a3\u4e2a\u52a0\u5bc6\u6b64\u4fe1\u606f\u7684\u4eba\uff0c\u81ea\u8eab\u5c31\u77e5\u9053\u539f\u59cb\u4fe1\u606f\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_3","title":"\u4e00\u822c\u7684\u52a0\u5bc6\u901a\u4fe1","text":"<p>\u5373\u516c\u94a5\u516c\u5f00\u540e\uff0c\u53d1\u9001\u8005A\u4f7f\u7528\u516c\u94a5\u52a0\u5bc6\u81ea\u5df1\u7684\u4fe1\u606f\u540e\uff0c\u53d1\u9001\u7ed9B\u3002B\u4f7f\u7528\u79c1\u94a5\uff08\u4e0d\u516c\u5f00\uff09\u89e3\u5bc6\u540e\u5f97\u5230\u4fe1\u606f\u3002\u6b64\u8fc7\u7a0b\u662f\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u79c1\u94a5\u62e5\u6709\u8005\u80fd\u89e3\u5bc6\u4fe1\u606f\u3002</p> <p>B\u518d\u5bf9\u56de\u590d\u4fe1\u606f\u7528\u79c1\u94a5\u52a0\u5bc6\uff0cA\u5f97\u5230\u540e\u4f7f\u7528\u516c\u94a5\u89e3\u5bc6\u5373\u53ef\u5f97\u5230\u56de\u590d\u4fe1\u606f\u3002\u800c\u7531\u4e8e\u516c\u94a5\u662f\u516c\u5f00\u7684\uff0c\u6b64\u56de\u590d\u6d88\u606f\u5982\u679c\u88ab\u5176\u4ed6\u4eba\u6536\u5230\uff0c\u5c06\u4e5f\u80fd\u89e3\u5bc6\u770b\u5230\u3002</p> <p>\u7531\u6b64\uff0chttps\u534f\u8bae\u7684\u505a\u6cd5\u4fbf\u662f\uff0c\u56de\u590d\u4fe1\u606f\u4e2d\u662f\u516c\u5f00\u81ea\u5df1\u6240\u652f\u6301\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u4ee5\u4fbf\u8ba9A\u9009\u62e9\u4e00\u79cd\u65b9\u5f0f\u6765\u5bf9\u540e\u7eed\u7684\u901a\u4fe1\u8fdb\u884c\u52a0\u5bc6\uff0c\u5728A\u9009\u62e9\u540e\uff0c\u56e0\u4e3aA\u5230B\u7684\u53d1\u9001\u662f\u5b89\u5168\u7684\uff0c\u56e0\u6b64\u4e5f\u786e\u4fdd\u4e86\u5b83\u4eec\u4e4b\u95f4\u5efa\u7acb\u4e86\u79c1\u5bc6\u7684\u901a\u4fe1\uff0c\u5373A\u6240\u51b3\u5b9a\u91c7\u53d6\u7684B\u6240\u56de\u590d\u652f\u6301\u7684\u52a0\u5bc6\u5f62\u5f0f\u4e4b\u4e00\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_4","title":"\u4fe1\u606f\u6458\u8981","text":"<p>\u76ee\u524d\u4f7f\u7528\u7684\u4e00\u4e9b\u8f83\u6d41\u884c\u7684\u6563\u5217\u7b97\u6cd5\u662f\u5b89\u5168\u6563\u5217\u7b97\u6cd5 1 (SHA-1)\u3001\u5b89\u5168\u6563\u5217\u7b97\u6cd5 2 \u7cfb\u5217\uff08SHA-2 \u548c SHA-256\uff09\u548c\u6d88\u606f\u6458\u8981 5 (MD5)\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_5","title":"\u6570\u5b57\u7b7e\u540d","text":"<p>\u5982\u4e0a\u6240\u8bf4\uff0c\u516c\u94a5\u4e00\u822c\u7528\u4e8e\u52a0\u5bc6\u4fe1\u606f\uff0c\u79c1\u94a5\u4e00\u822c\u7528\u4e8e\u89e3\u5bc6\u4fe1\u606f\u3002\u800c\u6570\u5b57\u7b7e\u540d\u65f6\u7684\u7528\u6cd5\u4e0e\u6b64\u76f8\u53cd\uff0c\u5373\u7528\u79c1\u94a5\u52a0\u5bc6\uff0c\u5916\u90e8\u9a8c\u8bc1\u8005\u518d\u7528\u516c\u94a5\u89e3\u5bc6\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6570\u5b57\u7b7e\u540d\u7528\u4e8e\u9a8c\u8bc1\u5916\u90e8\u63a5\u6536\u8005\u5f97\u5230\u7684\u6570\u636e\u672a\u88ab\u7be1\u6539\u3002\u6ce8\u610f\uff0c\u662f\u6307\u201c\u672a\u88ab\u7be1\u6539\u201d\uff0c\u5e76\u4e0d\u662f\u6307\u4fdd\u5bc6\uff08\u65e0\u6cd5\u8ba9\u5176\u4ed6\u7a83\u542c\u8005\u8bfb\u53d6\uff09\u3001\u4e5f\u4e0d\u662f\u6307\u4efb\u4f55\u6587\u4ef6\u7684\u539f\u59cb\u5185\u5bb9\u3002\u5b83\u6240\u52a0\u5bc6\u7684\u5bf9\u8c61\u5f80\u5f80\u662f\u4fe1\u606f\u7684\u6458\u8981\uff0c\u5373\u54c8\u5e0c\uff0c\u800c\u975e\u4fe1\u606f\u6574\u4f53\u672c\u8eab\u3002\u7531\u6b64\uff0c\u5bf9\u4e8e\u63a5\u6536\u8005\u5728\u9a8c\u8bc1\u65f6\uff0c\u9700\u8981\u81ea\u884c\u6309\u7167\u7ea6\u5b9a\u6458\u8981\u7b97\u6cd5\u8ba1\u7b97\u4fe1\u606f\u672c\u4f53\u7684\u6458\u8981\uff0c\u518d\u4f7f\u7528\u516c\u94a5\u5bf9\u52a0\u5bc6\u6458\u8981\u89e3\u5bc6\uff0c\u5e76\u5bf9\u6bd4\u6458\u8981\u662f\u5426\u4e00\u81f4\u3002</p> <p>\u8bbe\u60f3\u7be1\u6539\u8005\u66f4\u6539\u4e86\u4fe1\u606f\u672c\u4f53\u540e\uff0c\u63a5\u6536\u8005\u8ba1\u7b97\u7684\u6458\u8981\u4fbf\u65e0\u6cd5\u548c\u79c1\u94a5\u6240\u52a0\u5bc6\u7684\u539f\u59cb\u4fe1\u606f\u672c\u4f53\u6458\u8981\u5339\u914d\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_6","title":"\u6570\u5b57\u8bc1\u4e66\u3001\u8bc1\u4e66\u9881\u53d1\u673a\u6784","text":"<p>\u6570\u5b57\u8bc1\u4e66\u53ef\u4ee5\u88ab\u81ea\u5df1\u751f\u6210\uff0c\u6b64\u65f6\u5f97\u5230\u7684\u5373\u81ea\u7b7e\u540d\u8bc1\u4e66\uff0c\u4e5f\u53ef\u4ee5\u88ab\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u6240\u9881\u53d1\u3002\u8fd9\u4e24\u7c7b\u4e0d\u540c\u7684\u8bc1\u4e66\u7684\u4f7f\u7528\u573a\u666f\u5404\u4e0d\u76f8\u540c\u3002</p> <p>\u6570\u5b57\u8bc1\u4e66\u5305\u542b\u4e2a\u4eba\u6216\u7ec4\u7ec7\u7684\u516c\u94a5\uff0c\u5e76\u7531 CA \u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002\u6709\u5173\u7ec4\u7ec7\u3001\u4e2a\u4eba\u548c CA \u7684\u5176\u4ed6\u4fe1\u606f\u4e5f\u53ef\u4ee5\u5305\u542b\u5728\u8bc1\u4e66\u4e2d\u3002</p> <p>\u6ce8\u610f\uff0c\u5b83\u9664\u4e86\u5305\u542b\u9700\u8981\u5bf9\u5916\u7684\u516c\u94a5\uff0c\u8fd8\u5305\u542b\u4e86\u9881\u53d1\u7ec4\u7ec7\u7684\u516c\u94a5\uff0c\u4ee5\u53ca\u9881\u53d1\u673a\u6784\u5bf9\u6b64\u7684\u6570\u5b57\u7b7e\u540d\u3002\u7531\u6b64\u6211\u4eec\u5728\u9a8c\u8bc1\u8bc1\u4e66\u7684\u65f6\u5019\uff0c\u9700\u8981\u5bf9\u6bd4\u6b64\u516c\u94a5\u548c\u6539\u8bc1\u4e66\u7ed3\u6784\u7684\u516c\u94a5\u89e3\u5bc6\u6570\u5b57\u7b7e\u540d\u540e\u7684\u4fe1\u606f\u662f\u5426\u5339\u914d\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_7","title":"\u8bc1\u4e66\u94fe\u3001\u8ba4\u8bc1\u94fe","text":"<p>\u5373\u901a\u8fc7\u6570\u5b57\u8bc1\u4e66\u4e2d\u7684\u9881\u53d1\u673a\u6784\uff0c\u4e00\u76f4\u5411\u4e0a\u9a8c\u8bc1\uff0c\u5373\u9a8c\u8bc1\u53d1\u9001\u8005\u7684\u6570\u5b57\u8bc1\u4e66\u3001\u53d1\u9001\u8005\u6570\u5b57\u8bc1\u4e66\u7684CA\u673a\u6784\u7684\u6570\u5b57\u8bc1\u4e66\uff0c\u4e00\u76f4\u5230\u67d0\u6570\u5b57\u8bc1\u4e66\u5df2\u5904\u4e8e\u201c\u53d7\u4fe1\u4efb\u201d\u7684\u8bc1\u4e66\u5217\u8868\u4e4b\u4e2d\u3002\u201c\u53d7\u4fe1\u4efb\u201d\u7684\u8bc1\u4e66\u5217\u8868\u4e00\u822c\u662f\u7531\u7cfb\u7edf\u5185\u7f6e\u7684\uff0c\u800c\u7528\u6237\u4e5f\u53ef\u4ee5\u5b89\u88c5\u4e00\u90e8\u5206\u3002\u5bf9\u4e8e\u5e94\u7528\u6846\u67b6\uff0c\u4e5f\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u662f\u5426\u4fe1\u4efb\u67d0\u6570\u5b57\u8bc1\u4e66\u3002</p>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/#_8","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>cisa site</li> </ul>"},{"location":"%E7%BC%96%E7%A0%81%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96/%E8%A1%A5%E7%A0%81%E8%BF%90%E7%AE%97/","title":"\u8865\u7801\u8fd0\u7b97","text":"<p>\u6b63\u6570\u7684\u8865\u7801\u662f\u539f\u7801\u3002\u8d1f\u6570\u7684\u8865\u7801\u662f\u539f\u7801\u57fa\u7840\u4e0a\uff0c\u4fdd\u7559\u7b26\u53f7\u4f4d\uff0c\u5176\u4f59\u5404\u4f4d\u53d6\u53cd\u6700\u540e\u518d\u52a01\u3002</p> <pre><code>\u4e3e\u4f8b\uff1a\n-5-3\n\n-5\n\u539f\u7801 1000 0101\n\u53d6\u53cd 1111 1010\n\u52a0\u4e00 1111 1011\n\n-3\n\u539f\u7801 1000 0011\n\u53d6\u53cd 1111 1100\n\u52a0\u4e00 1111 1101\n\n\n\u76f8\u52a0 1111 1000 \uff08-8\u7684\u8865\u7801\uff09\n\u51cf\u4e00 1111 0111\n\u53d6\u53cd 1000 1000 \uff08-8\u7684\u539f\u7801\uff09\n\n\n-1\n\u539f\u7801 1 0000 0001\n\u8865\u7801 1 1111 1111\n\n0\uff0c\u8865\u7801 0\n\nInteger.MIN_VALUE= 1000 0000 0000 0000 ... = -2^32\n\u7ed3\u679c\u662f\u539f\u7801\u3002\nInteger.max = 01111.... = 2^32-1\n</code></pre>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Linear%20gradient/","title":"Linear gradient","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Linear%20gradient/#_1","title":"\u6982\u8ff0","text":"<p>\u53ef\u4ee5\u8bbf\u95ee\u5728\u7ebf\u94fe\u63a5\uff0c\u624b\u52a8\u5237\u65b0\u9875\u9762\u6765\u91cd\u65b0\u5f97\u5230\u968f\u673a\u56fe\u6848\u3002</p> <p>\u6b64\u9879\u76ee\u5f97\u76ca\u4e8eCode pen\u7684\u7c7b\u4f3c\u9879\u76ee\u542f\u53d1\uff0c\u53ef\u4ee5\u7528Canvas API\uff0c\u7ed3\u5408\u56fe\u5c42\u6a21\u5f0f\uff08\u5373<code>CanvasRenderingContext2D.globalCompositeOperation</code>\uff09\u3001\u4ee5\u53ca\u5bf9\u9636\u6bb5\u6027\u6b65\u9aa4\u5148\u5bfc\u51fa\u4e3aImage\uff0c\u540e\u7eed\u518d\u5f15\u5165Image\u7f16\u6392\u7ed8\u5236\uff0c\u53ef\u4ee5\u628a\u4e00\u4e2a\u7b80\u5355\u7684\u7ebf\u6027\u6e10\u53d8\u505a\u51fa\u7c7b\u4f3c\u7684\u56fe\u6848\u3002\u8fd9\u7c7b\u56fe\u50cf\u57282000-2013\u5e74\u5de6\u53f3\u662f\u4e2a\u4eba\u5f88\u75f4\u8ff7\u7684\u4e00\u7c7b\u7c7b\u4f3cWindows Vista\u8ffd\u6367\u7684\u5149\u7ebf\u611f\u7684\u56fe\u7247\uff0c\u90a3\u4e2a\u65f6\u5019\u8fd8\u5c1d\u8bd5\u7528PhotoShop\u6765\u5236\u4f5c\uff0c\u4f46\u76f8\u6bd4\u8fd9\u4e2a\u968f\u673a\u751f\u6210\uff0c\u540e\u8005\u6548\u7387\u660e\u663e\u9ad8\u591a\u4e86\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Linear%20gradient/#_2","title":"\u622a\u56fe","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Linear%20gradient/#_3","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>\u5728\u7ebf\u4f53\u9a8c\uff0c\u53ef\u4ee5\u76f4\u63a5\u770b\u6e90\u7801\u3002</li> <li>CanvasRenderingContext2D.globalCompositeOperation mdn\u4ecb\u7ecd</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL%20shader%20language%20%28flower%29/","title":"OpenGL shader language (flower)","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL%20shader%20language%20%28flower%29/#_1","title":"\u6982\u8ff0","text":"<p>\u53ef\u4ee5\u8bbf\u95ee\u5728\u7ebf\u94fe\u63a5\u4f53\u9a8c\u3002</p> <p>\u6b64\u9879\u76ee\u662f\u5728\u5de5\u4f5c\u4e4b\u4f59\u5b66\u4e60glsl\u5b8c\u6210\u7684\uff0c\u672c\u6765\u662f\u60f3\u4e86\u89e3shader\uff0c\u4f46\u662f\u65e0\u610f\u4e4b\u95f4\u627e\u5230\u4e86\u5f88\u597d\u7684glsl\u6559\u7a0b\uff0c\u4e8e\u662f\u7528\u4e86\u4e00\u5468\u5b66\u4e60\u5b83\uff0c\u671f\u95f4\u505a\u51fa\u4e86\u5f88\u591a\u6709\u8da3\u7684\u4e1c\u897f\uff0c\u66f4\u6709\u4ee3\u8868\u6027\u7684\u662f\u8fd9\u4e2a\u3002\u5176\u5b9e\u786e\u5207\u7684\u8bf4\uff0c\u8fd9\u91cc\u53ea\u662f\u6d89\u53cafragment shader\uff0c\u5373\u7247\u6bb5\u7740\u8272\u5668\uff0c\u5e76\u6ca1\u6709\u6d89\u53ca\u9876\u70b9\u7740\u8272\u5668\u3001\u51e0\u4f55\u7740\u8272\u5668\u7b49\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL%20shader%20language%20%28flower%29/#_2","title":"\u5236\u4f5c\u601d\u8def","text":"<ul> <li>\u5f97\u5230\u4e86\u4e00\u5f20flower\u7684\u56fe\u7247\uff08by someone\uff09\uff0c\u5c31\u662f\u8fd9\u79cd\u89c4\u5219\u7684\u7531\u91cd\u590d\u7684\u5706\u5f27\u7ebf\u6761\u753b\u51fa\u6765\u7684\u3002</li> <li>\u5bf9\u8fd9\u4e2a\u56fe\u7528glsl\u5efa\u6a21\uff0c\u5148\u5f97\u5230\u4e00\u4e2a\u9759\u6001\u7684\u82b1\u6735\uff0c\u5b8c\u5168\u662fglsl\u751f\u6210\u7684\u82b1\u6735\u3002</li> <li>\u5f15\u5165\u65f6\u95f4\uff0c\u5bf9\u5c3a\u5bf8\u3001\u65cb\u8f6c\u3001\u989c\u8272\u52a0\u5165\u65f6\u95f4\u53d8\u91cf\uff0c\u52a0\u5165\u4e00\u4e9b\u4e09\u89d2\u51fd\u6570\u5373\u53ef\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL%20shader%20language%20%28flower%29/#_3","title":"\u542f\u53d1","text":"<p>glsl\u7ed9\u6211\u6700\u5927\u7684\u542f\u53d1\u5176\u5b9e\u662f\uff0c\u539f\u6765\u53ef\u4ee5\u7ad9\u5728\u8fd9\u79cd\u89d2\u5ea6\u63cf\u8ff0\u56fe\u50cf\uff0c\u5373\u8f93\u5165\u5750\u6807\uff0c\u8fd4\u56de\u4e00\u4e2a\u8be5\u50cf\u7d20\u7684\u989c\u8272\uff0c\u6bcf\u4e2a\u50cf\u7d20\u7684\u903b\u8f91\u90fd\u72ec\u7acb\uff0c\u7531\u6b64\u53ef\u4ee5\u5e76\u53d1\u6267\u884c\uff0c\u5e76\u80fd\u6781\u9ad8\u6548\u7387\u5730\u5f97\u5230\u7ed3\u679c\u3002\u800c\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u5bf9\u56fe\u50cf\u7684\u63cf\u8ff0\uff0c\u4e00\u76f4\u5efa\u7acb\u5728\u4f20\u7edf\u7684\u7ed8\u5236\u8c03\u7528\u4e0a\uff0c\u54ea\u6015openGl\u4e0d\u4e5f\u662f\u7ed8\u5236\u547d\u4ee4\u5417\uff0c\u800c\u5bf9\u4e8e\u56fe\u50cf\u6587\u4ef6\uff0c\u867d\u7136\u5176\u4e5f\u662f\u4e00\u79cd\u63cf\u8ff0\u50cf\u7d20\u4f4d\u7f6e\u989c\u8272\u7684\u96c6\u5408\uff0c\u4f46\u5b83\u4f9d\u7136\u6ca1\u5e26\u7ed9\u6211glsl\u6240\u7ed9\u6211\u7684\u542f\u53d1\u3002</p> <p>\u80fd\u7528\u4e00\u6bb5\u50cf\u7d20\u72ec\u7acb\u8fd0\u884c\u7684\u4ee3\u7801\uff0c\u8ba9\u6bcf\u4e2a\u50cf\u7d20\u7684\u8f93\u51fa\u7ed3\u679c\u5173\u8054\u8d77\u6765\u53d8\u5f97\u5177\u6709\u610f\u4e49\uff0c\u751f\u6210\u51fa\u52a8\u6001\u7684\u753b\u9762\uff0c\u5e76\u4e14\u65e0\u6bd4\u9ad8\u6548\uff0c\u662f\u5f88\u9177\u7684\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL%20shader%20language%20%28flower%29/#_4","title":"\u622a\u56fe","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL%20shader%20language%20%28flower%29/#_5","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>the bood of shader\uff0c\u5982\u679c\u5bf9glsl\u6709\u5174\u8da3\uff0c\u5219\u53ef\u4ee5\u5b8c\u6210\u6b64\u6559\u7a0b\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL/","title":"OpenGL","text":"<p>TODO \u6b64\u6587\u6863\u5c1a\u672a\u5b8c\u5168\u5b8c\u6210</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL/#_1","title":"\u6d41\u6c34\u7ebf","text":"<p>\u6ce8\u610f\uff0c\u84dd\u8272\u90e8\u5206\u7684shader\u662f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7684\u3002</p> <p></p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/OpenGL/#_2","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>opengl wiki pipeline overview</li> <li>learnopengl.com</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/","title":"Path tracing \u8def\u5f84\u8ffd\u8e2a","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_1","title":"\u6982\u8ff0","text":"<p>\u5199\u8fd9\u7bc7\u6587\u7ae0\u5df2\u7ecf\u662f\u5728\u5b8c\u6210\u8fd9\u4e9b\u5de5\u4f5c3\u4e2a\u591a\u6708\u4e4b\u540e\u4e86\uff0c\u53ef\u80fd\u6709\u4e9b\u4fe1\u606f\u5df2\u7ecf\u65e0\u6cd5\u7cbe\u786e\u56de\u5fc6\u8d77\u6765\u3002\u8fd9\u91cc\u6ca1\u6709\u5728\u7ebf\u4f53\u9a8c\uff0c\u53ea\u6709\u622a\u56fe\u548c\u4e4b\u524d\u5907\u4efd\u7684\u6e90\u7801\u53ef\u4ee5\u5728\u6587\u7ae0\u6700\u540e\u4e0b\u8f7d\u3002</p> <p>\u8fd9\u9879\u7814\u7a76\u65e8\u5728\u5bf9\u6700\u8fd1\u518d\u6b21\u53d7\u5230\u70ed\u6367\u7684\u5b9e\u65f6\u5149\u7ebf\u8ffd\u8e2a\u6709\u66f4\u52a0\u6df1\u5165\u7684\u7406\u89e3\uff0c\u7ed3\u679c\u6765\u770b\u57fa\u672c\u8fbe\u5230\u4e86\u8fd9\u4e2a\u76ee\u6807\u3002\u4ece\u4e00\u4efd\u7ecf\u5178\u768499\u884c\u4ee3\u7801\u5b9e\u73b0\u8def\u5f84\u8ffd\u8e2a\u4f5c\u4e3a\u8d77\u70b9\uff0c\u6d88\u5316\u5e76\u7406\u89e3\u5176\u4e2d\u7684\u539f\u7406\uff0c\u518d\u4e3a\u5176\u62d3\u5c55\u589e\u52a0\u66f4\u591a\u7684\u4f18\u5316\u3001\u7279\u6027\u652f\u6301\uff0c\u6700\u540e\u6211\u5f97\u5230\u4e86\u4e00\u4e2a\u53ef\u4ee5\u5bf9\u590d\u6742\u6a21\u578b\u8fdb\u884c\u8def\u5f84\u8ffd\u8e2a\u6e32\u67d3\u7684\u7a0b\u5e8f\uff0c\u5b83\u5305\u542b\u4e86\u4e00\u4e9b\u7b80\u5355\u7684\u4f18\u5316\uff08\u8fb9\u754c\u76d2\u5b50\u3001\u521d\u6b65\u7684\u516b\u53c9\uff09\uff0c\u8fd8\u501f\u52a9\u4e86intel\u516c\u5f00\u7684\u964d\u566a\u7a0b\u5e8f\uff0c\u4ee5\u8ba9\u6574\u4e2a\u753b\u9762\u5728\u4e00\u6b21\u91c7\u6837\u7684\u60c5\u51b5\u4e0b\u901a\u8fc7\u964d\u566a\u5f97\u5230\u8fdc\u6bd4\u591a\u6b21\u8fed\u4ee3\u66f4\u5177\u6709\u6027\u4ef7\u6bd4\u7684\u753b\u9762\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_2","title":"\u8def\u5f84\u8ffd\u8e2a","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_3","title":"\u6982\u8ff0","text":"<p>\u5149\u7ebf\u8ffd\u8e2a\u662f\u66f4\u5bbd\u6cdb\u7684\u8bdd\u9898\uff0c\u8def\u5f84\u8ffd\u8e2a\u88ab\u8ba4\u4e3a\u662f\u66f4\u5177\u4f53\u7684\u4e00\u79cd\u5b9e\u8df5\u624b\u6bb5\u3002\u5b83\u548c\u6211\u4eec\u4e60\u4ee5\u4e3a\u5e38\u7684\u201c\u5149\u6805\u5316\u201d\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u3002\u5149\u6805\u5316\u76ee\u524d\u5e7f\u6cdb\u7531\u56fe\u5f62\u9a71\u52a8\u7a0b\u5e8f\u3001\u56fe\u5f62\u786c\u4ef6\u6765\u652f\u6301\u5b9e\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u7ed8\u5236\u4e2d\u6700\u7ec8\u5f97\u5230\u4e00\u4efd\u50cf\u7d20\u4f4d\u56fe\uff0c\u5b83\u8db3\u591f\u5feb\u901f\u9ad8\u6548\u6240\u4ee5\u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u5b9e\u65f6\u6e32\u67d3\u7684\u5e38\u89c4\u624b\u6bb5\u3002</p> <p></p> <p>\u800c\u8def\u5f84\u8ffd\u8e2a\u5728\u76f8\u5f53\u957f\u7684\u65f6\u95f4\u91cc\uff0c\u88ab\u8ba4\u4e3a\u662f\u79bb\u7ebf\u7684\u6e32\u67d3\u65b9\u5f0f\uff0c\u9700\u8981\u5927\u91cf\u7684\u8ba1\u7b97\u6765\u6a21\u62df\u5149\u7ebf\u4ece\u76f8\u673a\u51fa\u53d1\uff0c\u5728\u573a\u666f\u4e2d\u6240\u9047\u5230\u7684\u6bcf\u4e2a\u70b9\uff0c\u5e76\u8003\u8651\u53d1\u751f\u7684\u5149\u7ebf\u53cd\u5c04\u3001\u6298\u5c04\uff0c\u56e0\u4e3a\u5149\u7ebf\u5728\u4e00\u4e2a\u7269\u4f53\u4e0a\u53cd\u5f39\u540e\uff0c\u4f1a\u53d8\u6210\u66f4\u591a\u7684\u5149\u7ebf\uff0c\u5b83\u7684\u8ffd\u8e2a\u6570\u91cf\u662f\u6307\u6570\u7ea7\u7684\u3002\u5b83\u66f4\u591a\u88ab\u7535\u5f71\u4e1a\u754c\u6240\u4f7f\u7528\u3002\u800c\u4e0b\u56fe\u662f\u82f1\u4f1f\u8fbe\u7684RTX\u4ecb\u7ecd\uff0c\u53ef\u4ee5\u7b80\u5355\u5bf9\u6bd4RayTrace\u548c\u5149\u6805\u5316\u7684\u7ba1\u9053\u5dee\u5f02\u3002</p> <p></p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_4","title":"\u9879\u76ee\u4ee3\u7801\u5b9e\u73b0\u6982\u8ff0","text":"<ul> <li>\u5bf9\u76f8\u673a\u7684\u6bcf\u4e2a\u50cf\u7d20\u53d1\u5c04\u4e00\u6761\u5149\u7ebf\uff0c\u6cbf\u89c6\u573a\u65b9\u5411\uff0c\u5bfb\u627e\u76f8\u4ea4\u7269\u4f53\uff08\u8fb9\u754c\u76d2\u5b50\u67e5\u627e\uff09\uff0c\u5bfb\u627e\u76f8\u4ea4\u4e09\u89d2\u5f62\uff0c\u5f97\u5230\u76f8\u4ea4\u70b9\uff0c\u6839\u636e\u4e09\u89d2\u5f62\u5b9a\u4e49\uff0c\u8fdb\u800c\u8ba1\u7b97\u53cd\u5f39\u5149\u7ebf/\u6298\u5c04\u5149\u7ebf</li> <li>\u5982\u679c\u6750\u8d28\u662f\u91d1\u5c5e\uff0c\u5219\u5b8c\u5168\u53cd\u5f39\uff0c\u5f97\u5230\u65b0\u7684\u5149\u7ebf\uff0c\u7ee7\u7eed\u9012\u5f52\u3002</li> <li>\u5982\u679c\u6750\u8d28\u662f\u73bb\u7483\uff0c\u5219\u90e8\u5206\u53cd\u5c04\u3001\u90e8\u5206\u6298\u5c04\uff0c\u5373\u5f97\u5230\u4e24\u6761\u5149\u7ebf\uff0c\u7ed3\u679c\u53d6\u5b83\u4eec\u7684\u5e73\u5747\u3002</li> <li>\u5982\u679c\u662f\u4e00\u822c\u6750\u8d28\uff0c\u5219\u5f97\u5230\u6298\u5c04\u3002</li> <li>\u76f8\u4ea4\u70b9\u548c\u6240\u6709\u5149\u6e90\u70b9\u5efa\u7acb\u5411\u91cf\uff0c\u5bfb\u627e\u662f\u5426\u6709\u7269\u4f53\u547d\u4e2d\uff0c\u82e5\u6ca1\u6709\uff0c\u8bf4\u660e\u5149\u7ebf\u53ef\u76f4\u5c04\uff0c\u5426\u5219\uff0c\u8bf4\u660e\u6709\u7269\u4f53\u906e\u6321\uff0c\u662f\u5728\u9634\u5f71\u4e4b\u4e2d\u3002\u5bf9\u4e8e\u524d\u8005\uff0c\u5438\u7eb3\u5149\u6e90\u4f5c\u4e3a\u5206\u91cf\u3002</li> <li>\u6bcf\u6b21\u5411\u4e0b\u9012\u5f52\u4f34\u968f\u80fd\u91cf\u635f\u5931\uff0c\u9012\u5f52\u7ec8\u6b62\u7531\u201cRussian roulette\uff08\u4fc4\u7f57\u65af\u8d4c\u76d8\uff09\u201d\u7b97\u6cd5\u51b3\u5b9a\u3002</li> <li>\u91c7\u6837\u6b21\u6570\u662f\u6307\u5bf9\u76f8\u673a\u5355\u4e2a\u50cf\u7d20\u53d1\u5c04\u4e00\u6761\u5149\u7ebf\u8fdb\u884c\u9012\u5f52\u8ba1\u7b97\u6b64\u8fc7\u7a0b\u7684\u6b21\u6570\u3002</li> </ul> <p>\u5b9e\u9645\u7684\u91c7\u6837\u6570\u7ed9\u5b9a\u7684\u662f1\uff0c\u6700\u540e\u5bf9\u7ed3\u679c\u505a\u964d\u566a\u5904\u7406\u3002\u589e\u52a0\u91c7\u6837\u6570\u4f1a\u5e26\u6765\u7ffb\u500d\u7684\u8ba1\u7b97\uff0c\u800c\u6700\u7ec8\u4f9d\u7136\u9700\u8981\u964d\u566a\uff0c\u591a\u91c7\u6837\u7684\u964d\u566a\u7ed3\u679c\u548c\u4f4e\u91c7\u6837\u7684\u964d\u566a\u7ed3\u679c\u65e0\u660e\u663e\u5dee\u5f02\u3002</p> <p>\u201cMonte Carlo \u8499\u7279\u5361\u6d1b\u201d\u662f\u6307\u7531\u8ba1\u7b97\u673a\u8fdb\u884c\u5e7f\u6cdb\u7684\u968f\u673a\u8fc7\u7a0b\u6765\u5f97\u5230\u4e00\u4e2a\u8fd1\u4f3c\u73b0\u5b9e\u7ed3\u679c\u7684\u65b9\u5f0f\u3002\u521d\u4e2d\u8bfe\u672c\u6709\u8bb2\u8fc7\u3002</p> <p>\u5177\u4f53\u4ee3\u7801\u7ec6\u8282\u8bf7\u53c2\u9605\u62d3\u5c55\u9605\u8bfb\u90e8\u5206\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_5","title":"\u542f\u53d1","text":"<p>\u8fd9\u4e5f\u662f\u7b2c\u4e00\u6b21\u9047\u5230\u5982\u6b64\u7cbe\u5999\u7684\u4e00\u6bb5C\u7a0b\u5e8f\uff0c\u5374\u53ef\u4ee5\u4f9d\u636e\u5bf9\u7b80\u5316\u8fc7\u7684\u201c\u5149\u7ebf\u65b9\u7a0b\u201d\u5efa\u6a21\uff0c\u4ee5\u7b80\u5355\u51e0\u4f55\u5f62\u72b6\u5efa\u6a21\uff0c\u5bf9\u6bcf\u4e2a\u50cf\u7d20\u4ee5\u65b9\u7a0b\u4e3a\u57fa\u7840\u3001\u4ee5\u573a\u666f\u6570\u636e\u5b9a\u4e49\uff08\u5305\u62ec\u76f8\u673a\u3001\u5149\u6e90\uff09\u4e3a\u201c\u8f93\u5165\u6e90\u201d\uff0c\u6765\u5f97\u5230\u4e00\u4e2a\u5c1d\u8bd5\u62df\u5408\u7269\u7406\u73b0\u5b9e\u7684\u56fe\u50cf\u3002</p> <p>\u8fd9\u4e9b\u4e1c\u897f\u5728\u771f\u6b63\u5c1d\u8bd5\u4e4b\u524d\u603b\u4f1a\u611f\u89c9\u662f\u9b54\u6cd5\u4e00\u6837\u96be\u4ee5\u89e6\u78b0\uff0c\u4f46\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u4e13\u5fc3\u5543\u8bfb\uff0c\u80fd\u9010\u6e10\u7406\u89e3\u80cc\u540e\u7684\u601d\u8def\u8fd8\u662f\u5f88\u6709\u6536\u83b7\u611f\u7684\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_6","title":"\u622a\u56fe","text":"<p>\u501f\u52a9\u4e4b\u524d\u505a\u7684\u4e2a\u4eba\u9879\u76ee<code>LoL Camera</code>\u9879\u76ee\u91cc\u7684\u6570\u636e\u8d44\u6e90\uff0c\u627e\u4e86\u51e0\u4e2a\u7b80\u5355\u7684\u6a21\u578b\u7528\u4e8e\u6e32\u67d3\u3002\u8fd9\u4e9b\u56fe\u7247\u5206\u8fa8\u7387\u63a5\u8fd11080p\uff0c\u6e32\u67d3\u7528\u65f6\u57fa\u672c\u572815-20\u5206\u949f\u3002Macbook pro2020\u4e2d\u9ad8\u914d\u3002\u539f\u56fe\u4e0d\u597d\u627e\u4e86\uff0c\u8fd9\u4e9b\u662f\u4ece\u5fae\u4fe1\u670b\u53cb\u5708\u590d\u5236\u56de\u6765\u7684\u3002</p> <p> </p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Path%20tracing%20%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA/#_7","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>\u4e4b\u524d\u5b8c\u6210\u8fd9\u4e9b\u5de5\u4f5c\u65f6\u7684\u4ee3\u7801\u5907\u4efd</li> <li>\u5927\u540d\u9f0e\u9f0e\u768499\u884c\u8def\u5f84\u8ffd\u8e2a</li> <li>\u8def\u5f84\u8ffd\u8e2a\u548c\u5149\u6805\u5316\u5bf9\u6bd4</li> <li>Nvidia Ray-tracing-essentials\uff0c\u5efa\u8bae\u8be5\u7cfb\u5217\u5168\u90e8\u6d4f\u89c8\u3002</li> <li>Scratchapixel \u5173\u4e8ePathTracing\u7684\u5185\u5bb9\uff0c\u91cc\u9762\u4ecb\u7ecd\u5f97\u6bd4\u8f83\u6e05\u695a\uff0c\u53ef\u4ee5\u8ddf\u968f\u6559\u7a0b\u5b8c\u6210\u7b97\u6cd5\u4f18\u5316\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Perlin%20noise%28Flow%20field%29/","title":"Perlin noise(Flow field)","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Perlin%20noise%28Flow%20field%29/#_1","title":"\u6982\u8ff0","text":"<p>\u53ef\u4ee5\u8bbf\u95ee\u5728\u7ebf\u94fe\u63a5\u4f53\u9a8c\u3002</p> <p>\u6b64\u9879\u76ee\u5f97\u76ca\u4e8eCode pen\u4e0a\u7684flow filed\u76f8\u5173\u4ecb\u7ecd\u3002\u786e\u5207\u7684\u8bf4\uff0c\u662f\u4f7f\u7528\u4e86\u4ece\u67cf\u6797\u566a\u58f0\u51fd\u6570\u7b80\u5316\u540e\u7684<code>simplex</code>\u566a\u58f0\u51fd\u6570\u6765\u751f\u6210\u4e09\u7ef4\u7684\u566a\u58f0\uff0c\u5e76\u628a\u566a\u58f0\u503c\u4f5c\u4e3a\u56fe\u50cf\u91cc\u5bf9\u5e94\u4f4d\u7f6e\u7684\u529b\u573a\uff0c\u6bcf\u4e2a\u573a\u91cc\u7684\u7c92\u5b50\u90fd\u4f1a\u53d7\u5230\u6240\u5728\u6700\u8fd1\u7684\u529b\u573a\u4f5c\u7528\u5f97\u5230\u65b0\u7684\u8fd0\u52a8\u72b6\u6001\uff0c\u4ece\u800c\u5f97\u5230\u4e86\u7c92\u5b50\u8fd0\u52a8\u3002\u5c3e\u8ff9\u7684\u8868\u73b0\u5f62\u5f0f\u5e76\u975e\u901a\u8fc7\u8bb0\u5f55\u7c92\u5b50\u5386\u53f2\u4f4d\u7f6e\uff0c\u800c\u662f\u501f\u52a9\u4e00\u4e2a\u5e26\u7455\u75b5\u7684\u5c0f\u6280\u5de7\uff0c\u5373\u6bcf\u6b21\u4e0d\u6e05\u9664\u753b\u5e03\uff0c\u800c\u662f\u7ed9\u753b\u5e03\u586b\u5145\u4e00\u4e2a\u5e26\u900f\u660e\u5ea6\u7684\u9ed1\u8272\uff0c\u4fbf\u7ee7\u7eed\u63a5\u7740\u7ed8\u5236\u65b0\u7684\u753b\u9762\u3002\u56e0\u800c\u8fc7\u53bb\u7684\u5185\u5bb9\u4f1a\u4e0d\u65ad\u88ab\u534a\u900f\u660e\u7684\u9ed1\u8272\u8986\u76d6\uff0c\u76f4\u5230\u51e0\u4e4e\u770b\u4e0d\u89c1\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Perlin%20noise%28Flow%20field%29/#_2","title":"\u6240\u7528\u6280\u672f","text":"<ul> <li>\u566a\u58f0\u751f\u6210\uff0c\u4f7f\u7528simplex noise\u53ef\u4ee5\u5f97\u5230\u6bd4perlin noise\u66f4\u4f73\u6027\u80fd\u7684\u7ed3\u679c\u3002\u4e4b\u6240\u4ee5\u9700\u8981\u4e09\u7ef4\u7684\u566a\u58f0\uff0c\u662f\u56e0\u4e3a\u753b\u9762\u662f\u4e8c\u7ef4\uff0c\u518d\u52a0\u4e00\u7ef4\u7528\u4e8e\u8fed\u4ee3\u65f6\u95f4\u53d8\u5316\u3002</li> <li>\u529b\u573a\u6539\u53d8\u7c92\u5b50\u8fd0\u52a8\u72b6\u6001\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u9aa4\u53ef\u4ee5\u5f97\u5230\u4e00\u4efd\u968f\u65f6\u95f4\u53d8\u5316\u7684\u4e8c\u7ef4\u566a\u58f0\uff08\u5c06\u4e00\u7ef4\u7528\u4e8e\u65f6\u95f4\uff09\uff0c\u5c06\u566a\u58f0\u5e73\u94fa\u5230\u56fe\u50cf\u4e2d\uff0c\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e2a\u50cf\u7d20\u8ddd\u79bb\u6700\u8fd1\u7684\u566a\u58f0\u70b9\u4f5c\u4e3a\u529b\u573a\u3002\u4e00\u4e2a\u529b\u573a\u70b9\u7684\u65b9\u5411\u548c\u5f3a\u5ea6\uff0c\u53ef\u4ee5\u6309\u81ea\u5b9a\u7684\u89c4\u5219\uff0c\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u4ece<code>simplex noise</code>\u4e2d\u53d6\u5f97\u3002</li> <li>\u7ed8\u5236\u65f6\u53ea\u9700\u8981\u8ba1\u7b97\u51fa\u65b0\u7684\u7c92\u5b50\u4f4d\u7f6e\uff0c\u5e76<code>lineTo</code>\u5373\u53ef\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u6709\u66f4\u591a\u7684\u624b\u6bb5\u8fdb\u884c\u5c1d\u8bd5\uff0c\u6216\u8bb8\u4f1a\u6709\u66f4\u67d4\u8f6f\u7684\u6548\u679c\u3002</li> <li>\u901a\u8fc7\u5728\u6bcf\u5e27\u7ed8\u5236\u524d\u8865\u5145\u4e00\u5c42\u5168\u5c40\u7684\u534a\u900f\u660e\u80cc\u666f\u8272\u906e\u7f69\uff0c\u4ece\u800c\u8ba9\u4e4b\u524d\u7684\u753b\u9762\u9010\u6e10\u892a\u53bb\uff0c\u8fbe\u5230\u5c3e\u8ff9\u7684\u6548\u679c\u3002\u5426\u5219\u53ea\u80fd\u4f7f\u7528\u5386\u53f2\u8bb0\u5f55\u65b9\u5f0f\u7ed8\u5236\u5c3e\u8ff9\u3002\u6b64\u65b9\u5f0f\u7684\u7455\u75b5\u5728\u4e8e\uff0c\u534a\u900f\u660e\u56fe\u5c42\u8986\u76d6\u5728\u4e00\u6bb5\u65f6\u95f4\u91cc\u5c06\u65e0\u6cd5\u5f7b\u5e95\u8ba9\u5176\u771f\u7684\u4e0d\u53ef\u89c1\uff0c\u6ce8\u610f\u89c2\u5bdf\u53ef\u4ee5\u770b\u5230\u80cc\u666f\u4e2d\u4f9d\u7136\u6709\u5c3e\u8ff9\u7684\u6b8b\u7559\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Perlin%20noise%28Flow%20field%29/#_3","title":"\u622a\u56fe","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Skia/","title":"Skia","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Skia/#_1","title":"\u6982\u8ff0","text":"<p>Skia\u662f\u4e00\u4e2a\u5f88\u9002\u5408\u7528\u6765\u628a\u73a9\u7684\u5e93\u3002\u5b83\u4e0d\u4ec5\u4f5c\u4e3a\u627f\u4e0a\u542f\u4e0b\u7684\u5173\u952e\u4e00\u5c42\uff08\u7b80\u5316Cpu/Gpu/Pdf\u7b49\u591a\u79cd\u65b9\u5f0f\u4f5c\u4e3a\u6e32\u67d3\u540e\u7aef\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u4e00\u81f4\u3001\u7b80\u5355\u7684API\uff0c\u66f4\u4e13\u6ce8\u4e8e\u63cf\u8ff02D\u7ed8\u5236\uff09\uff0c\u4e3a\u5927\u90e8\u5206\u7684UI\u6e32\u67d3\u6846\u67b6\u63d0\u4f9b\u4e86\u975e\u5e38\u91cd\u8981\u7684\u7ec4\u6210\u90e8\u5206\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Skia/#_2","title":"\u62d3\u5c55","text":"<ul> <li>Skija</li> <li>Skiko</li> <li>React Native Skia</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Skia/#cpu","title":"\u793a\u4f8b\uff1aCPU\u7ed8\u5236\uff0c\u5bfc\u51fa\u56fe\u7247","text":"<pre><code>#include \"include/core/SkCanvas.h\"\n#include \"include/core/SkColor.h\"\n#include \"include/core/SkRect.h\"\n#include \"include/core/SkSurface.h\"\n\nvoid draw(SkCanvas *canvas) {\n  canvas-&gt;save();\n  canvas-&gt;translate(SkIntToScalar(128), SkIntToScalar(128));\n  canvas-&gt;rotate(SkIntToScalar(45));\n  SkRect rect = SkRect::MakeXYWH(-90.5f, -90.5f, 181.0f, 181.0f);\n  SkPaint paint;\n  paint.setColor(SK_ColorBLUE);\n  canvas-&gt;drawRect(rect, paint);\n  canvas-&gt;restore();\n}\n\nint main() {\n  sk_sp&lt;SkSurface&gt; rasterSurface = SkSurface::MakeRasterN32Premul(600, 400);\n  SkCanvas *rasterCanvas = rasterSurface-&gt;getCanvas();\n\n  draw(rasterCanvas);\n\n  sk_sp&lt;SkImage&gt; img(rasterSurface-&gt;makeImageSnapshot());\n  if (!img) {\n    return -1;\n  }\n  sk_sp&lt;SkData&gt; png(img-&gt;encodeToData());\n  if (!png) {\n    return -1;\n  }\n  SkFILEWStream out(\"test.png\");\n  (void)out.write(png-&gt;data(), png-&gt;size());\n  return 0;\n}\n</code></pre> <p>cmakelists.txt\uff0c<code>target_include_directories</code>\u548c<code>find_library</code>\u6839\u636e\u5b9e\u9645skia\u7684<code>include</code>\u76ee\u5f55\u548c\u6784\u5efa\u4ea7\u7269\u7684\u76ee\u5f55\u6307\u5b9a\u3002\u5728mac\u4e0a\u6784\u5efa\u65f6\uff0c\u9700\u8981\u5f15\u5165mac\u4e0b\u7684framework\u3002\u8be6\u89c1<code>target_link_libraries</code>\u3002</p> <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(SkiaPlay VERSION 0.1)\nadd_executable(SkiaPlay play.cpp)\ntarget_compile_features(SkiaPlay PRIVATE cxx_std_17)\ntarget_include_directories(SkiaPlay PUBLIC \"${PROJECT_SOURCE_DIR}\")\nfind_library(Skia skia HINTS \"/Users/zhangruize/fav-libs/skia/out/Static\")\ntarget_link_libraries(SkiaPlay PUBLIC \"${Skia}\" \n\"-framework CoreFoundation\"\n\"-framework CoreGraphics\"\n\"-framework CoreText\"\n\"-framework ImageIO\"\n\"-framework ApplicationServices\"\n)\n</code></pre>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Skia/#gpu","title":"\u793a\u4f8b\uff1aGPU\u7ed8\u5236\uff0c\u5bfc\u51fa\u56fe\u7247","text":"<pre><code>#include \"include/core/SkCanvas.h\"\n#include \"include/core/SkColor.h\"\n#include \"include/core/SkRect.h\"\n#include \"include/core/SkSurface.h\"\n\nvoid draw(SkCanvas *canvas) {\n  canvas-&gt;save();\n  canvas-&gt;translate(SkIntToScalar(128), SkIntToScalar(128));\n  canvas-&gt;rotate(SkIntToScalar(45));\n  SkRect rect = SkRect::MakeXYWH(-90.5f, -90.5f, 181.0f, 181.0f);\n  SkPaint paint;\n  paint.setColor(SK_ColorBLUE);\n  canvas-&gt;drawRect(rect, paint);\n  canvas-&gt;restore();\n}\n\nint main() {\n  GrDirectContext *context =\n      GrDirectContext::MakeGL(GrGLMakeNativeInterface()).release();\n  SkSurface *surface =\n      SkSurface::MakeRenderTarget(context, SkBudgeted::kYes,\n                                  SkImageInfo::MakeN32Premul(300, 300))\n          .release();\n  if (surface == nullptr)\n    abort();\n\n  SkCanvas *canvas = surface-&gt;getCanvas();\n  ...\u540c\u4e0a\n}\n</code></pre>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/Skia/#glfw","title":"\u793a\u4f8b\uff1a\u7ed3\u5408glfw","text":"<pre><code>int main() {\n  GLFWwindow *window;\n  if (!glfwInit())\n    return -1;\n\n  int w = 640;\n  int h = 480;\n  window = glfwCreateWindow(640, 480, \"Hello World\", NULL, NULL);\n  glfwMakeContextCurrent(window);\n\n  GrDirectContext *context =\n      GrDirectContext::MakeGL(GrGLMakeNativeInterface()).release();\n\n  GrGLFramebufferInfo framebufferInfo;\n  framebufferInfo.fFBOID = 0;\n  framebufferInfo.fFormat = GL_RGBA8;\n  SkColorType colorType = kRGBA_8888_SkColorType;\n  GrBackendRenderTarget backendRenderTarget(w, h, 0, 0, framebufferInfo);\n  SkSurface *surface =\n      SkSurface::MakeFromBackendRenderTarget(context, backendRenderTarget,\n                                             kBottomLeft_GrSurfaceOrigin,\n                                             colorType, nullptr, nullptr)\n          .release();\n\n  if (surface == nullptr)\n    abort();\n\n  SkCanvas *canvas = surface-&gt;getCanvas();\n\n  glfwSwapInterval(1);\n\n  while (!glfwWindowShouldClose(window)) {\n    glfwWaitEvents();\n    SkPaint paint;\n    paint.setColor(SK_ColorWHITE);\n    canvas-&gt;drawPaint(paint);\n    paint.setColor(SK_ColorBLUE);\n    canvas-&gt;drawRect({100, 200, 300, 500}, paint);\n    context-&gt;flush();\n\n    glfwSwapBuffers(window);\n  }\n\n  glfwTerminate();\n  return 0;\n}\n</code></pre>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/alpha%20composition/","title":"Alpha composition","text":"<p>Alpha Composition\uff0c\u5373\u672c\u6587\u7b80\u5355\u8ba8\u8bba\u4e0bAlpha\u901a\u9053\u5f15\u5165\u540e\uff0c\u6bcf\u4e2a\u50cf\u7d20\u7684\u989c\u8272\u8ba1\u7b97\u65b9\u5f0f\u3002</p> <p>A: rgba(255,255,255,1)</p> <p>B: rgba(0,0,0,0.7)</p> <p>B over A:  result = 2551 0.3 + 0 *0.7 = 76</p> <p>A: rgba(255, 255, 255, 0.5) B: rgba(100, 100, 100, 0.8)</p> <p>B over A: result = 255*0.5 * 0.2 + 100 * 0.8 = 105</p> <p>\u5373\uff1a ColorResult = (ColorA * AlphaA) * (1 - AlphaB) + ColorB * AlphaB </p> <p>\u5176\u4e2d<code>ColorA*AlphaA</code>\u53ef\u4ee5\u79f0\u4e3a\u201c\u9884\u4e58\u201d\uff0c\u7531\u6b64\u6211\u4eec\u4e0a\u8ff0\u7b97\u51fa\u6765\u7684ColorResult\u5176\u5b9e\u4e5f\u662f\u9884\u4e58\u7ed3\u679c\u3002\u7531\u6b64\uff0c\u5b83\u53ef\u4ee5\u8fdb\u4e00\u6b65\u7ee7\u7eed\u4ee3\u5165\u540e\u7eed\u8ba1\u7b97\u3002\u5373</p> <p>PreMultpleColor(n) = PreMultipleColor(n-1)* (1- alphaN) + ColorN * alphaN\u3002</p> <p>\u5176\u5b9e\u5f88\u597d\u7406\u89e3\uff0c\u5c31\u662f\u4e4b\u524d\u7684\u7ed3\u679c\u4ec5\u53ef\u4ee5\u8d21\u732e(1-alphaB)\u7684\u5206\u91cf\uff0cColorB\u7684\u8d21\u732e\u4f1a\u88abalphaB\u76f4\u63a5\u76f8\u4e58\u3002\u7531\u6b64\uff0c\u82e5alphaB\u4e3a0\uff0c\u5219\u8ba4\u4e3a\u5b8c\u5168\u4f7f\u7528\u4e4b\u524d\u7684\u7ed3\u679c\uff0c\u82e5alphaB\u4e3a1\uff0c\u5219\u8ba4\u4e3a\u5b8c\u5168\u4f7f\u7528ColorB\u3002</p> <p>\u5bf9\u4e8exor\uff0c\u5373\u4ea6\u6216\u64cd\u4f5c\uff0c\u5373AlphaA ^ AlphaB \uff0c\u6b64\u65f6\u5b83\u4eec\u53d6\u503c\u5e94\u8be5\u9650\u5b9a\u4e8e0\u62161\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2/alpha%20composition/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>alpha compositing wiki</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc","text":""},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#osi-7-tcpip-4","title":"OSI 7\u5c42\u7f51\u7edc\u6a21\u578b\uff0c tcp/ip 4\u5c42\u7f51\u7edc\u6a21\u578b","text":"osi tcp/ip \u534f\u8bae \u5e94\u7528\u5c42 \u5e94\u7528\u5c42 HTTP\u3001TFTP, FTP, NFS, WAIS\u3001SMTP \u8868\u793a\u5c42 Telnet, Rlogin, SNMP, Gopher \u4f1a\u8bdd\u5c42 SMTP, DNS \u4f20\u8f93\u5c42 \u4f20\u8f93\u5c42 TCP, UDP \u7f51\u7edc\u5c42 \u7f51\u7edc\u5c42 IP, ICMP, ARP, RARP, AKP, UUCP \u6570\u636e\u94fe\u8def\u5c42 \u6570\u636e\u94fe\u8def\u5c42 FDDI, Ethernet, Arpanet, PDN, SLIP, PPP \u7269\u7406\u5c42 IEEE 802.1A, IEEE 802.2\u5230IEEE 802.11 <p>\u53c2\u8003</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#tcpip","title":"TCP/IP\u534f\u8bae \u6570\u636e\u5305","text":"<p>\u5404\u5c42\u8be6\u7ec6\u62a5\u6587\u6570\u636e\u7ed3\u6784\u53c2\u8003</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#udp-tcp","title":"udp, tcp","text":"<p>udp\u9996\u90e8\u683c\u5f0f</p> <p></p> <ul> <li>udp\u662f\u65e0\u8fde\u63a5\u7684\uff0c\u53d1\u9001\u6570\u636e\u524d\u4e0d\u9700\u8981\u5efa\u7acb\u8fde\u63a5</li> <li>udp\u5c3d\u6700\u5927\u52aa\u529b\u4ea4\u4ed8\uff0c\u4f46\u4e0d\u4fdd\u8bc1\u53ef\u9760\u4ea4\u4ed8\uff0c\u65e0\u62e5\u585e\u63a7\u5236</li> <li>udp\u9002\u5408\u591a\u5a92\u4f53\u901a\u4fe1\uff08\u76f4\u64ad\u3001\u8bed\u97f3\u901a\u8bdd\u3001\u89c6\u9891\u901a\u8bdd\uff09</li> <li>\u9996\u90e8\u5f00\u9500\u5c0f</li> </ul> <p></p> <ul> <li>tcp\u662f\u6709\u8fde\u63a5\u7684\uff0c\u63d0\u4f9b\u53ef\u9760\u4ea4\u4ed8\uff0c\u4fdd\u8bc1\u6570\u636e\u65e0\u5dee\u9519\uff0c\u4e0d\u4e22\u5931</li> <li>tcp\u63d0\u4f9b\u5168\u53cc\u5de5\u901a\u4fe1</li> <li>tcp\u9762\u5411\u5b57\u8282\u6d41\uff08\u901a\u8fc7\u5e8f\u53f7\u7b49\uff09</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_2","title":"\u4e09\u6b21\u63e1\u624b","text":"<ol> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u6570\u636e\u5305\uff0csyn=1,seq=X\uff08\u72b6\u6001\uff1aSYN_SENT\uff09</li> <li>\u670d\u52a1\u5668\u63a5\u6536\u5230\uff0c\u540c\u610f\u8fde\u63a5\uff0c\u8fd4\u56desyn=1, ack=1, ack_seq=X+1, seq=Y\uff08\u72b6\u6001SYN_RCVD\uff09</li> <li>\u5ba2\u6237\u7aef\u63a5\u6536\u540e\uff0c\u53d1\u9001ack=1, ack_seq=Y+1, seq=X+1</li> </ol> <p>\u4e3a\u4f55\u4e24\u6b21\u4e0d\u884c</p> <p>\u56e0\u4e3a\u53ef\u4ee5\u907f\u514d\u5df2\u7ecf\u5931\u6548\u7684tcp\u8fde\u63a5\u5bf9\u670d\u52a1\u7aef\u9020\u6210\u8d44\u6e90\u6d6a\u8d39\u3002\u5982\u679c\u4e24\u6b21\uff0c\u670d\u52a1\u5668\u5728\u6536\u5230\u7b2c\u4e00\u4e2a\u5305\u65f6\u5c31\u8981\u5efa\u7acb\u8fde\u63a5\uff0c\u5982\u679c\u8fd9\u4e2a\u5305\u5728\u7f51\u7edc\u9017\u7559\u5f88\u4e45\uff0c\u6216\u8fd4\u56de\u7684\u5305\u5ba2\u6237\u7aef\u6ca1\u6709\u6536\u5230\uff0c\u5ba2\u6237\u7aef\u6700\u540e\u8ba4\u4e3a\u8fde\u63a5\u5931\u6548\u4e86\uff0c\u4f46\u5bf9\u670d\u52a1\u7aef\u5374\u8ba4\u4e3a\u6b64\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\u4e86\u3002\u4f1a\u9020\u6210\u8d44\u6e90\u7684\u6d6a\u8d39\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_3","title":"\u56db\u6b21\u6325\u624b","text":"<ol> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u7ed3\u675f\u8bf7\u6c42\uff0cfin=1, seq=X</li> <li>\u670d\u52a1\u7aef\u6536\u5230\u7ed3\u675f\u8bf7\u6c42\uff0cack=1, ack_seq=X+1, seq=Y</li> <li>\u53ef\u80fd\u6709\u4e00\u4e9b\u6570\u636e\u5305</li> <li>\u670d\u52a1\u7aef\u771f\u6b63\u5f00\u59cb\u7ed3\u675f\uff0cfin=1, ack=1, ack_seq=X+1, seq=Z</li> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u786e\u8ba4\u5305\uff0cack=1, ack_seq=Z+1, seq=X+1</li> <li>\u5ba2\u6237\u7aef\u7b49\u5f852MSL\u65f6\u95f4\u3002\u6700\u7ec8\u5173\u95ed\u3002\uff08MSL\u6700\u5927\u62a5\u6587\u751f\u5b58\u65f6\u95f4\uff09</li> </ol> <p>\u5ba2\u6237\u7aef\u4e3a\u4f55\u7b49\u5f852MSL\u65f6\u95f4\uff1f</p> <p>\u56e0\u4e3a\u5982\u679c\u6700\u540e\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u7684ack\uff0c\u670d\u52a1\u7aef\u6ca1\u6709\u6536\u5230\u65f6\uff0c\u670d\u52a1\u7aef\u8fd8\u4f1a\u591a\u6b21\u53d1\u9001fin\u7ed9\u5ba2\u6237\u7aef\u3002\u7b49\u5f85\u7684\u8fd9\u6bb5\u65f6\u95f4\u662f\u786e\u4fdd\u670d\u52a1\u7aef\u6536\u5230\u4e86\u6700\u540e\u53d1\u9001\u7684ack\u30022MSL\u662f\u53d1\u51faack\u5230\u670d\u52a1\u7aef\u91cd\u53d1fin\u7684\u7406\u8bba\u6700\u957f\u65f6\u95f4\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_4","title":"\u786e\u8ba4\u673a\u5236","text":"<ul> <li>\u5e76\u4e0d\u662f\u5728\u6536\u5230\u6570\u636e\u65f6\uff0c\u7acb\u5373\u53d1\u9001ack\uff0c\u56e0\u4e3a\u63a5\u53d7\u5230\u7684\u6570\u636e\u5305\u987a\u5e8f\u4e0d\u4f1a\u4fdd\u8bc1\u3002\u53ef\u4ee5\u4e00\u5b9a\u7a0b\u5ea6\u964d\u4f4e\u7f51\u7edc\u6d41\u91cf</li> <li>\u4f1a\u5468\u671f\u6027\u68c0\u67e5\u662f\u5426\u9700\u8981\u53d1\u9001ack\uff08200ms\uff09\uff0c\u56e0\u6b64\u5f53\u6536\u5230\u591a\u4e2a\u5305\u65f6\uff0c\u53ea\u53d1\u9001\u6700\u65b0\u7684ack\uff0c\u6216\u8005\u53d1\u9001\u4e22\u5931\u7684ack\u3002\u4e5f\u53ef\u4ee5\u964d\u4f4e\u7f51\u7edc\u6d41\u91cf</li> <li>\u5982\u679c\u63a5\u53d7\u6570\u636e\u65f6\u4e5f\u6709\u6570\u636e\u8981\u53d1\u9001\uff0c\u53ef\u4ee5\u5e26\u4e0aack\u4fe1\u606f\u3002\u53ef\u4ee5\u964d\u4f4e\u7f51\u7edc\u6d41\u91cf\u3002</li> </ul> <p>\u53c2\u8003</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_5","title":"\u62e5\u585e\u63a7\u5236","text":"<ul> <li>\u6307\u6570\u589e\uff0c\u8fbe\u5230\u9608\u503c\u540e\u7ebf\u6027\u589e</li> <li>\u53d1\u751f\u4e22\u5305\u540e\uff0c\u6162\u542f\u52a8\uff0c\u91cd\u65b0\u8ddf\u7b2c\u4e00\u6b21\u4e00\u6837\u3002</li> <li>\u5feb\u901f\u6062\u590d\uff0c\u53d1\u751f\u4e22\u5305\u540e\uff0c\u6298\u534a\uff08\u4e58\u6cd5\u51cf\uff09\uff0c\u7136\u540e\u9608\u503c\u8c03\u5c0f\uff0c\u7ebf\u6027\u589e\u5927\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_6","title":"\u5feb\u901f\u91cd\u4f20","text":"<ul> <li>\u5feb\u901f\u91cd\u4f20\uff0c\u8fde\u7eed\u6536\u52303\u4e2a\u4e4b\u524d\u5305\u7684ack\uff0c\u5219\u7acb\u5373\u91cd\u4f20\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_7","title":"\u8d85\u65f6\u91cd\u4f20","text":"<ul> <li>\u8d85\u65f6\u91cd\u4f20\uff0c\u5982\u679c\u8d85\u8fc7\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u4e4b\u524d\u5305\u7684ack\uff0c\u5219\u8fdb\u884c\u91cd\u4f20\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#http","title":"http","text":"<ul> <li>\u660e\u6587\u4f20\u8f93</li> <li>\u4e0d\u540c\u7248\u672c\u7279\u6027\u4e0d\u540c\uff08todo)</li> <li>http\u65b9\u6cd5\uff1ahead, get, post, put, delete \u7b49\uff0c\u53c2\u89c1\u56fe\u8bf4\u90e8\u5206\u3002</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#get-post","title":"get post\u533a\u522b","text":"<ul> <li>get, post\u90fd\u53ef\u4ee5\u5728body\u53d1\u9001\u6570\u636e\u3002\u4f46get\u4e00\u822c\u53ea\u53d1\u9001\u6570\u636e\uff0c\u800c\u4e14\u4e00\u822c\u53ea\u6709\u83b7\u53d6\u6570\u636e\u7684\u610f\u5473\uff0c\u800cpost\u5219\u66f4\u591a\u662f\u53d1\u9001\u6570\u636e\u7684\u610f\u5473\u3002</li> <li>get\u4e00\u822c\u5728url\u4e2d\u4f20\u9012\u6570\u636e\uff0c\u800curl\u6709\u957f\u5ea6\u9650\u5236\u3002post\u4e00\u822c\u5728body\u53d1\u9001\u6570\u636e\uff0c\u6570\u636e\u89c4\u6a21\u4f1a\u66f4\u5927</li> </ul>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#tcp","title":"tcp\u62e5\u585e","text":"<p>\u4f1a\u6709\u4e00\u4e2a\u53d1\u9001\u7a97\u53e3\uff0c\u4e00\u4e2a\u62e5\u585e\u7684\u9608\u503csstresh\uff0c\u5f53\u53d1\u9001\u7a97\u53e3\u5c0f\u4e8esstresh\u7684\u65f6\u5019\uff0c\u662f\u6307\u6570\u589e\u3002\u5927\u4e8esstresh\u7684\u65f6\u5019\u6539\u4e3a\u7ebf\u6027\u589e\u3002\uff08\u6162\u5f00\u59cb\uff09</p> <p>\u5f53\u51fa\u73b0\u6536\u4e0d\u5230ack\uff08\u8d85\u65f6\uff09\uff0c\u5219sstresh\u4e3a\u5f53\u524d\u53d1\u9001\u7a97\u53e3\u7684\u4e00\u534a\u53d6\u503c\u3002\u91cd\u65b0\u5f00\u59cb\u8fdb\u884c\u4e0a\u8ff0\u6162\u5f00\u59cb\u7684\u8fc7\u7a0b\u3002</p> <p>\u5f53\u51fa\u73b0\u91cd\u590d\u786e\u8ba4\u7684\u65f6\u5019\uff0c\u4f1a\u8fdb\u884c\u201c\u5feb\u901f\u6062\u590d\u201d\uff0c\u5373\u5728sstresh\u51cf\u534a\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u628a\u53d1\u9001\u7a97\u53e3\u8bbe\u7f6e\u4e3asstresh\uff0c\u8fdb\u884c\u7ebf\u6027\u589e\u52a0\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#http-https","title":"http, https","text":"<p>https ssl\u5efa\u7acb\u56fe\u89e3</p> <ol> <li>\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\uff0c\u5305\u542b\u5ba2\u6237\u7aef\u652f\u6301\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ef\u5e26\u4e00\u4e2a\u968f\u673a\u751f\u6210\u7684\u6570\u3002</li> <li>\u670d\u52a1\u7aef\u6839\u636e\u53cc\u65b9\u652f\u6301\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u9009\u62e9\u4e00\u4e2a\uff0c\u518d\u751f\u6210\u4e00\u4e2a\u968f\u673a\u6570\u8fd4\u56de\u3002\u7a0d\u540e\u8fd8\u4f1a\u628a\u81ea\u5df1\u7684\u6570\u5b57\u8bc1\u4e66\u53d1\u9001\u8fd4\u56de\u3002</li> <li>\u5ba2\u6237\u7aef\u6536\u5230\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u8fdb\u884c\u6821\u9a8c\u3002</li> <li>\u5ba2\u6237\u7aef\u7ed3\u5408\u4e24\u4e2a\u968f\u673a\u6570\uff0c\u6700\u540e\u751f\u6210\u4e00\u4e2a\u4f1a\u8bdd\u79d8\u94a5\uff0c\u518d\u7528\u670d\u52a1\u7aef\u6570\u5b57\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\u52a0\u5bc6\u540e\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u3002</li> <li>\u670d\u52a1\u7aef\u7528\u79c1\u94a5\u89e3\u5bc6\u540e\uff0c\u53d6\u51fa\u4f1a\u8bdd\u5bc6\u94a5\u3002\u4e4b\u540e\u53cc\u65b9\u901a\u4fe1\u4fbf\u53ef\u4ee5\u4f7f\u7528\u6b64\u5bc6\u94a5\u8fdb\u884c\u901a\u4fe1\u4e86\u3002</li> </ol> <p>\u6838\u5fc3\u70b9\u5728\u4e8e\uff0c\u6570\u5b57\u8bc1\u4e66\u786e\u4fdd\u4e86\u670d\u52a1\u7aef\u662f\u5426\u53ef\u4ee5\u4fe1\u4efb\u3002\u800c\u5ba2\u6237\u7aef\u751f\u6210\u4e00\u4e2a\u5bc6\u94a5\u518d\u7528\u670d\u52a1\u7aef\u7684\u516c\u94a5\u52a0\u5bc6\u8fd4\u56de\uff0c\u6700\u7ec8\u4f5c\u4e3a\u4f1a\u8bdd\u7684\u5bc6\u94a5\uff0c\u8fd9\u786e\u4fdd\u4e86\u5ba2\u6237\u7aef\u7684\u771f\u5b9e\u6027\u3002</p> <p></p> <p>https\u662f\u5982\u4f55\u4fdd\u8bc1\u5b89\u5168\u7684\uff0c\u6570\u5b57\u8bc1\u4e66\u662f\u4ec0\u4e48</p> <ul> <li>\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u9664\u4e86\u51fa\u5382\u8bbe\u5907\u5185\u7f6e\u7684\u4ee5\u5916\uff0c\u8fd8\u6709\u7528\u6237\u53ef\u4ee5\u81ea\u5df1\u6dfb\u52a0\u7684\u3002\u68c0\u67e5\u201c\u4e2d\u95f4\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u201d\u7684\u8bc1\u4e66\u662f\u5426\u6709\u6548\u548c\u68c0\u67e5\u5176\u4ed6\u8bc1\u4e66\u6ca1\u6709\u533a\u522b\uff0c\u53ea\u6709\u68c0\u67e5\u5230\u6700\u540e\u662f\u6765\u81ea\u8bbe\u5907\u8ba4\u53ef\u7684\u201c\u6839\u201d\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u5373\u53ef\uff0c\u6216\u8005\u8bbe\u5907\u4fe1\u4efb\u7684\u8bc1\u4e66\u5373\u53ef\u3002</li> <li>\u6307\u7eb9\u548c\u6307\u7eb9\u7b97\u6cd5\u662f\u88ab\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7684\u79c1\u94a5\u52a0\u5bc6\u8fc7\u7684\uff0c\u56e0\u6b64\u9700\u8981\u8be5\u9881\u53d1\u673a\u6784\u7684\u516c\u94a5\u89e3\u5bc6\uff0c\u624d\u80fd\u6821\u5bf9\u8bc1\u4e66\u3002</li> <li>\u6307\u7eb9\u7528\u6765\u76f8\u5f53\u4e8e\u662f\u6570\u5b57\u8bc1\u4e66\u5728\u6307\u7eb9\u7b97\u6cd5\u4e0b\u6c42\u51fa\u7684\u54c8\u5e0c\u503c\uff0c\u7528\u4e8e\u9632\u6b62\u8bc1\u4e66\u88ab\u7be1\u6539\u3002</li> </ul> <p>https\u7684\u6293\u5305</p> <p>\u4e3b\u8981\u662f\u8ba9\u5ba2\u6237\u7aef\u7684\u8bbe\u5907\u4fe1\u4efb\u6293\u5305\u8f6f\u4ef6\u7684\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#http2-feature","title":"http2 feature","text":"<p>http:1,1.1,2...https://www.ruanyifeng.com/blog/2016/08/http.html</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#dns","title":"dns","text":"<p>check google cloud desc: https://cloud.google.com/dns/docs/dns-overview?hl=zh-cn</p> <p>dns server\u53d1\u73b0</p> <p>dns request\u534f\u8bae</p> <p>look like:https://serverfault.com/questions/173187/what-does-a-dns-request-look-like</p> <p>dns \u8fd4\u56de</p> <p>\u4f18\u5148\u67e5\u770b\u7f13\u5b58\uff0c\u6bcf\u4e2a\u8bb0\u5f55(record)\u90fd\u4f1a\u6709time-to-live\u8868\u793a\u6709\u6548\u65f6\u95f4\u3002\u82e5\u65e0\u5bf9\u5e94\u7684\u8bb0\u5f55\uff0c\u6216\u7f13\u5b58\u5931\u6548\uff0c\u5219\u7ee7\u7eed\u5411\u4e0a\u4e00\u7ea7dns\u670d\u52a1\u8be2\u95ee\u3002</p> <p>dns server\u5206\u7ea7</p> <ul> <li>\u672c\u5730dns server(local)</li> <li>\u6839 dns server(.root\u662f\u6839\u57df\u540d\uff0c\u56fa\u5b9a)</li> <li>\u9876\u7ea7\u57df\u540d dns server(.org, .com\u662f\u9876\u7ea7\u57df\u540d)</li> <li>\u6b21\u7ea7\u57df\u540d dns server(xxx.com\u4e2d\u7684xxx)</li> <li>\u4e09\u7ea7\u57df\u540d dns server(mail.xxx.com\u4e2d\u7684mail)</li> </ul> <p>\u67e5\u8be2\u4ee5\u201c\u5206\u800c\u6cbb\u4e4b\u201d\u7684\u601d\u60f3\u8fdb\u884c\u67e5\u8be2\u3002\u5373\u6839-&gt;\u9876\u7ea7\u57df\u540d-&gt;...\uff0c\u4f7f\u7528udp\u534f\u8bae\uff0c\u56e0\u4e3atcp\u7684\u6570\u636e\u5305\u9700\u89819\u4e2a\uff087\u4e2a\u63e1\u624b\u6325\u624b\uff0c1\u4e2aRequest\uff0c1\u4e2aResponse\uff09</p> <p>\u7528\u6237\u2014\u672c\u5730\u9012\u5f52\u670d\u52a1\u5668\u2014\u6839\u6743\u5a01\u670d\u52a1\u5668\u2014COM\u6743\u5a01\u670d\u52a1\u5668\u2014xxorg.com\u6743\u5a01\u670d\u52a1\u5668</p>"},{"location":"%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#http-dns","title":"http dns","text":"<p>\u4f20\u7edfdns\u4f1a\u6709\u51e0\u4e2a\u5b89\u5168\u98ce\u9669\uff0c\u4e00\u4e2a\u662f\u4f20\u8f93\u8fc7\u7a0b\u4e0d\u52a0\u5bc6\uff0c\u4e2d\u95f4\u8def\u7531\u53ef\u4ee5\u6536\u96c6\u4e2a\u4eba\u4fe1\u606f\u3002\u4e00\u4e2a\u662f\uff0c\u89e3\u6790\u5668\u4e0d\u4e00\u5b9a\u53ef\u9760\uff0c\u89e3\u6790\u5668\u4e00\u822c\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\uff0c\u800c\u7cfb\u7edf\u7684\u89e3\u6790\u5668\u4e00\u822c\u53c8\u662f\u8fde\u63a5\u5230\u7f51\u7edc\u65f6\uff0c\u8def\u7531\u6765\u63d0\u4f9b\u7684\uff0c\u4e0d\u53ef\u9760\u7684\u89e3\u6790\u5668\u53ef\u4ee5\u7be1\u6539\u7ed3\u679c\u3002</p> <p>https://hacks.mozilla.org/2018/05/a-cartoon-intro-to-dns-over-https/</p> <p>\u800c\u89e3\u51b3\u65b9\u5f0f\u662f\uff0c\u66f4\u6539\u53ef\u9760\u7684\u89e3\u6790\u5668\uff0c\u6b64\u5916\uff0c\u89e3\u6790\u5668\u7684dns\u8bf7\u6c42\u662f\u4ee5\u89e3\u6790\u5668\u4f9b\u5e94\u5546\u7684ip\u53d1\u8d77\uff0c\u89c4\u907f\u4e2a\u4eba\u4fe1\u606f\u6cc4\u6f0f\u3002\u6b64\u5916\u5ba2\u6237\u5230\u89e3\u6790\u5668\u7684dns\u8bf7\u6c42\u662f\u4ee5https\u4f20\u8f93\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/MVC%20MVP%20MVVM/","title":"MVC MVP MVVM","text":"<p>\u9996\u5148\uff0c\u4e0d\u4f7f\u7528\u8fd9\u4e9b\u6846\u67b6\uff0c\u4e00\u822c\u4f1a\u9047\u5230\u96be\u4ee5\u7ef4\u62a4\u3001\u96be\u4ee5\u62d3\u5c55\u3001\u96be\u4ee5\u6d4b\u8bd5\u7684\u95ee\u9898</p> <p></p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/MVC%20MVP%20MVVM/#mvc","title":"MVC","text":"<p>View\u63d0\u4f9b\u57fa\u672c\u529f\u80fd\u63a5\u53e3\uff0cUI\u4e8b\u4ef6\u7531View\u611f\u77e5\uff0c\u8c03\u7528controller\u54cd\u5e94\u5e76\u7531controller\u627eModel\u83b7\u53d6\u6570\u636e\u3002model\u83b7\u53d6\u6570\u636e\u4e4b\u540e\u544a\u77e5controller\uff08\u53ef\u80fd\u4e0d\u662f\u901a\u8fc7\u56de\u8c03\u800c\u662f\u63a5\u53e3\uff09\uff0ccontroller\u4ee5view\u63a5\u53e3\u6765\u505c\u6b62loading\uff0c\u5e76\u544a\u77e5view\u3002view\u518d\u81ea\u884c\u4ecemodel\u4e2d\u8bfb\u6570\u636e\u7ed3\u679c\u3002\uff08\u6240\u4ee5\u8fd9\u8bbe\u8ba1\u5f88\u8111\u6b8b\uff0c\u5927\u90e8\u5206\u573a\u666f\u4e0d\u5408\u9002\uff0c3\u4e2a\u89d2\u8272\u5173\u7cfb\u6709\u70b9\u590d\u6742\uff09</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/MVC%20MVP%20MVVM/#mvp","title":"MVP","text":"<p>View\u63d0\u4f9b\u57fa\u672c\u63a5\u53e3\uff0cUI\u4e8b\u4ef6\u7531View\u611f\u77e5\uff0c\u8c03\u7528presenter\u54cd\u5e94\u5e76\u7531presenter\u627emodel\u83b7\u53d6\u6570\u636e\uff0c\u6570\u636e\u83b7\u53d6\u901a\u8fc7\u56de\u8c03\uff0c\u800c\u975epresenter\u63a5\u53e3\u3002\u4e4b\u540e\u518d\u901a\u8fc7View\u63a5\u53e3\u5b8c\u6210UI\u66f4\u65b0\u548c\u64cd\u4f5c\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0cView\u4e0d\u9700\u8981\u611f\u77e5model\uff0c\u4e0d\u9700\u8981\u64cd\u4f5cmodel\u3002\u4f46\u662fpresenter\u548cView\u8fd8\u5b58\u5728\u53cc\u5411\u7684\u5173\u7cfb\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/MVC%20MVP%20MVVM/#mvvm","title":"MVVM","text":"<p>\u5728presenter\u7684\u57fa\u7840\u4e0a\uff0cview\u548cViewModel\u4e0d\u518d\u53cc\u5411\u5173\u8054\u3002ViewModel\u53ea\u9700\u8981\u63d0\u4f9b\u6570\u636e\u8ba2\u9605\u3002\u800cView\u6839\u636eui\u4e8b\u4ef6\u81ea\u884c\u901a\u8fc7viewModel\u63a5\u53e3\u8c03\u7528\u53bb\u8bf7\u6c42\u65b0\u6570\u636e\uff0c\u800c\u6570\u636e\u7684\u66f4\u65b0\u4e00\u822c\u901a\u8fc7ViewModel\u63d0\u4f9b\u7684\u6570\u636e\u8ba2\u9605\u5b8c\u6210\u3002</p> <p>\u8fd9\u540e\u9762\u4e24\u79cd\u7684\u53ef\u6d4b\u8bd5\u6027\u90fd\u8981\u597d\u5f88\u591a\u3002 \u5b9e\u9645\u7684View\u4e00\u822c\u662factivity\u6216\u8005Fragment\uff0c\u4e5f\u53ef\u4ee5\u662fViewGroup\u81ea\u5b9a\u4e49\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/","title":"\u4f9d\u8d56\u6ce8\u5165","text":"<p>\u4e0d\u5f97\u4e0d\u8bf4DI\u662f\u4e00\u4e2a\u5373\u4f7f\u4e0d\u5173\u5fc3\uff0c\u4e5f\u80fd\u7ecf\u5e38\u542c\u5230\u7684\u4e1c\u897f\u3002\u4e86\u89e3\u548c\u638c\u63e1Dagger2\u5e76\u4e0d\u5bb9\u6613\uff0c\u5b83\u6bd4\u5e38\u89c1\u7684\u5e93\u66f4\u96be\u4f7f\u7528\u3002\u6211\u4e5f\u603b\u611f\u89c9Dagger2\u7684\u89e3\u51b3\u65b9\u6848\u5728\u672a\u6765\u5e94\u8be5\u4f1a\u88ab\u91cd\u6784\u6216\u66ff\u6362\uff0c\u56e0\u4e3a\u76ee\u524d\u7684\u5b66\u4e60\u4f7f\u7528\u6210\u672c\u592a\u9ad8\uff0c\u5176\u4f7f\u7528\u7684\u590d\u6742\u6027\u6709\u65f6\u5019\u5df2\u7ecf\u5927\u4e8e\u6240\u80fd\u5e26\u6765\u7684\u597d\u5904\uff0c\u6216\u8005\u56e0\u5176\u590d\u6742\u6027\u5e26\u6765\u7684\u9519\u8bef\u4f7f\u7528\u3001\u7ef4\u62a4\u6210\u672c\uff0c\u90fd\u5c06\u4e3a\u5176\u5e26\u6765\u7684\u597d\u5904\u5927\u6253\u6298\u6263\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#_1","title":"\u80cc\u666f","text":"<p>\u4f9d\u8d56\u6ce8\u5165\u662f\u6bd4\u8f83\u5bbd\u6cdb\u7684\u6982\u5ff5\uff0c\u6ca1\u6709\u4f9d\u8d56\u6ce8\u5165\uff0c\u5199\u51fa\u6765\u7684\u4ee3\u7801\u4e5f\u4f9d\u7136\u53ef\u4ee5\u9ad8\u6548\u4e14\u8fd0\u884c\u826f\u597d\u3002DI\u4e00\u822c\u5173\u6ce8\u5982\u4e0b\u7684\u4ee3\u7801\u573a\u666f\uff1a <pre><code>\u6784\u9020\u5668\u9700\u8981\u5916\u90e8\u53c2\u6570\nclass UsefullAbility(source:Source, context:Context){}\n\n\u7c7b\u5185\u90e8\u6210\u5458\u9700\u8981\u4ece\u5916\u90e8\u8bfb\u53d6\u503c\nclass Fragment(){\n    var propertyFromOutsideToPass\n\n    fun ...{\n        propertyFromOutsideToPass = oursideProperty.\n    }\n}\n\nclass Adapter(){\n    var propertyFromOutsideToPass by ...\n}\n</code></pre> \u66f4\u4e00\u822c\u7684\uff0c\u4e00\u79cd\u573a\u666f\u662f\u65b9\u6cd5\u8c03\u7528\u4f20\u5165\u53c2\u6570\uff0c\u4e00\u79cd\u662f\u6210\u5458\u53d8\u91cf\u8d4b\u503c\u3002\u6362\u53e5\u8bdd\u8bf4\u4e00\u4e9b\u4e0d\u8003\u8651\u4f9d\u8d56\u6ce8\u5165\u7684\u573a\u666f\u6bd4\u5982\u6240\u9700\u8981\u7684\u53c2\u6570\u5747\u53ef\u4ee5\u7531\u5185\u90e8\u751f\u6210\u3001\u4e5f\u4e0d\u9700\u8981\u5bf9\u5916\u66b4\u9732\uff0c\u5c40\u90e8\u53d8\u91cf\uff0c\u591a\u6b21\u91cd\u65b0\u8d4b\u503c\u3001\u5177\u6709\u66f4\u7279\u5b9a\u903b\u8f91\u7684\u6210\u5458\u53d8\u91cf\u3002\u5728\u8003\u8651DI\u7684\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u5982\u679c\u4e0d\u501f\u52a9\u5de5\u5177\uff0c\u5728\u65b9\u6cd5\u5165\u53c2\u60c5\u51b5\u4e0b\uff0c\u4e00\u822c\u4f1a\u6709\u4e00\u4e9b\u4e1c\u897f\u626e\u6f14\u4e86\u5bb9\u5668\u89d2\u8272\uff0c\u5373\u8d1f\u8d23\u521b\u5efa\u5b9e\u4f8b\u3001\u6309\u9700\u4fdd\u7559\uff0c\u5982\u679c\u662f\u7c7b\u4f3c\u7f51\u7edc\u914d\u7f6e\u3001\u5b58\u50a8\u914d\u7f6e\uff0c\u5219\u4e00\u822c\u4f1a\u6709\u5168\u5c40\u7684\u7ba1\u7406\u7c7b\u3002\u800c\u5bf9\u6210\u5458\u53d8\u91cf\u4ece\u5916\u90e8\u53d6\u503c\u65f6\uff0c\u5219\u4f1a\u53d8\u5f97\u66f4\u56f0\u96be\u4e00\u4e9b\uff08\u5f53\u7136Kotlin\u7684\u5c5e\u6027\u59d4\u6258\u8ba9\u8fd9\u4e2a\u8fc7\u7a0b\u53d8\u5f97\u4f3c\u4e4e\u5927\u6709\u6539\u89c2\uff09\uff0c\u751a\u81f3\u5728\u7c7b\u4f3c\u7684\u573a\u666f\u4e0b\u9700\u8981\u591a\u6b21\u7f16\u5199\u76f8\u4f3c\u7684\u4ee3\u7801\u3002</p> <p>\u800cDI\u5de5\u5177\u65e8\u5728\u7b80\u5316\u8fd9\u79cd\u8fc7\u7a0b\uff0c\u5b83\u4f1a\u5c3d\u91cf\u4e3a\u4f60\u751f\u6210\u8fd9\u4e9b\u7528\u4e8e\u7ef4\u62a4\u5728\u591a\u4e2a\u7c7b\u3001\u62bd\u8c61\u8303\u56f4\u3001\u5c42\u3001\u6a21\u5757\u4e4b\u95f4\u4f20\u9012\u5b9e\u4f8b\u3001\u6784\u9020\u5b9e\u4f8b\u7684\u5de5\u4f5c\u3002\u6709\u7684\u65b9\u6848\u9700\u8981\u6211\u4eec\u7528DSL\u65b9\u5f0f\u63cf\u8ff0\u5173\u7cfb\uff08koin\uff09\uff0c\u6709\u7684\u65b9\u6848\u9700\u8981\u6211\u4eec\u7528\u6ce8\u89e3\u63cf\u8ff0\uff08Dagger\uff09\u3002\u5728\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u6709\u7684\u65b9\u6848\u4f9d\u9760\u8fd0\u884c\u65f6\u53cd\u5c04\uff08Guice\uff09\uff0c\u6709\u7684\u5728apt/kapt\u751f\u6210\u4ee3\u7801\u3001\u7ed3\u5408\u90e8\u5206\u4ee3\u7801\u4fb5\u5165\u5b8c\u6210\uff08Dagger\uff0c\u4ee3\u7801\u4fb5\u5165\u662f\u6307\uff0c\u9700\u8981\u4f9d\u8d56apt/kapt\u751f\u6210\u7684\u7c7b\uff0c\u5728\u539f\u6709\u903b\u8f91\u4e2d\u624b\u52a8\u6dfb\u52a0\u8c03\u7528\uff09\u3002</p> <p>\u4f9d\u8d56\u6ce8\u5165DI\u548cService Locator(SL)\u662f\u6709\u533a\u522b\u7684\u3002\u540e\u8005\u66f4\u504f\u5411\u63a5\u53e3-\u5b9e\u73b0\u67e5\u8be2\u3001\u83b7\u53d6\uff0c\u800c\u4f9d\u8d56\u6ce8\u5165\u5219\u66f4\u5bbd\u6cdb\uff0c\u4ece\u63a5\u53e3\u3001\u5b9e\u4f8b\u3001\u7ec4\u88c5\u3001\u6536\u96c6\u4e00\u4e9b\u65b0\u7684\u5185\u5bb9\u3001\u6784\u5efa\u5173\u7cfb\u56fe\uff0c\u5747\u662f\u5b83\u7684\u8303\u7574\u3002\u800c\u670d\u52a1\u5b9a\u4f4d\u5668\u5f80\u5f80\u4f1a\u5ffd\u7565\u4f9d\u8d56\u5173\u7cfb\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#dagger-android","title":"\u4f7f\u7528dagger-android","text":"<p>dagger\u7684\u4f7f\u7528\u786e\u5b9e\u4e0d\u7b97\u5bb9\u6613\u3002\u5373\u4f7f\u770b\u5b98\u65b9\u7684\u6559\u7a0b\uff0c\u4e5f\u6709\u8868\u8ff0\u4e0d\u6e05\uff0c\u6781\u5bb9\u6613\u8e29\u5751\u7684\u5730\u65b9\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u59a8\u770b\u4e00\u4e0b\u5b98\u65b9\u7684blueprint\u5de5\u7a0b\u91ccdagger-android\u7684\u5177\u4f53\u4f7f\u7528\u3002\u6765\u5c11\u8d70\u5f2f\u8def\u3002</p> <p>\u76f8\u6bd4dagger\u7684\u666e\u901ajava\u73af\u5883\uff0candroid\u4e2d\uff0cactivity, fragment, view, viewModel\u8fd9\u4e9b\u7c7b\u7684\u751f\u6210\u5176\u5b9e\u5e76\u4e0d\u662f\u6211\u4eec\u6240\u53d1\u8d77\u7684\u3002\u6211\u4eec\u867d\u7136\u4e0d\u5fc5\u4f9d\u8d56\u5b83\u4eec\u7684\u6784\u9020\u505a\u4ec0\u4e48\uff08\u9664\u4e86ViewModel\uff09\uff0c\u5373\u4e0d\u600e\u4e48\u9700\u8981<code>work(fragment, activity)</code>\u5e76\u4e3a\u6b64new\u6216\u8005\u4f20\u9012\u5b9e\u4f8b\u8fd9\u79cd\u60c5\u51b5\u3002\u4f46\u4e00\u822c\u6765\u8bf4\uff0c\u5176\u6210\u5458\u53d8\u91cf\u5f80\u5f80\u6709\u9700\u8981\u6ce8\u5165\u7684\uff0c\u6700\u5e38\u89c1\u7684\u662f<code>viewModel</code>\u3002<code>viewModel</code>\u4e5f\u4f1a\u88ab\u591a\u4e2a<code>fragment</code>\u6240\u5171\u4eab\uff0c<code>viewModel</code>\u7684\u6784\u9020\u5f80\u5f80\u8fd8\u9700\u8981\u4e00\u4e9b\u914d\u7f6e\u624d\u80fd\u5b9e\u73b0<code>viewModel</code>\u5185\u90e8\u7684\u80fd\u529b\uff0c\u800c\u8fd9\u4e9b\u914d\u7f6e\u91cc\uff0c\u53ef\u80fd\u53c8\u9700\u8981\u4e00\u5207\u5176\u4ed6\u7684\u914d\u7f6e\u3002\u6bd4\u5982\u8fd9\u6837\u7684\u4f9d\u8d56<code>viewModel(repo), repo(apiService)</code>\u7b49\u7b49\u3002</p> <p>\u5728\u51c6\u5907\u5f00\u59cb\u4e3a\u8fd9\u79cd\u573a\u666f\u4f7f\u7528dagger-android\u65f6\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u610f\u8bc6\u5230\uff1a - \u4e0d\u80fd\u5728fragment\u4e2d\u521b\u5efa\u65b0\u7684dagger component\u662f\u56e0\u4e3a\u8fd9\u6837\u5fc5\u7136\u4f1a\u5bfc\u81f4\u65b0\u7684viewModel\u3002 - viewModel\u7684\u5b9e\u9645\u521b\u5efa\u5e76\u4e0d\u5e94\u8be5\u7531\u6211\u4eec\u89e6\u53d1\uff0c\u800c\u662f\u5b9e\u73b0<code>ViewModelProvider.Factory</code>\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728<code>fragment</code>\u4e2d\u8bbf\u95ee<code>ViewModelProvider</code>\u53bb\u8bf7\u6c42\u6307\u5b9aViewModel\u7c7b\u7684\u5b9e\u4f8b\u5373\u53ef\u3002\u6bd5\u7adf\uff0c<code>ViewModel</code>\u7684\u51fa\u73b0\u662f\u4e3a\u4e86\u89e3\u51b3<code>Fragment</code>, <code>activity</code>\u5728\u914d\u7f6e\u53d8\u66f4\u3001\u4ee5\u53ca\u5176\u4ed6\u72b6\u6001\u9500\u6bc1\u6062\u590d\u65f6 <code>\u72b6\u6001</code> \u8de8<code>fragment/activity</code>\u5b9e\u4f8b\u95ee\u9898\u3001\u4ee5\u53ca\u5728\u591a<code>fragment</code>\u4e4b\u95f4\u5171\u4eab\u95ee\u9898\u7684\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#1-applicationcomponent","title":"1. \u58f0\u660eApplicationComponent","text":"<p>\u4f7f\u7528@Component\u6ce8\u89e3\uff0c\u4e3a\u5e94\u7528\u7c7b\u5b9a\u4e49\u4e00\u4e2adagger\u7ec4\u4ef6\uff0c\u6ce8\u610f\uff0c\u6b64\u63a5\u53e3\u9700\u8981\u7ee7\u627f\u4e8e\uff1a<code>AndroidInjector&lt;?&gt;</code>\uff0c\u5e76\u63d0\u4f9bfactory\u63a5\u53e3\u53caFactory.create\u65b9\u6cd5\u3002</p> <p>\u5728Component\u6ce8\u89e3\u91cc\uff0c\u4e00\u5b9a\u8981\u52a0\u4e0a<code>AndroidInjectionModule</code>\uff0c\u6b64\u6a21\u5757\u7528\u4e8e\u4e3aAndroid Injector\u63d0\u4f9b\u4e86Map\u7684\u5904\u7406\u3002</p> <p>Application\u7c7b\u9700\u8981\u7ee7\u627f\u4e8eDaggerApplication\uff0c\u5e76\u5b9e\u73b0<code>applicationInjector():AndroidInjector</code>\u65b9\u6cd5\uff0c\u521b\u5efa\u51fa\u6b64Dagger\u7ec4\u4ef6\u3002</p> <p>\u5230\u8fd9\u4e00\u6b65\uff0c\u6211\u4eec\u8fd8\u5e76\u672a\u7ed9<code>android injector</code>\u63d0\u4f9b\u4efb\u4f55activity, fragment\u7684\u5de5\u5382\uff0c\u56e0\u6b64\uff0cAndroid injector\u8fd8\u4e0d\u80fd\u4e3a\u6211\u4eec\u5728<code>Activity, fragment</code>\u4e2d\u8fdb\u884c\u6ce8\u5165\uff08\u6210\u5458\u53d8\u91cf\u6ce8\u5165\uff0c\u6bd4\u5982ViewModelProvider.Factory\uff09</p> <p>\u4e4b\u6240\u4ee5\u4f7f\u7528Android Injector, android-dagger\uff0c\u662f\u56e0\u4e3a\u5b83\u63d0\u4f9b\u4e86\u4e00\u5c42\u7b80\u5355\u7684\u6846\u67b6\uff0c\u6765\u66f4\u4fbf\u4e8e\u4f7f\u7528dagger\uff0c\u82e5\u6ca1\u6709\u8fd9\u5c42\u6846\u67b6\uff0c\u6211\u4eec\u65e0\u6cd5\u8ba9application\u7ee7\u627f\u4e8e<code>DaggerApplication</code>, \u65e0\u6cd5\u8ba9<code>fragment</code>\u7ee7\u627f\u4e8e<code>DaggerFragment</code>\uff0c \u65e0\u6cd5\u8ba9<code>Activity</code>\u7ee7\u627f\u4e8e<code>DaggerActivity</code>\u7b49\uff0c\u8fd9\u4f1a\u4f7f\u5f97\u6211\u4eec\u9700\u8981\u5728Activity\u4e2d\u5f80\u5f80\u9700\u8981getApplication\uff0c\u8bbf\u95ee\u5b83\u7684DaggerApplicationComponent\uff0c\u518d\u8c03\u7528xxActivityCompoennt\u6765\u5f97\u5230\u6b64Activity\u5bf9\u5e94\u7684dagger\u7ec4\u4ef6\u3002\u5bf9\u4e8eFragment\u6765\u8bf4\uff0c\u7c7b\u4f3c\u7684\uff0c\u9700\u8981getActivity\uff0c\u8bbf\u95eeActivity\u7684\u516c\u5f00\u6210\u5458\u53d8\u91cfDaggerXxxActivityComponent\uff0c\u8c03\u7528inject\u624d\u80fd\u8ba9\u81ea\u5df1\u88ab\u6ce8\u5165\u3002 \u800c\u6709\u4e86dagger-android\u540e\uff0c\u53ea\u9700\u6309\u9700\u7ee7\u627f\u8fd9\u4e9b\u7c7b\u5373\u53ef\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8c03\u7528DagerXxxxCompoennt.inject(this)\uff0c\u56e0\u4e3a\u7ee7\u627f\u540e\uff0c\u5728\u5bf9\u5e94\u751f\u547d\u5468\u671f\u65b9\u6cd5\u4e2d\uff0c\u5c01\u88c5\u5c42\u5df2\u7ecf\u7edf\u4e00\u8c03\u7528\u4e86\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#2-activitymodule","title":"2. \u58f0\u660eActivityModule","text":"<p>\u4e3a\u4e86\u80fd\u591f\u7ee7\u627f\u4e8e<code>DaggerActivity/ DaggerFragment</code>\u7b49\uff0c\u6765\u83b7\u5f97\u5c01\u88c5\u5c42\u7684<code>inject(this)</code>\u8c03\u7528\uff0c\u6211\u4eec\u9700\u8981\u63d0\u4f9b\u66f4\u591a\u7684<code>AndroidInjector.Factory</code>\uff0c\u5982\u540c\u4e0a\u4e00\u6b65\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u7684\u521b\u5efaactivity\u5bf9\u5e94\u7684module\uff0c\u6765\u7ee7\u627f<code>AndroidInjector</code>\uff0c\u63d0\u4f9bFactory\u63a5\u53e3\u53ca\u65b9\u6cd5\uff0c\u5e76\u518d\u5efa\u7acb\u5bf9\u5e94\u7684Dagger\u7ec4\u4ef6\uff0c\u5e76\u7528<code>@ClassKey</code>\u6216<code>@StringKey</code>\u628a\u8fd9\u4e2a<code>AndroidInjector</code>\u5b50\u7c7b\u4e0ekey\u5173\u8054\uff0c\u4ece\u800c\u53ef\u4ee5\u88ab<code>AndroidInjectionModule</code>\u6a21\u5757\u68c0\u7d22\u3002</p> <p>\u5c3d\u7ba1\u5982\u6b64\uff0candroid-dagger\u63d0\u4f9b\u4e86<code>@ContributesAndroidInjector</code>\u6ce8\u89e3\uff0c\u5b83\u7528\u4e8e\u7b80\u5316\u8fd9\u4e00\u8fc7\u7a0b\uff0c\u501f\u52a9\u5b83\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e3aactivity\u5efa\u7acb\u4e00\u4e2a\u5bf9\u5e94module\uff08\u62bd\u8c61\u7c7b\uff09\uff0c\u5b83\u6709\u4e00\u4e2a\u62bd\u8c61\u65b9\u6cd5\uff0c\u65e0\u53c2\u6570\uff0c\u8fd4\u56de\u6307\u5b9aactivity\u5373\u53ef\u3002\u6b64\u5916\uff0c\u8fd8\u53ef\u4ee5\u8865\u5145module\u5230\u8fd9\u4e2acomponent\u4e4b\u4e2d\u3002\uff08\u6ce8\u610f\uff0c\u867d\u7136\u6211\u4eec\u6ca1\u628a\u5b83\u5199\u6210component\uff0c\u4f46\u5b83\u4f1a\u751f\u6210\u51fa\u5bf9\u5e94\u7684 dagger component\uff09\uff0c\u6bd4\u5982\u8865\u5145\u4e00\u4e9b<code>Fragment</code>\u7684module\uff0c\u800c\u8fd9\u4e9bfragment\u5982\u679c\u4e5f\u662f\u7ee7\u627f\u4e8e<code>DaggerFragment</code>\u7684\uff0c\u90a3\u4e48\u5982\u540c\u524d\u9762\u6240\u8bf4\uff0c\u53ef\u4ee5\u7528<code>@ContributesAndroidInjector</code>\u7c7b\u4f3c\u7684\u5b8c\u6210\u3002</p> <p>\u5230\u8fd9\u4e00\u6b65\uff0c\u6211\u4eec\u8fd8\u6ca1\u6709\u6d89\u53caViewModelProvider.Factory\u7684\u63d0\u4f9b\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#3-viewmodelproviderfactory","title":"3. \u58f0\u660eViewModelProvider.Factory","text":"<p>\u6b64\u8fc7\u7a0b\u6211\u5b8c\u5168\u6309\u7167\u4e86blueprint\u9879\u76ee\u4f5c\u4e3a\u53c2\u7167\u3002\u9700\u8981\u51e0\u4e2a\u6b65\u9aa4\uff1a - \u7528<code>@MapKey</code>\u6ce8\u89e3\u521b\u5efa<code>ViewModelKey</code>\u6ce8\u89e3\uff0c\u53c2\u6570\u662fViewModel\u5b50\u7c7b\u3002\u4fbf\u4e8e\u6ce8\u518cViewModel\u65f6\u6807\u8bc6\u3002 - \u63d0\u4f9b\u4e00\u4e2adagger moudle\uff0c\u63d0\u4f9b\u4e86<code>ViewModelProvider.Factory</code>\uff0c\u800c\u5b83\u7684\u5b9e\u73b0\u7c7b\u7684\u6784\u9020\u51fd\u6570\u901a\u8fc7<code>Inject</code>\u6ce8\u89e3\uff0c\u6ce8\u5165Dagger\u641c\u96c6\u5230\u7684ViewModel Map\u3002 - \u501f\u52a9 <code>@Binds</code> <code>@IntoMap</code> <code>@ViewModelKey(XxxxViewModel::class)</code>\u6ce8\u89e3\u5230\u63a5\u53e3\u65b9\u6cd5\uff0c\u63d0\u4f9bViewModel\u3002 - \u5728\u9700\u8981ViewModel\u7684Fragment\u7684dagger component\u4e2d\uff0c\u5f15\u5165\u7b2c\u4e8c\u90e8\u7684module\u4f5c\u4e3a\u4f9d\u8d56\u5373\u53ef\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#_2","title":"\u5176\u4ed6","text":"<p><code>@IntoMap, @IntoSet</code>\u786e\u5b9e\u662f\u66f4\u4e3a\u5f3a\u5927\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u7406\u8bba\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u641c\u96c6\u3001\u63d0\u4f9b\u51fa\u66f4\u591a\u6709\u4ef7\u503c\u7684\u4e1c\u897f\u3002\u800c\u5bf9\u4e8e\u4f7f\u7528\u7684\u5730\u65b9\uff0c\u4ec5\u4ec5\u662f\u53ea\u9700\u8981<code>@Inject</code>\u5230\u6784\u9020\u5668\u6216\u8005\u6210\u5458\u53d8\u91cf\uff0c\u5373\u53ef\u4eab\u53d7\u5230\u8fd9\u4efdmap\u3002</p> <p>\u867d\u7136\u5f3a\u5927\uff0c\u4f46\u662f\u5b83\u4f7f\u7528\u8d77\u6765\u786e\u5b9e\u9700\u8981\u9002\u5e94\u3002\u56e0\u4e3a\u9700\u8981\u4e00\u8fb9\u5199\u7528\u4e8ekapt\u7684\u4f7f\u7528\u5927\u91cf\u6ce8\u89e3\u7684\u4ee3\u7801\uff0c\u6765\u8868\u8ff0\u5173\u7cfb\u3001\u914d\u7f6e\u3001\u6ce8\u518c\uff0c\u53e6\u4e00\u8fb9\u9700\u8981\u5728apt\u540e\u7684\u4e16\u754c\u53bb\u4f7f\u7528\u3002\u8fd9\u79cd\u5206\u9694\u867d\u7136\u7406\u8bba\u4e0a\u5e94\u8be5\u5e76\u4e0d\u9700\u8981\u7279\u522b\u6ce8\u610f\uff0c\u4f46\u8fd8\u662f\u4f1a\u611f\u89c9\u5947\u602a\u3002</p> <p>\u6b64\u5916\uff0c\u7531\u4e8e\u4e0d\u5f53\u7684\u4f7f\u7528\uff0c\u548c\u8303\u56f4\u7684\u7ba1\u7406\uff0c\u53ef\u80fd\u4e5f\u5bb9\u6613\u51fa\u73b0\u5b66\u4e60\u4e0d\u7cbe\u5e26\u6765\u7684\u6392\u67e5\u6210\u672c\u3002</p> <p>\u4e0d\u7528\u5bb3\u6015\uff0c\u53ef\u4ee5\u770b\u770b\u81ea\u52a8\u751f\u6210\u7684\u4ee3\u7801\uff0c\u6216\u8bb8\u4f1a\u5e2e\u52a9\u7406\u89e3</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#_3","title":"\u778e\u63b0\u4e00\u53e5","text":"<p>\u5b9e\u9645\u4e0a\u6211\u8ba4\u4e3a\uff0c\u4f5c\u4e3a\u4f9d\u8d56\u6ce8\u5165\uff0c\u5b83\u5728\u89e3\u51b3\u95ee\u9898\u7684\u540c\u65f6\uff0c\u4f46\u4e5f\u5728\u5f15\u5165\u5bf9\u5b83\u7684\u67d0\u4e9b\u4f9d\u8d56\uff0c\u8fd9\u4e00\u70b9\u5df2\u7ecf\u4e0d\u592a\u5b8c\u7f8e\u4e86\u3002\u8bed\u8a00\u5c42\u9762\u6216\u8bb8\u4f1a\u6709\u66f4\u597d\u7684\u89e3\u51b3\u9014\u5f84\u3002\u4f9d\u8d56\u662f\u7531\u8bed\u8a00\u8fdb\u5165\u8fdb\u6765\u7684\uff0c\u5b83\u65e0\u6bd4\u81ea\u7136\uff0c\u4f9d\u8d56\u6ce8\u5165\u53ea\u662f\u56e0\u4e3a\u8fd9\u79cd\u539f\u6709\u7684\u4f9d\u8d56\u5173\u7cfb\u5728\u67d0\u4e9b\u65f6\u5019\u53d8\u5f97\u590d\u6742\u3001\u4ee5\u53ca\u6709\u5197\u4f59\u5904\u7406\u4ee3\u7801\u7b49\u95ee\u9898\u3002\u65e0\u8bba\u7a0b\u5e8f\u5728\u7f16\u8bd1\u65f6\u3001\u8fd8\u662f\u5728\u8fd0\u884c\u65f6\uff0c\u90fd\u4f34\u968f\u7740\u4f9d\u8d56\u7684\u89e3\u6790\u3002\u800c\u6ce8\u5165\u66f4\u50cf\u662f\u201c\u58f0\u660e\u5f0f\u201d\u7684\u4f7f\u7528\uff0c\u53ea\u201c\u58f0\u660e\u201d\u9700\u8981\u4ec0\u4e48\uff0c\u5728\u4ec0\u4e48\u8303\u56f4\u5185\u5171\u4eab\uff0c\u6807\u8bc6\u7b26\u5982\u4f55\u7b49\uff0c\u5b83\u4e4b\u6240\u4ee5\u80fd\u53d6\u5f97\uff0c\u524d\u63d0\u662f\u4f9d\u8d56\u56fe\u5df2\u7ecf\u6210\u7acb\uff0c\u800c\u4e14\u8303\u56f4\u8fd9\u4e9b\u5df2\u7ecf\u88ab\u6211\u4eec\u624b\u52a8\u7eb3\u5165\u8003\u8651\u6dfb\u52a0\u5230\u4e86\u5404\u79cd\u8bf4\u660e\u7ec6\u8282\u91cc\uff0c\u53d1\u751f\u7684\u771f\u6b63\u201c\u9b54\u6cd5\u201d\u5e76\u4e0d\u591a\uff0c\u5b83\u4eec\u53ea\u662f\u4e00\u7c7b\u201c\u8868\u8ff0\u5de5\u5177\u94fe\u201d\uff0c\u5728\u9a8c\u8bc1\u4f9d\u8d56\u5173\u7cfb\u65e0\u8bef\u540e\uff0c\u4e3a\u4f60\u751f\u6210\u51fa\u8f93\u5165\u53c2\u6570\u7684\u4ee3\u7801\u800c\u5df2\u3002</p> <p>\u8bed\u8a00\u5c42\u9762\u6216\u8bb8\u53ef\u4ee5\u7ed9\u51fa\u66f4\u591a\u7684\u652f\u6301\u3002\u6bd4\u8d77javax\u7684inject\u90a3\u4e9b\u6ce8\u89e3\u7c7b\u53ef\u4ee5\u66f4\u8fdb\u4e00\u6b65\u3002\u5c31\u5982Kotlin\u7684\u5c5e\u6027\u59d4\u6258\u5176\u5b9e\u4e5f\u5728\u6709\u6548\u63a8\u52a8\u8fd9\u79cd\u53d1\u5c55\u4e00\u6837\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#_4","title":"\u4f18\u52a3","text":"<p>\u9996\u5148\u5e94\u8be5\u628a\u81ea\u52a8\u5316DI\u5de5\u5177\u548c\u624b\u52a8DI\u90fd\u7406\u89e3\u4e3aDI\uff0c\u7136\u540e\u8ba8\u8bbaDI\u548c\u975eDI\u7684\u4f18\u52a3\u5bf9\u6bd4\u3002\u8fd9\u6837\u81ea\u7136\u4e0d\u5fc5\u591a\u8bf4\uff0c\u5bf9\u6bd4\u7684\u662f\uff0c\u4e00\u4e2a\u5c01\u88c5\u7c7b\u3001\u65b9\u6cd5\u7684\u529f\u80fd\uff0c\u662f\u4f9d\u8d56\u4e8e\u5165\u53c2\u63d0\u4f9b\u7684\u4fe1\u606f\u6765\u5b8c\u6210\u529f\u80fd\uff0c\u8fd8\u662f\u57fa\u672c\u4e0d\u9700\u8981\u5165\u53c2\uff0c\u800c\u5c3d\u53ef\u80fd\u5185\u90e8\u81ea\u5df1\u53bb\u7d22\u53d6\u3001\u521b\u5efa\u6240\u6709\u9700\u8981\u4e1c\u897f\u3002\u4ece\u8fd9\u4e2a\u51fa\u53d1\u70b9\uff0c\u8bb8\u591a\u5173\u4e8e\u63cf\u8ff0DI\u7684\u4f18\u70b9\u5c31\u5f88\u597d\u7406\u89e3\u4e86\uff1a - \u4fbf\u4e8e\u4ee3\u7801\u590d\u7528 - \u4fbf\u4e8e\u91cd\u6784 - \u6613\u4e8e\u6d4b\u8bd5</p> <p>\u56e0\u4e3a\u81ea\u52a8DI\u548c\u624b\u52a8DI\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u90fd\u53ef\u4ee5\u8f7b\u677e\u66ff\u6362\u5b9e\u73b0\uff0c\u6240\u4ee5\u5b83\u4eec\u90fd\u4eab\u53d7DI\u7684\u8fd9\u4e9b\u4f18\u70b9\u3002\u81ea\u52a8DI\u53ea\u662f\u8fdb\u4e00\u6b65\u51cf\u5c11\u4e86\u4e00\u4e9b\u6837\u677f\u4ee3\u7801\uff08\u5982\u679c\u6709\uff09\u3002</p> <p>\u7f3a\u70b9\uff0c\u548c\u975eDI\uff0c\u6bd4\u5982Service Locator\u76f8\u6bd4\uff0c\u6709\u65f6\u5019\u589e\u52a0\u4e86\u590d\u6742\u6027\uff0c\u9700\u8981\u4f20\u9012\uff0c\u4f20\u9012\u9700\u8981\u6210\u672c.</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/#_5","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Android developer, dependency-injection</li> <li>Android Blueprint Example\uff0c\u53ef\u80fd\u9700\u8981\u5207\u6362\u5230\u5176\u4ed6\u5206\u652f</li> <li>Dagger 2</li> <li>Android developer, dagger</li> </ul> <p>\u7b2c\u4e09\u65b9\u57fa\u4e8eKotlin\u7684\u5e93</p> <ul> <li>koin</li> <li>kodein</li> </ul>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%9C%8D%E5%8A%A1%E5%AE%9A%E4%BD%8D%E5%99%A8/","title":"\u670d\u52a1\u5b9a\u4f4d\u5668","text":"<p>\u5b83\u4e00\u822c\u88ab\u8ba4\u4e3a\u662f\u548c\u201c\u4f9d\u8d56\u6ce8\u5165\u201d\u8bbe\u8ba1\u6a21\u5f0f\u5f62\u6210\u76f8\u53cd\u64cd\u4f5c\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002\u4e00\u822c\u9700\u8981\u63d0\u4f9b\u4e00\u7cfb\u5217\u7684\u670d\u52a1\u63a5\u53e3\u3001\u6ce8\u518c\u670d\u52a1\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u3001\u5728\u9700\u8981\u65f6\u518d\u5b9e\u4f8b\u5316\u670d\u52a1\u5b9e\u73b0\uff0c\u5e76\u8003\u8651\u7f13\u5b58\u5b9e\u73b0\u3002\u6bd4\u5982\u5b89\u5353\u4e2d<code>getSystemService()</code>\u3002</p> <p>\u5b83\u88ab\u8ba4\u4e3a\u662f\u8db3\u591f\u7b80\u5355\u3001\u5bf9\u5c0f\u578b\u5e94\u7528\u53cb\u597d\u7684\u3002\u7f3a\u70b9\u5728\u4e8e\u5b83\u9690\u79d8\u4e86\u670d\u52a1\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u53e6\u5916\u4ece\u6d4b\u8bd5\u3001\u5bf9\u67d0\u5207\u9762\u6d4b\u8bd5\u65f6\u4e5f\u6bd4\u201c\u4f9d\u8d56\u6ce8\u5165\u201d\u66f4\u52a0\u56f0\u96be\u3002</p> <p>\u4f46\u65e0\u8bba\u5982\u4f55\uff0c\u8fd9\u4e24\u79cd\u65b9\u5f0f\u90fd\u5341\u5206\u5e38\u89c1\uff0c\u4ee5\u81f3\u4e8e\u6709\u65f6\u5019\u4f1a\u5ffd\u7565\u8ba4\u4e3a\u5b83\u662f\u8bbe\u8ba1\u6a21\u5f0f\u7684\u4e00\u79cd\u3002</p> <p>Jdk6\u63d0\u4f9b\u4e86ServiceProviderInterface\uff0c\u501f\u52a9\u5728jar\u6587\u4ef6\u4e2d\u63d0\u4f9b\u989d\u5916\u7684\u5143\u6570\u636e\uff0c\u6765\u5efa\u7acb\u670d\u52a1\u548c\u5b9e\u73b0\u7c7b\u7684\u6620\u5c04\u5173\u7cfb\u3002\u8fd9\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u5355\u7684\u6b64\u8bbe\u8ba1\u6a21\u5f0f\u7684\u5b9e\u73b0\u673a\u5236\u3002</p>"},{"location":"%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%9C%8D%E5%8A%A1%E5%AE%9A%E4%BD%8D%E5%99%A8/#_1","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Service Locator Pattern and Java Implementation</li> <li>\u201cJava\u201d section</li> </ul>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/","title":"Compose\u7406\u89e3","text":""},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/#_1","title":"\u80cc\u666f","text":"<p>\u6211\u8ba4\u4e3aCompose\u7684\u8bde\u751f\uff0c\u51fa\u4e8e\u5982\u4e0b\u51e0\u4e2a\u80cc\u666f\uff1a</p> <ul> <li>\u58f0\u660e\u5f0fUI\u5f97\u5230\u8ffd\u6367\u3002\u524d\u7aef\u957f\u671f\u7684\u58f0\u660e\u5f0f\u6846\u67b6\u601d\u7ef4\u4e60\u60ef\uff0c\u4ee5\u53caReact, Vue\u7b49\u5e93\uff0c\u90fd\u662f\u5f88\u597d\u7684\u4ee3\u8868\u3002</li> <li>Kotlin\u5bf9DSL\u7684\u53cb\u597d\u652f\u6301\uff0c\u53ef\u4ee5\u9ad8\u6548\u5236\u5b9aDSL\u3002</li> <li>Android\u4e00\u76f4\u4ee5\u6765\u51e0\u4e4e\u90fd\u662f\u547d\u4ee4\u5f0f\u5f00\u53d1\uff08\u9664\u4e86\u89c6\u56fe\u7ed1\u5b9a\u3001\u6570\u636e\u7ed1\u5b9a\uff09\u3002</li> </ul>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/#compose","title":"Compose","text":"<p>\u662f\u4e00\u5957\u65e8\u5728\u7528\u58f0\u660e\u5f0f\u65b9\u5f0f\u6765\u6784\u5efa\u539f\u751fUI\u7684\u7cfb\u7edf\uff0c\u6709\u6bd4\u8f83\u7ec6\u81f4\u7684\u5206\u5c42\u67b6\u6784\u3002\u5b83\u76ee\u6807\u5e94\u8be5\u662f\u80fd\u66ff\u4ee3\u73b0\u6709\u7684Android View\u7cfb\u7edf\uff0c\u5c3d\u7ba1\u5982\u6b64\uff0c\u4e5f\u63d0\u4f9b\u4e86\u6298\u4e2d\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u4ee5<code>ComposeView:View</code>\u6765\u5f15\u5165\u5230View\u7684\u7ed3\u6784\u4e4b\u4e2d\u3002\u751a\u81f3\uff0c\u5728<code>ComposeView</code>\u4e4b\u4e2d\uff0c\u4f9d\u7136\u53ef\u4ee5<code>addView(View)</code>\u4ee5\u6b64\u6765\u5f25\u8865\u4e00\u4e9bCompose\u6682\u65f6\u4e0d\u4fbf\u652f\u6301\u7684<code>View</code>\u3002</p> <p>\u4ece\u8fd9\u4e2a\u76ee\u7684\u51fa\u53d1\uff0c\u5b83\u5728Android\u7684UI\u57fa\u7840Framework\u5373\uff0cchorographer, Canvas\u4e4b\u4e0a\uff0c\u6784\u5efa\u4e86\u81ea\u5df1\u7684\u63a5\u53e3\u7cfb\u7edf\u3002\u8fd9\u4e00\u7cfb\u5217\u7684\u65b0\u65b9\u5f0f\uff0c\u5bf9\u4e8e\u4e4b\u524d\u719f\u6089<code>View/ViewGroup</code>\u63a5\u53e3\u7684\u4eba\u6765\u8bf4\uff0c\u662f\u5168\u65b0\u7684\u3001\u964c\u751f\u7684\u3002\u56e0\u4e3a\u5c06\u4e0d\u518d\u6709\u719f\u6089\u7684<code>Text:View, LinearLayout:ViewGroup, View.setOnClickListener, Text.setText\uff0c ViewGroup.addView</code>\u7b49\u8fd9\u4e9b\u63a5\u53e3\u3002\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u5168\u65b0\u7684\u4e00\u5957\u3002</p> <p>\u5728\u4e00\u5f00\u59cb\u6211\u4ee5\u4e3aCompose\u53ea\u662f\u57fa\u4e8eView\u7684\u63a5\u53e3\u91cd\u65b0\u4ee5DSL\u7684\u65b9\u5f0f\u7ec4\u7ec7\uff0c\u66ff\u4ee3\u7684\u662fXML\u586b\u5145\u65b9\u5f0f\uff08\u867d\u7136\u66ff\u4ee3XML\u66f4\u65e9\u4e5f\u6709\u7b2c\u4e09\u65b9\u7684\u5e93\uff09\u3002\u540e\u6765\u624d\u610f\u8bc6\u5230Compose\u76ee\u6807\u66f4\u52a0\u6fc0\u8fdb\u3002\u662f\u4e00\u4e2a\u5168\u65b0\u7684\u65b9\u5f0f\u6765\u6784\u5efaAndroid\u539f\u751f\u3002\u751a\u81f3\u8fd8\u6709Compose For Desktop\u8fd9\u79cd\u4ea7\u7269\u51fa\u73b0\u3002</p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/#_2","title":"\u4f18\u52a3","text":"<p>\u6309\u5b98\u65b9\u6587\u6863\u8bf4\u660e\uff0c\u4f7f\u7528Compose\u7684\u4f18\u70b9\u5728\u4e8e\u66f4\u5c0f\u7684\u5305\u4f53\u79ef\u3001\u66f4\u5feb\u7684\u6784\u5efa\u65f6\u95f4\u3002\u8fd9\u4e24\u70b9\u5747\u5f97\u76ca\u4e8e\u53bb\u9664\u4e86\u5e03\u5c40XML\u8d44\u6e90\u7684\u5904\u7406\u3002\u6b64\u5916\uff0c\u8fd0\u884c\u65f6\u6027\u80fd\u4e5f\u88ab\u8ba4\u4e3a\u66f4\u5feb\uff0c\u56e0\u4e3a\u907f\u514d\u4e86XML\u7684\u89e3\u6790\u586b\u5145\u8fc7\u7a0b\u3002</p> <p>\u7f3a\u70b9\uff1a\u5bf9\u4e8e\u90e8\u5206\u5f15\u5165Compose\u540e\u4e5f\u4f1a\u5e26\u6765\u5305\u589e\u91cf\u3002\u975e\u6346\u7ed1\u5e93\u4f7f\u5f97\u4e0d\u80fd\u50cfView\u7684\u63a5\u53e3\u5728Zygote\u65f6\u6709\u9884\u52a0\u8f7d\u3002\u4f46\u662f\u5b83\u9644\u5e26\u4e86\u5b89\u88c5\u89c4\u5219\u6587\u4ef6\uff08<code>ProfileInstaller</code>\uff09\uff0c\u5c06\u6709\u52a9\u4e8e\u5728\u5b89\u88c5apk\u65f6\uff0c\u8fdb\u884cAOT\u7f16\u8bd1\u3002\u5e2e\u52a9\u51cf\u5c11Compose\u542f\u52a8\u65f6\u95f4\u548c\u5361\u987f\u3002</p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/#_3","title":"\u4e2a\u4eba\u5f00\u53d1\u4f53\u9a8c","text":"<p>\u4f7f\u7528Compose\u5f00\u53d1\u4e86\u97f3\u4e50\u7684\u9875\u9762\uff0c\u53ea\u6d89\u53ca\u4e86\u57fa\u672c\u7684\u9875\u9762\u5143\u7d20\u548c\u4ea4\u4e92\uff0c\u53ea\u4eceUI\u76f8\u5173\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u4e2a\u4eba\u8bc4\u4ef7\u8981\u70b9\u5982\u4e0b\uff1a</p> <ul> <li>\u628aUI\u7684\u6784\u5efa\u62c6\u5206\u5230\u4ee3\u7801\u903b\u8f91\u4e2d\uff0c\u8fd9\u79cd\u611f\u89c9\u5bf9\u5b89\u5353\u6765\u8bf4\u662f\u65b0\u9896\u7684\uff0c\u6709\u4e9b\u7c7b\u4f3c\u524d\u7aef\u7684\u9879\u76ee\u3002</li> <li>Compose\u505a\u5230\u4e86\u58f0\u660e\u5f0f\u3001\u505a\u5230\u4e86\u53ef\u7ec4\u5408\uff0c\u4f46\u5728\u4eab\u53d7\u9ad8\u6548\u5f00\u53d1UI\u524d\uff0c\u6709\u5f88\u591a\u5b66\u4e60\u6210\u672c\u9700\u8981\u514b\u670d\u3002</li> <li>\u754c\u9762Preview\u8fd8\u6bd4\u8f83\u7e41\u7410\uff0c\u76ee\u524d\u53eaPreview\u4e86\u5f88\u7b80\u5355\u7684\u5143\u7d20\uff0c\u590d\u6742\u9875\u9762\u7684Preview\u6613\u7528\u6027\u4e0a\u76ee\u524d\u8fd8\u6bd4\u4e0d\u8fc7Xml\u7684tools\u547d\u540d\u7a7a\u95f4\u3002\u66f4\u591a\u65f6\u5019\u662f\u65e0\u53ef\u89c6\u5316\uff0c\u51e0\u4e4e\u53ea\u770b\u4ee3\u7801\u6765\u9884\u6d4b\u9875\u9762\u5e03\u5c40\u3002</li> <li>\u5bf9Material\u652f\u6301\u53cb\u597d\uff0c\u4f46\u82e5\u6d89\u53ca\u5e7f\u6cdb\u7684UI\uff0c\u5c06\u6709\u5927\u91cf\u7684\u5b66\u4e60\u6210\u672c\u3002\u6bd4\u5982\u52a8\u753b\u3001\u5217\u8868\u3001\u6eda\u52a8\u3001\u53ef\u7ed8\u5236\u56fe\u50cf\u7b49\u7b49\u3002\u56e0\u4e3a\u5931\u53bb\u4e86\u8d44\u6e90\u6587\u4ef6\uff0c\u610f\u5473\u7740\u5f88\u591a\u65f6\u5019\u9700\u8981\u9760API\u6765\u63cf\u8ff0\uff0c\u800c\u638c\u63e1\u8fd9\u4e9bAPI\u9700\u8981\u7cbe\u529b\u3002</li> <li>\u72b6\u6001\u66f4\u65b0\u65f6\u9700\u8981\u5c0f\u5fc3\uff0c\u6709\u4e00\u5b9a\u5b66\u4e60\u6210\u672c\u3002\u4e0d\u5c0f\u5fc3\u7684\u72b6\u6001\u7ba1\u7406\uff0c\u4f1a\u5bfc\u81f4\u9875\u9762\u4e0d\u65adRecompose\uff0c\u800c\u4e14\u51e0\u4e4e\u5f97\u4e0d\u5230\u4efb\u4f55\u63d0\u793a\uff0c\u4e5f\u4e00\u5207\u8fd0\u4f5c\u826f\u597d\u3002\u72b6\u6001\u66f4\u65b0\u7b49\u65b9\u5f0f\u9700\u8981\u4e60\u60ef\u3001\u9002\u5e94\u3002</li> <li>\u6bd4\u4f20\u7edf\u5b89\u5353\u5f00\u53d1\u66f4\u8f7b\u4fbf\u7b80\u6d01\u5feb\u901f\u3002\u5c31\u50cf\u6211\u53ea\u60f3\u8868\u8fbe\u5217\u8868\u65f6\uff0c\u5e76\u4e0d\u4e50\u610f\u4e3aRecyclerview\u5199\u90a3\u4e48\u591a\u7c7b\u4e00\u6837\u3002</li> </ul>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/#_4","title":"\u778e\u63b0\u4e00\u53e5","text":"<p>Compose\u4e0d\u4ec5\u662f\u4e00\u4e2a\u5b89\u5353\u4e0a\u7684\u9009\u9879\uff0cJetBrains\u628aCompose\u4e5f\u4f5c\u4e3a\u5728\u591a\u5e73\u53f0\u4e0a\u63a8\u5e7fKotlin\u6784\u5efaUI\u5e94\u7528\u7684\u65b9\u5f0f\u3002\u8fd9\u7ed9\u5b66\u4e60\u638c\u63e1Compose\u7684\u4eba\u5e26\u6765\u4e86\u66f4\u591a\u7684\u6536\u76ca\u3002\u622a\u81f3\u76ee\u524d\uff0cCompose\u591a\u5e73\u53f0\u8fd8\u5904\u4e8ealpha\u72b6\u6001\u3002\u4e0d\u8fc7\u672a\u6765\u4e5f\u4f1a\u662f\u8de8\u7aef\u65b9\u5411\u7684\u53c8\u4e00\u65b9\u6848\u3002\u8fd9\u4ee3\u8868\u7740\uff0cCompose/Flutter\u8fd9\u4e24\u4e2a\u5b89\u5353\u4e0a\u8f83\u70ed\u95e8\u7684\u8de8\u7aef\u65b9\u6848\uff0c\u5c06\u9762\u4e34\u66f4\u590d\u6742\u7684\u5173\u7cfb\u3002</p> <p>\u6211\u4eec\u4e0d\u59a8\u7b80\u5355\u5bf9\u6bd4\u4e00\u4e0bCompose\u548cFlutter\uff0c\u5728\u5bf9\u5916\u63a5\u53e3\u5c42\uff0c\u5bf9\u5f00\u53d1\u8005\u7684\u4f53\u9a8c\u5176\u5b9e\u5c31\u662f\uff0cKotlin\u7684\u751f\u6001\u4e0eDart\u7684\u751f\u6001\uff0c\u4f60\u66f4\u559c\u6b22\u7528Kotlin\u7684Compose DSL\u89c4\u5219\u6765\u5199\u9875\u9762\uff0c\u8fd8\u662fDart\u7684Flutter\u6765\u4ee5\u54cd\u5e94\u5f0f\u6784\u5efa\u9875\u9762\u3002\u66f4\u4e0b\u4e00\u5c42\uff0cCompose\u503e\u5411\u4e8e\u501f\u52a9\u5e73\u53f0\u7684\u539f\u751f\u80fd\u529b\uff0cFlutter\u5219\u662f\u81ea\u5e26\u4e00\u4e2aUI\u5f15\u64ce\u3002\u4f46\u9274\u4e8eFlutter\u7684UI\u5f15\u64ce\u662fC++\u5b8c\u6210\u7684\uff0c\u5bf9\u4e8eCompose\u6765\u8bf4\u4f9d\u7136\u53ef\u4ee5\u652f\u6301\uff0c\u56e0\u6b64\uff0c\u8fd9\u663e\u5f97Flutter\u7684\u4e0a\u5c42\uff0cDart/Dart VM\u5904\u5883\u7565\u5fae\u5c34\u5c2c\u3002\u4f46Dart, Dart VM\u4e5f\u53f7\u79f0\u662f\u5176\u8bbe\u8ba1\u80fd\u6709\u52a9\u4e8e\u66f4\u5feb\u8fdb\u884c\u8fd9\u79cdUI\u6811\u7684\u91cd\u5efa\u3002</p> <p>\u6211\u5bf9Dart\u4e86\u89e3\u8fd8\u4e0d\u591a\uff0c\u8fd9\u91cc\u4e0d\u591a\u518d\u778e\u626fDart\u548cKotlin\u7684\u5bf9\u6bd4\u3002</p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/Compose/Compose%E7%90%86%E8%A7%A3/#_5","title":"\u62d3\u5c55\u9605\u8bfb","text":"<ul> <li>Compose\u5206\u5c42\u67b6\u6784\u5b98\u7f51\u6587\u6863\uff0c\u82e5\u5173\u6ce8\u5982\u4f55\u5b9e\u73b0\uff0c\u53ef\u4ee5\u5173\u6ce8compose.ui\u5305\u4e0b\u5185\u5bb9\u3002</li> <li>ProfileInstaller\u4ecb\u7ecd</li> <li>Compose\u591a\u5e73\u53f0</li> </ul>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/electron/%E6%A6%82%E8%BF%B0/","title":"\u6982\u8ff0","text":"<p><code>Electron \u57fa\u4e8e Chromium \u548c Node.js, \u8ba9\u4f60\u53ef\u4ee5\u4f7f\u7528 HTML, CSS \u548c JavaScript \u6784\u5efa\u5e94\u7528\u3002</code></p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/electron/%E6%A6%82%E8%BF%B0/#_1","title":"\u8fdb\u7a0b\u6a21\u578b","text":""},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/electron/%E6%A6%82%E8%BF%B0/#_2","title":"\u4e3b\u8fdb\u7a0b","text":"<p>\u6bcf\u4e2a Electron \u5e94\u7528\u90fd\u6709\u4e00\u4e2a\u5355\u4e00\u7684\u4e3b\u8fdb\u7a0b\uff0c\u4f5c\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u5165\u53e3\u70b9\u3002 \u4e3b\u8fdb\u7a0b\u5728 Node.js \u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5177\u6709 require \u6a21\u5757\u548c\u4f7f\u7528\u6240\u6709 Node.js API \u7684\u80fd\u529b\u3002</p> <p>\u4e3b\u8fdb\u7a0b\u7684\u4e3b\u8981\u76ee\u7684\u5305\u62ec\uff1a - \u4f7f\u7528 BrowserWindow \u6a21\u5757\u521b\u5efa\u548c\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u3002 - \u901a\u8fc7 Electron \u7684 app \u6a21\u5757\u6765\u63a7\u5236\u60a8\u5e94\u7528\u7a0b\u5e8f\u7684\u751f\u547d\u5468\u671f\u3002 - \u4e3b\u8fdb\u7a0b\u4e5f\u6dfb\u52a0\u4e86\u81ea\u5b9a\u4e49\u7684 API \u6765\u4e0e\u7528\u6237\u7684\u4f5c\u4e1a\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002 Electron \u6709\u7740\u591a\u79cd\u63a7\u5236\u539f\u751f\u684c\u9762\u529f\u80fd\u7684\u6a21\u5757\uff0c\u4f8b\u5982\u83dc\u5355\u3001\u5bf9\u8bdd\u6846\u4ee5\u53ca\u6258\u76d8\u56fe\u6807\u3002</p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/electron/%E6%A6%82%E8%BF%B0/#_3","title":"\u6e32\u67d3\u8fdb\u7a0b","text":""},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/flutter/%E6%A6%82%E8%BF%B0/","title":"\u6982\u8ff0","text":"<p>Flutter\u67b6\u6784\u5206\u4e3a\u4e09\u5c42\uff1a</p> <ul> <li>Framework\uff1a\u4f7f\u7528Dart\u7f16\u5199\u7684UI\u5e94\u7528\u6846\u67b6\uff0c\u4f9d\u8d56engine\u5c42\u7684Dart\u5c01\u88c5\u3002</li> <li>Engine\uff1a\u5927\u90e8\u5206\u662f\u7528 C++ \u7f16\u5199\u7684\uff0c\u5b83\u63d0\u4f9b\u4e86 Flutter \u6838\u5fc3 API \u7684\u5e95\u5c42\u5b9e\u73b0\uff0c\u5305\u62ec\u56fe\u5f62\uff08\u901a\u8fc7Skia\uff09\u3001\u6587\u672c\u5e03\u5c40\u3001\u6587\u4ef6\u548c\u7f51\u7edc I/O\u3001\u53ef\u8bbf\u95ee\u6027\u652f\u6301\u3001\u63d2\u4ef6\u67b6\u6784\u4ee5\u53ca Dart \u8fd0\u884c\u65f6\u548c\u7f16\u8bd1\u5de5\u5177\u94fe\u3002</li> <li>Embeder: \u5d4c\u5165\u5c42\u4e3b\u8981\u662f\u63d0\u4f9b\u5404\u5e73\u53f0\u63a5\u5165Flutter\u6240\u63d0\u4f9b\u7684\u5e73\u53f0\u76f8\u5173\u4ee3\u7801\uff0c\u91c7\u7528\u5e73\u53f0\u4e3b\u6d41\u8bed\u8a00\u7f16\u5199\uff0c\u5305\u62ec\u63d2\u4ef6\u3001\u6e32\u67d3\u8868\u9762\u3001\u7ebf\u7a0b\u914d\u7f6e\u7b49\u3002</li> </ul> <p></p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/flutter/%E6%A6%82%E8%BF%B0/#dart-vs-javascript","title":"Dart vs Javascript","text":"<p>\u5b83\u4eec\u90fd\u662f\u5355\u7ebf\u7a0b\u8bed\u8a00\u3002\u4e14\u53d7Node.js\u542f\u53d1\u3002Dart:io\u4e5f\u4f9d\u8d56\u5f02\u6b65\u56de\u8c03\u3001\u4e8b\u4ef6\u9a71\u52a8\u3002</p> <p>Dart is a single-threaded programming language. If an operation blocks the Dart thread, the application makes no progress before that operation completes. For scalability it is therefore crucial that no I/O operations block. Instead of blocking on I/O operations, dart:io uses an asynchronous programming model inspired by node.js, EventMachine, and Twisted.</p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/flutter/%E6%A6%82%E8%BF%B0/#flutter-vs-compose","title":"Flutter vs Compose","text":"<p>\u4e24\u8005\u7684\u7f16\u5199\u6bd4\u8f83\u76f8\u4f3c\uff0cCompose\u5219\u662f\u501f\u9274\u4e8eFlutter\uff0c\u501f\u52a9\u4e8eKotlin DSL\u3002\u5b83\u5728\u7f16\u5199\u5b89\u5353UI\u5e94\u7528\u7684\u65f6\u5019\u6bd4Flutter\u663e\u7136\u66f4\u9ad8\u6548\uff0c\u66f4\u5c0f\u7684\u5305\u4f53\u79ef\uff0c\u4f46\u603b\u7684\u6765\u8bf4\uff0cCompose\u76f8\u5bf9\u5c0f\u4f17\u3002</p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/flutter/%E6%A6%82%E8%BF%B0/#widget-tree-element-tree-render-tree","title":"Widget tree, Element tree, Render tree.","text":"<p>\u6bcf\u4e2a<code>Widget</code>\u5728\u6784\u5efa\u65f6\u53ef\u80fd\u8fd8\u4f1a\u5f15\u5165\u5176\u4ed6<code>Widget</code>\uff0c\u6bcf\u4e2a<code>Widget</code>\u90fd\u4f1a\u5bf9\u5e94\u4e00\u4e2a<code>Element</code>\u8282\u70b9\uff0c<code>Element</code>\u6709\u4e24\u7c7b\u57fa\u672c\u8282\u70b9\uff1a</p> <ul> <li>ComponentElement, \u5176\u4ed6\u5143\u7d20\u7684\u5bbf\u4e3b\u3002</li> <li>RenderObjectElement\uff0c\u53c2\u4e0e\u5e03\u5c40\u6216\u7ed8\u5236\u9636\u6bb5\u7684\u5143\u7d20\u3002</li> </ul> <p><code>widget</code>\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u5305\u62ec\u8282\u70b9\u4e4b\u95f4\u7684\u7236/\u5b50\u5173\u7cfb\uff0c\u6240\u4ee5\u5bf9<code>widget</code> tree\u7684\u4efb\u4f55\u66f4\u6539\u90fd\u4f1a\u5bfc\u81f4\u8fd4\u56de\u4e00\u7ec4\u65b0\u7684\u5c0f\u90e8\u4ef6\u5bf9\u8c61\u3002\u4f46\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u5fc5\u987b\u91cd\u5efa\u5e95\u5c42\u8868\u793a\u3002<code>Elements</code> tree\u5728\u5e27\u4e0e\u5e27\u4e4b\u95f4\u662f\u6301\u4e45\u7684\uff0c\u56e0\u6b64\u8d77\u7740\u5173\u952e\u7684\u6027\u80fd\u4f5c\u7528\uff0c\u5141\u8bb8 Flutter \u5728\u7f13\u5b58\u5176\u5e95\u5c42\u8868\u793a\u7684\u540c\u65f6\uff0c\u5c31\u597d\u50cf\u5c0f\u90e8\u4ef6\u5c42\u6b21\u7ed3\u6784\u662f\u5b8c\u5168\u4e00\u6b21\u6027\u7684\u4e00\u6837\u3002\u901a\u8fc7\u4ec5\u904d\u5386\u66f4\u6539\u7684\u5c0f\u90e8\u4ef6\uff0cFlutter \u53ef\u4ee5\u4ec5\u91cd\u5efa\u5143\u7d20\u6811\u4e2d\u9700\u8981\u91cd\u65b0\u914d\u7f6e\u7684\u90e8\u5206\u3002</p> <p>\u6e32\u67d3\u6811\u4e2d\u6bcf\u4e2a\u8282\u70b9\u7684\u57fa\u7c7b\u662f RenderObject\uff0c\u5b83\u7684\u5b50\u7c7b\u4eec\u8d1f\u8d23\u5177\u4f53\u7684\u6d4b\u91cf\u548c\u7ed8\u5236\u3002\u6811\u7684\u6839\u662f<code>RenderView</code>\u3002\u5b83\u8868\u793a\u6e32\u67d3\u6811\u7684\u603b\u8f93\u51fa\u3002\u5f53\u5e73\u53f0\u8981\u6c42\u6e32\u67d3\u65b0\u5e27\u65f6\uff08\u4f8b\u5982\uff0c\u7531\u4e8e vsync\u6216\u7531\u4e8e\u7eb9\u7406\u89e3\u538b\u7f29/\u4e0a\u4f20\u5b8c\u6210\uff09\uff0c\u5c06\u8c03\u7528\u8be5 compositeFrame()\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u662fRenderView\u6e32\u67d3\u6811\u6839\u90e8\u5bf9\u8c61\u7684\u4e00\u90e8\u5206. \u8fd9\u5c06\u521b\u5efa\u4e00\u4e2aSceneBuilder\u6765\u89e6\u53d1\u573a\u666f\u7684\u66f4\u65b0\u3002\u573a\u666f\u5b8c\u6210\u540e\uff0cRenderView\u5bf9\u8c61\u5c06\u5408\u6210\u7684\u573a\u666f\u4f20\u9012\u7ed9 \u4e2d\u7684Window.render()\u65b9\u6cd5dart:ui\uff0c\u8be5\u65b9\u6cd5\u5c06\u63a7\u5236\u6743\u4f20\u9012\u7ed9 GPU \u8fdb\u884c\u6e32\u67d3\u3002</p> <p></p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Sticker%20Board%E9%A1%B9%E7%9B%AE/","title":"Sticker Board\u9879\u76ee","text":"<p>\u8d34\u7eb8\u6d82\u9e26\u677f\uff08Sticker Board\uff09\u662f\u4e00\u6b3e\u72ec\u7acb\u5f00\u53d1\u7684\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\uff0c\u5b83\u5141\u8bb8\u591a\u4eba\u5b9e\u65f6\u5728\u5171\u4eab\u753b\u677f\u4e0a\u8fdb\u884c\u521b\u4f5c\u3002\u5fae\u4fe1\u626b\u7801\u4e0b\u65b9\u4e8c\u7ef4\u7801\u5373\u53ef\u4f53\u9a8c\uff1a</p> <p></p>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Sticker%20Board%E9%A1%B9%E7%9B%AE/#_1","title":"\u529f\u80fd\u7279\u6027","text":"<ul> <li>\u591a\u4eba\u5b9e\u65f6\u5728\u5171\u4eab\u753b\u677f\u8fdb\u884c\u521b\u4f5c</li> <li>\u5bf9\u56fe\u7247\u81ea\u7531\u88c1\u526a\u3001\u6d82\u9e26\u8fdb\u884c\u4e8c\u6b21\u521b\u4f5c\u5e76\u4e0a\u4f20\u4f5c\u4e3a\u8d34\u7eb8</li> <li>\u4e0e\u597d\u53cb\u3001\u4e0e\u793e\u533a\u5206\u4eab\u8d34\u7eb8\u3001\u5206\u4eab\u753b\u677f\u3001\u5bfc\u51fa\u753b\u677f\u4f5c\u4e3a\u56fe\u7247</li> <li>\u753b\u677f\u66f4\u65b0\u63d0\u9192\u3001\u5185\u5bb9\u7ba1\u7406\u3001\u52a8\u753b\u3001\u81ea\u5b9a\u6837\u5f0f\u98ce\u683c\u7b49</li> </ul>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Sticker%20Board%E9%A1%B9%E7%9B%AE/#_2","title":"\u622a\u56fe","text":""},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Sticker%20Board%E9%A1%B9%E7%9B%AE/#_3","title":"\u6240\u7528\u6280\u672f","text":"<ul> <li>\u817e\u8baf\u4e91SDK\u540e\u7aef\u5b58\u50a8\u6570\u636e\u3001\u5b9e\u65f6\u63a8\u9001</li> <li>\u5c0f\u7a0b\u5e8f\u4f7f\u7528Typescript\u7f16\u5199\uff0c\u62bd\u8c61\u51fa\u4e86\u8d34\u7eb8\u7f16\u8f91\u6a21\u5757\u56e0\u6b64\u53ef\u5728\u591a\u4e2a\u9875\u9762\u4f7f\u7528</li> <li>\u8d34\u7eb8\u5236\u4f5c\u4f7f\u7528Canvas2D API\uff0c\u4e3b\u8981\u501f\u52a9\u56fe\u5c42\u6e32\u67d3\u6a21\u5f0f\uff0c\u5bfc\u51fa\u8d34\u7eb8\u4f7f\u7528DataUrl</li> <li>\u753b\u677f\u76f4\u63a5\u6d82\u9e26\u3001\u8d34\u7eb8\u521b\u4f5c\u7b49\u4f7f\u7528\u624b\u52bf\u4e8b\u4ef6\uff08\u66fe\u5c1d\u8bd5\u89e6\u6478\u4e8b\u4ef6\u52a8\u6001\u751f\u6210svg\u4f46\u5728\u624b\u673a\u4e0a\u6027\u80fd\u4e0d\u4f73\uff09</li> <li>\u201c\u753b\u677f\u5bfc\u51fa\u4f5c\u4e3a\u56fe\u7247\u201d\u529f\u80fd\u4f7f\u7528\u540e\u7aef\u751f\u6210Html\u7531Puppeteer\u622a\u56fe\u5bfc\u51fa</li> <li>\u65b0\u5efa\u753b\u677f\u968f\u673a\u6837\u5f0f\u4f7f\u7528HSL\u989c\u8272\u65b9\u6848\uff0c\u5176\u4e2dL\u7684\u53d6\u503c\u4fdd\u7559\u4e00\u5b9a\u5dee\u8ddd\uff0c\u7531\u6b64\u53ef\u4ee5\u5f97\u5230\u80fd\u6709\u5145\u8db3\u5bf9\u6bd4\u5ea6\u7684\u968f\u673a\u524d\u666f\u8272\u4e0e\u80cc\u666f\u8272\u3002</li> <li>\u8d34\u7eb8\u75313\u4e2a\u5c42\u7ec4\u6210\uff0c\u6309\u5982\u4e0b\u65b9\u5f0f\u7ed8\u5236\u3001\u8ba1\u7b97\u6709\u6548\u8fb9\u754c\u540e\u8c03\u6574\u533a\u57df\u5bfc\u51fa\u5373\u53ef\uff1a</li> <li>\u4ee5\u8d34\u7eb8\u753b\u7b14\u4f5c\u4e3a\u6837\u5f0f\uff0c\u7ed8\u5236\u8d34\u7eb8\u5185\u5bb9\u8def\u5f84+\u6d82\u9e26\u8def\u5f84\uff0c\u5373\u5f97\u5230\u8d34\u7eb8\u8fb9\u6846\u90e8\u5206\u3002</li> <li>\u539f\u56fe+SOURCE_IN\u8d34\u7eb8\u5185\u5bb9\u8def\u5f84\u7ed8\u5236\uff0c\u5373\u5f97\u5230\u8d34\u7eb8\u5185\u5bb9\u90e8\u5206\u3002</li> <li>\u4ee5\u6d82\u9e26\u753b\u7b14\u4f5c\u4e3a\u6837\u5f0f\uff0c\u7ed8\u5236\u6d82\u9e26\u8def\u5f84\uff0c\u5373\u5f97\u5230\u6700\u4e0a\u5c42\u7684\u6d82\u9e26\u90e8\u5206\u3002</li> </ul>"},{"location":"%E8%B7%A8%E7%AB%AF%E6%8A%80%E6%9C%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/Sticker%20Board%E9%A1%B9%E7%9B%AE/#_4","title":"\u8fdb\u5c55\u4e0e\u603b\u7ed3","text":"<p>\u5f00\u53d1\u5468\u671f\u63a5\u8fd14\u5468\uff0c2021\u5e749\u6708\u4e2d\u65ec\u4e0a\u7ebf\uff0c\u5f53\u524d\u7528\u6237\u89c4\u6a21&lt;50/\u5929\u3002</p> <p>\u63a8\u5e7f\u65b9\u5f0f\u6bd4\u8f83\u6709\u9650\uff0c\u5df2\u77e5\u7684\uff1a</p> <ul> <li>\u817e\u8baf\u5e7f\u544a\uff08\u5e7f\u544a\u4e3b\uff09\uff0c\u9700\u8981\u66f4\u591a\u7684\u5e94\u7528\u5185\u5bb9\u4ea7\u751f\u3001\u65e5\u6d3b\u95ee\u9898\u3001\u793e\u533a\u8d28\u91cf\u3002</li> <li>\u624b\u52a8\u65b9\u5f0f\u5728\u77e5\u4e4e\u3001\u767e\u5ea6\u8d34\u5427\u63a8\u5e7f\u3002</li> </ul> <p>\u53cd\u601d\uff1a\u5c3d\u7ba1\u5f00\u53d1\u6b64\u9879\u76ee\u524d\u5df2\u7ecf\u5c1d\u8bd5\u4e86\u5176\u4ed6\u7684\u4e24\u4e2a\u5c0f\u7a0b\u5e8f\u72ec\u7acb\u9879\u76ee\uff0c\u4e5f\u5df2\u7ecf\u505a\u4e86\u7ade\u54c1\u5206\u6790\uff0c\u601d\u8003\u4e86\u4ea7\u54c1\u5b9a\u4f4d\uff0c\u4f46\u76ee\u524d\u4ecd\u7136\u672a\u53d6\u5f97\u6240\u60f3\u8c61\u7684\u6548\u5e94\uff0c\u5bf9\u6211\u6765\u8bf4\uff0c\u6709\u5982\u4e0b\u7684\u8fd9\u4e9b\u95ee\u9898\u662f\u6ca1\u6709\u826f\u597d\u89e3\u51b3\u7684\uff1a</p> <ul> <li>\u76ee\u6807\u7528\u6237\u89e6\u8fbe</li> <li>\u89e6\u8fbe\u540e\u7528\u6237\u662f\u5426\u771f\u7684\u6709\u5174\u8da3\uff0c\u4ea7\u54c1\u5b9a\u4f4d\u662f\u5426\u7ad9\u5f97\u4f4f\u811a</li> <li>\u793e\u533a\u5185\u5bb9\u7684\u521d\u59cb\u95e8\u69db</li> <li>\u8fdb\u4e00\u6b65\u63a8\u5e7f\u524d\u7684\u8fd0\u8425\u624b\u6bb5</li> </ul> <p>\u5c0f\u7a0b\u5e8f\u9879\u76ee\u5176\u5b9e\u5728\u6211\u773c\u91cc\u53ef\u4ee5\u5206\u4e3a\u4e24\u4e2a\u73af\u8282\uff1a\u7528\u6237\u6253\u5f00\u5c0f\u7a0b\u5e8f\u524d\uff0c\u548c\u8fdb\u5165\u5c0f\u7a0b\u5e8f\u540e\u3002\u524d\u8005\u662f\u6f0f\u6597\uff0c\u540e\u8005\u662f\u771f\u6b63\u5f00\u59cb\u4ea7\u54c1\u4f53\u9a8c\u8fc7\u7a0b\u3002\u5bf9\u6211\u6765\u8bf4\uff0c\u6211\u57fa\u672c\u4e0d\u4f1a\u62c5\u5fc3\u540e\u8005\u7684\u5b9e\u73b0\u548c\u4f53\u9a8c\uff0c\u800c\u524d\u8005\u5bf9\u6211\u6765\u8bf4\u662f\u66f4\u56f0\u96be\u3001\u751a\u81f3\u9700\u8981\u501f\u52a9\u66f4\u591a\u4eba\u529b\u91cf\u624d\u80fd\u6709\u6548\u89e3\u51b3\u7684\u3002</p>"}]}